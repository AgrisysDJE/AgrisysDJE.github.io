{"version":3,"sources":["Src/Stores/CreateStore.js","Src/Stores/Startup/Actions.js","Src/Stores/Example/Actions.js","Src/Stores/Device/BLE/Actions.js","Src/Stores/Device/BlueTooth/Actions.js","Src/Stores/Device/Actions.js","Src/Services/NavigationService.js","Src/Stores/Firebase/Actions.js","Src/Sagas/StartupSaga.js","Src/Services/UserService.js","Src/Config/index.js","Src/Sagas/Example/ExampleSaga.js","Src/Services/DeviceService.js","Src/Stores/Device/Selectors.js","Src/Sagas/Device/BLE/BLESaga.js","Src/Sagas/Device/BlueTooth/BlueToothSaga.js","Src/Sagas/Device/DeviceSaga.js","Src/Stores/Firebase/Selectors.js","Src/Services/FirebaseService.js","Src/Sagas/Firebase/FirebaseSaga.js","Src/Sagas/index.js","Src/Stores/Example/InitialState.js","Src/Stores/Example/Reducers.js","Src/Stores/Device/BLE/InitialState.js","Src/Stores/Device/BlueTooth/InitialState.js","Src/Stores/Device/InitialState.js","Src/Stores/Device/BLE/Reducers.js","Src/Stores/Device/BlueTooth/Reducers.js","Src/Stores/Device/Reducers.js","Src/Stores/Firebase/Reducers.js","Src/Stores/Firebase/InitialState.js","Src/Theme/Colors.js","Src/Theme/Fonts.js","Src/Theme/Metrics.js","Src/Theme/Images.js","Src/Theme/Helpers.js","Src/Theme/ApplicationStyles.js","Src/Containers/SplashScreen/SplashScreen.js","Src/Containers/SplashScreen/SplashScreenStyle.js","Src/Containers/DeepLinking/DeepLinkingScreen.js","Src/Components/Button.js","Src/Components/Button_Panel.js","Src/Components/TitleElement.js","Src/Components/CustomListItem.js","Src/Components/ContentProp.js","Src/Components/Loading.js","Src/Components/OperationsPanel.js","Src/Components/Progressbar.js","Src/Components/DateTime_Picker.js","Src/Components/Comment_Module.js","Src/Containers/Agrisys/FrontScreenStyle.js","Src/Containers/Agrisys/FrontScreen.js","Src/Stores/Example/Selectors.js","Src/Containers/Example/ExampleScreenStyle.js","Src/Containers/Example/ExampleScreen.js","Src/Containers/Device/DeviceScreenStyle.js","Src/Containers/Device/DeviceScreen.js","Src/Navigators/FrontNavigator.js","Src/Containers/Cloud/AuthScreens/UserLoadingScreen.js","Src/Containers/Cloud/AuthScreens/AuthStyle.js","Src/Containers/Cloud/AuthScreens/VerifyScreen.js","Src/Containers/Cloud/AuthScreens/UserLoginScreen.js","Src/Containers/Cloud/UserPanel/UserPanelStyle.js","Src/Containers/Cloud/UserPanel/UserInformation.js","Src/Containers/Cloud/UserPanel/Subscription.js","Src/Containers/Cloud/UserPanel/FarmInformation.js","Src/Containers/Cloud/AuthScreens/CreateUserDataScreen.js","Src/Navigators/AuthNavigator.js","Src/Containers/Cloud/UserPanel/FrontScreen.js","Src/Containers/Cloud/UserPanel/Dashboard.js","Src/Containers/Cloud/CloudScreenStyle.js","Src/Containers/Cloud/UserPanel/Pigs.js","Src/Containers/Cloud/UserPanel/Pens.js","Src/Containers/Cloud/UserPanel/Batchs.js","Src/Containers/Cloud/UserPanel/CurveElement.js","Src/Containers/Cloud/UserPanel/GrowthCurves.js","Src/Containers/Cloud/UserPanel/Operations.js","Src/Containers/Cloud/UserPanel/Weighing.js","Src/Containers/Cloud/UserPanel/DataEditor.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pens.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pigs.js","Src/Containers/Cloud/UserPanel/DataDisplay.js","Src/Containers/Cloud/UserPanel/DataPlotter.js","Src/Navigators/UserPanelNavigator.js","Src/Containers/Cloud/AdminPanel/AdminPanelStyle.js","Src/Containers/Cloud/AdminPanel/FrontScreen.js","Src/Containers/Cloud/AdminPanel/UserBoard.js","Src/Containers/Cloud/AdminPanel/SystemBoard.js","Src/Navigators/AdminPanelNavigator.js","Src/Navigators/AppNavigator.js","Src/Containers/Root/RootScreen.js","Src/Stores/index.js","App.tsx","Src/Assets/Images/Home.png","Src/Assets/Images/Dashboard.png","Src/Assets/Images/System.png","Src/Assets/Images/Feed-Curves.png","Src/Assets/Images/Growth-curve.png","Src/Assets/Images/User.png","Src/Assets/Images/Sow.png","Src/Assets/Images/Section.png","Src/Assets/Images/Area_Colour.png","Src/Assets/Images/AutoPig.png","Src/Assets/Images/Feed-Components.png","Src/Assets/Images/Hexagon-globe.png","Src/Assets/Images/Hexa-icon.png","Src/Assets/Images/Logo.png","Src/Assets/Images/TOM.png"],"names":["JSOGTransform","createTransform","inboundState","key","JSOG","encode","outboundState","decode","persistConfig","storage","transforms","blacklist","createActions","startup","Types","Creators","StartupTypes","fetchUser","fetchUserLoading","fetchUserSuccess","fetchUserFailure","ExampleTypes","bleStartup","bleStateUpdated","startBleScan","stopBleScan","readBleDeviceData","BleTypes","bluetoothStartup","startBluetoothScan","stopBluetoothScan","bluetoothScanAble","readBlueDeviceData","BluetoothTypes","deviceStartup","setDeviceError","scannerStateUpdated","addDevice","removeDevice","clearDevices","connectedDeviceUpdated","connectionStateUpdated","connectionMethodeUpdated","setDeviceData","updateDeviceData","connectDevice","disconnectDevice","readDeviceData","fetchDevice","DeviceTypes","BleCreators","BlueToothCreators","navigator","LastPage","firebaseStartup","firebaseIsLoading","setFirebaseError","setViewError","viewIsLoading","setCurrentData","actionStarting","fetchStarting","dataFetchSuccess","fetchSuccess","fetchFailure","FirebaseTypes","navigate","routeName","params","dispatch","NavigationActions","replace","StackActions","navigateAndReset","reset","index","actions","setTopLevelNavigator","navigatorRef","nacigationPop","back","console","log","Platform","OS","put","DeviceActions","FirebaseActions","NavigationService","in200s","curryN","min","max","value","isNumber","is","Number","gte","isWithin","userApiClient","axios","create","baseURL","headers","Accept","timeout","userService","Math","random","Promise","resolve","reject","number","floor","get","toString","then","response","status","data","ExampleActions","call","user","deviceService","Version","a","async","PermissionsAndroid","check","PERMISSIONS","ACCESS_COARSE_LOCATION","request","RESULTS","GRANTED","ScannerState","ConnectionState","ConnectionMethode","handleBleState","connectBle","handleConnection","handleScanning","scanBle","setBleScannerStart","sagaArgs","permitError","fork","BLEManager","manager","eventChannel","emit","subscription","onStateChange","state","remove","buffers","expanding","stateChannel","take","newState","BleActions","cancelled","close","device","select","connectionMethode","connectedDevice","_manager","isConnected","onDisconnected","error","type","disconnectedChannel","actionChannel","deviceActionChannel","connect","discoverAllServicesAndCharacteristics","_device","race","deviceAction","disconnected","cancelConnection","KnownUUIDS","services","_services","serviceUUIDs","filter","service","includes","uuid","monitor","characteristics","characteristic","push","forEach","i","monitorCharacteristicForService","readingChannel","TempData_Reading","Buffer","from","length","PacketId","BatteryLevel","base64","charCodeAt","Battery","RawData","header","slice","compare","parseInt","NewData","concat","TagId","tagid","FatLayers","FatL1","FatL2","FatL3","layers","layer1","layer2","layer3","scanTask","bleState","scannerState","connectionState","channel","action","State","PoweredOn","cancel","startDeviceScan","allowDuplicates","scannedDevice","localName","stopDeviceScan","scanningChannel","scanBluetooth","setBlueScannerStart","BlueManager","PairDevice","id","res","receiveData","Message","TAGId","Discover","NativeEventEmitter","addListener","Device","address","name","alias","bluetoothChannel","StopDiscovery","BluetoothSearchAble","methode","UserStates","DataStates","DataRefs","FIREBASEUSER","USERSDATA","USERS","FARMS","SECTIONS","PENS","PIGS","BATCHS","WEIGHING","GRAPH","COMMENTS","FARMDATAS","SHARES","Actions","SIGN","FETCH","CREATE","UPDATE","MOVE","DELETE","CLEAR","ADD","Operations","ErrorTypes","format_num","num","format_Time","time","s","Date","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","auth","messaging","database","reA","reN","sortAlphaNum","b","aA","bA","aN","bN","sortObject","o","sorted","hasOwnProperty","sort","DataStringCheck","Check_num","first","numbers","specialChars","indexOf","GetWeight_FromPen","PenId","WeighingsStore","AfterTime","BeforeTime","Weighing","_weighing","weighing","GetBatch_FromPen","localDataStore","batchs","_batch","batch","pens","GetStats_FromPen","PenData","StartDate","EndDate","PenWeighings","Animals","PenWeight","PenGrowth","AveragePenGrowth","datas","count","weighings","GrowthCount","lastDate","LastWeight","undefined","LastWeightDay","FirstWeight","Object","keys","weight","Weight","now","getTime","isVirtual","Batch","TempGraph","GetCurve_FromBatch","graphs","BatchEndDate","Predict","CurvePredict","Now","_date","lastWeighing","Addition","setDate","days","tempEnd","date","Growth","GetStats_FromBatch","PenCount","CollectedWeight","CollectedGrowth","isClosed","TargetWeight","GetBatchEnd","PenEnds","reverse","e","Batch_Pen","Pen","closed","PenStats","AverageWeight","parseFloat","toFixed","AverageGrowth","GraphsStore","CurrentData","gcurve","curveId","Id","TempCurve","currentTime","AccumulateTime","periode","Time","PeriodeLength","NewTime","setMonth","get_DataSpot","MinMax_Time","MinMax_Data","FindTime","Data","DataTime","ExValue","VirData","ExTime","slope","minX","maxX","minY","GetSlope_Between","Weighing2","weight2","StartIndex","PredictCurve","CurrentTime","Temp_CurrentIndex","unshift","PredictStart","TempEx","DataSpot","FirstSpot","CurrentIndex","WeightNow","require","default","_firebase","apps","Constants","manifest","web","config","firebase","initializeApp","createFirebaseUserWithemailandpassword","Email","Pass","createUserWithEmailAndPassword","User","currentUser","Name","displayName","email","UserId","uid","_data","updateProfile","sendEmailVerification","catch","code","viewError","message","signinWithemailandpassword","logoutUser","signInWithEmailAndPassword","sendResetPassword","sendPasswordResetEmail","signOut","path","refreshUser","reload","ref","CurrentUser","createFarm","Farms","farmid","updateFarmData","FarmId","sections","Sections","Pens","updateUserData","UserData","farms","fetchFarm","updateFarm","fetchSections","fetchPens","createNewPen","deletePen","updatePen","fetchPigs","updatePigdata","fetchBatchs","createBatchs","updateBatchs","fetchWeights","createWeight","fetchComments","createComment","fetchGraphData","updateGraphData","SetUpdateTime","DataRef","update","update_time","ServerValue","TIMESTAMP","CheckDataTime","once","_Time","UpdateTime","val","List","userData","_farmData","farm","set","SectionId","DoFetch","_sectionidData","_pensData","penData","pen","ref2","section","_Pen","Datas","_pigsData","pigData","pig","updatePigPen","Action","counts","isNaN","pigs","BatchId","_batchdata","curve","batchdata","devianceMin","devianceMax","BatchPens","JSON","stringify","RemovedPens","x","enddate","NewPens","SamePens","pendata","startdate","CurveId","comments","p","_","_resolve","setTimeout","weights","limitStart","limitTo","MemSections","orderByChild","limitToLast","snapshot","c","_weighingTime","Weighings_Time","itemsProcessed","newWeights","Quantity","weightRef","comment","commentRef","quantity","GraphId","graph","Graphs","GraphVal","newGraph","Agraph","AgraphVal","Graph","_Graph","firebaseService","requestPermission","authStatus","AuthorizationStatus","AUTHORIZED","PROVISIONAL","isPermit_UserPermission","title","okText","_cancelable","Alert","alert","text","onPress","cancelable","onDismiss","token","to","messageId","messageType","notification","body","sendMessage","msg","handleAuthState","handleActions","onMessageHandler","onBackgroundMessageHandler","isSupported","disableYellowBox","onAuthStateChanged","authChannel","newAuth","firebaseUser","values","FirebaseUser","messageListener","onMessage","remoteMessage","onMessageChannel","onNotificationOpenedApp","setBackgroundMessageHandler","root","all","takeLatest","STARTUP","StartupSaga","FETCH_USER","ExampleSaga","DEVICE_STARTUP","DeviceSaga","CONNECT_DEVICE","DISCONNECT_DEVICE","READ_DEVICE_DATA","FETCH_DEVICE","BLE_STARTUP","START_BLE_SCAN","STOP_BLE_SCAN","READ_BLE_DEVICE_DATA","BLUETOOTH_STARTUP","START_BLUETOOTH_SCAN","STOP_BLUETOOTH_SCAN","BLUETOOTH_SCAN_ABLE","READ_BLUE_DEVICE_DATA","FIREBASE_STARTUP","FirebaseSaga","reducer","createReducer","userIsLoading","userErrorMessage","FETCH_USER_LOADING","FETCH_USER_SUCCESS","FETCH_USER_FAILURE","errorMessage","INITIAL_STATE","PoweredOff","deviceIsLoading","deviceErrorMessage","DeviceList","deviceData","BLE_INITIAL_STATE","BLUETOOTH_INITIAL_STATE","HANDLERS","BLE_STATE_UPDATED","SET_DEVICE_ERROR","SCANNER_STATE_UPDATED","ADD_DEVICE","some","NewList","REMOVE_DEVICE","splice","CLEAR_DEVICES","CONNECTED_DEVICE_UPDATED","CONNECTION_STATE_UPDATED","CONNECTION_METHODE_UPDATED","SET_DEVICE_DATA","UPDATE_DEVICE_DATA","newData","BLEReducers","BluetoothReducers","FIREBASE_IS_LOADING","loadingstate","SET_FIREBASE_ERROR","firebaseErrorMessage","SET_VIEW_ERROR","VIEW_IS_LOADING","SET_CURRENT_DATA","currentData","ACTION_STARTING","FETCH_STARTING","DATA_FETCH_SUCCESS","NewDataStore","NewFirebaseUser","_user","element","_auth","Values","users","FETCH_SUCCESS","newlocalDataStore","_newState","mergeDeep","target","source","isObject","obj","targetValue","sourceValue","Array","isArray","append","FETCH_FAILURE","h1","fontSize","h2","h3","normal","tiny","small","medium","tinyBottomMargin","marginBottom","smallBottomMargin","bottomMargin","mediumBottomMargin","tinyVerticalMargin","marginVertical","smallVerticalMargin","verticalMargin","mediumVerticalMargin","tinyHorizontalMargin","marginHorizontal","smallHorizontalMargin","horizontalMargin","mediumHorizontalMargin","tinyHorizontalPadding","paddingHorizontal","smallHorizontalPadding","horizontalPadding","mediumHorizontalPadding","tinyVerticalPadding","paddingVertical","smallVerticalPadding","verticalPadding","mediumVerticalPadding","Home","DashBoard","System","Curves","GCurves","Sow","Section","AutoPig","Feed","Haxa_globe","Hexa_icon","Logo","logo","column","flexDirection","colMain","justifyContent","colCenter","alignItems","colCross","columnReverse","row","rowMain","rowCenter","rowCross","rowReverse","center","crossCenter","crossEnd","crossStart","crossStretch","fill","flex","fillCenter","fillCol","fillColCenter","fillColCross","fillColMain","fillColReverse","fillRow","fillRowCenter","fillRowCross","fillRowMain","fillRowReverse","fullSize","height","width","halvWidth","midWidth","fullWidth","mainCenter","mainEnd","mainSpaceAround","mainSpaceBetween","mainStart","mainContainer","Metrics","contentContainer","marginTop","borderContainer","borderWidth","borderColor","borderRadius","maxWidth","zIndex","textContainer","Fonts","buttonContainer","loadingContainer","position","left","right","top","bottom","backgroundColor","logoContainer","backgroundReset","Colors","rotate90","transform","rotate","rotate90Inverse","mirror","scaleX","scrollSpaceAround","flexGrow","scrollSpaceBetween","selfStretch","alignSelf","textCenter","textAlign","textJustify","textLeft","textRight","button","color","buttonText","result","input","navigationHeader","StyleSheet","container","SplashScreen","props","getInitialNotification","this","checkData","getData","prevProps","prevState","View","style","Helpers","Style","Image","Images","resizeMode","Component","DeepLinkingScreen","Text","styles","boxContainer","ApplicationStyles","icon","Button","TextView","textStyle","ImageView","_Image","iconStyle","TouchableOpacity","boxStyle","buttonStyle","Button_Panel","Texts","Buttons","image","itemStyle","TitleElement","listitem","CustomListItem","containerStyle","Content","Title","Subtitle","contentBox","minHeight","ContentProp","texts","textsStyle","datasStyle","onLongPress","view","dataRow","OperationsPanel","pigTag","PigsList","newPig","getPenAndSection","setCurrentPig","editPens","onDone","charAt","toUpperCase","newWeight","penId","newComment","newPigCount","setState","ScrollView","paddingRight","setCurrentDataElement","pigtag","dataId","countChange","ProgressBar","animation","useRef","Animated","Value","progress","Color","useEffect","timing","current","toValue","duration","start","interpolate","inputRange","outputRange","extrapolate","paddingBottom","alignContent","progressBar","absoluteFill","paddingTop","padding","monthNames","DateTime_Picker","getStates","year","month","day","Selected","Year","Month","Day","forceUpdate","changed","Today","YearItems","String","Picker","Item","label","MonthItems","DayItems","selectedValue","minWidth","marginRight","onValueChange","_year","_month","_day","textAreaContainer","textArea","Comment_Module","useState","InputText","setInputText","QuantityText","setQuantityText","WeightText","setWeightText","App","marginLeft","TextInput","multiline","onChangeText","underlineColorAndroid","placeholder","placeholderTextColor","numberOfLines","FrontScreen","ShowMainError","FocusSubscription","Props","navigation","payload","setViewLoading","ErrorMessage","ele","liveInEurope","entries","example","city","instructions","fontStyle","ios","android","ExampleScreen","useDispatch","useSelector","ActivityIndicator","size","deviceContainer","deviceDataContainer","text2","DeviceScreen","DeviceData","Devices","Unknown","ConnectedDevice_View","map","Dev","StackNavigator","createStackNavigator","screen","Front","navigationOptions","headerMode","headerShown","headerTitleStyle","Example","initialRouteName","defaultNavigationOptions","headerTitleAlign","headerRight","PanelsSorter","userType","UserLoadingScreen","ISLOADPAGE","firebaseData","page","emailVerified","prev","getUser","IsLoading","clearDataMem","UserLoginScreen","CreateUser","secureTextEntry","createUser","signIN","resetPass","VerifyScreen","setUser","Verified","UserInformation","setData","FirstN","LastN","Contact","ContactP","Address","Country","lastN","contact","phoneNumber","F_FirstN","React","createRef","F_LastN","F_Contact","F_ContactP","F_Address","test","_UserData","country","updateUser","OnDone","window","Dimensions","Subscription","onChange","dimensions","CurrentSub","Billing","addEventListener","removeEventListener","wide","fontWeight","CheckBox","FarmInformation","FarmName","Cvr","Manager","FarmData","cvr","getFarm","_FarmData","_sections","_pens","i2","sectionPens","CreateNewUserData","ViewState","Display","precreateUserData","Subsc","LoadingUserScreen","LoginUser","LoginUserScreen","headerLeft","paddingLeft","CreateUserData","CreateUserDataScreen","logOut","Dashboard","Mail","BatchList","SectionsList","MaxCap","CurCap","farmName","farmManager","farmMail","Farm","BatchID","End","getSections","getPens","getBatch","getWeights","getCurve","FarmProgress","FlatList","renderItem","item","keyExtractor","loading","inputContainer","Pigs","PigTag","getPigs","connectedState","SafeAreaView","tagId","pigId","Device_Display","circle","Scanner_Display","known","Weighings","Mid","property","itemDimension","spacing","renderSectionHeader","displayWeight","round","Batchs","onMultiChange","items","xorBy","selectedPens","freePens","BatchName","ShowPicker","StartD","Curve","DevianceMin","DevianceMax","avaiblePens","add","scrollEnabled","batchName","_pen","mode","itemValue","itemIndex","endsWith","labelStyle","optionsLabelStyle","options","selectedValues","onMultiSelect","onTapClose","isMulti","newBatch","updateBatch","_Date","setBatch","batchId","getRandomNumber","low","high","getRandomColor","red_range","green_range","blue_range","a_range","red","green","blue","alpha","r","g","rgbaValue","CurveElement","Legends","DataSets","Labels","ActiveIndex","ActiveLength","ActiveDataSets","ActiveStartDate","ActiveEndDate","ViewPoint","D","DataX","dataX","opacity","TempData","TempEndDate","NextEnd","_EndDate","Prediction","DoPredict","BatchPen","DataSet","DataSetX","WeightsToGraphData","TemplatePeriode","CurrentDate","getNewDate","setGraphPeriode","BatchIsOpen","Height","Width","DataPoints","point","horizontal","showsHorizontalScrollIndicator","maxHeight","labels","xMinMax","legend","datasets","onDataPointClick","withShadow","withVerticalLines","fromZero","segments","verticalLabelRotation","xLabelsOffset","chartConfig","backgroundGradientFrom","backgroundGradientTo","decimalPlaces","labelColor","propsForDots","strokeWidth","stroke","control","CurveEditor","TimeText","dataset","Point","setPoint","step","evt","split","getPen","curveid","setCurve","GrowthCurve","CurveList","CurveName","Periode","CurveData","AppStyle","WebStyle","numColumns","newCurve","updateCurve","actionType","DataEditor","NewSection","DataView","PenEditor_View_Creator","PigEditor_View_Creator","Control","CurrentAction","exists","penAction","PenEditor_Titles","pigAction","Section_Picker","senctionId","DataDisplay_Pens","WeighingsList","CommentsList","Comments","object","MemTime","getComments","localDataStoree","pigcount","penWeight","batch_name","age","StartTime","onPageSwipe","sender","onDataPress","Comment","dir","DataDisplay_Pigs","DataDisplay","PigData_View","ingrid","Comments_List","batchData","PenMemTime","Days","Virtual","UserFront","UserFrontScreen","UserDashBoard","UserDashBoardScreen","UserPigs","UserPigsScreen","UserPens","UserPensScreen","UserBatchs","UserBatchsScreen","UserCurves","UserCurvesScreen","UserOperations","UserOperationsScreen","WeighingOperations","UserDataEditor","UserDataDisplay","DataPlotter","UserDataPlotter","UserListBoard","UserList","getUsers","SystemListBoard","FarmList","getFarms","editable","setUserFarm","AdminFront","AdminFrontScreen","UserBoard","AdminUserBoard","SystemBoard","AdminSystemBoard","UserPanel","UserPanelNavigation","MainStack","FrontNavigation","AuthStack","AuthNavigation","AdminPanel","AdminPanelNavigator","createAppContainer","RootScreen","StartupActions","AppNavigator","uriPrefix","rootReducer","rootSaga","middleware","enhancers","sagaMiddleware","createSagaMiddleware","applyMiddleware","persistedReducer","persistReducer","store","createStore","compose","persistor","persistStore","blemanager","BleManager","setLogLevel","LogLevel","Verbose","NativeModules","BlueToothControl","run","configureStore","combineReducers","ExampleReducer","DeviceReducer","FirebaseReducer","module","exports"],"mappings":"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","file":"static/js/app.74045fd2.chunk.js","sourcesContent":["import { Platform } from 'react-native'\r\n\r\nimport { applyMiddleware, compose, createStore } from 'redux'\r\nimport createSagaMiddleware from 'redux-saga'\r\nimport { persistReducer, persistStore, createTransform } from 'redux-persist'\r\n\r\nimport { NativeModules } from 'react-native'\r\nimport { BleManager, BleError, LogLevel } from 'react-native-ble-plx'\r\n\r\n//** fix: error serializing state TypeError: Converting circular structure to JSON  */\r\n// https://www.npmjs.com/package/jsog\r\n// https://www.npmjs.com/package/flatted\r\nimport JSOG from 'jsog';\r\nexport const JSOGTransform = createTransform(\r\n  (inboundState, key) => JSOG.encode(inboundState),\r\n  (outboundState, key) => JSOG.decode(outboundState),\r\n)\r\n\r\n/**\r\n * This import defaults to localStorage for web and AsyncStorage for react-native.\r\n *\r\n * Keep in mind this storage *is not secure*. Do not use it to store sensitive information\r\n * (like API tokens, private and sensitive data, etc.).\r\n *\r\n * If you need to store sensitive information, use redux-persist-sensitive-storage.\r\n * @see https://github.com/CodingZeal/redux-persist-sensitive-storage\r\n */\r\nimport storage from 'redux-persist/lib/storage'\r\n\r\nconst persistConfig = {\r\n  key: 'root',\r\n  storage: storage,\r\n  transforms: [JSOGTransform],\r\n  /**\r\n   * Blacklist state that we do not need/want to persist\r\n   */\r\n  blacklist: [\r\n    // 'auth',\r\n  ],\r\n}\r\n\r\nexport default (rootReducer, rootSaga) => {\r\n  const middleware = []\r\n  const enhancers = []\r\n\r\n  // Connect the sagas to the redux store\r\n  const sagaMiddleware = createSagaMiddleware()\r\n  middleware.push(sagaMiddleware)\r\n\r\n  enhancers.push(applyMiddleware(...middleware))\r\n\r\n  // Redux persist\r\n  const persistedReducer = persistReducer(persistConfig, rootReducer)\r\n\r\n  const store = createStore(persistedReducer, compose(...enhancers))\r\n  const persistor = persistStore(store)\r\n\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    // First step is to create BleManager which should be used as an entry point\r\n    // to all BLE related functionalities\r\n    const blemanager = new BleManager();\r\n    blemanager.setLogLevel(LogLevel.Verbose);\r\n\r\n    const bluemanager = NativeModules.BlueToothControl;\r\n\r\n    // SagaArgs Construcktor\r\n    const sagaArgs = {BLEManager: blemanager, BlueManager: bluemanager}\r\n\r\n    // Kick off the root saga\r\n    sagaMiddleware.run(rootSaga, sagaArgs)\r\n  }else {\r\n    sagaMiddleware.run(rootSaga)\r\n  }\r\n  \r\n  return { store, persistor }\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\nconst { Types, Creators } = createActions({\r\n  // This action is triggered when the application starts\r\n  startup: null,\r\n})\r\n\r\nexport const StartupTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  // Fetch user informations\r\n  fetchUser: null,\r\n  // The operation has started and is loading\r\n  fetchUserLoading: null,\r\n  // User informations were successfully fetched\r\n  fetchUserSuccess: ['user'],\r\n  // An error occurred\r\n  fetchUserFailure: ['errorMessage'],\r\n})\r\n\r\nexport const ExampleTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bleStartup: null,\r\n  bleStateUpdated: ['bleState'],\r\n\r\n  startBleScan: null,\r\n  stopBleScan: null,\r\n\r\n  readBleDeviceData: null,\r\n})\r\n\r\nexport const BleTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bluetoothStartup: null,\r\n\r\n  startBluetoothScan: null,\r\n  stopBluetoothScan: null,\r\n  \r\n  bluetoothScanAble: null,\r\n\r\n  readBlueDeviceData: null,\r\n})\r\n\r\nexport const BluetoothTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\nimport BleCreators, {BleTypes} from './BLE/Actions'\r\nimport BlueToothCreators, {BluetoothTypes} from './BlueTooth/Actions'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Device Saga\r\n  deviceStartup: null,\r\n  setDeviceError: ['errorMessage'], // Device-saga error occurred\r\n\r\n  scannerStateUpdated: ['scannerState'],\r\n\r\n  addDevice: ['device'],\r\n  removeDevice: ['device'],\r\n  clearDevices: null,\r\n\r\n  connectedDeviceUpdated: ['connectedDevice'], \r\n\r\n  connectionStateUpdated: ['connectionState'],\r\n  connectionMethodeUpdated: ['connectionMethode'],\r\n\r\n  setDeviceData: ['data'],\r\n  updateDeviceData: ['data'],\r\n\r\n  connectDevice: ['device'],\r\n  disconnectDevice: ['methode'],\r\n  readDeviceData: null,\r\n\r\n  fetchDevice: null, // Fetch device informations\r\n})\r\n\r\nexport const DeviceTypes = {...Types, ...BleTypes, ...BluetoothTypes}\r\nexport default {...Creators, ...BleCreators, ...BlueToothCreators}","import React from 'react'\r\nimport { BackHandler } from 'react-native'\r\nimport { NavigationActions, StackActions } from 'react-navigation'\r\n\r\n/**\r\n * The navigation is implemented as a service so that it can be used outside of components, for example in sagas.\r\n *\r\n * @see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html\r\n */\r\n\r\nlet navigator\r\nvar LastPage\r\n/**\r\n * This function is called when the RootScreen is created to set the navigator instance to use.\r\n */\r\nfunction setTopLevelNavigator(navigatorRef) {\r\n  navigator = navigatorRef\r\n\r\n  /*BackHandler.addEventListener('hardwareBackPress', () => {\r\n    console.log(navigator._navigation)\r\n    if (navigator && navigator._navigation && navigator._navigation.state) {\r\n      var Stackindex = navigator._navigation.state.index\r\n      var Stack = navigator._navigation.state.routes[Stackindex]\r\n      if (Stack.routes){\r\n        var index = Stack.index;\r\n        var routeName = Stack.routes[index].routeName;\r\n        if (routeName === 'UserFront' || routeName === 'LoginUser'){\r\n          navigator.dispatch(\r\n            NavigationActions.back()\r\n          )\r\n          //navigate('FrontScreen');\r\n          //return true;\r\n        }\r\n      }\r\n    }\r\n  });*/\r\n}\r\n\r\nfunction replace(routeName, params){\r\n  if (LastPage === routeName) return null\r\n  else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.replace({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  }\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigate(routeName, params) {\r\n  if (LastPage === routeName) return null\r\n  else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      NavigationActions.navigate({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  }\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route AND reset the navigation history.\r\n *\r\n * That means the user cannot go back. This is useful for example to redirect from a splashscreen to\r\n * the main screen: the user should not be able to go back to the splashscreen.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigateAndReset(routeName, params) {\r\n  if (LastPage === routeName) return null\r\n  else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.reset({\r\n        index: 0,\r\n        key: null,\r\n        actions: [\r\n          NavigationActions.navigate({\r\n            routeName,\r\n            params,\r\n          }),\r\n        ],\r\n      })\r\n    )\r\n  }\r\n}\r\n\r\nfunction nacigationPop() {\r\n  navigator.dispatch(NavigationActions.back())\r\n}\r\n\r\nexport default {\r\n  navigate,\r\n  replace,\r\n  navigateAndReset,\r\n  setTopLevelNavigator,\r\n  nacigationPop,\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Firebase Saga events\r\n  firebaseStartup: null,\r\n  //Firebase Saga and service\r\n  firebaseIsLoading: ['loadingstate'],\r\n  setFirebaseError: ['errorMessage'], // Firebase-saga error occurred\r\n\r\n  setViewError: ['errorMessage'], // view error\r\n  viewIsLoading: ['loadingstate'],\r\n  \r\n  setCurrentData: ['data'],\r\n\r\n  //Firebase Data fetches\r\n  actionStarting: ['action', 'ref', 'params'], // Data action (create, singin, share)\r\n  fetchStarting: ['action', 'ref', 'params'], // Fetch data informations\r\n  dataFetchSuccess: ['params'],\r\n  fetchSuccess: ['data'], // Informations were successfully fetched\r\n  fetchFailure: ['errorMessage'], // An error occurred\r\n})\r\n\r\nexport const FirebaseTypes = {...Types }\r\nexport default {...Creators }","import { Platform } from 'react-native';\r\n\r\nimport { put, call } from 'redux-saga/effects'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport ExampleActions from '../Stores/Example/Actions'\r\nimport DeviceActions from '../Stores/Device/Actions'\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\n\r\n/**\r\n * The startup saga is the place to define behavior to execute when the application starts.\r\n */\r\nexport function* startup() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  console.log(\"Starting sagas\")\r\n  \r\n  // Add more operations you need to do at startup here\r\n  //yield put(ExampleActions.fetchUser())\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    yield put(DeviceActions.deviceStartup())\r\n  }\r\n  yield put(FirebaseActions.firebaseStartup())\r\n\r\n  // When those operations are finished we redirect to the main screen\r\n  NavigationService.navigateAndReset('MainStack')\r\n}\r\n","import axios from 'axios'\r\nimport { Config } from '../Config'\r\nimport { is, curryN, gte } from 'ramda'\r\n\r\nconst isWithin = curryN(3, (min, max, value) => {\r\n  const isNumber = is(Number)\r\n  return isNumber(min) && isNumber(max) && isNumber(value) && gte(value, min) && gte(max, value)\r\n})\r\nconst in200s = isWithin(200, 299)\r\n\r\n/**\r\n * This is an example of a service that connects to a 3rd party API.\r\n *\r\n * Feel free to remove this example from your application.\r\n */\r\nconst userApiClient = axios.create({\r\n  /**\r\n   * Import the config from the App/Config/index.js file\r\n   */\r\n  baseURL: Config.API_URL,\r\n  headers: {\r\n    Accept: 'application/json',\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 3000,\r\n})\r\n\r\nfunction fetchUser() {\r\n  // Simulate an error 50% of the time just for testing purposes\r\n  console.log(\"user fetch test\");\r\n  if (Math.random() > 0.5) {\r\n    return new Promise((resolve, reject) => {\r\n      console.log(\"error\");\r\n      resolve(null)\r\n    })\r\n  }\r\n\r\n  const number = Math.floor(Math.random() / 0.1) + 1\r\n\r\n  return userApiClient.get(number.toString()).then((response) => {\r\n    if (in200s(response.status)) {\r\n      return response.data\r\n    }\r\n\r\n    return null\r\n  })\r\n}\r\n\r\nexport const userService = {\r\n  fetchUser,\r\n}\r\n","export const Config = {\r\n  API_URL: 'https://jsonplaceholder.typicode.com/users/',\r\n}\r\n","import { put, call } from 'redux-saga/effects'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { userService } from '../../Services/UserService'\r\n\r\n/**\r\n * A saga can contain multiple functions.\r\n *\r\n * This example saga contains only one to fetch fake user informations.\r\n * Feel free to remove it.\r\n */\r\nexport function* fetchUser() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  yield put(ExampleActions.fetchUserLoading())\r\n\r\n  // Fetch user informations from an API\r\n  const user = yield call(userService.fetchUser)\r\n  if (user) {\r\n    yield put(ExampleActions.fetchUserSuccess(user))\r\n  } else {\r\n    yield put(\r\n      ExampleActions.fetchUserFailure('There was an error while fetching user informations.')\r\n    )\r\n  }\r\n}\r\n","import { Platform, PermissionsAndroid } from 'react-native'\r\nimport { Config } from '../Config'\r\n\r\nasync function isPermit_Android() {\r\n  if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n    const Have_Coarse_Location = await PermissionsAndroid.check(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n   if (!Have_Coarse_Location) {\r\n      const Got_Access = await PermissionsAndroid.request(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n      if (Got_Access !== PermissionsAndroid.RESULTS.GRANTED) {\r\n        console.log(\"No Ble Permission granted : Android\");\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction isBlePermitted() {\r\n  return new Promise((resolve, reject) => {\r\n    if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n      if (!isPermit_Android()){\r\n        resolve('This application needs premissions to be using BLE');\r\n      }\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nexport const deviceService = {\r\n  isBlePermitted,\r\n  //isPermit_Android,\r\n}\r\n","export const ScannerState = {\r\n  IDLE: 'IDLE',\r\n  AVAILABLE: 'AVAILABLE',\r\n  SCANNING: 'SCANNING',\r\n};\r\n\r\nexport const ConnectionState = {\r\n  DISCONNECTED: 'DISCONNECTED',\r\n  CONNECTING: 'CONNECTING',\r\n  DISCOVERING: 'DISCOVERING',\r\n  CONNECTED: 'CONNECTED',\r\n  DISCONNECTING: 'DISCONNECTING',\r\n};\r\n\r\nexport const ConnectionMethode = {\r\n  NONE: 'NONE',\r\n  BLE: 'BLE',\r\n  SERIAL: 'SERIAL',\r\n  BLUETOOTH: 'BLUETOOTH',\r\n  WIFI: 'WIFI',\r\n};","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\nimport base64 from 'react-native-base64'\r\nimport { Buffer } from 'buffer'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BleActions from '../../../Stores/Device/BLE/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device, State, Service, Characteristic, Descriptor } from 'react-native-ble-plx'\r\n\r\nexport function* bleStartup(sagaArgs) {\r\n  //Check and setup BLE....\r\n  const permitError = yield call(deviceService.isBlePermitted)\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BLEManager)\r\n    yield fork(handleBleState, sagaArgs.BLEManager)\r\n    yield fork(handleConnection, sagaArgs.BLEManager)\r\n  }\r\n  \r\n  console.log('BLE Startup : Done');\r\n}\r\n\r\n// This generator tracks our BLE state. Based on that we can enable scanning, get rid of devices etc.\r\n// eventChannel allows us to wrap callback based API which can be then conveniently used in sagas.\r\nfunction* handleBleState(manager: BleManager) {\r\n  console.log(\"Handle BLE State...\")\r\n\r\n  const stateChannel = yield eventChannel((emit) => {\r\n    const subscription = manager.onStateChange((state) => {\r\n      emit(state)\r\n    }, true)\r\n    return () => {\r\n      subscription.remove()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newState = yield take(stateChannel)\r\n      console.log(\"New BLE state: \" + newState)\r\n      yield put(BleActions.bleStateUpdated(newState))\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      stateChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* connectBle(device: Device) {\r\n  //dummy function\r\n}\r\n\r\nfunction* handleConnection(manager: BleManager) {\r\n  console.log(\"Handle BLE Connection...\")\r\n  \r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_DEVICE');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLE) continue;\r\n\r\n    var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n    //if (connectedDevice != null) return;  // TODO: Allready connected ? if problem\r\n\r\n    if (device === null || device._manager === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    if (device.isConnected()) {\r\n      console.log(\"is connected ??\");\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        yield call([device, device.connect]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        var _device = device;\r\n\r\n        yield fork(readBleDeviceData, manager)\r\n\r\n        for (; ;) {\r\n          const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });\r\n\r\n          if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield call([_device, _device.cancelConnection]);\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              //TODO: search for lost \"connected\" device..\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        /*yield put(\r\n            DeviceActions.setDeviceError(error)\r\n        )*/\r\n      } finally {\r\n        disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions...');\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBleDeviceData(manager: BleManager) {\r\n  // TODO: read service .... se Tests SensorTag-master project ... or try following\r\n  // or https://stackoverflow.com/questions/50137867/send-data-using-react-native-ble-plx-package\r\n  // or https://github.com/Polidea/react-native-ble-plx/issues/392\r\n  // or https://stackoverflow.com/questions/63012926/how-to-read-ble-peripheral-characteristics-in-react-native-using-react-native-bl\r\n  \r\n  // Better jet: https://www.polidea.com/blog/ReactNative_and_Bluetooth_to_An_Other_level/\r\n\r\n  \r\n  // Explanation of plx ble.. notify changes for characteristics and reading / writing\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Notifying\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Reading\r\n  \r\n  const KnownUUIDS = [\r\n    '0000fff0-0000-1000-8000-00805f9b34fb', //* BF-8 EarTag reader Service's\r\n    '0000fff1-0000-1000-8000-00805f9b34fb',\r\n\r\n    '0000180f-0000-1000-8000-00805f9b34fb', //* Battery service (General BLE)\r\n    '00002a19-0000-1000-8000-00805f9b34fb',\r\n  ];\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const _services: Array<Service> = yield call([device, device.services]);\r\n  const serviceUUIDs = device.serviceUUIDs;\r\n\r\n  const services: Array<Service> = _services.filter(service => serviceUUIDs.includes(service.uuid))\r\n\r\n  var monitor = [];\r\n\r\n  for (const service of services) {\r\n    console.log('Device had service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      console.log('  characteristic: ' + characteristic.uuid);\r\n\r\n      if (KnownUUIDS.includes(service.uuid) && KnownUUIDS.includes(characteristic.uuid)) {\r\n        monitor.push([service.uuid, characteristic.uuid])\r\n      }\r\n    }\r\n  }\r\n\r\n  //const services: Array<Service> = yield call([device, device.services]);\r\n  //TODO: merch with KnownUUIDS and withouth monitor.. (append services)\r\n  /*for (const service of services) {\r\n    console.log('Found service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      const descriptors: Array<Descriptor> = yield call([characteristic, characteristic.descriptors]);\r\n\r\n      for (const descriptor of descriptors) {\r\n        //Can contain value...\r\n        console.log('* Found descriptor: ' + descriptor.uuid);\r\n        const d: Descriptor = yield call([descriptor, descriptor.read]);\r\n        console.log('  ** Descriptor value: ' + (d.value || 'null'));\r\n\r\n        //yield call([descriptor, descriptor.write], 'AAA=');\r\n      }\r\n      if (characteristic.isReadable) {\r\n        //Can contain value...\r\n        var c = yield call([characteristic, characteristic.read]);\r\n        console.log('? characteristic: ' + characteristic.uuid);\r\n        if (characteristic.isNotifiable) {\r\n          console.log('  Is Notifiable');\r\n        }\r\n        //var basevalue = base64.decode(c.value);\r\n        //basevalue = basevalue.charCodeAt(0);\r\n        console.log('  ** Got base64 value: ' + c.value);\r\n        //if (characteristic.isWritableWithResponse) {\r\n      }\r\n    }\r\n  }*/\r\n\r\n  const readingChannel = yield eventChannel((emit) => {\r\n    monitor.forEach((service, i) => {\r\n      device.monitorCharacteristicForService(\r\n        service[0], service[1],\r\n        (error, characteristic) => {\r\n          if (error) {\r\n            emit([error, characteristic]);\r\n            return;\r\n          }\r\n          // ************************\r\n          if (characteristic != null) {\r\n            emit([error, characteristic]);\r\n          }\r\n          // *************************\r\n        },\r\n      );\r\n    });\r\n    \r\n    return () => {\r\n      // ****\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    // Used to receive multiple data packets\r\n    var TempData_Reading = Buffer.from([]);\r\n    var length = 0;\r\n    var PacketId = 0;\r\n\r\n    for (; ;) {\r\n      if (readingChannel != null) {\r\n        const [error, characteristic] = yield take(readingChannel);\r\n        if (error != null) {\r\n          yield put(DeviceActions.setDeviceError(error))\r\n        }\r\n        if (characteristic != null) {\r\n          //console.log(characteristic.uuid);\r\n          // Handler for Battery state Change\r\n          if (characteristic.uuid == \"00002a19-0000-1000-8000-00805f9b34fb\") {\r\n            var BatteryLevel = base64.decode(characteristic.value);\r\n            BatteryLevel = BatteryLevel.charCodeAt(0);\r\n            yield put(DeviceActions.updateDeviceData({Battery: BatteryLevel}))\r\n          } \r\n          // Handler for BF-8 EarTag reader Data\r\n          else if (characteristic.uuid == \"0000fff1-0000-1000-8000-00805f9b34fb\") {\r\n            //console.log(\"Raw \", characteristic.value);                        //Display data raw\r\n            var RawData = Buffer.from(characteristic.value, 'base64');    \r\n            //console.log(\"Base64 Decoded Buffer: \", RawData)               //Display data base64 decoded\r\n            //console.log(\"ascii: \", RawData.toString('ascii'));            //Display string\r\n\r\n            if (PacketId === 0) {                                         // If no data is processing (New Data read)\r\n              var header = RawData.slice(0,4)\r\n              if (Buffer.compare(header, Buffer.from([170,170,170,170])) == 0) {  // Data Read header [AA AA AA AA / -1431655766]\r\n                length = (parseInt(RawData.slice(4,8).toString(\"hex\"), 16) - 8)   // Next int is the data length (-8 for PacketId 8 bit)\r\n                PacketId = parseInt(RawData.slice(8,12).toString(\"hex\"), 16)      // Packet type id [Recv RFID Packet / Recv Fat Layers ID] = [251658240 / 2315255808]\r\n                RawData = RawData.slice(12,RawData.length)                        // Last of packet is filled with data\r\n\r\n                //console.log(\"Id = \", PacketId);\r\n                //console.log(\"data length = \", length);\r\n              }\r\n            }\r\n\r\n            var NewData = Buffer.concat([TempData_Reading, RawData])     // else append data string\r\n            //console.log(\"NewData: \", NewData);\r\n            //console.log(\"NewData base64: \", NewData.toString('base64'));\r\n            //console.log(\"ascii: \", NewData.toString('ascii'));\r\n            \r\n            //console.log(\"new length \", (NewData.length * 8));\r\n            if (NewData.length < 4 || Buffer.compare(NewData.slice(NewData.length -4, NewData.length), Buffer.from([85,85,85,85])) != 0) { // Data Read End [55 55 55 55]\r\n              TempData_Reading = NewData;\r\n            }\r\n            else {\r\n              while (NewData.length * 8 > length || Buffer.compare(NewData.slice(NewData.length-1, NewData.length), Buffer.from([85])) == 0){\r\n                NewData = NewData.slice(0, NewData.length -1)\r\n              }\r\n              if (PacketId == 251658240) { // Recv RFID Packet\r\n                var TagId = NewData.toString('ascii')\r\n                TagId = TagId.slice(0,3) + \"-\" + TagId.slice(3,TagId.length)\r\n                console.log(\"Read Tag: \", TagId);\r\n                yield put(DeviceActions.updateDeviceData({tagid: TagId, FatLayers: 0, FatL1: 0, FatL2: 0, FatL3: 0}))\r\n              } \r\n              else if (PacketId == 2315255808) { //Recv Fat Layers ID\r\n                console.log(\"Fat done\");\r\n                var layers = parseInt(NewData.slice(0,1).toString(\"hex\"), 16);    // First byte is Layer count\r\n                var layer1 = parseInt(NewData.slice(3,4).toString(\"hex\"), 16);    // 4th. byte is layer one fat layer (data is value in mm)\r\n                var layer2 = parseInt(NewData.slice(5,6).toString(\"hex\"), 16);    // 6th. byte is layer two fat layer (data is value in mm)\r\n                var layer3 = parseInt(NewData.slice(7,8).toString(\"hex\"), 16);    // 8th. byte is layer third fat layer (data is value in mm)\r\n\r\n                console.log(\"layers: \" + layers + \" layer1: \" + layer1);\r\n                console.log(\"layer2: \" + layer2 + \" layer3: \" + layer3);\r\n                console.log(\"NewData: \", NewData);\r\n\r\n                yield put(DeviceActions.updateDeviceData({FatLayers: layers, FatL1: layer1, FatL2: layer2, FatL3: layer3}))\r\n                /*var FatData = NewData.toString('ascii')\r\n                console.log(\"Read Data: \", FatData);*/\r\n\r\n                /*\r\n                getRealLayerDepthMM_1() {\r\n                return (((float) this.mRawLayerData1) * 1.0f) / 256.0f;\r\n                */\r\n              }\r\n\r\n              PacketId = 0;\r\n              length = 0;\r\n              TempData_Reading = Buffer.from([]);\r\n            }\r\n\r\n            /*const TestValue = Buffer.from(characteristic.value, 'base64').readUInt16LE(0);\r\n            console.log(\"Test Value: \" + TestValue);*/\r\n            \r\n            /*if (value.startsWith(\"****\")) {\r\n              var TagType = value.slice(value.length - 8, value.length - 5);\r\n              var TagId = value.slice(value.length - 5, value.length);\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGType: TagType}))\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            } else if (value.endsWith(\"UUUU\")){\r\n              var TagId = yield select((state) => state.device.deviceData)\r\n              TagId = TagId.TAGId + value;\r\n\r\n              while (TagId.startsWith('0')){\r\n                TagId = TagId.slice(1, TagId.length);\r\n              }\r\n              while (TagId.endsWith('U')){\r\n                TagId = TagId.slice(0, TagId.length -1)\r\n              }\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            }\r\n            else {\r\n              console.log(value);\r\n              yield put(DeviceActions.updateDeviceData({Unknown: value}))\r\n            }*/\r\n          } else {\r\n            console.log(\"unknown char: \", characteristic.uuid);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  } catch (error) {\r\n    //yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      if (readingChannel != null) readingChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * BLE state is in PoweredOn state\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLE\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager: BleManager) {\r\n  console.log(\"Handle BLE Scanning...\")\r\n\r\n  var scanTask = null\r\n  var bleState: $Keys<typeof State> = yield select((state) => state.device.bleState);\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'BLE_STATE_UPDATED',\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | BLE_STATE_UPDATED\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'BLE_STATE_UPDATED':\r\n        bleState = action.bleState\r\n        break;\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      bleState === State.PoweredOn && \r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLE &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n    \r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBle, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBle(manager: BleManager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n  \r\n  console.log(\"Scanning started\");\r\n\r\n  const scanningChannel = yield eventChannel((emit) => {\r\n    manager.startDeviceScan(\r\n      null,\r\n      { allowDuplicates: true },\r\n      (error, scannedDevice) => {\r\n        if (error) {\r\n          emit([error, scannedDevice]);\r\n          return;\r\n        }\r\n        // ************************\r\n        if (scannedDevice != null) {\r\n          if (scannedDevice.localName != null) {\r\n            //TODO: auto list only supported devices...\r\n            //TODO: auto connect \"missing / disconnected\" divece..\r\n\r\n            /*if (scannedDevice.id === TagId && TagId != null) { // Catch Specefic SensorTag\r\n              emit([error, scannedDevice]);\r\n            } else { //Else if not ....*/\r\n              emit([error, scannedDevice]);\r\n            //}\r\n          } \r\n          /*else if (scannedDevice.name != null && scannedDevice.name != \"\"){\r\n            console.log(\"Device found Name: \" + scannedDevice.name);\r\n          }\r\n          // Test\r\n          if (scannedDevice.isConnectable != null && scannedDevice.id != null){\r\n            console.log(\"Connect ??: \" + scannedDevice.id);\r\n          }*/\r\n        }\r\n        // *************************\r\n      },\r\n    );\r\n    return () => {\r\n      manager.stopDeviceScan();\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    for (; ;) {\r\n      const [error, scannedDevice]: [?BleError,?Device] = yield take(scanningChannel);\r\n      if (error != null) {\r\n        console.log(\"Ble Scan Error: \", error);\r\n        yield put(DeviceActions.setDeviceError(error))\r\n      }\r\n      if (scannedDevice != null) {\r\n        //console.log(\"Interest Device Found: \" + scannedDevice.localName);\r\n        yield put(DeviceActions.addDevice(scannedDevice));\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.log(\"Ble Scan Error: \", error);\r\n    yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      scanningChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBleScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBleScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBleScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\n\r\nexport function* stopBleScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}","import { PermissionsAndroid, NativeModules, NativeEventEmitter } from 'react-native'\r\nimport {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BluetoothActions from '../../../Stores/Device/BlueTooth/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { Device } from 'react-native-ble-plx'\r\n\r\nexport function* bluetoothStartup(sagaArgs) {\r\n  //Check and setup Bluetooth....\r\n  const permitError = yield call(deviceService.isBlePermitted) //BLE permits is same for bluetooth\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BlueManager)\r\n    yield fork(handleConnection, sagaArgs.BlueManager)\r\n  }\r\n  \r\n  console.log('BlueTooth Startup : Done');\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLUETOOTH\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager) {\r\n  console.log(\"Handle Bluetooh Scanning...\")\r\n\r\n  var scanTask = null\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLUETOOTH &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n\r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBluetooth, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//** Todo: Be done... (code is not touched... can contain lots of error) */\r\nfunction* handleConnection(manager) {\r\n  console.log(\"Handle Bluetooth Connection...\")\r\n\r\n  var testTask = null;\r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_BLUETOOTH');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLUETOOTH) continue;\r\n\r\n    if (device === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      // TODO: handle disconnect\r\n\r\n      /*const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);*/\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        const res = yield call(manager.PairDevice, device.id);\r\n        console.log(\"\",res);\r\n        //yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        //yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        //for (; ;) {\r\n          /*const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });*/\r\n\r\n          /*if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              yield call([device, device.cancelConnection]);\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }*/\r\n\r\n        //}\r\n      } catch (error) {\r\n        console.log(\"?: \", error);\r\n        //yield put(DeviceActions.setDeviceError(error))\r\n      } finally {\r\n        //disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions... ', error);\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBlueDeviceData(sagaArgs) {\r\n  console.log(\"Blue Read\");\r\n  const manager = sagaArgs.BlueManager;\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const Message = yield call(manager.receiveData, device.id);\r\n  console.log(Message);\r\n  if (Message != \"\") {\r\n    yield put(DeviceActions.updateDeviceData({TAGId: Message}))\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBluetooth(manager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n\r\n  console.log(\"Scanning started\");\r\n\r\n  yield call(manager.Discover);\r\n  const bluetoothChannel = yield eventChannel((emit) => {\r\n    const blueTootControlEmitter = new NativeEventEmitter(manager);\r\n    const subscription = blueTootControlEmitter.addListener('blueToothDeviceFound', (device) => {\r\n      if (device != null){\r\n        var scannedDevice = new Device();\r\n        scannedDevice.id = device.address\r\n        scannedDevice.localName = (device.name != null ? device.name : \"NONE\");\r\n        scannedDevice.name = device.alias\r\n        \r\n        if (scannedDevice.localName != null) {\r\n          if (scannedDevice.localName === 'SensorTag') { // Catch Specefic SensorTag\r\n            //console.log(\"Device with Tag found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          } else { //Else if not ....\r\n            //console.log(\"Device found localName: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          }\r\n        } \r\n        else if (device.alias != null && device.alias != \"\"){\r\n          scannedDevice.name = device.alias\r\n          emit(scannedDevice);\r\n          //console.log(\"Device found Name: \" + scannedDevice.name);\r\n        }\r\n      }\r\n    })\r\n    return () => {\r\n      subscription.remove();\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const scannedDevice: Device = yield take(bluetoothChannel);\r\n      if (scannedDevice != null) {\r\n        console.log(\"Interest Device Found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n        yield put(DeviceActions.addDevice(scannedDevice))\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield call(manager.StopDiscovery);\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      bluetoothChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBluetoothScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLUETOOTH)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBlueScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBlueScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\nexport function* stopBluetoothScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}\r\n\r\nexport function* bluetoothScanAble(sagaArgs){\r\n  yield call(sagaArgs.BlueManager.BluetoothSearchAble);\r\n}","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { deviceService } from '../../Services/DeviceService'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device} from 'react-native-ble-plx'\r\n//Include BLE Saga\r\nimport * as BLE from './BLE/BLESaga'\r\nexport {BLE}\r\n//Include BlueTooth Saga\r\nimport * as BlueTooth from './BlueTooth/BlueToothSaga'\r\nexport {BlueTooth}\r\n\r\nexport function* deviceStartup() {\r\n  //Check and setup BLE.... / Bluetooth\r\n  yield put(DeviceActions.setDeviceError(\"\"))\r\n  yield put(DeviceActions.clearDevices());\r\n  yield put(DeviceActions.connectedDeviceUpdated(null)); // TODO: load connected device if possible\r\n  yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n\r\n  yield put(DeviceActions.bleStartup());\r\n  yield put(DeviceActions.bluetoothStartup());\r\n  \r\n  console.log('Device Startup : Done');\r\n}\r\n\r\nexport function* connectDevice(device: Device){\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n  //console.log(\"Device: \", device); // dummy call to connect...\r\n}\r\n\r\nexport function* disconnectDevice(methode){\r\n  //console.log(\"Device: \", device); // dummy call to disconnect...\r\n}\r\n\r\nexport function* readDeviceData(){\r\n  var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n  if (connectedDevice != null) {\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode == ConnectionMethode.BLE) {\r\n      yield put(DeviceActions.readBleDeviceData())\r\n    } else if (connectionMethode == ConnectionMethode.BLUETOOTH) {\r\n      yield put(DeviceActions.readBlueDeviceData())\r\n    }\r\n  }\r\n}\r\n\r\nexport function* fetchDevice(sagaArgs) {\r\n  console.log(\"??\");\r\n  //yield put(DeviceActions.fetchDeviceLoading())\r\n  //yield call(scan_BLE, sagaArgs);\r\n}","//#region Defines\r\nexport const UserStates = {\r\n  STARTER: 'starter',\r\n  FREE: 'free',\r\n  WORKER: 'worker',\r\n  OWNER: 'owner',\r\n  ADMIN: 'admin',\r\n}\r\n\r\nexport const DataStates = {\r\n  CLOSED: 'Closed'\r\n}\r\n\r\nexport const DataRefs = {\r\n  FIREBASEUSER: 'firebaseuser',\r\n  USERSDATA: 'usersdata',\r\n  USERS: 'users',\r\n  FARMS: 'farms',\r\n  SECTIONS: 'farms_data/$farmid/sections',\r\n  PENS: 'farms_data/$farmid/pens',\r\n  PIGS: 'farms_data/$farmid/pigs',\r\n  BATCHS: 'farms_data/$farmid/batchs',\r\n\r\n  WEIGHING: 'farms_data/$farmid/pens/$penid/weighings/',\r\n  GRAPH: 'farms_data/$farmid/Graph/$graphid/',\r\n\r\n  COMMENTS: 'farms_data/$farmid/datas/comments/',\r\n  FARMDATAS: 'farms_data/$farmid/datas/',\r\n  SHARES: 'shareData'\r\n}\r\n\r\nexport const Actions = {\r\n  SIGN: 'sign',\r\n\r\n  FETCH: 'fetch',\r\n  CREATE: 'create',\r\n  UPDATE: 'update',\r\n  MOVE: 'move',\r\n  DELETE: 'delete',\r\n  CLEAR: 'clear',\r\n  ADD: 'add',\r\n}\r\n\r\nexport const Operations = {\r\n  ADD: 'Add pig',\r\n  MOVE: 'Move pig',\r\n  LOST: 'Lost pig',\r\n  SOLD: 'Sold pig',\r\n  NOTE: 'Pen Note',\r\n}\r\n\r\nexport const ErrorTypes = {\r\n  SYSTEM: 'System',\r\n  EMAIL: 'Email',\r\n  PASSWORD: 'Password',\r\n  FORMAT: 'Format',\r\n}\r\n//#endregion\r\n\r\n//#region Formaters\r\nfunction format_num(num) {\r\n  if (num < 10){\r\n    num = \"0\"+num\r\n  }\r\n  return num;\r\n}\r\nexport function format_Time(time) {\r\n  var s = new Date(parseInt(time));\r\n  var datetime = format_num(s.getDate()) + \"/\" + format_num(s.getMonth() +1) + \"/\" + s.getFullYear() + \" \" \r\n                  + format_num(s.getHours()) + \":\" + format_num(s.getMinutes()) + \":\" + format_num(s.getSeconds());\r\n  return datetime\r\n}\r\n\r\nvar reA = /[^a-zA-Z]/g;\r\nvar reN = /[^0-9]/g;\r\nfunction sortAlphaNum(a, b) {\r\n  var aA = a.replace(reA, \"\");\r\n  var bA = b.replace(reA, \"\");\r\n  if (aA === bA) {\r\n    var aN = parseInt(a.replace(reN, \"\"), 10);\r\n    var bN = parseInt(b.replace(reN, \"\"), 10);\r\n    return aN === bN ? 0 : aN > bN ? 1 : -1;\r\n  } else {\r\n    return aA > bA ? 1 : -1;\r\n  }\r\n}\r\n\r\nexport function sortObject(o) {\r\n  var sorted = {},\r\n  key, a = [];\r\n\r\n  for (key in o) {\r\n    if (o.hasOwnProperty(key) && key !== \"__jsogObjectId\" && key !== \"update_time\") {\r\n      a.push(key);\r\n    }\r\n  }\r\n  a.sort(sortAlphaNum);\r\n\r\n  for (key = 0; key < a.length; key++) {\r\n    sorted[a[key]] = o[a[key]];\r\n  }\r\n  return sorted;\r\n}\r\n\r\nexport function DataStringCheck(data, Check_num = true) {\r\n  if (!data || data === \"\"){\r\n    return false\r\n  }\r\n  if (!typeof(data) === 'string'){\r\n    return false\r\n  }else {\r\n    if (Check_num) {\r\n      var first = data[0]\r\n      var numbers = '0123456789';\r\n      for(var i = 0; i < numbers.length;i++){\r\n        if(first === numbers[i]){\r\n          return false\r\n        }\r\n      }\r\n    }\r\n\r\n    var specialChars = '/[`!@#$%^&*()+\\-=\\[\\]{};\\':\"\\\\|,.<>\\/?~]/¨´';\r\n    for(var i = 0; i < specialChars.length;i++){\r\n      if(data.indexOf(specialChars[i]) > -1){\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  return true\r\n}\r\n//#endregion\r\n\r\n//#region Data gets\r\nexport function GetWeight_FromPen(PenId, WeighingsStore = null, AfterTime = null, BeforeTime = null) {\r\n  //PenId: Parrent Get ellement (ID),\r\n  //WeighingsStore: LocalDataStore.weighings,\r\n  //AfterTime: Only data after specefied Time,\r\n  //BeforeTime: Only data before specefied Time\r\n  var Weighing = null;\r\n\r\n  if (PenId, WeighingsStore){\r\n    for (const _weighing in WeighingsStore[PenId]) {\r\n      var weighing = WeighingsStore[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) {\r\n        if ((!AfterTime || weighing.time >= AfterTime) &&\r\n          (!BeforeTime || weighing.time <= BeforeTime)) {\r\n          Weighing = weighing\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return Weighing;\r\n}\r\n\r\nexport function GetBatch_FromPen(localDataStore, PenId) {\r\n  if (localDataStore.batchs) {\r\n    //Get batch form pen\r\n    for (const _batch in localDataStore.batchs) {\r\n      var batch = localDataStore.batchs[_batch]\r\n      if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n        return localDataStore.batchs[_batch]\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetStats_FromPen(PenId, PenData, localDataStore, StartDate, EndDate, PenWeighings = null){\r\n  var Animals = 0;\r\n  var PenWeight = 0\r\n  var PenGrowth = 0\r\n  var AveragePenGrowth = 0;\r\n\r\n  if (PenData.datas && PenData.datas.count || PenData.count) {\r\n    if (PenData.count) Animals += PenData.count\r\n    else Animals += PenData.datas.count\r\n  }\r\n  \r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var GrowthCount = 0\r\n\r\n    var lastDate = 0\r\n    var LastWeight = undefined;\r\n    var LastWeightDay = undefined;\r\n    var FirstWeight = undefined;\r\n\r\n    if (!PenWeighings) PenWeighings = localDataStore.weighings[PenId]\r\n    if (PenWeighings) {\r\n      Object.keys(PenWeighings).forEach((weight) => {\r\n        var Weight = PenWeighings[weight]\r\n        if (Weight.time >= StartDate && Weight.time <= EndDate && Weight.time > lastDate) {\r\n          PenWeight = Weight.weight\r\n          if (Weight.count) PenWeight = Weight.weight / Weight.count;\r\n\r\n          if (LastWeight !== undefined) {\r\n            PenGrowth = PenWeight - LastWeight\r\n            GrowthCount++;\r\n          }\r\n\r\n          lastDate = Weight.time\r\n          LastWeight = PenWeight\r\n          LastWeightDay = Weight.time\r\n          if (!FirstWeight) FirstWeight = Weight.time;\r\n        }\r\n      })\r\n    }\r\n\r\n    var now = new Date().getTime()\r\n    var isVirtual = false;\r\n    if (StartDate && EndDate) {\r\n      var Batch = GetBatch_FromPen(localDataStore,PenId)\r\n      var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      var BatchEndDate = EndDate;\r\n      var Predict = CurvePredict(localDataStore, PenId, Batch, TempGraph)\r\n      if (Predict != null && Predict.Now && now > new Date(lastDate).getDate()) {\r\n        PenWeight = Predict.Now\r\n        if (LastWeight !== undefined) {\r\n          PenGrowth += PenWeight - LastWeight\r\n          GrowthCount++;\r\n        }\r\n        var _date = new Date(Predict.lastWeighing.time + Predict.Addition)\r\n        _date.setDate(_date.getDate() + Predict.days)\r\n        LastWeightDay = _date.getTime()\r\n        isVirtual = true\r\n      }\r\n      if (Predict && Predict.lastWeighing && Predict.days) {\r\n        var tempEnd = new Date(EndDate).getTime()\r\n        var date = new Date(Predict.lastWeighing.time)\r\n        date.setDate(date.getDate() + Predict.days)\r\n        tempEnd = date.getTime()\r\n        if (Predict.Addition) {\r\n          tempEnd += Predict.Addition\r\n        }\r\n        if (EndDate === BatchEndDate || EndDate < tempEnd) {\r\n          EndDate = tempEnd;\r\n        }\r\n      }\r\n    }\r\n    if (GrowthCount > 0) {\r\n      var Growth = (PenGrowth / GrowthCount)\r\n      var days = (LastWeightDay - FirstWeight) / 86400000\r\n      Growth = Growth / days\r\n      AveragePenGrowth += Growth //AverageGrowth for specefic pen\r\n    }\r\n  }\r\n  return { Animals, PenWeight, AveragePenGrowth, EndDate, isVirtual }\r\n}\r\n\r\nexport function GetStats_FromBatch(Batch, localDataStore, Closed=true) {\r\n  var isVirtual = false;\r\n  var PenCount = 0;\r\n  var Animals = 0\r\n  var CollectedWeight = 0;\r\n  var CollectedGrowth = 0;\r\n  \r\n  var isClosed = (Batch.state && Batch.state === \"Closed\")?true:false\r\n\r\n  var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n  if (!TempGraph) return null;\r\n  var TargetWeight = TempGraph.data[TempGraph.data.length -1]\r\n  var EndDate = GetBatchEnd(Batch, TempGraph)\r\n  var StartDate = Batch.time;\r\n\r\n  var PenEnds = 0\r\n  if (Batch && Batch.pens && localDataStore.pens) {\r\n    Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(Batch_Pen => {\r\n      if (localDataStore && localDataStore.pens && localDataStore.pens[Batch_Pen] && localDataStore.weighings && localDataStore.weighings[Batch_Pen] || isClosed) {\r\n        var Pen = isClosed?Batch.pens[Batch_Pen]:localDataStore.pens[Batch_Pen]\r\n        PenCount++\r\n        \r\n        var PenWeighings = isClosed?Batch.closed.weighings[Batch_Pen]:localDataStore.weighings[Batch_Pen]\r\n        if (PenWeighings) {\r\n          var PenStats = GetStats_FromPen(Batch_Pen, Pen, localDataStore, StartDate, EndDate, PenWeighings)\r\n          Animals += PenStats.Animals;\r\n          var PenWeight = PenStats.PenWeight\r\n          if (PenWeight === 0) {\r\n            PenCount--\r\n          } else {\r\n            CollectedWeight += PenWeight\r\n            CollectedGrowth += PenStats.AveragePenGrowth\r\n            if (PenEnds < PenStats.EndDate) PenEnds = PenStats.EndDate\r\n            if (!isVirtual) isVirtual = PenStats.isVirtual\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  if (PenEnds > 0) EndDate = PenEnds\r\n  var AverageWeight = CollectedWeight / PenCount\r\n  AverageWeight = parseFloat(AverageWeight).toFixed(2)\r\n  var AverageGrowth = CollectedGrowth / PenCount\r\n  AverageGrowth = parseFloat(AverageGrowth).toFixed(2)\r\n\r\n  return {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual}\r\n}\r\n\r\nexport function GetCurve_FromBatch(Batch, GraphsStore = null, CurrentData = null) {\r\n  //Batch: Parrent Get ellement,\r\n  //GraphsStore: LocalDataStore.graphs,\r\n  //CurrentData: Data state get,\r\n  if (Batch) {\r\n    if (Batch.gcurve && Batch.state && Batch.state === DataStates.CLOSED) {\r\n      return Batch.gcurve;\r\n    }\r\n    if (GraphsStore) {\r\n      if (CurrentData && (typeof CurrentData === 'string' || CurrentData.curveId)) {\r\n        var Id = (typeof CurrentData === 'string')? CurrentData: CurrentData.curveId\r\n        return GraphsStore[Id];\r\n      }\r\n      if (Batch.gcurve){\r\n        return GraphsStore[Batch.gcurve];\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetBatchEnd(Batch, TempCurve){\r\n  if (Batch && Batch.time && TempCurve){\r\n    var currentTime = new Date(Batch.time) //Does not allow weight's after Batch end\r\n    for (var i = 0; i < TempCurve.data.length; i++) {\r\n      if (i < TempCurve.data.length -1) {\r\n        currentTime = new Date(AccumulateTime(currentTime, TempCurve.periode))\r\n      }\r\n    }\r\n    return currentTime.getTime();\r\n  }\r\n  return null\r\n}\r\n//#endregion\r\n\r\n//#region Curve Functions\r\nexport function AccumulateTime(Time, PeriodeLength) {\r\n  var NewTime = new Date(Time.getTime())\r\n  switch(PeriodeLength) {\r\n    case \"Days\":\r\n    //86.400.000 ms\r\n    NewTime.setDate(NewTime.getDate() + 1)\r\n    break;\r\n    case \"Month\":\r\n    NewTime.setMonth(NewTime.getMonth() + 1)\r\n    break;\r\n    case \"Weeks\":\r\n    default:\r\n    NewTime.setDate(NewTime.getDate() + 7)\r\n    break;\r\n  }\r\n  return NewTime;\r\n}\r\n\r\n//Get Today-point expected data and virtual simulation For PenId with Batch / or given\r\nexport function get_DataSpot_FromData(localDataStore, PenId, Batch, Closed = false) {\r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var Weighing = null;\r\n\r\n    //get newest weighing\r\n    for (const _weighing in localDataStore.weighings[PenId]) {\r\n      var weighing = localDataStore.weighings[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) { \r\n        Weighing = weighing\r\n      }\r\n    }\r\n\r\n    if (Weighing) {\r\n      var weight = Weighing.weight\r\n      weight = weight / Weighing.count\r\n      if (weight && !isNaN(weight)) {\r\n        if (!Batch) {\r\n          //Get batch form pen\r\n          for (const _batch in localDataStore.batchs) {\r\n            var batch = localDataStore.batchs[_batch]\r\n            if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n              Batch = localDataStore.batchs[_batch]\r\n              //break; //diffrenc from web ??? (needed in mobile..)\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Batch && Batch.time && Batch.datas \r\n          && localDataStore.graphs && localDataStore.graphs[Batch.gcurve]) {\r\n          var Curve = localDataStore.graphs[Batch.gcurve]\r\n          var WeighingTime = Weighing.time\r\n\r\n          if (Closed || (WeighingTime > Batch.time && (!Batch.state || Batch.state !== \"Closed\"))) {\r\n            var StartTime = Batch.time\r\n            var EndTime = Batch.time\r\n            var index = 0;\r\n            var currentTime = new Date(StartTime)\r\n            for (index = 0; index < Curve.data.length-1; index++) {\r\n              currentTime = new Date(AccumulateTime(currentTime, Curve.periode))\r\n              EndTime = currentTime.getTime()\r\n              if (EndTime >= WeighingTime) {\r\n                break;\r\n              } else {\r\n                StartTime = EndTime\r\n              }\r\n            }\r\n            //var EndDate = EndDate = currentTime.getTime();\r\n            \r\n            var Keys = Object.keys(Curve.data);\r\n            var DataSpot = get_DataSpot([StartTime, EndTime], [Curve.data[Keys[index]], Curve.data[index +1]], new Date().getTime(), weight, WeighingTime)\r\n            DataSpot.Batch = Batch\r\n            return DataSpot\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\n//Get point expected data and virtual simulation from data.\r\n//ExValue = Expected value if slope continues, for spots given (or inbetween).\r\n//VirData = Virtual calculation for Data progress to DataTime, if slope continues.\r\nexport function get_DataSpot(MinMax_Time, MinMax_Data, FindTime, Data, DataTime) {\r\n  var ExValue = null\r\n  var VirData = null\r\n  var ExTime = null\r\n  if (FindTime) {\r\n    var slope = GetSlope_Between(MinMax_Time, MinMax_Data)\r\n    var FindX = FindTime- MinMax_Time[0]\r\n    // ExValue = (FindX * Slope) + MinY             // Setting FindTime, due b then = Min data.. (b is y = 0)\r\n    ExValue = (FindX * slope) + MinMax_Data[0]          // ( X * a ) + b = Expeted data for spot on CalcTime\r\n    \r\n    if (Data && DataTime) {\r\n      var Findx2 = DataTime- MinMax_Time[0]\r\n      var ExData = (Findx2 * slope) + MinMax_Data[0]    //Expeted data for given Time 2\r\n      \r\n      var DataDiff = ExData - Data;\r\n      VirData = ExValue + DataDiff;\r\n\r\n      ExTime = (Data - MinMax_Data[0]) / slope          // (y-b)/a = Expeted time for data\r\n      ExTime = MinMax_Time[0] + ExTime\r\n      ExTime = Math.floor(ExTime)\r\n    }\r\n  }\r\n  return {ExValue, VirData, ExTime}\r\n}\r\n\r\n//Get Slope Between two points\r\nfunction GetSlope_Between(MinMax_Time, MinMax_Data){\r\n  var minX = MinMax_Time[0]\r\n  var maxX = MinMax_Time[1]\r\n  var minY = MinMax_Data[0]\r\n  var maxY = MinMax_Data[1]\r\n\r\n  //Slope = DeltaY / DeltaX\r\n  var slope = (maxY - minY) / (maxX - minX)\r\n  if (minY > minX) slope = -slope;\r\n  return slope\r\n}\r\n\r\nexport function CurvePredict(localDataStore, PenId, Batch, TempCurve) {\r\n  if (localDataStore) {\r\n    /* Get data */\r\n    if (!PenId && Batch && Batch.pens){\r\n      PenId = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId'))[0]\r\n    }\r\n    if (!Batch) {\r\n      Batch = GetBatch_FromPen(localDataStore, PenId)\r\n    }\r\n    if (Batch && Batch.time) {\r\n      if (!TempCurve) {\r\n          TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      }\r\n      if (TempCurve && TempCurve.data) {\r\n        var BatchEndDate = GetBatchEnd(Batch, TempCurve)\r\n        var Weighing = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, BatchEndDate);\r\n        if (Weighing && Weighing.weight) {\r\n          var weight = Weighing.weight\r\n          if (Weighing.count) weight = weight / Weighing.count\r\n          var Weighing2 = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, Weighing.time -1);\r\n          var weight2 = Weighing2?Weighing2.weight:0\r\n          if (Weighing2 && Weighing2.count) weight2 = weight2 / Weighing2.count\r\n\r\n          var StartIndex = \"none\";\r\n          var PredictCurve = { periode: TempCurve.periode, data: [] }\r\n          var now = new Date(Date.now())\r\n          now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n          var CurrentTime = new Date(Batch.time)\r\n          var Temp_CurrentIndex = 0;\r\n\r\n          /* find template fit */\r\n          for (var index = 0; index < TempCurve.data.length; index++) {\r\n            if (CurrentTime.getTime() <= now) {\r\n              CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n              Temp_CurrentIndex++;\r\n            }\r\n\r\n            if (weight <= TempCurve.data[index]) {\r\n              if (StartIndex === \"none\") {\r\n                StartIndex = index\r\n              }\r\n              PredictCurve.data.push(TempCurve.data[index])\r\n            }\r\n          }\r\n          if (weight < weight2) {\r\n            StartIndex = StartIndex -1\r\n            PredictCurve.data.unshift(TempCurve.data[StartIndex])\r\n          }\r\n\r\n          var PredictStart = new Date(Batch.time)\r\n          for (let index = 0; index < StartIndex; index++) {\r\n            PredictStart = new Date(AccumulateTime(PredictStart, TempCurve.periode))\r\n          }\r\n\r\n          PredictCurve.Now = weight\r\n          PredictCurve.TempEx = TempCurve.data[Temp_CurrentIndex]\r\n          if (StartIndex !== \"none\") {\r\n            var DataSpot = null\r\n            if (Weighing2) {\r\n              DataSpot = get_DataSpot([Weighing2.time, Weighing.time], [weight2, weight], Weighing.time, TempCurve.data[StartIndex], PredictStart.getTime())\r\n            }\r\n            if (DataSpot && DataSpot.ExTime) {\r\n              PredictCurve.FirstSpot = DataSpot.ExTime \r\n              PredictCurve.Addition = DataSpot.ExTime - Weighing.time\r\n            } else {\r\n              PredictCurve.FirstSpot = new Date(Weighing.time + 86400000)\r\n              PredictCurve.Addition = 86400000\r\n            }\r\n\r\n            if (BatchEndDate) {\r\n              var now = new Date(Date.now())\r\n              if (BatchEndDate <= now) {\r\n                now = new Date(BatchEndDate)\r\n              }\r\n\r\n              now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n              CurrentTime = new Date(Weighing.time)\r\n              var CurrentIndex = 0;\r\n              for (var index = 0; index < PredictCurve.data.length; index++) {\r\n                if (CurrentTime.getTime() < now) {\r\n                  CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n                  CurrentIndex ++;\r\n                }\r\n              }\r\n              CurrentIndex--\r\n              \r\n              var WeightNow = PredictCurve.data[CurrentIndex];\r\n              if (WeightNow) PredictCurve.Now = WeightNow\r\n              else PredictCurve.Now = weight\r\n            }\r\n          }\r\n\r\n          var days = 0;\r\n          if (TempCurve.periode === \"Days\") days = PredictCurve.data.length\r\n          else if (TempCurve.periode === \"Weeks\") days = (PredictCurve.data.length) * 7\r\n          PredictCurve.days = days\r\n          PredictCurve.lastWeighing = Weighing\r\n\r\n          PredictCurve.Batch = Batch;\r\n          return PredictCurve;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n//#endregion","import { Platform, Alert } from 'react-native'\r\n\r\nimport { UserStates } from '../Stores/Firebase/Selectors'\r\nimport { Actions, DataRefs, format_Time } from '../Stores/Firebase/Selectors';\r\n\r\nlet auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase\r\n\r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n\r\n  auth = _firebase.auth;\r\n  messaging = _firebase.messaging;\r\n  database = _firebase.database;\r\n  //#endregion\r\n}\r\n\r\n//#region Firebase specefic services\r\nasync function isPermit_UserPermission() {\r\n  const authStatus = await messaging().requestPermission();\r\n  const enabled =\r\n    authStatus === messaging.AuthorizationStatus.AUTHORIZED ||\r\n    authStatus === messaging.AuthorizationStatus.PROVISIONAL;\r\n\r\n  if (!enabled) {\r\n    console.log('Authorization status:', authStatus);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction requestUserPermission() {\r\n  return new Promise((resolve, reject) => {\r\n    if ((Platform.OS === \"ios\" || Platform.OS == \"android\") && !isPermit_UserPermission()) {\r\n      resolve('This application needs premissions to be using notifications')\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nasync function is_getToken() {\r\n  var fcmToken = \"\"\r\n  try{\r\n    fcmToken = await messaging().getToken();\r\n    console.log('Device_token: ', fcmToken)\r\n  }catch(error){\r\n    console.log(error)\r\n  }\r\n  return fcmToken;\r\n}\r\n\r\nfunction requestFirebaseToken() {\r\n  return new Promise((resolve, reject) => {\r\n    var token;\r\n    if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    }else if (messaging.isSupported()) {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    }\r\n    if (!token) {\r\n      resolve('Could not find Firebase messaging Token')\r\n    }\r\n    resolve(token)\r\n  })\r\n}\r\n\r\nfunction wrappedAlert(title, message, okText, _cancelable) {\r\n  return new Promise(resolve => {\r\n    Alert.alert(\r\n      title,\r\n      message,\r\n      [{text: okText, onPress: function() { resolve(); }}],\r\n      {cancelable: _cancelable, onDismiss: function() {resolve(); }},\r\n    );\r\n  });\r\n}\r\n//#endregion\r\n\r\n//#region Firebase Auth services\r\nfunction createFirebaseUserWithemailandpassword({Email, Pass}) {\r\n  return new Promise((resolve, reject) => {\r\n    auth().createUserWithEmailAndPassword(Email,Pass).then(() => {\r\n      var User = auth().currentUser;\r\n      var Name = User.displayName ? User.displayName : User.email\r\n      actionStarting(DataRefs.USERSDATA, Actions.UPDATE, {UserId: User.uid, Data: {\r\n        name: Name,\r\n        state: UserStates.STARTER,\r\n      }}).then((_data) => {\r\n        User.updateProfile({\r\n          displayName: Name\r\n        }).then((data) => {\r\n          User.sendEmailVerification().then(function() {\r\n            // Email sent.\r\n            resolve(null)\r\n          }).catch(function(error) {\r\n            console.log(\"error in send EmailVerification\", error)\r\n            resolve({error:error.code, viewError:'Verification could not be send'})\r\n          });\r\n        }).catch(function(error) {\r\n          console.log(\"update profile\")\r\n          resolve({error:error.code, viewError:'Update error, please refresh'})\r\n        });\r\n      })\r\n      \r\n    }).catch(error => {\r\n      console.log(\"UserCreate Error: \", error);\r\n      if (error.code === 'auth/email-already-in-use') {\r\n        resolve({error:error.code, viewError:'The email address is already in use.'})\r\n        //Should not exploid the users... (this could be used as a find user-mails) ???\r\n      }\r\n      else if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else if (error.code === 'auth/weak-password') {\r\n        resolve({error:error.code, viewError: error.message})\r\n      } else {\r\n        resolve({error:error.code, viewError: 'Something went wrong'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction signinWithemailandpassword({Email, Pass}){\r\n  if (auth().currentUser){\r\n    if (auth().currentUser.email != Email){\r\n      const res = logoutUser()\r\n    }\r\n    else {\r\n      return new Promise((resolve, reject) => {\r\n        resolve(true)\r\n      })\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    auth().signInWithEmailAndPassword(Email,Pass).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User Signin Error: \", error);\r\n\r\n      if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else {\r\n        resolve({error:'Could not singin', viewError:'Could not singin'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction sendResetPassword({Email}){\r\n  return new Promise((resolve, reject) => {\r\n    auth().sendPasswordResetEmail(Email).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User resetPass error:\", error);\r\n      if (error.code === 'auth/user-not-found'){\r\n        //Should not exploid the users... (this could be used as a find user-mails)\r\n      }\r\n      resolve(null)\r\n    })\r\n  })\r\n}\r\n\r\nfunction logoutUser(){\r\n  return new Promise((resolve, reject) => {\r\n    auth().signOut().then(() => {\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    }).catch(error => {\r\n      console.log(\"User logout error:\", error);\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    })\r\n  })\r\n}\r\n\r\nfunction refreshUser(){\r\n  return new Promise((resolve, reject) => {\r\n    var user = auth().currentUser\r\n    if (user){\r\n      auth().currentUser.reload().then((data) => {\r\n        user = auth().currentUser\r\n        console.log(data, user)\r\n        //resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n      })\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Master Control\r\nfunction actionStarting(ref, action, params = null){\r\n  const CurrentUser = auth().currentUser;\r\n  switch(ref){\r\n    case DataRefs.USERSDATA:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"UserData\")) {\r\n            return new Promise((resolve, reject) => {\r\n              var Data = params[0]\r\n              createFarm({Data:{name: params.Farms.name}}).then((farmid) => {\r\n                updateFarmData({FarmId:farmid, Data:{sections:params.Sections, pens: params.Pens}}).then(() => {\r\n                  updateUserData({Data:{state: params.UserData.state, farms: {[farmid]: true}}}).then(() => {\r\n                    fetchUser(CurrentUser.uid).then((data) => {\r\n                      var Data = data.data\r\n                      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:Data })\r\n                    });\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          }\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateUserData(params)\r\n        case Actions.SIGN:\r\n          if (!params){\r\n            return logoutUser()\r\n          }else {\r\n            if (params.hasOwnProperty(\"refresh\")){ // TODO: verify\r\n              return refreshUser()\r\n            } else return signinWithemailandpassword(params)\r\n          }\r\n          break;\r\n        case Actions.CLEAR:\r\n          if (!CurrentUser) {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n          } else {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERSDATA, data:{}}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n\r\n    case DataRefs.USERS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params, true)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"Email\") && params.hasOwnProperty(\"Pass\")) return createFirebaseUserWithemailandpassword(params)\r\n          else if (params.hasOwnProperty(\"Email\")) return sendResetPassword(params)\r\n          break;\r\n        case Actions.UPDATE:\r\n          return {type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:params}\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchFarm(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateFarm(params)\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.FARMS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMDATAS:\r\n      switch(action) {\r\n        case Actions.UPDATE:\r\n          return updateFarmData(params)\r\n      }\r\n      break;\r\n\r\n    case DataRefs.SECTIONS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchSections(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.SECTIONS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PENS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPens(params);\r\n        case Actions.CREATE:\r\n          return createNewPen(params);\r\n        case Actions.DELETE:\r\n          return deletePen(params)\r\n        case Actions.UPDATE:\r\n          return updatePen(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PENS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PIGS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPigs(params);\r\n        case Actions.CREATE:\r\n          return updatePigdata(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PIGS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.BATCHS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchBatchs(params)\r\n        case Actions.CREATE:\r\n          return createBatchs(params)\r\n        case Actions.UPDATE:\r\n          return updateBatchs(params)\r\n        case Actions.DELETE:\r\n          //return deleteBatch(params)\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.BATCHS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.WEIGHING:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchWeights(params);\r\n        case Actions.CREATE:\r\n          return createWeight(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.WEIGHING, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.COMMENTS:\r\n      switch(action) {\r\n        case Actions.FETCH:\r\n          return fetchComments(params);\r\n        case Actions.CREATE:\r\n          return createComment(params);\r\n      }\r\n      break;\r\n\r\n    case DataRefs.GRAPH:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchGraphData(params);\r\n        case Actions.CREATE:\r\n          return updateGraphData(params);\r\n        case Actions.UPDATE:\r\n          return updateGraphData(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.GRAPH, data:{}}\r\n      }\r\n      break;\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    resolve({error: \"Unknown Action\"})\r\n  })\r\n}\r\n//#endregion\r\n\r\nfunction SetUpdateTime(DataRef) {\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Setting Update Time\")\r\n    database().ref(DataRef).update({\r\n      update_time: database.ServerValue.TIMESTAMP,\r\n    }).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(error)\r\n      /*if (error.code === 'database/permission-denied') {\r\n        console.log(\"Batch update was permission denied. \");\r\n      }else if (error.code) {\r\n        console.log(\"Batch update Error: \", error);\r\n      }*/\r\n      resolve(true)\r\n    });\r\n  })\r\n}\r\nfunction CheckDataTime(DataRef, DataTime) {\r\n  return new Promise((resolve, reject) => {\r\n    if (!DataTime) resolve(true)\r\n    database().ref(DataRef + \"/update_time\").once('value').then((_Time) => {\r\n      var UpdateTime = _Time.val()\r\n      if (!UpdateTime) {\r\n        SetUpdateTime(DataRef).then((res) => {\r\n          resolve(true)\r\n        })\r\n      } else {\r\n        if (DataTime) {\r\n          if (DataTime === \"SET\"){\r\n            SetUpdateTime(DataRef).then((res) => {\r\n              resolve(res)\r\n            })\r\n          } else if (DataTime < UpdateTime){\r\n            resolve(true)\r\n          }\r\n          else resolve(false)\r\n        }else resolve(true)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n//#region User data Controls\r\nfunction fetchUser({UserId}, List = false) {\r\n  var user = \"\";\r\n  if (UserId) user = UserId\r\n  else if (!List && auth().currentUser) user = auth().currentUser.uid;\r\n\r\n  if (user || List) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).once('value').then((userData) => {\r\n        var data = userData.val()\r\n        if (!List) {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:{data}})\r\n        } else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.USERS, data:{data}})\r\n        }\r\n      }).catch(error => {\r\n        console.log(error)\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    })\r\n  }\r\n  else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateUserData({UserId, Data}) {\r\n  const user = UserId? UserId: auth().currentUser.uid;\r\n  if (user) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then((data) => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    }) \r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm info data Controls\r\nfunction fetchFarm({FarmId}) {\r\n  var ref = \"farms/\" + FarmId\r\n  return database().ref(ref).once('value').then((_farmData) => {\r\n    //TODO:Multiple farms\r\n    var data = _farmData.val()\r\n    if (FarmId) {\r\n      data = {[FarmId]:data}\r\n    }\r\n    return {type:Actions.UPDATE, path:DataRefs.FARMS, data: data}\r\n  })\r\n  /*} else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })*/\r\n}\r\n\r\nfunction updateFarm({FarmId, Data}) {\r\n  return new Promise((resolve, reject) => {\r\n    if (FarmId){\r\n      database().ref('farms/'+ FarmId).update({\r\n        ...Data\r\n      }).then(()=> {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    } else {\r\n      const farm = database().ref('farms/').push()\r\n      const farmid = farm.key\r\n      farm.set({\r\n        Data\r\n      }).then(() => {\r\n        resolve(farmid)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nfunction createFarm({Data}){\r\n  const user = auth().currentUser;\r\n  const ref = \"users/\" + user.uid;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const farm = database().ref('farms/').push()\r\n    const farmid = farm.key\r\n    \r\n    farm.set({\r\n      email: user.email,\r\n      manager: user.displayName ? user.displayName : user.email,\r\n      name: Data.name\r\n    }).then(() => {\r\n      resolve(farmid)\r\n    }).catch(error => {\r\n      console.log(\"Create Farm Error: \", error);\r\n      resolve(false)\r\n    })\r\n  })\r\n}\r\n\r\nfunction updateFarmData({FarmId, Data}) {\r\n  if (FarmId) {\r\n    const ref = \"farms_data/\" + FarmId;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then(() => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"Farm data update was permission denied.\");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n\r\n        resolve(false)\r\n      })\r\n    })\r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm data Controls\r\n\r\n//#region Sections\r\nfunction fetchSections({FarmId, SectionId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/sections\";\r\n    if (SectionId){\r\n      ref += \"/\" + SectionId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/sections\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          console.log(\"Sections fetch called\")\r\n          return database().ref(ref).once('value').then((_sectionidData) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.SECTIONS, data:_sectionidData.val()})\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Sections Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Pens\r\nfunction fetchPens({FarmId, PenId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pens\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/pens\", DataTime).then((DoFetch) => {\r\n        if (DoFetch){\r\n          console.log(\"Pens fetch Called\")\r\n\r\n          database().ref(ref).once('value').then((_pensData) => {\r\n            if (PenId) {\r\n              var penData = _pensData.val()\r\n              if (!penData) penData = {}\r\n              if (!penData.datas) penData.datas = {}\r\n              //if (!penData.datas.gcurve) penData.datas.gcurve = \"default\";\r\n      \r\n              var pen = {[PenId]: penData};\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen})\r\n            } else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_pensData.val()})\r\n            }\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  } \r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pens Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createNewPen({FarmId, PenId, SectionId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n        database().ref(ref2).set({\r\n          section: SectionId,\r\n        }).then(() => {\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n            [PenId]: true,\r\n          }).then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              });\r\n            });\r\n          });\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction deletePen({FarmId, PenId, SectionId}){\r\n  if (FarmId && PenId){\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref + \"pens/\" + PenId).remove().then(() => {\r\n        if (SectionId){\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens/\" + PenId).remove().then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              })\r\n            });\r\n          })\r\n        }else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePen({FarmId, PenId, Pen}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId){\r\n        fetchPens({FarmId: FarmId, PenId: PenId}).then((_Pen) => {\r\n          var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n          var data = Pen.datas\r\n          var Datas = {..._Pen.data[PenId].datas, ...data}\r\n          database().ref(ref2).update({\r\n            ...Pen,\r\n            datas: Datas\r\n          }).then(() => {\r\n            if (Pen.section) {\r\n              database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n                [PenId]: true,\r\n              }).then(() => {\r\n                database().ref(ref + \"sections/\").update({\r\n                  update_time: database.ServerValue.TIMESTAMP,\r\n                }).then(() => {\r\n                  resolve(null)\r\n                });\r\n              });\r\n            }\r\n          });\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Pigs\r\nfunction fetchPigs({FarmId, TagId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pigs\";\r\n    if (TagId){\r\n      ref += \"/\" + TagId\r\n    }\r\n\r\n    return database().ref(ref).once('value').then((_pigsData) => {\r\n      if (TagId) {\r\n        var pigData = _pigsData.val()\r\n        if (!pigData) return null;\r\n        if (!pigData.datas) pigData.datas = {}\r\n        if (!pigData.datas.gcurve) pigData.datas.gcurve = \"default\";\r\n\r\n        var pig = {[TagId]: pigData};\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:pig}\r\n      } else {\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:_pigsData.val()}\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pigs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updatePigPen({FarmId, TagId, PenId, Action}) {\r\n  if (PenId) {\r\n    var ref2 = \"farms_data/\" + FarmId + \"/\" + \"pens/\" + PenId + \"/datas\"\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref2 + \"/count\").once('value').then((counts) => {\r\n        var val = counts.val()\r\n        if (!val) val = 0\r\n        if (Action && !isNaN(Action)) {\r\n          val = parseInt(val) + parseInt(Action)\r\n        } else {\r\n          val = parseInt(val) +1\r\n        }\r\n        database().ref(ref2).update({\r\n          count: val,\r\n        }).then(() => {\r\n          fetchPens({FarmId: FarmId, PenId: PenId}).then((pen) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen.data})\r\n          })\r\n        });\r\n      }).catch(error => {\r\n        console.log(\"Update pig pen Error: \", error);\r\n        resolve(null)\r\n      })\r\n    })\r\n  }else {\r\n    return new Promise((resolve, reject) => {\r\n      resolve(null)\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePigdata({FarmId, TagId, PenId, Action}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    if (TagId) {\r\n      return new Promise((resolve, reject) => {\r\n        var ref2 = ref + \"pigs/\" + TagId + \"/\"\r\n        fetchPigs({FarmId: FarmId, TagId: TagId}).then((pig) => {\r\n          if (pig && pig.data) {\r\n            pig = pig.data[TagId]?pig.data[TagId]:null\r\n          }\r\n          if (!pig || !pig.hasOwnProperty('pen')){\r\n            database().ref(ref2).update({\r\n              pen: 0,\r\n            }).then(() => {\r\n              fetchPigs({FarmId: FarmId}).then((pigs) => {\r\n                console.log(\"?\", pigs)\r\n                resolve(null)\r\n                //resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs})\r\n              })\r\n            })\r\n          }\r\n          else if (PenId && PenId != pig.pen) {\r\n            updatePigPen({FarmId: FarmId, TagId: TagId, PenId: pig.pen, Action:-1}).then((data)=>{\r\n              updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:+1}).then((data)=>{\r\n                database().ref(ref2).update({\r\n                  pen: PenId\r\n                }).then(() => {\r\n                  fetchPigs({FarmId: FarmId}).then((pigs)=> {\r\n                    resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs.data})\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        })\r\n      })\r\n    } else {\r\n      return new Promise((resolve, reject) => {\r\n        updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:Action}).then((data) => {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:data.data})\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Batchs\r\nfunction fetchBatchs({FarmId, BatchId, Data, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    if (BatchId){\r\n      ref += \"/\" + BatchId\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/batchs\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (!Data) {\r\n            database().ref(ref).once('value').then((_batchdata) => {\r\n              if (BatchId) {\r\n                var batchdata = _batchdata.val()\r\n                if (!batchdata) return null;\r\n                if (!batchdata.datas) batchdata.datas = {}\r\n                if (!batchdata.pens) batchdata.pens = []\r\n                if (!batchdata.datas.gcurve) batchdata.datas.gcurve = \"default\";\r\n\r\n                var batch = {[BatchId]: batchdata};\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:batch})\r\n              } else {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:_batchdata.val()})\r\n              }\r\n            })\r\n          }\r\n          else if (BatchId) {\r\n            switch(Data){\r\n              case DataRefs.BATCHS:\r\n                ref += \"/\" + \"datas\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var data = {[BatchId]: {datas: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:data})\r\n                })\r\n              case DataRefs.PENS:\r\n                ref += \"/\" + \"pens\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var pens = {[BatchId]: {pens: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:pens})\r\n                })\r\n              case DataRefs.GRAPH:\r\n                ref += \"/\" + \"gcurve\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var curve = {[BatchId]: {gcurve: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:curve})\r\n                })\r\n            }\r\n          }\r\n\r\n        } else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Batchs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createBatchs({FarmId, BatchId, Batch}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (Batch && Batch.name) {\r\n        BatchId = Batch.name;\r\n        ref += \"/\" + Batch.name + \"/\"\r\n        delete Batch.name;\r\n        database().ref(ref).set({\r\n          ...Batch,\r\n        }).then(() => {\r\n          Object.keys(Batch.pens).forEach(pen => {\r\n            updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n          })\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        }).catch(error => {\r\n          if (error.code === 'database/permission-denied') {\r\n            console.log(\"Batch update was permission denied. \");\r\n          }else if (error.code) {\r\n            console.log(\"Batch update Error: \", error);\r\n          }\r\n          resolve({error:\"An error occurred\"})\r\n        })\r\n      } else if (BatchId) { //added else ??? still cleanup ??\r\n        console.log(\"???\") //TODO: why id.. mabye cleanup\r\n        ref += \"/\" + BatchId + \"/\"\r\n        database().ref(ref).set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          pens:[],\r\n          datas:{\r\n            devianceMin:1,\r\n            devianceMax:2,\r\n          }\r\n        }).then(() => {\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction updateBatchs({FarmId, BatchId, Batch, Data}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (BatchId && Batch) {\r\n        ref += \"/\" + BatchId\r\n        fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.PENS}).then((_batch) => {\r\n          var Pens = _batch.data[BatchId].pens\r\n          if (Batch.name) delete Batch.name\r\n\r\n          var BatchPens = {}\r\n          if (Batch.pens && JSON.stringify(Batch.pens)!==JSON.stringify(Pens)) {\r\n            if (!Pens) Pens = []\r\n            var RemovedPens = Object.keys(Pens).filter(x => !Object.keys(Batch.pens).includes(x) && !Pens[x].enddate);\r\n            var NewPens = Object.keys(Batch.pens).filter(x => !Object.keys(Pens).includes(x) || Pens[x].enddate);\r\n            var SamePens = Object.keys(Pens).filter(x => !Object.keys(RemovedPens).includes(x) && !Object.keys(NewPens).includes(x));\r\n\r\n            if (RemovedPens && RemovedPens.length > 0) {\r\n              RemovedPens.forEach(pen => {\r\n                if (Pens[pen]) {\r\n                  var Pen = Pens[pen]\r\n                  Pen.enddate = Date.now()\r\n                  BatchPens[pen] = Pen\r\n                  fetchPens({FarmId: FarmId, PenId:pen}).then((pendata) => {\r\n                    var count = 0\r\n                    if (pendata.data[pen] && pendata.data[pen].datas && pendata.data[pen].datas.count)count=pendata.data[pen].datas.count\r\n                    BatchPens[pen].count = count\r\n                  })\r\n                  updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:\"\"}}})\r\n                }\r\n              })\r\n            }\r\n            if (NewPens && NewPens.length > 0) {\r\n              NewPens.forEach(pen => {\r\n                var Pen = Pens[pen]?Pens[pen]:{startdate:Date.now()}\r\n                if (Pen.enddate) delete Pen.enddate\r\n                BatchPens[pen] = Pen\r\n                updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n              })\r\n            }\r\n\r\n            if (SamePens && SamePens.length > 0) {\r\n              SamePens.forEach(pen => {\r\n                BatchPens[pen] = Pens[pen]\r\n              })\r\n            }\r\n          }\r\n          Batch.pens = BatchPens\r\n\r\n          if (Batch.state && Batch.state === \"Closed\") {\r\n            fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.GRAPH}).then((curve) => {\r\n              var CurveId = curve.data[BatchId].gcurve\r\n              fetchGraphData({FarmId: FarmId}).then((curve) => {\r\n                Batch.gcurve = curve.data[CurveId]\r\n                Batch.closed = {comments: [], weighings: []}\r\n                \r\n                for (let i = 0, p = Promise.resolve(); i <= Object.keys(Pens).length; i++) {\r\n                  p = p.then(_ => new Promise(_resolve => {\r\n                    setTimeout(function () {\r\n                      if (i !== Object.keys(Pens).length) {\r\n                        var PenId = Object.keys(Pens)[i]\r\n                        Batch.pens[PenId] = Pens[PenId]\r\n                        fetchPens({FarmId: FarmId, PenId:PenId}).then((pendata) => {\r\n                          var count = 0\r\n                          if (pendata.data[PenId] && pendata.data[PenId].datas && pendata.data[PenId].datas.count)count=pendata.data[PenId].datas.count\r\n                          Batch.pens[PenId].count = count\r\n                        })\r\n                        if (!Batch.pens[PenId].enddate) {\r\n                          Batch.pens[PenId].enddate = Date.now()\r\n                        }\r\n                        updatePen({FarmId:FarmId, PenId:PenId, Pen:{datas:{batch:\"\", count:0}}})\r\n\r\n                        fetchComments({FarmId: FarmId, PenId: PenId}).then((comments) => {\r\n                          Batch.closed.comments[PenId] = comments.data[PenId]\r\n                          database().ref(\"farms_data/\" + FarmId + \"/datas/comments/\" + PenId).remove()\r\n                          \r\n                          fetchWeights({FarmId: FarmId, PenId: PenId}).then((weights) => {\r\n                            Batch.closed.weighings[PenId] = weights.data[PenId]\r\n                            database().ref(\"farms_data/\" + FarmId + \"/weighings/\" + PenId).remove()\r\n                            _resolve();\r\n                          })\r\n                        })\r\n                      }\r\n                      else {\r\n                        database().ref(ref).update({\r\n                          ...Batch\r\n                        }).then(()=>{\r\n                          database().ref(ref + \"/closed\").set(\r\n                            Batch.closed\r\n                          ).then(() => {\r\n                            fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                              resolve(data)\r\n                            })\r\n                          }).catch(error => {\r\n                            if (error.code === 'database/permission-denied') {\r\n                              console.log(\"Batch update was permission denied. \");\r\n                            }else if (error.code) {\r\n                              console.log(\"Batch update Error: \", error);\r\n                            }\r\n                            console.log(error)\r\n                            resolve({error:\"An error occurred\"})\r\n                          })\r\n                        })\r\n                      }\r\n                    })\r\n                  }));\r\n                }\r\n              })\r\n            })\r\n          } else {\r\n            database().ref(ref).update({\r\n              ...Batch,\r\n            }).then(() => {\r\n              fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                resolve(data)\r\n              })\r\n            }).catch(error => {\r\n              if (error.code === 'database/permission-denied') {\r\n                console.log(\"Batch update was permission denied. \");\r\n              }else if (error.code) {\r\n                console.log(\"Batch update Error: \", error);\r\n              }\r\n              console.log(error)\r\n              resolve({error:\"An error occurred\"})\r\n            })\r\n          }\r\n        })\r\n      }else {\r\n        console.log(\"Update Batchs Error\");\r\n        resolve(null)\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Weights\r\nfunction fetchWeights({FarmId, PenId, SectionId, limitStart = 0, limitTo = 9999, DataTime, MemSections}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/weighings\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (PenId) {\r\n            console.log(\"Weight fetch called, getting Pen\")\r\n            ref += \"/\" + PenId\r\n            database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n              var weighing = {[snapshot.key]:{}}\r\n              snapshot.forEach(c => {\r\n                weighing[snapshot.key][c.key] = c.val()\r\n              })\r\n              resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:weighing})\r\n            })\r\n          } else {\r\n            console.log(\"Weight fetch called, getting Sections\")\r\n            database().ref(ref + \"/update_time\").once('value').then((_weighingTime) => {\r\n              //TODO: Section fetch cast :: in mem check ??\r\n              var Weighings_Time = _weighingTime.val()\r\n              fetchSections({FarmId, SectionId, DataTime: MemSections?MemSections.update_time:null}).then((sections) => {\r\n                var itemsProcessed = 0;\r\n                var length = 0;\r\n                var newWeights = {}\r\n                var Sections = sections?sections.data:MemSections\r\n                Object.keys(Sections).forEach(section => {\r\n                  if (Sections[section] && Sections[section].pens) {\r\n                    length += Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').length\r\n                    Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').forEach(pen => {\r\n                      fetchWeights({FarmId:FarmId, PenId:pen, limitStart:0, limitTo:limitTo}).then((weights) => {\r\n                        itemsProcessed++\r\n                        newWeights = {...newWeights, ...weights.data}\r\n                        if (itemsProcessed === length) {\r\n                          newWeights.update_time = Weighings_Time\r\n                          resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                        }\r\n                      }).catch(error => {\r\n                        console.log(error)\r\n                        resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                      })\r\n                    })\r\n                  }\r\n                })\r\n              }).catch(error => {\r\n                console.log(error)\r\n              })\r\n            })\r\n          }\r\n\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createWeight({FarmId, PenId, Weight, Quantity, Date}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const weightRef = database().ref(ref).push()\r\n        const weightId = weightRef.key\r\n        weightRef.set({\r\n          time: Date,\r\n          weight: Weight,\r\n          count: Quantity,\r\n        }).then(() => {\r\n          fetchWeights({FarmId:FarmId, PenId:PenId, DataTime: \"SET\"}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Weight Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Comments\r\nfunction fetchComments({FarmId, PenId, limitStart = 0, limitTo = 5}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        ref += \"/\" + PenId\r\n        database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n          var comment = {[snapshot.key]:{}}\r\n          snapshot.forEach(c => {\r\n            comment[snapshot.key][c.key] = c.val()\r\n          }) \r\n          resolve({type:Actions.UPDATE, path:DataRefs.COMMENTS, data:comment})\r\n        })\r\n      } else {\r\n        //TODO: ...Comment other than PenId\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createComment({FarmId, PenId, Action, Data, Quantity, Weight}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const commentRef = database().ref(ref).push()\r\n        const commentId = commentRef.key\r\n\r\n        commentRef.set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          user: auth().currentUser.email,\r\n          action: Action,\r\n          quantity: Quantity,\r\n          weight: Weight,\r\n          data: Data,\r\n        }).then(() => {\r\n          fetchComments({FarmId:FarmId, PenId:PenId}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Comment Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    } else {\r\n      //TODO: ...Comment other than PenId\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Graphs\r\nfunction fetchGraphData({FarmId, GraphId, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    ref = ref + \"/\" + GraphId;\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/graph\", DataTime).then((DoFetch) => {\r\n        console.log(\"Doing Graphs fetch\", DoFetch, \"Always..\")\r\n        //if (DoFetch){\r\n\r\n          database().ref(ref).once('value').then((graph) => {\r\n            var Graphs = null\r\n            var GraphVal = graph.val()\r\n            if (GraphVal) {\r\n              if (GraphId) {\r\n                var newGraph = {[graph.key]: GraphVal}\r\n                Graphs = {...Graphs, ...newGraph}\r\n              }else {\r\n                Graphs = {...Graphs, ...GraphVal}\r\n              }\r\n            }\r\n            if (!GraphId) {\r\n              database().ref(\"farms_data/Agrisys/graph\").once('value').then((Agraph) => {\r\n                var AgraphVal = Agraph.val();\r\n                if (AgraphVal) {\r\n                  Graphs = {...AgraphVal, ...Graphs}\r\n                }\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              }).catch(error => {\r\n                console.log(\"Get Agrisys graph Error: \", error);\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              })\r\n            }else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n            }\r\n          }).catch(error => {\r\n            console.log(\"Get farm graph Error: \", error);\r\n            resolve(null)\r\n          })\r\n\r\n        /*}\r\n        else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:{}})\r\n        }*/\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateGraphData({FarmId, Graph}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    if (Graph.name) {\r\n      ref += \"/\" + Graph.name + \"/\"\r\n      return new Promise((resolve, reject) => {\r\n        database().ref(ref).update({\r\n          data: Graph.data,\r\n          periode: Graph.periode\r\n        }).then(() => {\r\n          fetchGraphData({FarmId: FarmId, GraphId: Graph.name}).then((_Graph)=>{\r\n            resolve(_Graph)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Graph Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n//#endregion\r\n\r\nexport const firebaseService = {\r\n  //Firebase\r\n  requestUserPermission,\r\n  requestFirebaseToken,\r\n  wrappedAlert,\r\n\r\n  //Firebase Auth (could be moved to fetch / action)\r\n  createFirebaseUserWithemailandpassword,\r\n  signinWithemailandpassword,\r\n  sendResetPassword,\r\n  logoutUser,\r\n  refreshUser,\r\n\r\n  //Commnads\r\n  actionStarting,\r\n}\r\n","import { Platform, Alert } from 'react-native'\r\nimport {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\nimport { firebaseService } from '../../Services/FirebaseService'\r\n\r\nvar auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require( '@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase;\r\n  \r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n  \r\n  auth = _firebase.auth;\r\n  messaging = _firebase.messaging;\r\n  database = _firebase.database;\r\n  //#endregion\r\n}\r\n\r\nimport { UserStates, DataRefs, Actions } from '../../Stores/Firebase/Selectors'\r\n\r\nexport function* firebaseStartup() {\r\n  //Check and setup Firebase and permissions\r\n  yield put(FirebaseActions.setFirebaseError(null))\r\n\r\n  /*console.log(\"test\")\r\n  if (Platform.OS !== 'ios' && Platform.OS !== 'android') {\r\n    console.log(\"Starting\")\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }*/\r\n\r\n  const permitError = yield call(firebaseService.requestUserPermission)\r\n  if (permitError) {\r\n    yield put(FirebaseActions.fetchFailure(permitError))\r\n  }else {\r\n    //yield put(FirebaseActions.firebaseIsLoading(true))\r\n    yield fork(handleAuthState)\r\n    yield fork(handleActions)\r\n\r\n    if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n      yield fork(onMessageHandler)\r\n      yield fork(onBackgroundMessageHandler)\r\n    }\r\n    else if (messaging.isSupported()) {\r\n      yield fork(onMessageHandler)\r\n      yield fork(onBackgroundMessageHandler)\r\n    }\r\n\r\n    //var FirebaseToken = yield call(firebaseService.requestFirebaseToken);\r\n    //console.log('Firebase Token: ', FirebaseToken);\r\n    \r\n    //yield fork(testmessage,FirebaseToken)\r\n  }\r\n\r\n  console.log('Firebase Startup : Done');\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    console.log('Firebase will disable yellow box debug')\r\n    console.disableYellowBox = true;\r\n  }\r\n}\r\n\r\n//Somehow works ??? but should only work at server hosting XMPP, try firebase functions insted if nessasary\r\n//TODO: check this more... SendNotification to device\r\n//it seams to work ... but slow ???\r\nfunction* testmessage(token) {\r\n  /*messaging().sendMessage({\r\n      to: '11111111111111@fcm.googleapis.com',\r\n      messageId: 'test1',\r\n      messageType: 'test2',\r\n      notification: {\r\n          title: 'Foo',\r\n          body: 'Bar',\r\n      }\r\n    });*/\r\n    //to: 'worker@agrisys.dk',\r\n  var message = {\r\n    to: token,\r\n    messageId: 'test1',\r\n    messageType: 'test2',\r\n    notification: {\r\n        title: 'Foo',\r\n        body: 'Bar',\r\n    }\r\n  }\r\n  messaging().sendMessage(message).then(msg => {\r\n    console.log(msg)\r\n  })\r\n}\r\n\r\nexport function* handleAuthState() {\r\n  const authChannel = yield eventChannel((emit) => {\r\n    const subscription = auth().onAuthStateChanged((user) => {\r\n      if (user == null){\r\n        emit(\"NONE\")\r\n      }else {\r\n        emit(user)\r\n      }\r\n    })\r\n    return () => {\r\n      subscription()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newAuth = yield take(authChannel)\r\n      var firebaseUser = newAuth === \"NONE\"?null:newAuth;\r\n      if (firebaseUser) {\r\n        const userData = yield call(firebaseService.actionStarting, DataRefs.USERSDATA, Actions.FETCH, {UserId: firebaseUser.uid})\r\n        if (userData.data) {\r\n          firebaseUser.farms = userData.data.data.farms\r\n          firebaseUser.state = userData.data.data.state\r\n          yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: firebaseUser}))\r\n          //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: userData.data}))    //TODO: mabye moved to firebaseUser..\r\n        }\r\n      } else {\r\n        yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: {}}))\r\n        //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: {}}))    //TODO: mabye moved to firebaseUser..\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      authChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* handleActions() {\r\n  const channel = yield actionChannel([\r\n    'ACTION_STARTING',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action: ACTION_STARTING = yield take(channel)\r\n\r\n    //console.log(action.ref, action.action, action.params)\r\n\r\n    if (Object.values(Actions).includes(action.action)) {\r\n      if (Object.values(DataRefs).includes(action.ref)) {\r\n        const FirebaseUser = yield select((state) => state.firebase.firebaseUser);\r\n        if (action.action != Actions.SIGN && FirebaseUser && FirebaseUser.farms) {\r\n          if (!action.params) action.params = {}\r\n          if (!action.params.FarmId) action.params.FarmId = [Object.keys(FirebaseUser.farms)[0]]\r\n        }\r\n\r\n        const NewData = yield call(firebaseService.actionStarting, action.ref, action.action, action.params)\r\n        if (NewData && (NewData.error || NewData.viewError)) {\r\n          yield put(FirebaseActions.fetchFailure(NewData.error))\r\n          yield put(FirebaseActions.setViewError(NewData.viewError))\r\n        } else {\r\n          //console.log(\"resCall: \", NewData)\r\n          if (NewData && NewData.hasOwnProperty(\"type\") && NewData.hasOwnProperty(\"path\") && NewData.hasOwnProperty(\"data\")) {\r\n            yield put(FirebaseActions.dataFetchSuccess(NewData))\r\n          }\r\n          else {\r\n            //console.log(\"Old Path: \", action.ref, action.action, params, NewData)\r\n            yield put(FirebaseActions.fetchSuccess({localDataStore:NewData}))\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Foreground State\r\nexport function* onMessageHandler() {\r\n  const onMessageChannel = yield eventChannel((emit) => {\r\n    const messageListener = messaging().onMessage((remoteMessage) => {\r\n      //console.log(\"message ? \", remoteMessage);\r\n      emit(remoteMessage);\r\n    });\r\n    return () => {\r\n      messageListener();\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    for (;;) {\r\n      const remoteMessage = yield take(onMessageChannel)\r\n      console.log(\"New Firebase message: \", remoteMessage)\r\n      if (remoteMessage.notification && remoteMessage.notification.title && remoteMessage.notification.body){\r\n        yield call(firebaseService.wrappedAlert, remoteMessage.notification.title, remoteMessage.notification.body, \"Ok\", false)\r\n      }else {\r\n        console.log(\"New Firebase data message: \", remoteMessage)\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      onMessageChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Background & Quit state\r\nexport function* onBackgroundMessageHandler() {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    // Assume a message-notification contains a \"type\" property in the data payload of the screen to open\r\n    messaging().onNotificationOpenedApp(remoteMessage => {\r\n      console.log(\r\n        'Notification caused app to open from background state:',\r\n        remoteMessage.notification,\r\n      );\r\n      //NavigationService.navigate(remoteMessage.data.type); // this is not view..\r\n    });\r\n\r\n    const onMessageChannel = yield eventChannel((emit) => {\r\n      messaging().setBackgroundMessageHandler((remoteMessage) => {\r\n        emit(remoteMessage);\r\n      });\r\n      return () => {\r\n        //\r\n      };\r\n    }, buffers.expanding(1));\r\n\r\n    try {\r\n      for (;;) {\r\n        const remoteMessage = yield take(onMessageChannel)\r\n        console.log(\"New background Firebase message: \", remoteMessage)\r\n      }\r\n    } finally {\r\n      if (yield cancelled()) {\r\n        onMessageChannel.close()\r\n      }\r\n    }\r\n  }\r\n}","import { takeLatest, all, take } from 'redux-saga/effects'\r\n\r\nimport { StartupTypes } from '../Stores/Startup/Actions'\r\nimport { ExampleTypes } from '../Stores/Example/Actions'\r\nimport { DeviceTypes } from '../Stores/Device/Actions'\r\nimport { FirebaseTypes } from '../Stores/Firebase/Actions'\r\n\r\nimport * as StartupSaga from './StartupSaga'\r\nimport * as ExampleSaga from './Example/ExampleSaga'\r\nimport * as DeviceSaga from './Device/DeviceSaga'\r\nimport * as FirebaseSaga from './Firebase/FirebaseSaga'\r\n\r\nexport default function* root(sagaArgs) {\r\n  yield all([\r\n    /**\r\n     * @see https://redux-saga.js.org/docs/basics/UsingSagaHelpers.html\r\n     */\r\n    // Run the startup saga when the application starts\r\n    takeLatest(StartupTypes.STARTUP, StartupSaga.startup), //Initer\r\n    \r\n\r\n    //Example\r\n    takeLatest(ExampleTypes.FETCH_USER, ExampleSaga.fetchUser), // Call `fetchUser()` when a `FETCH_USER` action is triggered\r\n    \r\n    //Device Main Saga\r\n    takeLatest(DeviceTypes.DEVICE_STARTUP, DeviceSaga.deviceStartup), //Initer\r\n\r\n    takeLatest(DeviceTypes.CONNECT_DEVICE, DeviceSaga.connectDevice),\r\n    takeLatest(DeviceTypes.DISCONNECT_DEVICE, DeviceSaga.disconnectDevice),\r\n    takeLatest(DeviceTypes.READ_DEVICE_DATA, DeviceSaga.readDeviceData),\r\n\r\n    takeLatest(DeviceTypes.FETCH_DEVICE, DeviceSaga.fetchDevice, sagaArgs),\r\n\r\n    //BLE Saga\r\n    takeLatest(DeviceTypes.BLE_STARTUP, DeviceSaga.BLE.bleStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLE_SCAN, DeviceSaga.BLE.startBleScan),\r\n    takeLatest(DeviceTypes.STOP_BLE_SCAN, DeviceSaga.BLE.stopBleScan),\r\n    takeLatest(DeviceTypes.READ_BLE_DEVICE_DATA, DeviceSaga.BLE.readBleDeviceData, sagaArgs),\r\n    \r\n    //Android BlueThooth Saga\r\n    takeLatest(DeviceTypes.BLUETOOTH_STARTUP, DeviceSaga.BlueTooth.bluetoothStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.startBluetoothScan),\r\n    takeLatest(DeviceTypes.STOP_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.stopBluetoothScan),\r\n    takeLatest(DeviceTypes.BLUETOOTH_SCAN_ABLE, DeviceSaga.BlueTooth.bluetoothScanAble, sagaArgs),\r\n    takeLatest(DeviceTypes.READ_BLUE_DEVICE_DATA, DeviceSaga.BlueTooth.readBlueDeviceData, sagaArgs),\r\n    \r\n\r\n    //Firebase Saga\r\n    takeLatest(FirebaseTypes.FIREBASE_STARTUP, FirebaseSaga.firebaseStartup), //Initer\r\n  ])\r\n}\r\n","/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n}\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\nimport { createReducer } from 'reduxsauce'\r\nimport { ExampleTypes } from './Actions'\r\n\r\nexport const fetchUserLoading = (state) => ({\r\n  ...state,\r\n  userIsLoading: true,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserSuccess = (state, { user }) => ({\r\n  ...state,\r\n  user: user,\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: errorMessage,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const reducer = createReducer(INITIAL_STATE, {\r\n  [ExampleTypes.FETCH_USER_LOADING]: fetchUserLoading,\r\n  [ExampleTypes.FETCH_USER_SUCCESS]: fetchUserSuccess,\r\n  [ExampleTypes.FETCH_USER_FAILURE]: fetchUserFailure,\r\n})\r\n","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n  bleState: State.PoweredOff, // status of the BLE manger\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from './Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n//BLE Saga's\r\nimport { INITIAL_STATE as BLE_INITIAL_STATE } from './BLE/InitialState'\r\n//BlueTooth Saga's\r\nimport { INITIAL_STATE as BLUETOOTH_INITIAL_STATE} from './BlueTooth/InitialState'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Device Main Info\r\n  deviceIsLoading: false,\r\n  deviceErrorMessage: null,\r\n\r\n  //Device list Info... (only one ???)\r\n  scannerState: ScannerState.IDLE, // status of BLE scanner\r\n  DeviceList: [], //An Array of Discovered Devices\r\n\r\n  //Connection info...\r\n  connectedDevice: {}, // the current connected device element\r\n  connectionState: ConnectionState.DISCONNECTED, // the status of the current device connection\r\n  connectionMethode: ConnectionMethode.NONE,  //the current connected Methode\r\n\r\n  deviceData: {}, // Something\r\n\r\n  //BLE specefic\r\n  ...BLE_INITIAL_STATE,\r\n  //BlueTooth specefic\r\n  ...BLUETOOTH_INITIAL_STATE,\r\n}","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BleTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const bleStateUpdated = (state, {bleState}) => {\r\n  return({\r\n    ...state,\r\n    bleState: bleState,\r\n  })\r\n}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n  [BleTypes.BLE_STATE_UPDATED]: bleStateUpdated,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BluetoothTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from './Selectors'\r\nimport { DeviceTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n//BLE Saga's\r\nimport * as BLEReducers from './BLE/Reducers'\r\n//BlueTooth Saga's\r\nimport * as BluetoothReducers from './BlueTooth/Reducers'\r\n\r\nexport const setDeviceError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  deviceErrorMessage: errorMessage,\r\n})\r\n\r\nexport const scannerStateUpdated = (state, {scannerState}) => {\r\n  return({\r\n    ...state,\r\n    scannerState: scannerState,\r\n  })\r\n}\r\n\r\nexport const addDevice = (state, {device}) => {\r\n  if (state.DeviceList.some(Device => Device.id === device.id )) { //&& device.isConnectable)){\r\n    return({...state});\r\n  } else {\r\n    //device._manager = null; // Type.script Stringify ... not allowing function callback (fix see CreateStore.js)\r\n    var NewList = [...state.DeviceList];\r\n    NewList.push(device);\r\n\r\n    return({\r\n      ...state,\r\n      DeviceList: NewList,\r\n    });\r\n  }\r\n}\r\n\r\nexport const removeDevice = (state, {device}) => {\r\n  var NewList = [...state.DeviceList];\r\n  for( var i = 0; i < NewList.length; i++){ \r\n    if ( NewList[i] === device) {\r\n      NewList.splice(i, 1); \r\n    }\r\n  }\r\n\r\n  return ({\r\n    ...state,\r\n    DeviceList: NewList,\r\n  });\r\n}\r\n\r\nexport const clearDevices = (state) => ({\r\n  ...state,\r\n  DeviceList: [],\r\n  deviceData: {}\r\n})\r\n\r\nexport const connectedDeviceUpdated = (state, {connectedDevice}) => {\r\n  if (!connectedDevice) {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice,\r\n      //deviceData: {}\r\n    })\r\n  } else {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice\r\n    })\r\n  }\r\n}\r\n\r\n// Connections *******************************************\r\nexport const connectionStateUpdated = (state, {connectionState}) => ({\r\n  ...state,\r\n  connectionState: connectionState\r\n})\r\nexport const connectionMethodeUpdated = (state, {connectionMethode}) => ({\r\n  ...state,\r\n  connectionMethode: connectionMethode\r\n})\r\n\r\nexport const setDeviceData = (state, {data}) => ({\r\n  ...state,\r\n  deviceData: data\r\n})\r\nexport const updateDeviceData = (state, {data}) => {\r\n  const newData = {...state.deviceData, ...data}\r\n  return({\r\n  ...state,\r\n  deviceData: newData\r\n})}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [DeviceTypes.SET_DEVICE_ERROR]: setDeviceError,\r\n  \r\n  //Managers...\r\n  [DeviceTypes.SCANNER_STATE_UPDATED]: scannerStateUpdated,\r\n\r\n  [DeviceTypes.ADD_DEVICE]: addDevice,\r\n  [DeviceTypes.REMOVE_DEVICE]: removeDevice,\r\n  [DeviceTypes.CLEAR_DEVICES]: clearDevices,\r\n\r\n  [DeviceTypes.CONNECTED_DEVICE_UPDATED]: connectedDeviceUpdated,\r\n  \r\n  //Connection...\r\n  [DeviceTypes.CONNECTION_STATE_UPDATED]: connectionStateUpdated,\r\n  [DeviceTypes.CONNECTION_METHODE_UPDATED]: connectionMethodeUpdated,\r\n\r\n  //Data...\r\n  [DeviceTypes.SET_DEVICE_DATA]: setDeviceData,\r\n  [DeviceTypes.UPDATE_DEVICE_DATA]: updateDeviceData,\r\n\r\n  //BLE Saga\r\n  ...BLEReducers.HANDLERS,\r\n\r\n  //Android BlueTooth Saga\r\n  ...BluetoothReducers.HANDLERS,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\nimport { append } from 'funcadelic';\r\n\r\nimport { Actions, DataRefs } from './Selectors'\r\nimport { FirebaseTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const firebaseIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  firebaseIsLoading: loadingstate,\r\n})\r\n\r\nexport const setFirebaseError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseErrorMessage: errorMessage,\r\n})\r\n\r\nexport const setViewError = (state, { errorMessage }) => {\r\n  return({\r\n    ...state,\r\n    viewError: errorMessage,\r\n  })\r\n}\r\n\r\nexport const viewIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  viewIsLoading: loadingstate,\r\n})\r\n\r\nexport const setCurrentData = (state, {data}) => {\r\n  return({\r\n    ...state,\r\n    currentData: data\r\n  })\r\n}\r\n\r\nfunction IDGenerate(){\r\n  return Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\nexport const actionStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nexport const fetchStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nfunction mergeDeep(target, source) {\r\n  const isObject = (obj) => obj && typeof obj === 'object';\r\n\r\n  if (!isObject(target) || !isObject(source)) {\r\n    return source;\r\n  }\r\n\r\n  Object.keys(source).forEach(key => {\r\n    const targetValue = target[key];\r\n    const sourceValue = source[key];\r\n\r\n    if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\r\n      //target[key] = targetValue.concat(sourceValue);  //Mercing value of arrays would creates doubles.. like curve data..\r\n    } else if (isObject(targetValue) && isObject(sourceValue)) {\r\n      target[key] = mergeDeep(Object.assign({}, targetValue), sourceValue);\r\n    } else {\r\n      target[key] = sourceValue;\r\n    }\r\n  });\r\n\r\n  return target;\r\n}\r\n\r\nexport const dataFetchSuccess = (state, { params }) => {\r\n  const {type, path, data} = params\r\n  var NewDataStore = state.localDataStore;\r\n  var NewFirebaseUser = {...state.firebaseUser};\r\n  switch(type) {\r\n    case Actions.UPDATE:\r\n    case Actions.ADD:\r\n      var newData = {...data}\r\n      if (path === DataRefs.FIREBASEUSER) {\r\n        if (data && data.data) newData = {...data.data}\r\n        if (data && data._user) {\r\n          Object.keys(data._user).forEach(element => {\r\n            newData[element] = data._user[element]\r\n          })\r\n          delete newData._user\r\n          delete newData._auth\r\n        }\r\n        if (newData && Object.keys(newData).length > 0) {\r\n          var Values = [\"displayName\", \"name\", \"lastN\", \"email\", \"emailVerified\", \"address\", \"country\", \"farms\", \"isAnonymous\", \"phoneNumber\", \"photoURL\", \"refreshToken\", \"state\", \"uid\"]\r\n          Object.keys(newData).forEach(element => {\r\n            for (var index = 0; index < Values.length; index++) {\r\n              if (Values[index] === element) {\r\n                NewFirebaseUser[element] = newData[element]\r\n                break;\r\n              }\r\n            }\r\n          });\r\n        }else {\r\n          NewFirebaseUser = newData;\r\n        }\r\n      }\r\n      if (!data) break;\r\n      switch(path){\r\n        case DataRefs.FIREBASEUSER:\r\n          //Done above\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          Object.keys(newData).forEach(element => {\r\n            if (!NewDataStore.userData) NewDataStore.userData = {};\r\n            NewDataStore.userData[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.users) NewDataStore.users = {};\r\n          if (data.data) newData = data.data\r\n          if (newData.users) newData = newData.users\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.users[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.FARMS:\r\n          if (!NewDataStore.farms) NewDataStore.farms = {};\r\n          if (data.farms) newData = data.farms\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.farms[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.BATCHS:\r\n          if (!NewDataStore.batchs) NewDataStore.batchs = {};\r\n          if (data.batchs) newData = data.batchs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.batchs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.SECTIONS:\r\n          if (!NewDataStore.sections) NewDataStore.sections = {};\r\n          if (data.sections) newData = data.sections\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.sections[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PENS:\r\n          if (!NewDataStore.pens) NewDataStore.pens = {};\r\n          if (data.pens) newData = data.pens\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pens[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PIGS:\r\n          if (!NewDataStore.pigs) NewDataStore.pigs = {};\r\n          if (data.pigs) newData = data.pigs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pigs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.COMMENTS:\r\n          if (!NewDataStore.comments) NewDataStore.comments = {};\r\n          if (data.comments) newData = data.comments\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.comments[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.GRAPH:\r\n          if (!NewDataStore.graphs) NewDataStore.graphs = {};\r\n          if (data.graphs) newData = data.graphs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.graphs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.WEIGHING:\r\n          if (!NewDataStore.weighings) NewDataStore.weighings = {};\r\n          if (data.weighings) newData = data.weighings\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.weighings[element] = newData[element]\r\n          });\r\n          break;\r\n      }\r\n      //console.log(path, data)\r\n      break;\r\n    case Actions.CLEAR:\r\n      switch(path){\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.userData) NewDataStore.userData = {};\r\n          NewDataStore.userData.action = \"CLEAR\";\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          console.log(\"CLEAR\")\r\n          if (NewDataStore.batchs) NewDataStore.batchs = {}\r\n          if (NewDataStore.sections) NewDataStore.sections = {}\r\n          if (NewDataStore.pens) NewDataStore.pens = {}\r\n          if (NewDataStore.pigs) NewDataStore.pigs = {}\r\n          if (NewDataStore.graphs) NewDataStore.graphs = {}\r\n          if (NewDataStore.weighings) NewDataStore.weighings = {}\r\n          if (NewDataStore.userData && NewDataStore.userData.action) {\r\n            NewDataStore.userData.action = {}\r\n            //NewDataStore.userData = {}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n    default:\r\n      console.log(\"DataFetch Not created / default\")\r\n      break;\r\n  }\r\n  return({\r\n    ...state,\r\n    firebaseUser: NewFirebaseUser,\r\n    localDataStore: NewDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchSuccess = (state, { data }) => {\r\n  var newlocalDataStore = {...state.localDataStore}\r\n  var newState = {...state}\r\n\r\n  if (data) {\r\n    let {localDataStore, ..._newState} = data;\r\n\r\n    if (localDataStore) {\r\n      if (Object.keys(localDataStore).length !== 0) {\r\n        newlocalDataStore = mergeDeep(localDataStore, newlocalDataStore)\r\n      }\r\n      else {\r\n        newlocalDataStore = {...localDataStore}\r\n      }\r\n    }\r\n    newState = append(state,_newState)\r\n  }\r\n  return({\r\n    ...newState,\r\n    localDataStore: newlocalDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseIsLoading: false,\r\n  firebaseErrorMessage: errorMessage,\r\n  viewIsLoading: false,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [FirebaseTypes.FIREBASE_IS_LOADING]: firebaseIsLoading,\r\n  [FirebaseTypes.SET_FIREBASE_ERROR]: setFirebaseError,\r\n\r\n  [FirebaseTypes.SET_VIEW_ERROR]: setViewError,\r\n  [FirebaseTypes.VIEW_IS_LOADING]: viewIsLoading,\r\n\r\n  [FirebaseTypes.SET_CURRENT_DATA]: setCurrentData,\r\n\r\n  [FirebaseTypes.ACTION_STARTING]: actionStarting,\r\n  [FirebaseTypes.FETCH_STARTING]: fetchStarting,\r\n  [FirebaseTypes.DATA_FETCH_SUCCESS]: dataFetchSuccess,\r\n  [FirebaseTypes.FETCH_SUCCESS]: fetchSuccess,\r\n  [FirebaseTypes.FETCH_FAILURE]: fetchFailure,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","import { UserStates } from './Selectors'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  firebaseIsLoading: false,     //SystemLoading\r\n  firebaseErrorMessage: null,   //SystemError\r\n\r\n  firebaseUser: null,           //UserData\r\n\r\n  localDataStore: {},           //Full DataStore\r\n  currentData: null,            //State DataStore\r\n\r\n  viewIsLoading: false,         //View / state - waiting for action\r\n  viewError: null,              //View / state - error display\r\n}","/**\r\n * This file contains the application's colors.\r\n *\r\n * Define color here instead of duplicating them throughout the components.\r\n * That allows to change them more easily later on.\r\n */\r\n\r\nexport default {\r\n  transparent: 'rgba(0,0,0,0)',\r\n  white: '#ffffff',\r\n  gray: '#a6a6a6',\r\n\r\n  text: '#4a4a49',\r\n  secountText: '#ffffff',\r\n\r\n  primary: '#a3b9cf',\r\n\r\n  success: '#03a489',\r\n  error: '#dc3545',\r\n  overest: '#4cafea',\r\n  pigpink: '#FFAA95',\r\n\r\n  input: '#86939e',\r\n\r\n  AgriGreen: '#03a489',\r\n  AgriDarkblue: '#4463ab',\r\n  AgriLightblue: '#a3b9cf',\r\n  AgriDark: '#4a4a49',\r\n}\r\n","import { StyleSheet } from 'react-native'\r\n\r\nconst size = {\r\n  h1: 38,\r\n  h2: 34,\r\n  h3: 30,\r\n  input: 18,\r\n  regular: 17,\r\n  medium: 14,\r\n  small: 12,\r\n}\r\n\r\nexport default {\r\n  h1: {\r\n    fontSize: size.h1,\r\n  },\r\n  h2: {\r\n    fontSize: size.h2,\r\n  },\r\n  h3: {\r\n    fontSize: size.h3,\r\n  },\r\n  normal: {\r\n    fontSize: size.regular,\r\n  },\r\n}","/**\r\n * This file contains metric values that are global to the application.\r\n */\r\n\r\n// Examples of metrics you can define:\r\nexport const tiny = 5\r\nexport const small = tiny * 2 // 10\r\nexport const normal = tiny * 3 // 15\r\nexport const medium = normal * 2 // 30\r\n\r\nexport default {\r\n  tiny,\r\n  small,\r\n  normal,\r\n  medium,\r\n  \r\n  tinyBottomMargin: {\r\n    marginBottom: tiny,\r\n  },\r\n  smallBottomMargin: {\r\n    marginBottom: small,\r\n  },\r\n  bottomMargin: {\r\n    marginBottom: normal,\r\n  },\r\n  mediumBottomMargin: {\r\n    marginBottom: medium,\r\n  },\r\n\r\n  tinyVerticalMargin: {\r\n    marginVertical: tiny,\r\n  },\r\n  smallVerticalMargin: {\r\n    marginVertical: small,\r\n  },\r\n  verticalMargin: {\r\n    marginVertical: normal,\r\n  },\r\n  mediumVerticalMargin: {\r\n    marginVertical: medium,\r\n  },\r\n\r\n  tinyHorizontalMargin: {\r\n    marginHorizontal: tiny,\r\n  },\r\n  smallHorizontalMargin: {\r\n    marginHorizontal: small,\r\n  },\r\n  horizontalMargin: {\r\n    marginHorizontal: normal,\r\n  },\r\n  mediumHorizontalMargin: {\r\n    marginHorizontal: medium,\r\n  },\r\n\r\n  tinyHorizontalPadding: {\r\n    paddingHorizontal: tiny,\r\n  },\r\n  smallHorizontalPadding: {\r\n    paddingHorizontal: small,\r\n  },\r\n  horizontalPadding: {\r\n    paddingHorizontal: normal,\r\n  },\r\n  mediumHorizontalPadding: {\r\n    paddingHorizontal: medium,\r\n  },\r\n\r\n  tinyVerticalPadding: {\r\n    paddingVertical: tiny,\r\n  },\r\n  smallVerticalPadding: {\r\n    paddingVertical: small,\r\n  },\r\n  verticalPadding: {\r\n    paddingVertical: normal,\r\n  },\r\n  mediumVerticalPadding: {\r\n    paddingVertical: medium,\r\n  },\r\n}\r\n","/**\r\n * Images should be stored in the `App/Images` directory and referenced using variables defined here.\r\n */\r\n\r\nexport default {\r\n  Home: require('../Assets/Images/Home.png'),\r\n\r\n  DashBoard: require('../Assets/Images/Dashboard.png'),\r\n  System: require('../Assets/Images/System.png'),\r\n  Curves: require('../Assets/Images/Feed-Curves.png'),\r\n  GCurves: require('../Assets/Images/Growth-curve.png'),\r\n\r\n  User: require('../Assets/Images/User.png'),\r\n  Sow: require('../Assets/Images/Sow.png'),\r\n  Section: require('../Assets/Images/Section.png'),\r\n  Pens: require('../Assets/Images/Area_Colour.png'),\r\n  AutoPig: require('../Assets/Images/AutoPig.png'),\r\n  Feed: require('../Assets/Images/Feed-Components.png'),\r\n\r\n  Haxa_globe: require('../Assets/Images/Hexagon-globe.png'),\r\n  Hexa_icon: require('../Assets/Images/Hexa-icon.png'),\r\n  Logo: require('../Assets/Images/Logo.png'),\r\n\r\n  logo: require('../Assets/Images/TOM.png'),\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  //********************** col sets */\r\n  column: {\r\n    flexDirection: 'column',\r\n  },\r\n  colMain: {\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  colCenter: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  colCross: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  columnReverse: {\r\n    flexDirection: 'column-reverse',\r\n  },\r\n\r\n  //********************** Row sets */\r\n  row: {\r\n    flexDirection: 'row',\r\n  },\r\n  rowMain: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCenter: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCross: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  rowReverse: {\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Cross sets */\r\n  center: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  crossCenter: {\r\n    alignItems: 'center',\r\n  },\r\n  crossEnd: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  crossStart: {\r\n    alignItems: 'flex-start',\r\n  },\r\n  crossStretch: {\r\n    alignItems: 'stretch',\r\n  },\r\n\r\n  //********************** Fill sets */\r\n  fill: {\r\n    flex: 1,\r\n  },\r\n  fillCenter: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillCol: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n  },\r\n  fillColCenter: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColCross: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  fillColMain: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColReverse: {\r\n    flex: 1,\r\n    flexDirection: 'column-reverse',\r\n  },\r\n  fillRow: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n  },\r\n  fillRowCenter: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowCross: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  fillRowMain: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowReverse: {\r\n    flex: 1,\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Size sets */\r\n  fullSize: {\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  halvWidth: {\r\n    width: '50%',\r\n  },\r\n  midWidth: {\r\n    width: '75%',\r\n  },\r\n  fullWidth: {\r\n    width: '100%',\r\n  },\r\n\r\n  //********************** Main sets */\r\n  mainCenter: {\r\n    justifyContent: 'center',\r\n  },\r\n  mainEnd: {\r\n    justifyContent: 'flex-end',\r\n  },\r\n  mainSpaceAround: {\r\n    justifyContent: 'space-around',\r\n  },\r\n  mainSpaceBetween: {\r\n    justifyContent: 'space-between',\r\n  },\r\n  mainStart: {\r\n    justifyContent: 'flex-start',\r\n  },\r\n\r\n  //********************** Container sets */\r\n  mainContainer:{\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n  },\r\n  contentContainer:{\r\n    flex:1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n    marginTop: Metrics.small,\r\n    ...Metrics.bottomMargin,\r\n  },\r\n  borderContainer: {\r\n    borderWidth: 1,\r\n    borderColor: '#000',\r\n    borderRadius: 15,\r\n    ...Metrics.tinyHorizontalPadding,\r\n    ...Metrics.tinyVerticalPadding,\r\n    maxWidth:450,\r\n    zIndex: 1,\r\n  },\r\n  textContainer:{\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n    alignItems: 'center',\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.small,\r\n    maxWidth:450,\r\n  },\r\n  loadingContainer: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n  logoContainer: {\r\n    width: '100%',\r\n    height: 220,\r\n  },\r\n\r\n  //**********************  */\r\n  backgroundReset: {\r\n    backgroundColor: Colors.transparent,\r\n  },\r\n\r\n  rotate90: {\r\n    transform: [{ rotate: '90deg' }],\r\n  },\r\n  rotate90Inverse: {\r\n    transform: [{ rotate: '-90deg' }],\r\n  },\r\n  mirror: {\r\n    transform: [{ scaleX: -1 }],\r\n  },\r\n\r\n  scrollSpaceAround: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-around',\r\n  },\r\n  scrollSpaceBetween: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-between',\r\n  },\r\n\r\n  selfStretch: {\r\n    alignSelf: 'stretch',\r\n  },\r\n\r\n  textCenter: {\r\n    textAlign: 'center',\r\n  },\r\n  textJustify: {\r\n    textAlign: 'justify',\r\n  },\r\n  textLeft: {\r\n    textAlign: 'left',\r\n  },\r\n  textRight: {\r\n    textAlign: 'right',\r\n  },\r\n};\r\n","/**\r\n * This file defines the base application styles.\r\n *\r\n * Use it to define generic component styles (e.g. the default text styles, default button styles...).\r\n */\r\nimport { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  button: {\r\n    backgroundColor: Colors.primary,\r\n    color: Colors.secountText,\r\n  },\r\n  buttonText: {\r\n    color: Colors.secountText,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n\r\n  navigationHeader:{\r\n    textAlign: 'center',\r\n    alignSelf:'center',\r\n    flexGrow:1,\r\n  }\r\n};\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, Image, Platform } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nlet messaging;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/messaging').default;\r\n\r\n  messaging = firebase.messaging();\r\n  //#endregion\r\n}\r\n\r\nimport Style from './SplashScreenStyle'\r\nimport { Helpers, Images } from '../../Theme'\r\n\r\nclass SplashScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    /*this.state = {\r\n    }*/\r\n  }\r\n\r\n  getData(){\r\n    if (Platform.OS === \"android\" || Platform.OS === \"ios\"){\r\n      messaging().onNotificationOpenedApp(remoteMessage => {\r\n        console.log(\r\n          'Notification caused app to open from background state:',\r\n          remoteMessage.notification,\r\n        );\r\n        NavigationService.navigate(remoteMessage.data.type);\r\n      });\r\n\r\n      // Check whether an initial notification is available\r\n      messaging().getInitialNotification().then(remoteMessage => {\r\n        if (remoteMessage) {\r\n          console.log(\r\n            'Notification caused app to open from quit state:',\r\n            remoteMessage.notification,\r\n          );\r\n          NavigationService.navigate(remoteMessage.data.type); // e.g. \"Settings\"\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount(){\r\n    //this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Style.container]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    //setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SplashScreen);\r\n//export default SplashScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n})\r\n","import React from 'react'\r\nimport { Text, View } from 'react-native'\r\nimport { Helpers, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component with a deep link.\r\n */\r\nconst DeepLinkingScreen = () => (\r\n  <View style={[Helpers.fillCenter, Helpers.rowMain, Metrics.mediumHorizontalMargin]}>\r\n    <Text>\r\n      This is deep linking example screen which can be accessed using agrissysapp://deeplink scheme!\r\n    </Text>\r\n  </View>\r\n)\r\n\r\nexport default DeepLinkingScreen\r\n","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst Button = props => {\r\n  var TextView = [<Text style={[styles.text, props.textStyle]} key={0}>{props.Text}</Text>]\r\n\r\n  var ImageView = []\r\n  if (props.icon) {\r\n    var _Image = <Image style={Helpers.fullSize} source={props.icon} resizeMode={'contain'} />\r\n    ImageView = (\r\n      <View style={[styles.icon, props.iconStyle]}>\r\n        {_Image}\r\n      </View>\r\n    )\r\n  }\r\n  return (\r\n    <TouchableOpacity style={[styles.boxContainer, props.boxStyle]} onPress={props.onPress}>\r\n      {props.icon?(\r\n        <View style={[styles.button, props.buttonStyle, Helpers.rowCenter]}>\r\n          <View style={[Helpers.colCenter, Helpers.fill]}>\r\n            {TextView}\r\n          </View>\r\n            {ImageView}\r\n        </View>\r\n      ):(\r\n        <View style={[styles.button, props.buttonStyle]}>\r\n          {TextView}\r\n        </View>\r\n      )}\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  boxContainer:{\r\n    ...Helpers.center,\r\n    ...Metrics.tinyVerticalMargin,\r\n  },\r\n  button: {\r\n    borderRadius: 15,\r\n    ...Helpers.center,\r\n    ...Helpers.fullWidth,\r\n    ...Metrics.horizontalPadding,\r\n    ...ApplicationStyles.button,\r\n  },\r\n  text: {\r\n    ...ApplicationStyles.buttonText,\r\n    ...Metrics.verticalPadding,\r\n    ...Helpers.center,\r\n    textAlign:\"center\",\r\n  },\r\n  icon: {\r\n    ...Helpers.colCenter,\r\n    ...Metrics.smallVerticalMargin,\r\n    width: '25%', \r\n    height: 50,\r\n  },\r\n});\r\n\r\nexport default Button;","import React from 'react';\r\nimport { View, Text, Image} from 'react-native';\r\nimport Button from './Button'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst Button_Panel = props => {\r\n  const Texts = props.Texts;\r\n  const Images = props.Images;\r\n\r\n  const onPress = props.onPress;\r\n\r\n  var Buttons = []\r\n\r\n  Texts.forEach((element, index) => {\r\n    var image = null\r\n    if (Images && Images[index]){\r\n      image = Images[index]\r\n    }\r\n    Buttons.push(\r\n      <Button key={index} Text={element} icon={image}\r\n        iconStyle={props.iconStyle} itemStyle={props.itemStyle}\r\n        onPress={() => {\r\n          if (onPress) {\r\n            onPress({index: index, text: element})\r\n          }\r\n        }}/>\r\n    )\r\n  });\r\n\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:30}, props.style] }>\r\n      {Buttons}\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default Button_Panel;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport Button from './Button';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst TitleElement = props => {\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin,] }>\r\n      <Button Text={props.Text} icon={props.icon} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n        onPress={() => {\r\n          if (props.onPress){\r\n            props.onPress()\r\n          }\r\n        } }/>\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default TitleElement;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text} from 'react-native';\r\nimport { ListItem } from 'react-native-elements'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst CustomListItem = props => {\r\n  const key = props.key? props.key : 0\r\n  return (\r\n    <ListItem key={key} containerStyle={[styles.listitem, {flexDirection:\"column\", borderRadius:0}, props.itemStyle]} button onPress={props.onPress}>\r\n      <ListItem.Content>\r\n        <ListItem.Title>{props.Title}</ListItem.Title>\r\n        {props.hasOwnProperty(\"Subtitle\") ? <ListItem.Subtitle>{props.Subtitle}</ListItem.Subtitle>\r\n        :(<></>)}\r\n      </ListItem.Content>\r\n    </ListItem>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  listitem: {\r\n    flex: 1,\r\n    ...Helpers.borderContainer,\r\n    ...Helpers.center,\r\n    backgroundColor: '#fff',\r\n    paddingVertical: 5,\r\n    paddingHorizontal: 5,\r\n  },\r\n});\r\n\r\nexport default CustomListItem;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, FlatList} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst ContentProp = props => {\r\n  var texts = [];\r\n  if (props.texts){\r\n    props.texts.forEach((element,i) => {\r\n      texts.push(\r\n        (<View style={[styles.contentBox, props.textsStyle]} key={\"text_\" + i}>\r\n          <Text>{element}</Text>\r\n        </View>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var datas = [];\r\n  if (props.datas) {\r\n    props.datas.forEach((element,i) => {\r\n      datas.push(\r\n        (<TouchableOpacity style={[styles.contentBox, props.datasStyle]} onLongPress={() => {\r\n          if (props.onPress){\r\n            props.onPress({data: element, index: i})\r\n          }\r\n        }} key={\"data_\" + i}>\r\n          <Text>{element}</Text>\r\n        </TouchableOpacity>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var length = texts.length > datas.length? texts.length : datas.length\r\n  \r\n  var view = [];\r\n  for(var i = 0; i < length; i++) {\r\n    var dataRow = [];\r\n    if (i < texts.length) {\r\n      dataRow.push(texts[i])\r\n    } else {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"leftSpace_\" + i}/>))\r\n    }\r\n\r\n    if (datas.length > 0) {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter, {maxWidth:20}]} key={\"seperator_\" + view.length}/>))\r\n\r\n      if (i < datas.length) {\r\n        dataRow.push(datas[i])\r\n      } else {\r\n        dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"rightSpace_\" + i}/>))\r\n      }\r\n    }\r\n\r\n    view.push(\r\n      (<View style={[props.datas?Helpers.rowCenter:Helpers.halvWidth, Metrics.tinyVerticalMargin]} key={\"row_\" + view.length}>\r\n        {dataRow}\r\n      </View>)\r\n    )\r\n  }\r\n  \r\n  return (view);\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  contentBox: {\r\n    ...Helpers.fill,\r\n    ...Helpers.colCenter,\r\n    ...Helpers.borderContainer,\r\n    borderRadius: 0,\r\n    minHeight:30,\r\n  }\r\n});\r\n\r\n\r\nexport default ContentProp;","import React, { useEffect } from 'react'\r\nimport { StyleSheet, Text, View, Image, ActivityIndicator } from 'react-native'\r\n\r\nimport { Helpers, Images, Colors } from '../Theme'\r\n\r\nconst Loading = props => {\r\n  if (props.loading){\r\n    var styles = props.back ? styles.container: {}\r\n    return (\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer, styles]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  } else return null;\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n});\r\n\r\nexport default Loading\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Comment_Module } from '../Components'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nclass OperationsPanel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      View:1,\r\n    }\r\n  }\r\n\r\n  getPenAndSection() {\r\n    var Section, Pen = undefined\r\n    if (this.props.pig && this.props.pigTag && this.props.PigsList) {\r\n      if (this.props.PigsList[this.props.pigTag] && this.props.PigsList[this.props.pigTag].pen && this.props.PigsList[this.props.pigTag].pen != 0) {\r\n        Pen = this.props.PigsList[this.props.pigTag].pen\r\n\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (localDataStore && localDataStore.pens && localDataStore.pens[Pen]) {\r\n          var PenData = localDataStore.pens[Pen];\r\n          Section = PenData.section;\r\n        }\r\n      }\r\n    }\r\n    return {Section, Pen}\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    if (this.props.pig) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Add Pig\"\r\n            onPress={() => {\r\n              if (this.props.pigTag !== \"\" ) {\r\n                if (Object.keys(this.props.PigsList).filter(e => e === this.props.pigTag).length > 0){\r\n                  this.props.setFirebaseError(\"Can not add Tag already exist\")\r\n                } else {\r\n                  this.props.setFirebaseError(\"\")\r\n                  this.props.newPig(this.props.pigTag)\r\n                }\r\n              }\r\n              else this.props.setFirebaseError(\"A Tag is needed\")\r\n            } }/>\r\n          <Button Text=\"Move Pig\"\r\n            onPress={() => {\r\n              var {Section, Pen} = this.getPenAndSection()\r\n              this.props.setCurrentPig(this.props.pigTag, Section, Pen)\r\n              NavigationService.navigate(\"DataEditor\")\r\n            } }/>\r\n        </View>\r\n      )\r\n    } else if (this.props.section) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Weight\"\r\n              onPress={() => {\r\n                NavigationService.navigate(\"WeighingOperations\")\r\n              }}/>\r\n          <View style={[{marginTop:40}]}>\r\n            <Button Text=\"Add Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.CREATE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n            <Button Text=\"Remove Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.DELETE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n          </View>\r\n        </View>\r\n      )\r\n    } else {\r\n      var Action = 1;\r\n      switch(this.state.View) {\r\n        case Operations.MOVE:\r\n        case Operations.LOST:\r\n        case Operations.SOLD:\r\n          Action = -1\r\n        case Operations.ADD:\r\n          return(\r\n            <Comment_Module Title={\"Operations comment:\"} Quantity={true} Weight={true} onDone={(res) => {\r\n              if (res.res) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                var quantity = res.quantity\r\n                if (isNaN(quantity)) quantity = 1\r\n                Action = Action * quantity\r\n                if (res.weight && res.weight !== \"\") {\r\n                  var weight = res.weight\r\n                  if (this.state.View === Operations.ADD) {\r\n                    this.props.newWeight(CurrentData.penId, weight, Date.now(),1)\r\n                  }\r\n                }\r\n\r\n                this.props.newComment(CurrentData.penId, action, res.data, quantity, weight)\r\n                this.props.newPigCount(CurrentData.penId, Action)\r\n              }\r\n\r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          //this.props.newPigCount(CurrentData.penId, Action * \"count_input\", comment)\r\n        case Operations.NOTE:\r\n          return(\r\n            <Comment_Module Title={\"Pen Note:\"} onDone={(res) => {\r\n              if (res.res && res.data) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                \r\n                this.props.newComment(CurrentData.penId, action, res.data)\r\n              }\r\n              \r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          break;\r\n        default:\r\n          return(\r\n            <ScrollView style={{paddingRight: 5}}>\r\n              <View style={[Helpers.buttonContainer]}>\r\n                <Button Text=\"Weight\"\r\n                    onPress={() => {\r\n                      NavigationService.navigate(\"WeighingOperations\")\r\n                    }}/>\r\n                <Button Text=\"Note\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.NOTE,\r\n                      })\r\n                    }\r\n                  }/>\r\n                <View style={[{marginTop:10}]}>\r\n                  <Button Text=\"Add Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.ADD,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Move Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.MOVE,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Lost Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.LOST,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Sold Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.SOLD,\r\n                      })\r\n                    } }/>\r\n                </View>\r\n              </View>\r\n            </ScrollView>\r\n          )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n\r\n    editPens: (action) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action:action})),\r\n\r\n    setCurrentPig: (pigTag, Section, Pen) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PIGS, action:Actions.CREATE, pigtag:pigTag, data:{section:Section}, dataId:Pen})),\r\n    newPig: (pigTag) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {TagId: pigTag})),\r\n    newPigCount: (penId, countChange) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {PenId: penId, Action:countChange})),\r\n\r\n    newComment: (penId, action, data, quantity=null, weight=null) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.COMMENTS, {PenId: penId, Action: action, Data: data, Quantity:quantity, Weight:weight})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OperationsPanel);\r\n//export default OperationsPanel","import React, {useRef, useState, useEffect} from 'react';\r\nimport { Text, View, StyleSheet, Animated } from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst ProgressBar = props => {\r\n  let animation = useRef(new Animated.Value(0));\r\n  const progress = props.progress\r\n  const Color = props.color?props.color:\"#8BED4F\"\r\n  \r\n  useEffect(() => {\r\n    Animated.timing(animation.current, {\r\n      toValue: progress,\r\n      duration: 100\r\n    }).start();\r\n  },[progress])\r\n\r\n  const width = animation.current.interpolate({\r\n    inputRange: [0, 100],\r\n    outputRange: [\"0%\", \"100%\"],\r\n    extrapolate: \"clamp\"\r\n  })\r\n  return (\r\n    <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, minHeight:45, paddingBottom:10}]}>\r\n      <View style={[Helpers.fill, Helpers.fullWidth, Helpers.colMain, {alignContent:'center'}]}>\r\n        {props.text?(\r\n        <Text style={{alignSelf:'flex-start', minHeight:20}}>\r\n          {props.text}\r\n        </Text>):(<></>)}\r\n        <View style={styles.progressBar}>\r\n          <Animated.View style={[StyleSheet.absoluteFill], {backgroundColor: Color, width }}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ProgressBar;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingTop: 5,\r\n    padding: 8,\r\n  },\r\n  progressBar: {\r\n    flexDirection: 'row',\r\n    height: 20,\r\n    width: '100%',\r\n    borderColor: '#000',\r\n    borderWidth: 2,\r\n    borderRadius: 5\r\n  }\r\n});\r\n","import React, { Component } from 'react'\r\nimport { StyleSheet, View, TouchableOpacity, Picker, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n];\r\n\r\nclass DateTime_Picker extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n      \r\n    const {year, month, day} = this.getStates(props)\r\n    this.state = {\r\n      year: year,\r\n      month: month,\r\n      day: day,\r\n    }\r\n  }\r\n\r\n  getStates(props) {\r\n    var Today = new Date();\r\n    var Selected = new Date();\r\n    if (props.Selected) {\r\n      Selected = new Date(props.Selected)\r\n    }\r\n\r\n    var year, month, day;\r\n    year = Selected.getFullYear()\r\n    month = Selected.getMonth()\r\n    day = Selected.getDate()\r\n\r\n    if (!props.Selected) {\r\n      if (props.Year){\r\n        year = this.props.Year\r\n      }\r\n      if (props.Month){\r\n        month = this.props.Month\r\n      }\r\n      if (props.Day){\r\n        day = this.props.Day\r\n      }\r\n    }\r\n    return {year, month, day}\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevProps.Selected){\r\n      if (prevProps.Selected != this.props.Selected){\r\n        const {year, month, day} = this.getStates(this.props)\r\n        this.setState({\r\n          year: year,\r\n          month: month,\r\n          day: day,\r\n        }, this.forceUpdate())\r\n      }\r\n    } else {\r\n      var changed = false;\r\n      if (prevProps.Year != this.props.Year) changed = true\r\n      if (prevProps.Month != this.props.Month) changed = true\r\n      if (prevProps.Day != this.props.Day) changed = true\r\n      if (changed) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    var Today = new Date();\r\n\r\n    var year = Today.getFullYear()\r\n    var YearItems = []\r\n    for (let index = year + 25; index > year - 25; index--) {\r\n      var val = String(index)\r\n      YearItems.push(<Picker.Item key={\"Year_\" + index} value={index} label={val} />)\r\n    }\r\n      \r\n    var MonthItems = []\r\n    var month = Today.getMonth()\r\n    for (let index = 0; index < monthNames.length; index++) {\r\n      var val = String(index)\r\n      MonthItems.push(<Picker.Item key={\"Month_\" + index} value={index} label={monthNames[index]} />)\r\n    }\r\n  \r\n    var DayItems = []\r\n    var days = new Date(year, month + 1, 0).getDate()\r\n    for (let index = 1; index <= days; index++) {\r\n      var val = String(index)\r\n      DayItems.push(<Picker.Item key={\"Day_\" + index} value={index} label={val} />)\r\n    }\r\n\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.row, {marginBottom:-10,}, this.props.style]}>\r\n        <Picker selectedValue={this.state.year} style={[{minWidth: 101, marginRight:5}]}\r\n          onValueChange={(_year) => {\r\n            year = _year\r\n            this.props.onValueChange(new Date(year, this.state.month, this.state.day))\r\n          }}>\r\n          {YearItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.month} style={[{minWidth: 110, marginRight:5}]}\r\n          onValueChange={(_month) => {\r\n            month = _month\r\n            this.props.onValueChange(new Date(this.state.year, month, this.state.day))\r\n          }}>\r\n          {MonthItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.day} style={[{minWidth: 83}]}\r\n          onValueChange={(_day) => {\r\n            days = parseInt(_day)\r\n            this.props.onValueChange(new Date(this.state.year, this.state.month, days))\r\n          }}>\r\n          {DayItems}\r\n        </Picker>\r\n      </View>\r\n    )\r\n  }\r\n}\r\nexport default DateTime_Picker;","import React, { useState } from 'react';\r\nimport { Platform, View, Text, TextInput, Image, StyleSheet, RecyclerViewBackedScrollViewComponent} from 'react-native';\r\nimport Button from './Button'\r\nimport { Icon, Input } from 'react-native-elements'\r\nimport { Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst Comment_Module = props => {\r\n  const Title = props.Title;\r\n  const Quantity = props.Quantity?props.Quantity:false\r\n  const Weight = props.Weight?props.Weight:false\r\n  \r\n  const onDone = props.onDone;\r\n  var Button1 = \"Done\";\r\n  var Button2 = \"Cancel\";\r\n  const [InputText, setInputText] = useState(\"\");\r\n  const [QuantityText, setQuantityText] = useState(\"1\");\r\n  const [WeightText, setWeightText] = useState(\"\");\r\n\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.buttonContainer, props.style] }>\r\n      <View style={styles.textAreaContainer} >\r\n        <View style={[App?{}:Helpers.row]}>\r\n          {Title?(<Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>{Title}</Text>):(<></>)}\r\n          {Quantity?(\r\n            <View style={[Helpers.row, App?{}:{marginLeft:50, marginBottom:4}]}>\r\n              <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Quantity:</Text>\r\n              <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n                multiline={false}\r\n                onChangeText={(text) => {\r\n                  if (text === \"\" || !isNaN(text)) setQuantityText(text)\r\n                }}\r\n                value={QuantityText}\r\n              />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {Weight?(\r\n          <View style={[Helpers.row, App?{}:{marginBottom:4}]}>\r\n            <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Average Weight:</Text>\r\n            <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n              multiline={false}\r\n              onChangeText={(text) => {\r\n                if (text === \"\" || !isNaN(text)) setWeightText(text)\r\n              }}\r\n              value={WeightText}\r\n            />\r\n          </View>\r\n        ):(<></>)}\r\n        <TextInput\r\n          style={styles.textArea}\r\n          underlineColorAndroid=\"transparent\"\r\n          placeholder=\"Type something\"\r\n          placeholderTextColor=\"grey\"\r\n          numberOfLines={10}\r\n          multiline={true}\r\n          onChangeText={(text) => setInputText(text)}\r\n          value={InputText}\r\n        />\r\n      </View>\r\n      <Button key={\"_Done\"} Text={Button1}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: true, data: InputText, quantity: QuantityText, weight: WeightText})\r\n          }\r\n        }}/>\r\n      <Button key={\"_Cancel\"} Text={Button2}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: false, data: InputText})\r\n          }\r\n        }}/>\r\n    </View>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  textAreaContainer: {\r\n    borderColor: Colors.gray,\r\n    borderWidth: 1,\r\n    padding: 5\r\n  },\r\n  textArea: {\r\n    height: 150,\r\n    justifyContent: \"flex-start\",\r\n    borderColor: \"black\",\r\n    borderWidth: 0.5,\r\n    padding: 5,\r\n  }\r\n})\r\n\r\nexport default Comment_Module;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 190,\r\n    marginTop: Metrics.medium * 2, \r\n    marginBottom: Metrics.medium,\r\n  },\r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../Stores/Device/Actions'\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\n\r\nimport { Button_Panel } from '../../Components'\r\nimport Style from './FrontScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images } from '../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      ShowMainError: false,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseErrorMessage = this.props.firebase.firebaseErrorMessage\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Style.logoContainer]}>\r\n          <Image style={[Helpers.fullSize]} source={Images.Logo} resizeMode={'contain'} />\r\n        </View>\r\n\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize]}>\r\n          <View style={[Helpers.textContainer, Helpers.fullWidth]}>\r\n            {this.state.ShowMainError && firebaseErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <Text style={ApplicationStyles.text}>Welcome to Agrisys App</Text>\r\n            <Text style={ApplicationStyles.text}>Please choose your action</Text>\r\n          </View>\r\n\r\n          <Button_Panel \r\n            Texts={[\"Connect to Agrisys Cloud\", \"Connect to Device\"]}\r\n            Images={[Images.Haxa_globe, null]}\r\n            onPress={(ele) => {\r\n              switch(ele.index){\r\n                case 0:\r\n                  NavigationService.navigate('AuthStack')\r\n                  break;\r\n                case 1:\r\n                  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n                    NavigationService.navigate(\"DeviceScreen\")\r\n                  }\r\n                  break;\r\n              }\r\n              /*<Button Text=\"Example\"\r\n              onPress={() => NavigationService.navigate(\"ExampleScreen\")}/>*/\r\n            }}\r\n          />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","/**\r\n * Selectors let us factorize logic that queries the state.\r\n *\r\n * Selectors can be used in sagas or components to avoid duplicating that logic.\r\n *\r\n * Writing selectors is optional as it is not always necessary, we provide a simple example below.\r\n */\r\n\r\nexport const liveInEurope = (state) => {\r\n  if (Object.entries(state.example.user).length <= 0) return null\r\n\r\n  // For this example, we imagine this cities are european cities\r\n  const europeanCities = [\r\n    'Gwenborough',\r\n    'Wisokyburgh',\r\n    'McKenziehaven',\r\n    'South Elvis',\r\n    'Roscoeview',\r\n  ]\r\n\r\n  return europeanCities.includes(state.example.user.address.city)\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  instructions: {\r\n    ...Fonts.normal,\r\n    fontStyle: 'italic',\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 300,\r\n    marginBottom: 25,\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, Button, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { liveInEurope } from '../../Stores/Example/Selectors'\r\n\r\nimport Style from './ExampleScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component.\r\n *\r\n * This screen displays a little help message and informations about a fake user.\r\n * Feel free to remove it.\r\n */\r\nconst instructions = Platform.select({\r\n  ios: 'Press Cmd+R to reload,\\nCmd+D or shake for dev menu.',\r\n  android: 'Double tap R on your keyboard to reload,\\nShake or press menu button for dev menu.',\r\n})\r\n\r\nconst ExampleScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const user = useSelector((state) => state.example.user)\r\n  const userIsLoading = useSelector((state) => state.example.userIsLoading)\r\n  const userErrorMessage = useSelector((state) => state.example.userErrorMessage)\r\n\r\n  useEffect(() => {\r\n    dispatch(ExampleActions.fetchUser())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fillCenter,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      {userIsLoading ? (\r\n        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\r\n      ) : (\r\n        <View>\r\n          <View style={Style.logoContainer}>\r\n            <Image style={Helpers.fullSize} source={Images.logo} resizeMode={'contain'} />\r\n          </View>\r\n          <Text style={Style.text}>To get started, edit App.js</Text>\r\n          <Text style={Style.instructions}>{instructions}</Text>\r\n          {userErrorMessage ? (\r\n            <Text style={Style.error}>{userErrorMessage}</Text>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.result}>\r\n                {\"I'm a fake user, my name is \"}\r\n                {user.name}\r\n              </Text>\r\n              <Text style={Style.result}>\r\n                {liveInEurope ? 'I live in Europe !' : \"I don't live in Europe.\"}\r\n              </Text>\r\n            </View>\r\n          )}\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => dispatch(ExampleActions.fetchUser())}\r\n            title=\"Refresh\"\r\n          />\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => NavigationService.navigate(\"TestScreen\") }\r\n            title=\"Test\"\r\n          />\r\n        </View>\r\n      )}\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ExampleScreen\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 220,\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.small,\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  deviceContainer: {\r\n    flex: 1,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n  deviceDataContainer: {\r\n    borderWidth: 1,\r\n    borderColor: \"#000\",\r\n    marginTop: Metrics.normal,\r\n    paddingTop: Metrics.small,\r\n    paddingHorizontal: Metrics.normal,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text2: {\r\n    ...Fonts.normal,\r\n    marginRight: Metrics.small,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, FlatList, SafeAreaView, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { ScannerState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { Button, CustomListItem } from '../../Components'\r\nimport Style from './DeviceScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../Theme'\r\n\r\nimport { Service, } from 'react-native-ble-plx'\r\n\r\nconst BLEButton = (dispatch, Active = false) => {\r\n  if (!Active) {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n              onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n    )\r\n  } else {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n              onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n    )\r\n  }\r\n} \r\n\r\nconst ConnectedDevice_View = (connectedDevice, DeviceData) => {\r\n  const dispatch = useDispatch()\r\n  return (\r\n    <View>\r\n      <CustomListItem Title={connectedDevice.localName} Subtitle={connectedDevice.id} itemStyle={{marginBottom: 10}} onPress={() => dispatch(DeviceActions.disconnectDevice())}/>\r\n      { DeviceData && Object.keys(DeviceData).length > 1 ? (\r\n        <View style={Style.deviceDataContainer}>\r\n          {/* if battery is presented */}\r\n          {DeviceData && DeviceData.Battery ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Device battery level</Text>\r\n              <Text>{DeviceData.Battery + \"%\"}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n\r\n          {/* App scanners data */}\r\n          {DeviceData.tagid ? (\r\n          <View style={Style.textContainer}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n          {DeviceData.Unknown ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>unknon Id:</Text>\r\n              <Text>{DeviceData.Unknown}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n      ):(<></>)\r\n      }\r\n    </View>\r\n  )\r\n}\r\n\r\nconst DeviceScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const deviceErrorMessage = useSelector((state) => state.device.deviceErrorMessage)\r\n\r\n  const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n\r\n  const scannerState = useSelector((state) => state.device.scannerState)\r\n  const connectionMethode = useSelector((state) => state.device.connectionMethode)\r\n  const Devices = useSelector((state) => state.device.DeviceList)\r\n\r\n  useEffect(() => {\r\n    //dispatch(DeviceActions.fetchDevice())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fill,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      <View>\r\n        <View style={Style.textContainer}>\r\n          {deviceErrorMessage ? (\r\n            <View>\r\n              <Text>There was a error while retrieving conected device</Text>\r\n              \r\n            </View>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.text}>Corrently connected:</Text>\r\n              <Text style={Style.text}>{connectedDevice && connectedDevice.name ? (connectedDevice.name):(\"None\") /*mabye use localname*/}</Text>\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.buttonContainer}>\r\n          {connectedDevice ? (\r\n            <View>\r\n              <Button buttonStyle={ApplicationStyles.button} Text=\"Disconnect Device\" \r\n                onPress={() => dispatch(DeviceActions.disconnectDevice(connectionMethode))}/>\r\n              {/*<Button buttonStyle={ApplicationStyles.button} Text=\"Activate device reading\"\r\n                onPress={() => {\r\n                  dispatch(DeviceActions.readDeviceData())\r\n                }}\r\n              />*/}\r\n            </View>\r\n            ): (\r\n            <View>\r\n              {connectionMethode == ConnectionMethode.BLE && scannerState != ScannerState.IDLE ? (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n                  onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n                  ) : (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n                  onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n                )\r\n              }\r\n              \r\n              {Platform.OS === 'ios' ? (<></>):(\r\n                <View>\r\n                  {connectionMethode == ConnectionMethode.BLUETOOTH && scannerState != ScannerState.IDLE ? (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Stop Bluetooth Search\" \r\n                      onPress={() => dispatch(DeviceActions.stopBluetoothScan())}/>\r\n                      ) : (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Search Bluetooth devices\" \r\n                      onPress={() => dispatch(DeviceActions.startBluetoothScan())}/>\r\n                    )\r\n                  }\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"Make Discoverable (Blu 30sec)\" \r\n                      onPress={() => dispatch(DeviceActions.bluetoothScanAble())}/>\r\n\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"OnDevice-serial\" \r\n                      onPress={() => {}}/>\r\n                </View>\r\n              )}\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.deviceContainer}>\r\n          <Text style={Style.text2}>Device List:</Text>\r\n            { connectedDevice ? \r\n              ConnectedDevice_View(connectedDevice, DeviceData)\r\n              : (\r\n                <ScrollView style={{paddingRight: 5}}>\r\n                  {Devices.map((Dev, i) => (\r\n                    <CustomListItem key={i} Title={Dev.localName} Subtitle={Dev.id} onPress={() => dispatch(DeviceActions.connectDevice(Dev))}/>\r\n                  ))}\r\n                </ScrollView> \r\n              )\r\n            }\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nexport default DeviceScreen;\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport Front from '../Containers/Agrisys/FrontScreen'\r\nimport Example from '../Containers/Example/ExampleScreen'\r\nimport Device from '../Containers/Device/DeviceScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // The main application screen is our \"ExampleScreen\". Feel free to replace it with your\r\n    // own screen and remove the example.\r\n    FrontScreen: {\r\n      screen: Front,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n        headerShown: false,\r\n      }),\r\n      path: 'main',\r\n    },\r\n    \r\n    DeviceScreen: {\r\n      screen: Device,\r\n      navigationOptions: () => ({\r\n        title: 'Device',\r\n        headerTitleStyle:{\r\n          ...ApplicationStyles.navigationHeader\r\n        },\r\n      }),\r\n    },\r\n\r\n    ExampleScreen: {\r\n      screen: Example,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n      }),\r\n      path: 'example',\r\n    }\r\n  },\r\n  {\r\n    initialRouteName: 'FrontScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, Image, View, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport {Actions, DataRefs, UserStates} from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Loading } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;\r\n  //#endregion\r\n}\r\n\r\nconst PanelsSorter = (userType) => {\r\n  switch(userType) {\r\n    case UserStates.ADMIN:\r\n      return \"AdminPanel\"\r\n    case UserStates.OWNER:\r\n      return \"ConsysPanel\"\r\n    case UserStates.FREE:\r\n      return \"UserPanel\"\r\n    case UserStates.STARTER:\r\n      return \"CreateUserData\"\r\n    default:\r\n      return \"LoginUser\"\r\n  }\r\n};\r\n\r\nclass UserLoadingScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    const firebaseData = this.props.firebase;\r\n    if (!firebaseData) {\r\n      this.props.setFirebaseError(\"Internal rootdata Error\")\r\n      NavigationService.navigate('MainStack')\r\n      return;\r\n    }\r\n    \r\n    var page = \"LoginUser\";\r\n    const firebaseUser = firebaseData.firebaseUser\r\n    if (firebaseUser && Object.keys(firebaseUser).length > 1) {\r\n      if (firebaseUser.state === UserStates.STARTER && !firebaseUser.emailVerified) {\r\n        var User = auth().currentUser;\r\n        if(!User.emailVerified) {\r\n          page = \"VerifyScreen\";\r\n        }else {\r\n          page = PanelsSorter(firebaseUser.state)\r\n        }\r\n      } else {\r\n        page = PanelsSorter(firebaseUser.state)\r\n      }\r\n    }\r\n\r\n    NavigationService.navigate(page)\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      if (this.props.firebase.firebaseUser != prevProps.firebase.firebaseUser) { //Only checking user changes\r\n        var now = this.props.firebase.firebaseUser\r\n        var prev = prevProps.firebase.firebaseUser\r\n        if (!now || now.uid !== prev.uid || (now.state !== prev.state && prev.state !== UserStates.STARTER) || now.emailVerified != prev.emailVerified) {\r\n          console.log(\"UserLoading\")\r\n          this.checkData(this.props);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.props.getUser(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ISLOADPAGE = this.state.ISLOADPAGE;\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        {!ISLOADPAGE ?(\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            <Text style={ApplicationStyles.text}>This page contains an error.</Text>\r\n            <Text style={ApplicationStyles.text}>If you are going back, please press back again.</Text>\r\n          </View>\r\n        ):(\r\n          <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n            <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n          </View>\r\n        )}\r\n        {(IsLoading || ISLOADPAGE) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})), //TODO: mabye not get user \r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoadingScreen);\r\n//export default UserLoadingScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  \r\n})\r\n","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Platform } from 'react-native'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;\r\n  //#endregion\r\n}\r\n\r\nclass VerifyScreen extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    \r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    if (props.firebase && props.firebase.firebaseUser) {\r\n      var User = auth().currentUser;\r\n\r\n      if (User && !props.firebase.firebaseUser.emailVerified && !props.firebase.viewIsLoading){\r\n        User.reload().then((data)=>{\r\n          if(User.emailVerified) {\r\n            this.props.setViewLoading(true)\r\n            this.props.setUser(User.emailVerified)\r\n            console.log(\"Verified\")\r\n            NavigationService.navigate(\"AuthStack\")\r\n          }\r\n        })\r\n      }\r\n      \r\n      if (props.firebase.firebaseUser.emailVerified) NavigationService.navigate(\"AuthStack\")\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          <View>\r\n            <Text>Please verify your account by accepting the email, sent to your current account</Text>\r\n            <Text>This page will not refresh itself...</Text>\r\n            <Button Text=\"Resend verification\"\r\n              onPress={() => {\r\n                console.log(\"send\", firebaseUser, this.state.User)\r\n                if (firebaseUser && this.state.User) {\r\n                  this.state.User.sendEmailVerification()\r\n                }\r\n              }}/>\r\n            <Button Text=\"Refresh\"\r\n              onPress={() => {\r\n                this.checkData(this.props, this.state)\r\n              }}/>\r\n          </View>\r\n          \r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setUser: (Verified) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {emailVerified:Verified, })),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VerifyScreen);\r\n//export default VerifyScreen;","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass UserLoginScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      Email: \"\",\r\n      Pass: \"\",\r\n      CreateUser: false,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          {!this.state.CreateUser?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={[Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Username\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Email: text})\r\n                  }}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Pass:text})\r\n                  }}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n                <Button Text=\"Login\" icon={Images.User}\r\n                  onPress={() => {\r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setViewError(\"Email is needed\")\r\n                    else if (this.state.Email === \"CLEAR\") this.props.clearDataMem()\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setViewError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.signIN(this.state.Email, this.state.Pass)\r\n                    }\r\n                  }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Send reset password\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    if (this.state.Email) {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.resetPass(this.state.Email)\r\n                    } else {\r\n                      this.props.setViewError(\"Please provide an Email\")\r\n                    }\r\n                  }}/>\r\n                <Button Text=\"Create New User\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    this.setState({\r\n                      Email: \"\",\r\n                      Pass: \"\",\r\n                      CreateUser: true,\r\n                    })\r\n                  }}/>\r\n              </View>\r\n            </View>\r\n          ):(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Email\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Email:text})}}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Pass:text})}}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n              </View>\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Create User\" \r\n                  onPress={() => { \r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setFirebaseError(\"Email is needed\")\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setFirebaseError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.createUser(this.state.Email,this.state.Pass)\r\n                    }\r\n                  }}\r\n                />\r\n              </View>\r\n            </View>\r\n          )}\r\n\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    signIN: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA, {Email: Email, Pass: Pass})),\r\n    resetPass: (Email) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email})),\r\n    createUser: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email, Pass: Pass})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoginScreen);\r\n//export default UserLoginScreen;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass UserInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FirstN, LastN, Contact, ContactP, Address} = this.setData(props)\r\n    this.state = {\r\n      FirstN: FirstN,\r\n      LastN: LastN,\r\n      Contact: Contact,\r\n      ContactP: ContactP,\r\n      Address: Address,\r\n      Country: \"\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FirstN = \"\"\r\n    var LastN = \"\"\r\n    var Contact = \"\"\r\n    var ContactP = \"\"\r\n    var Address = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.name && DataStringCheck(firebaseUser.name)){\r\n          FirstN = firebaseUser.name\r\n        }\r\n        if (firebaseUser.lastN){\r\n          LastN = firebaseUser.lastN\r\n        }\r\n        if (firebaseUser.contact){\r\n          Contact = firebaseUser.contact\r\n        }\r\n        if (firebaseUser.phoneNumber) {\r\n          ContactP = firebaseUser.phoneNumber\r\n        }\r\n        if (firebaseUser.address){\r\n          Address = firebaseUser.address\r\n        }\r\n      }\r\n    }\r\n    return {FirstN, LastN, Contact, ContactP, Address}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FirstN, LastN, Contact, ContactP, Address} = this.setData(this.props)\r\n          this.setState({\r\n            FirstN: FirstN,\r\n            LastN: LastN,\r\n            Contact: Contact,\r\n            ContactP: ContactP,\r\n            Address: Address,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    //TODO: Test more with input error display ??\r\n    const F_FirstN = React.createRef();\r\n    const F_LastN = React.createRef();\r\n    const F_Contact = React.createRef();\r\n    const F_ContactP = React.createRef();\r\n    const F_Address = React.createRef();\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"User Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input ref={F_FirstN}\r\n                label=\"First Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FirstN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FirstN:text})\r\n                  }\r\n                }}\r\n                value={this.state.FirstN}\r\n\r\n              />\r\n              <Input ref={F_LastN}\r\n                label=\"Last Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({LastN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({LastN:text})\r\n                  }\r\n                }}\r\n                value={this.state.LastN}\r\n              />\r\n              <Input ref={F_Contact}\r\n                label=\"Contact Email\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Contact:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Contact:text})\r\n                  }\r\n                }}\r\n                value={this.state.Contact}\r\n              />\r\n              <Input ref={F_ContactP}\r\n                label=\"Contact Phone\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text, false)){\r\n                      this.setState({ContactP:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({ContactP:text})\r\n                  }\r\n                }}\r\n                value={this.state.ContactP}\r\n              />\r\n              <Input ref={F_Address}\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save User information\" \r\n                onPress={() => {\r\n                  var _UserData = {}\r\n\r\n                  if (!this.state.FirstN || this.state.FirstN === \"\"){\r\n                    this.props.setViewError(\"First name is needed\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps:\"First name is needed\" })\r\n                    F_FirstN.current.shake();*/\r\n                  } else if (!DataStringCheck(this.state.FirstN)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps: \"First name contains invalid characters\" })\r\n                    F_FirstN.current.shake();*/\r\n                  }\r\n                  \r\n                  else if (!this.state.LastN || this.state.LastN === \"\"){\r\n                    this.props.setViewError(\"Last name is needed\")\r\n                  } else if (!DataStringCheck(this.state.LastN)) {\r\n                    this.props.setViewError(\"Last name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _UserData = {name: this.state.FirstN, lastN: this.state.LastN}\r\n                    if (this.state.Contact !== \"\") _UserData.email = this.state.Contact\r\n                    if (this.state.ContactP !== \"\") _UserData.phoneNumber = this.state.ContactP\r\n                    if (this.state.Address !== \"\") _UserData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _UserData.country = this.state.Country\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateUser(_UserData)\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserInformation);\r\n//export default UserInformation;","import React, { Component } from 'react'\r\nimport { Platform, Dimensions, Text, CheckBox, View, ScrollView, ActivityIndicator, TouchableOpacity } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Subscription extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {CurrentSub} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      CurrentSub: CurrentSub,\r\n\r\n      Billing: 0,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var CurrentSub = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.state && firebaseUser.state != UserStates.STARTER){\r\n          CurrentSub = firebaseUser.state\r\n        }\r\n      }\r\n    }\r\n    return { CurrentSub }\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.state != this.state.CurrentSub && this.state.CurrentSub === \"\")\r\n          ) {\r\n          const {CurrentSub} = this.setData(this.props)\r\n          this.setState({\r\n            CurrentSub: CurrentSub,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n    \r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            \r\n            <TitleElement Text=\"Subscription plan\"/>\r\n            <View style={[!App?Helpers.fillRowCenter:{}, {marginBottom:20}]}>\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.WORKER?{backgroundColor: Colors.AgriGreen}:{}]} \r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.WORKER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Staff</Text>\r\n                  {this.state.CurrentSub===UserStates.WORKER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.WORKER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to assign as staff of an existing farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.FREE?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.FREE\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Owner</Text>\r\n                  {this.state.CurrentSub===UserStates.FREE?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.FREE?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to create and manage own farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.OWNER?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.OWNER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Manager</Text>\r\n                  {this.state.CurrentSub===UserStates.OWNER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.OWNER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>9999.99€</Text>\r\n                  <Text>Access to manage own farm, and assing staff</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===\"Contact\"?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: \"Contact\"\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Get contacted</Text>\r\n                  {this.state.CurrentSub===\"Contact\"?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===\"Contact\"?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                <Text style={{fontWeight:\"bold\", height:20}}></Text>\r\n                  <Text>We will contact you, and tell more about our offers</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\" \r\n                onPress={() => {\r\n                  if (!this.state.CurrentSub || this.state.CurrentSub === \"\"){\r\n                    this.props.setViewError(\"Please choose a subscription type.\")\r\n                  }\r\n\r\n                  else if (this.props.OnDone) {\r\n                    this.props.OnDone(this.state.CurrentSub)\r\n                  } else {\r\n                    //TODO: something.. validate buy and update user state\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n\r\n    //updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n    //createUserData: (Userdata, Farm, Sections, Pens) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: Userdata, Farms:{name:Farm}, Sections:Sections, Pens:Pens})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Subscription);\r\n//export default Subscription;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass FarmInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FarmName, Address, Country, Cvr, Manager} = this.setData(props)\r\n    this.state = {\r\n      FarmName: FarmName,\r\n      Address: Address,\r\n      Country: Country,\r\n      Cvr: Cvr,\r\n      Manager: Manager,\r\n\r\n      Sections: \"0\",\r\n      Pens: \"0\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FarmName = \"\"\r\n    var Address = \"\"\r\n    var Country = \"\"\r\n    var Cvr = \"\"\r\n    var Manager = \"\"\r\n\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    if (firebaseUser) {\r\n      if (firebaseUser.lastN !== \"\") {\r\n        FarmName = firebaseUser.lastN\r\n      }\r\n      if (firebaseUser.address !== \"\") {\r\n        Address = firebaseUser.address\r\n      }\r\n      if (firebaseUser.country) {\r\n        Country = firebaseUser.country\r\n      }\r\n      if (firebaseUser.email != \"\") {\r\n        Manager = firebaseUser.email\r\n      }\r\n    }\r\n\r\n    if (localDataStore && firebaseUser && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var FarmData = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n      if (FarmData.name) FarmName = FarmData.name\r\n      if (FarmData.address) Address = FarmData.address\r\n      if (FarmData.country) Country = FarmData.country\r\n      if (FarmData.cvr) Cvr = FarmData.cvr\r\n      if (FarmData.manager) Manager = FarmData.manager\r\n    }\r\n\r\n    return {FarmName, Address, Country, Cvr, Manager}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n    this.props.getFarm()\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        /*if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FarmName, Address, Cvr, Manager} = this.setData(this.props)\r\n          this.state = {\r\n            FarmName: FarmName,\r\n            Address: Address,\r\n            Cvr: Cvr,\r\n            Manager: Manager,\r\n          }\r\n        }*/\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"Farm Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input\r\n                label=\"Farm Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FarmName:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FarmName:text})\r\n                  }\r\n                }}\r\n                value={this.state.FarmName}\r\n              />\r\n              <Input\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n              <Input\r\n                label=\"Cvr\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Cvr:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Cvr}\r\n              />\r\n              <Input\r\n                label=\"Manager contact\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text) {\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Manager:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Manager:text})\r\n                  }\r\n                }}\r\n                value={this.state.Manager}\r\n              />\r\n              <Input\r\n                label=\"Number of Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Sections:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Sections}\r\n              />\r\n              <Input\r\n                label=\"Number of Pens in each Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Pens:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Pens}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save User information\" \r\n                onPress={() => {\r\n                  var _FarmData = {}\r\n                  var _sections = {};\r\n                  var _pens = {};\r\n\r\n                  if (!this.state.FarmName || this.state.FarmName === \"\"){\r\n                    this.props.setViewError(\"Farm name is needed\")\r\n                  } else if (!DataStringCheck(this.state.FarmName)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _FarmData = {name: this.state.FarmName}\r\n\r\n                    if (this.state.Address !== \"\") _FarmData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _FarmData.country = this.state.Country\r\n                    if (this.state.Cvr !== \"\") _FarmData.cvr = this.state.Cvr\r\n                    if (this.state.Manager !== \"\") _FarmData.manager = this.state.Manager\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateFarm(_FarmData)\r\n\r\n                    if (this.state.Sections && this.state.Pens) {\r\n                      var Pen = 1;\r\n                      var i, i2;\r\n                      for (i = 1; i <= this.state.Sections; i++) {\r\n                        var sectionPens = {};\r\n                        for (i2 = 1; i2 <= this.state.Pens; i2++) {\r\n                          _pens['Pen_' + Pen] = {section: 'Section_' + i}\r\n                          sectionPens['Pen_' + Pen] = true\r\n                          Pen++;\r\n                        }\r\n                        \r\n                        _sections['Section_' + i] = {pens: sectionPens}\r\n                      }\r\n                      console.log(\"Set\", _sections, _pens)\r\n                      this.props.updateFarmData(_sections, _pens)\r\n                    }\r\n\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n\r\n    updateFarm: (FarmData) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMS, {Data: FarmData})),\r\n    updateFarmData: (sections, pens) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMDATAS, {Data:{sections:sections, pens:pens}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FarmInformation);\r\n//export default FarmInformation;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport UserInformation from '../UserPanel/UserInformation'\r\nimport Subscription from '../UserPanel/Subscription'\r\nimport FarmInformation from '../UserPanel/FarmInformation'\r\n\r\nclass CreateNewUserData extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ViewState: 1,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    //this.props.setViewError(null)\r\n\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      /*if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }*/\r\n      if (this.props.firebase.firebaseUser !== prevProps.firebase.firebaseUser) {\r\n        if (prevProps.firebase.firebaseUser.state !== UserStates.STARTER && this.state.ViewState !== 3) {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    var Display = [];\r\n    if (this.state.ViewState === 1) {\r\n      Display = [(<UserInformation key={\"View1\"} OnDone={res => {\r\n        if (res) {\r\n          this.setState({\r\n            ViewState:2\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 2) {\r\n      Display = [(<Subscription key={\"View2\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          var FarmName = \"Not set\"\r\n          if (this.props.firebase.firebaseUser.lastN) FarmName = this.props.firebase.firebaseUser.lastN;\r\n          this.props.precreateUserData(res, FarmName)\r\n\r\n          this.setState({\r\n            ViewState:3\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 3) {\r\n      Display = [(<FarmInformation key={\"View3\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          NavigationService.navigateAndReset('AuthStack')\r\n        }\r\n      }}/>)]\r\n    } else {\r\n      NavigationService.navigateAndReset('AuthStack')\r\n    }\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        {Display}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data})),\r\n    precreateUserData: (Subsc, FarmName) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: {state:Subsc}, Farms:{name:FarmName}, Sections:{}, Pens:{}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateNewUserData);\r\n//export default CreateNewUserData;","import React from 'react'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport LoadingUserScreen from '../Containers/Cloud/AuthScreens/UserLoadingScreen'\r\nimport LoginUserScreen from '../Containers/Cloud/AuthScreens/UserLoginScreen'\r\nimport VerifyScreen from '../Containers/Cloud/AuthScreens/VerifyScreen'\r\nimport CreateUserDataScreen from '../Containers/Cloud/AuthScreens/CreateUserDataScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    UserLoadingScreen: {\r\n      screen: LoadingUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User loading',\r\n      }),\r\n    },\r\n    LoginUser: {\r\n      screen: LoginUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Login',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n    },\r\n    VerifyScreen: {\r\n      screen: VerifyScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Verification',\r\n      }),\r\n    },\r\n    CreateUserData: {\r\n      screen: CreateUserDataScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Create Data',\r\n      }),\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserLoadingScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerLeft: () => (\r\n        <View style={{padding:6, paddingLeft: 15}}>\r\n          <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n        </View>\r\n      ),\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const firebase = this.props.firebase;\r\n\r\n    const IsLoading = firebase.firebaseIsLoading\r\n    const firebaseErrorMessage = firebase.firebaseErrorMessage\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseUser = firebase.firebaseUser\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"Dashboard\", \"Pens\", \"Batchs\", \"Growth curves\", \"Operations\", \"AutoPigs\", \"Feeding\", \"Pigs\"]}\r\n            Images={[Images.DashBoard, Images.Pens, Images.Section, Images.GCurves, Images.System, Images.AutoPig, Images.Feed, Images.Sow ]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"Dashboard\":\r\n                  NavigationService.navigate(\"UserDashBoard\")\r\n                  break;\r\n                case \"Pens\":\r\n                  NavigationService.navigate(\"UserPens\")\r\n                  break;\r\n                case \"Batchs\":\r\n                  NavigationService.navigate(\"UserBatchs\")\r\n                  break;\r\n                case \"Growth curves\":\r\n                  NavigationService.navigate(\"UserCurves\")\r\n                  break;\r\n                case \"Operations\":\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                  break;\r\n                case \"AutoPigs\":\r\n                  break;\r\n                case \"Feeding\":\r\n                  break;\r\n                case \"Pigs\":\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                  break;\r\n              }\r\n            }}\r\n          />\r\n          \r\n          {firebaseUser && firebaseUser.state === \"admin\"?(<></>):(\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { DataRefs, Actions, GetBatchEnd, CurvePredict, GetCurve_FromBatch, GetStats_FromBatch  } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, ContentProp, ProgressBar } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Name, Manager, Mail, SectionsList, BatchList, MaxCap, CurCap} = this.setData(props)\r\n    this.state = {\r\n      farmName: Name,\r\n      farmManager: Manager,\r\n      farmMail: Mail, \r\n\r\n      BatchList: BatchList,\r\n\r\n      MaxCap:MaxCap, \r\n      CurCap:CurCap,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    var Name = \"Not set\"\r\n    var Manager = \"Not set\"\r\n    var Mail = \"Not set\"\r\n\r\n    if (localDataStore && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n      Name = Farm.name?Farm.name: Name\r\n      Manager = Farm.name?Farm.manager: Manager\r\n      Mail = Farm.name?Farm.email: Mail\r\n    }\r\n\r\n    var BatchList = {}//localDataStore.batchs\r\n    var MaxCap = 0;\r\n    var CurCap = 0;\r\n\r\n    if (localDataStore.batchs) {\r\n      Object.keys(localDataStore.batchs).filter(e => e !== '__jsogObjectId' && e !== 'update_time').map((BatchID) => {\r\n        var Batch = localDataStore.batchs[BatchID]\r\n        var Data = GetStats_FromBatch(Batch, localDataStore)\r\n        if (Data) {\r\n          var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = Data\r\n          \r\n          if (Batch.pens) {\r\n            MaxCap += Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).length * 1;\r\n          }\r\n          CurCap += Animals;\r\n\r\n          Batch.count = Animals\r\n          Batch.weight = AverageWeight\r\n          Batch.target = TargetWeight\r\n          Batch.End = EndDate\r\n\r\n          BatchList[BatchID] = Batch\r\n        }\r\n      })\r\n    }\r\n\r\n    if (MaxCap === 0) MaxCap++;\r\n    return { Name, Manager, Mail, BatchList, MaxCap, CurCap }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getFarm()\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getBatch()\r\n    this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore && prevProps.firebase.localDataStore) {\r\n        const firebaseUser = this.props.firebase.firebaseUser\r\n        const localDataStore = this.props.firebase.localDataStore;\r\n\r\n        if (localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n          var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n          if ((this.state.farmName !== Farm.name || this.state.farmManager !== Farm.manager || this.state.farmMail !== Farm.email) ||\r\n              localDataStore.batchs && JSON.stringify(this.state.BatchList) !== JSON.stringify(localDataStore.batchs) ||\r\n              localDataStore.graphs && localDataStore.graphs !== prevProps.firebase.localDataStore.graphs) {\r\n            const {Name, Manager, Mail, BatchList, MaxCap, CurCap} = this.setData(this.props)\r\n            this.setState({\r\n              farmName: Name,\r\n              farmManager: Manager,\r\n              farmMail: Mail,\r\n        \r\n              BatchList: BatchList,\r\n\r\n              MaxCap:MaxCap, \r\n              CurCap:CurCap,\r\n            }, () => {\r\n              this.forceUpdate()\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var FarmProgress = 0\r\n    if (this.state.BatchList) {\r\n      var BatchList = Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))\r\n      BatchList.forEach(element => {\r\n        var Batch = this.state.BatchList[element]\r\n        FarmProgress += (Batch.weight/Batch.target)*100;\r\n      });\r\n      FarmProgress = (FarmProgress/(100*BatchList.length))*100\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n            <TitleElement Text=\"Farm description\"/>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.fullWidth, {height:110,}]}>\r\n              <ContentProp texts={[\"Farm name\", \"Manager\", \"E-mail\"]} datas={[this.state.farmName, this.state.farmManager, this.state.farmMail ]} />\r\n            </View>\r\n            <View style={{height:20}}/>\r\n            <ProgressBar text={\"Farm capacity: \" + this.state.CurCap + \" of \" + this.state.MaxCap} progress={(this.state.CurCap/this.state.MaxCap) * 100 }/>\r\n            <ProgressBar text={\"Farm performance:\"} progress={FarmProgress}/>\r\n\r\n            {this.state.BatchList?(\r\n              <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, marginTop:10}]}>\r\n                <Text>Batches:</Text>\r\n                <FlatList\r\n                  data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && \r\n                                                                (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))}\r\n                  renderItem={({item, i}) => {\r\n                    var Batch = this.state.BatchList[item]\r\n                    var TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n                    var End = GetBatchEnd(Batch, TempCurve)\r\n                    var EndDate = Batch.End;\r\n                    var Color = Colors.AgriGreen\r\n                    if (EndDate > End) Color = Colors.error\r\n                    var count = Batch.count\r\n                    if (!count) count = 0\r\n                    var progress = (Batch.weight/Batch.target)*100;\r\n\r\n                    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n                    var StartDate = new Date(Batch.time).getDate() + \"/\" + (new Date(Batch.time).getMonth() +1) + \"/\" + new Date(Batch.time).getFullYear()\r\n                    return(\r\n                      <ProgressBar text={item + \" Startdate: \" + StartDate + \" EndForcast: \" + EndDate + \", \" + count + \" pigs\"} progress={progress} color={Color}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <Button Text=\"Clear local datastore\"\r\n              onPress={() => {\r\n                this.props.clearDataMem()\r\n                this.getData()\r\n              }}/>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\r\n//export default Dashboard;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  loading: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  inputContainer: {\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n  \r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pigs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {PigsList} = this.setData(props)\r\n    this.state = {\r\n      PigsList: PigsList,\r\n      PigTag: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    this.props.getPigs()\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var PigsList = null\r\n    if (localDataStore && localDataStore.pigs) {\r\n      PigsList = sortObject(localDataStore.pigs)\r\n    }\r\n    \r\n    return {PigsList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.pigs && JSON.stringify(this.state.PigsList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.pigs))) {\r\n            const {PigsList} = this.setData(this.props)\r\n            this.setState({\r\n              PigsList: PigsList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    const connectedDevice = null\r\n    const connectedState = null\r\n    const DeviceData = null\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            <Device_Display connectedState={connectedState}/>\r\n            <Scanner_Display DeviceData={DeviceData}/>\r\n            {this.state.PigsList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.PigsList)}\r\n                    renderItem={({item})=>{\r\n                      var Pen = \"-\"\r\n                      var Section = \"-\"\r\n                      if (this.state.PigsList[item].pen && this.state.PigsList[item].pen != 0) {\r\n                        Pen = this.state.PigsList[item].pen\r\n                        if (localDataStore.pens && localDataStore.pens[Pen]){\r\n                          var PenData = localDataStore.pens[Pen];\r\n                          Section = PenData.section;\r\n                        }\r\n                      }\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={item} itemStyle={[{height:35,}]} onPress={() => {\r\n                              this.props.setData(item, Section, Pen)\r\n                              NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={Pen} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={Section} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={item => \"PigTag_\" + item}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"Pig-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  PigTag: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.PigTag\r\n              }\r\n            />\r\n            <OperationsPanel pig={true} pigTag={this.state.PigTag} PigsList={this.state.PigsList} />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getPigs: (tagId = null) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PIGS, {TagId: tagId})),\r\n    setData: (pigId, Section, Pen) => dispatch(FirebaseActions.setCurrentData({pigId:pigId, type:DataRefs.PIGS, section:Section, dataId:Pen})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pigs);\r\n//export default Pigs;\r\n\r\n//TODO extract to own component also used in DataDisplay\r\nconst Device_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    return(\r\n      <View style={[Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.rowCenter, ]}>\r\n        <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowMain]}>\r\n          <View style={[Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, {maxWidth:150}]}>\r\n            {props && props.connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst Scanner_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    const dispatch = useDispatch()\r\n    const DeviceData = (props && props.DeviceData)?props.DeviceData:null\r\n    return(\r\n      <View style={{flexDirection: 'row',justifyContent: 'space-between', borderWidth:1, borderColor:'#000', borderRadius: 25, paddingHorizontal:15, paddingVertical:10, marginBottom:10}}>\r\n        <View style={Style.textContainer, {paddingTop: 10}}>\r\n          {\r\n            // App scanners data\r\n          }\r\n          {DeviceData&&DeviceData.tagid? (\r\n          <View style={{marginBottom:5}}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData&& DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={{marginBottom:5}}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {DeviceData&& DeviceData.tagid ? (\r\n          <View style={{flexDirection: 'row',justifyContent: 'space-between'}}>\r\n            {known ?(\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Open data\" onPress={() => {\r\n              dispatch(FirebaseActions.setCurrentData({pigId:known, type:DataRefs.PIGS}))\r\n              NavigationService.navigate(\"DataDisplay\")\r\n            }}/>\r\n            ):(<></>)}\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Save Tag\" onPress={() => {\r\n              //dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {FarmId: Object.keys(localDataStore.userData.farms)[0]}))\r\n            }}/>\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList, TouchableOpacity, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nimport { SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pens extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Weighings, Mid} = this.setData(props)\r\n    this.state = {\r\n      Mid: Mid,\r\n      Sections: Sections,\r\n      Weighings: Weighings\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var Sections = {}\r\n    if (localDataStore && localDataStore.sections) {\r\n      Sections = sortObject(Props.firebase.localDataStore.sections)\r\n    }\r\n\r\n    var Mid = 0;\r\n    var Weighings = {}\r\n    if (localDataStore && localDataStore.weighings) {\r\n      Weighings = localDataStore.weighings\r\n      for (const property in localDataStore.weighings) {\r\n        if (localDataStore.weighings[property] && Object.keys(localDataStore.weighings[property]).length > 0){\r\n          var weight = localDataStore.weighings[property][Object.keys(localDataStore.weighings[property])[0]].weight\r\n          if (weight){\r\n            if (Mid > 0){\r\n              Mid = ((Mid + weight)/2)\r\n            } else {\r\n              Mid = (Mid + weight)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return {Sections, Weighings, Mid}\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    if (!localDataStore.weighings) localDataStore.weighings = {}\r\n    if (!localDataStore.batchs) localDataStore.batchs = {}\r\n    if (!localDataStore.graphs) localDataStore.graphs = {}\r\n\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n    this.props.getWeights(localDataStore.weighings.update_time, localDataStore.sections)\r\n\r\n    this.props.getBatch(localDataStore.batchs.update_time)\r\n    this.props.getCurve(localDataStore.graphs.update_time)\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) ||\r\n            (this.props.firebase.localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.weighings)))\r\n        ) {\r\n          const {Sections, Mid} = this.setData(this.props)\r\n          this.setState({\r\n            Mid: Mid,\r\n            Sections: Sections\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.fullSize, Helpers.fill]}>\r\n          {this.state.Sections? (\r\n            <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n              <SectionGrid\r\n                itemDimension={70}\r\n                spacing={10}\r\n                sections={\r\n                  Object.keys(this.state.Sections).filter(e => e !== 'update_time').map((Section) => {\r\n                    var Pens = sortObject(this.state.Sections[Section].pens)\r\n                    return(\r\n                      {\r\n                        title: Section,\r\n                        data: Object.keys(Pens)\r\n                      }\r\n                    )\r\n                  })\r\n                }\r\n\r\n                renderSectionHeader={({ section }) => (\r\n                  <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:0}]}>\r\n                    <Button Text={section.title} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                      onPress={() => {} }/>\r\n                  </View>\r\n                )}\r\n\r\n                renderItem={({ item }) => {\r\n                  var color = Colors.gray\r\n                  var displayWeight = null\r\n\r\n                  var Predict = CurvePredict(localDataStore, item)\r\n                  if (Predict != null) color = Colors.pigpink\r\n                  if (Predict && Predict.Now) {\r\n                    var Batch = Predict.Batch  //Mabye optain batch self ??\r\n\r\n                    var devianceMin = 2\r\n                    var devianceMax = 5\r\n                    if (Batch.datas.devianceMin) {\r\n                      devianceMin = Batch.datas.devianceMin\r\n                    }\r\n                    if (Batch.datas.devianceMax) {\r\n                      devianceMax = Batch.datas.devianceMax\r\n                    }\r\n                    var ExValue = Predict.TempEx\r\n                    var Weight = Predict.Now;\r\n                    var devianceValMin = (ExValue/100)* devianceMin\r\n                    var devianceValMax = (ExValue/100)* devianceMax\r\n                    if (ExValue && Weight < ExValue && Weight < ExValue - devianceValMin) {\r\n                      color = Colors.error\r\n                    } else if (ExValue && Weight > ExValue && Weight > ExValue + devianceValMax) {\r\n                      color = Colors.overest\r\n                    } else {\r\n                      color = Colors.success\r\n                    }\r\n                    displayWeight = Math.round(Weight * 100) / 100\r\n                  }\r\n\r\n                  return(\r\n                    <TouchableOpacity style={[Helpers.borderContainer, {width:70, height:70, alignItems:\"center\", justifyContent:\"center\", backgroundColor:color}]}\r\n                      onPress={() => {\r\n                        this.props.setCurrentData(item)\r\n                        NavigationService.navigate(\"DataDisplay\")\r\n                      }}>\r\n                      <Text>{item}</Text>\r\n                      {displayWeight?(<Text>{displayWeight + \" kg\"}</Text>):(<></>)}\r\n                    </TouchableOpacity>\r\n                  )\r\n                }}\r\n              />\r\n            </ScrollView>\r\n          ):(\r\n            <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n              <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n            </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n    getCurve: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\", DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pens);\r\n//export default Pens;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, GetStats_FromBatch, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, CustomListItem, Datetime_Picker } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport Icon from 'react-native-vector-icons/MaterialIcons'\r\nimport SectionedMultiSelect from 'react-native-sectioned-multi-select'\r\n\r\n//import moment from 'moment';\r\n//import SimplerDatePicker from '@cawfree/react-native-simpler-date-picker';\r\n//import DatePicker from 'react-native-simple-date-picker';\r\n\r\n//import DateTimePicker from '@react-native-community/datetimepicker';\r\n\r\n//Genneral test for submodule merge (please delete this line)\r\n\r\nimport SelectBox from 'react-native-multi-selectbox'\r\nimport { xorBy } from 'lodash'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Batchs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {BatchList, freePens} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      BatchList: BatchList,\r\n\r\n      Display: 0,\r\n\r\n      BatchName: \"\",\r\n      ShowPicker: false,\r\n      StartD: new Date().getTime(),\r\n      Curve: \"\",\r\n      DevianceMin: \"\",\r\n      DevianceMax: \"\",\r\n\r\n      freePens: freePens,\r\n      avaiblePens: freePens,\r\n      selectedPens: [],\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var BatchList = localDataStore.batchs\r\n    \r\n    var freePens = []\r\n    if (BatchList && localDataStore.sections) {\r\n      Object.keys(localDataStore.sections).forEach(section => {\r\n        if (localDataStore.sections[section].pens) {\r\n          var pens = []\r\n          Object.keys(localDataStore.sections[section].pens).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').forEach(pen => {\r\n            var add = true\r\n            Object.keys(BatchList).forEach(batch => {\r\n              if (!BatchList[batch].state || BatchList[batch].state !== \"Closed\") {\r\n                if (BatchList[batch].pens && BatchList[batch].pens[pen] && !BatchList[batch].pens[pen].enddate) {\r\n                  add = false;\r\n                }\r\n              }\r\n            });\r\n            if (add) {\r\n              var item = {\r\n                item: pen,\r\n                id: section + \"_\" + pen\r\n              }\r\n              freePens.push(item)\r\n            }\r\n          })\r\n        }\r\n      });\r\n    }\r\n    return { BatchList, freePens }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getBatch(localDataStore.batchs?localDataStore.batchs.update_time:null)\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.batchs && JSON.stringify(this.state.BatchList)!==JSON.stringify(this.props.firebase.localDataStore.batchs)) ||\r\n            (this.props.firebase.localDataStore.pens && JSON.stringify(this.state.pens)!==JSON.stringify(this.props.firebase.localDataStore.pens))) {\r\n          const {BatchList, freePens} = this.setData(this.props)\r\n          this.setState({\r\n            freePens: freePens,\r\n            BatchList: BatchList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  onMultiChange = (item) => {\r\n    var items = xorBy(this.state.selectedPens, [item], 'id')\r\n    this.setState({\r\n      selectedPens: items\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {this.state.Display === 0?(\r\n              //#region Normal Front View to display all batches.\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.BatchList ? (\r\n                  <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                    <FlatList scrollEnabled={true} style={[Helpers.fill]}\r\n                      data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                      renderItem={({item, i})=>{\r\n                        var name = item;\r\n                        if (this.state.BatchList[item] && this.state.BatchList[item].state && this.state.BatchList[item].state === \"Closed\") {\r\n                          name += \"  Closed\"\r\n                        }\r\n                        return(\r\n                          <Button Text={name} onPress={() => {\r\n                            var curveId = \"default\"\r\n                            if (this.state.BatchList[item] && this.state.BatchList[item].gcurve) {\r\n                              curveId = this.state.BatchList[item].gcurve\r\n                              if (typeof curveId !== 'string') curveId = null\r\n                            }\r\n                            this.props.setCurrentData(item, curveId)\r\n                            \r\n                            NavigationService.navigate('DataPlotter')\r\n                          }}/>\r\n                        )\r\n                      }}\r\n                      keyExtractor={(item, index) => index.toString()}\r\n                    />\r\n                  </View>\r\n                ):(<></>)}\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n                  <Button Text={\"New Batch\"} onPress={() => {\r\n                    var graph = 0\r\n                    if (localDataStore && localDataStore.graphs) {\r\n                      graph = Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time')[0]\r\n                    }\r\n                    this.setState({\r\n                      Display: 1,\r\n\r\n                      DevianceMin: String(2),\r\n                      DevianceMax: String(2),\r\n                      Curve: graph,\r\n\r\n                      freePens: this.state.freePens,\r\n                      avaiblePens: this.state.freePens,\r\n                      selectedPens: [],\r\n                    })\r\n                  }}/>\r\n                  {this.state.BatchList?(\r\n                  <Button Text={\"Edit or Close Batch\"} onPress={() => {\r\n                    var batchName = Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      )[0]\r\n                    var batch = this.state.BatchList[batchName]\r\n                    if (batch) {\r\n                      var Pens = []\r\n                      var pens = sortObject(batch.pens)\r\n                      Object.keys(pens).forEach(element => {\r\n                        if (!batch.pens[element].enddate) {\r\n                          if (localDataStore.pens && localDataStore.pens[element]){\r\n                            var _pen = localDataStore.pens[element]\r\n                            var item = {}\r\n                            item.item = element;\r\n                            item.id = _pen.section + \"_\" + element;\r\n                            Pens.push(item)\r\n                          }\r\n                        }\r\n                      });\r\n\r\n                      this.setState({\r\n                        Display: 2,\r\n                        BatchName: batchName,\r\n                        StartD: batch.time,\r\n                        Curve: batch.gcurve,\r\n                        DevianceMin: String(batch.datas.devianceMin),\r\n                        DevianceMax: String(batch.datas.devianceMax),\r\n                        avaiblePens: this.state.freePens.concat(Pens),\r\n                        selectedPens: Pens\r\n                      })\r\n                    }\r\n                  }}/>):(<></>)}\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            ):(\r\n              //#region Edit or create\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.Display === 1?( // Create\r\n                  <Input label={\"BatchName\"}\r\n                    containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, ]}\r\n                    onChangeText={text => {\r\n                      if (text){\r\n                        if (DataStringCheck(text)){\r\n                          this.setState({BatchName: text})\r\n                        }\r\n                      }else {\r\n                        this.setState({BatchName: text})\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.BatchName\r\n                    }\r\n                  />\r\n                ):( // Edit\r\n                  <View style={[Helpers.borderContainer, Helpers.fullWidth, {height:60, borderRadius:0, alignItems:\"center\"}]}>\r\n                    <Picker\r\n                      mode=\"dropdown\"\r\n                      selectedValue={this.state.BatchName}\r\n                      style={[Helpers.fullWidth, { height: 50, justifyContent:\"flex-end\"}]}\r\n                      onValueChange={(itemValue, itemIndex) => {\r\n                        if (this.state.BatchList && this.state.BatchList[itemValue]) {\r\n                          var batch = this.state.BatchList[itemValue]\r\n\r\n                          var Pens = []\r\n                          var pens = sortObject(batch.pens)\r\n                          Object.keys(pens).forEach(element => {\r\n                            if (!batch.pens[element].enddate) {\r\n                              if (localDataStore.pens && localDataStore.pens[element]){\r\n                                var _pen = localDataStore.pens[element]\r\n                                var item = {}\r\n                                item.item = element;\r\n                                item.id = _pen.section + \"_\" + element;\r\n                                Pens.push(item)\r\n                              }\r\n                            }\r\n                          });\r\n\r\n                          this.setState({\r\n                            BatchName: itemValue,\r\n                            StartD: batch.time,\r\n                            Curve: batch.gcurve,\r\n                            DevianceMin: String(batch.datas.devianceMin),\r\n                            DevianceMax: String(batch.datas.devianceMax),\r\n                            avaiblePens: this.state.freePens.concat(Pens),\r\n                            selectedPens: Pens,\r\n                          })\r\n                        }\r\n                      }}\r\n                    >\r\n                      {Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      ).map((graph, i) => {\r\n                        return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                      })}\r\n                    </Picker>\r\n                  </View>\r\n                )}\r\n                <View style={[Helpers.fullWidth, App?{}:Helpers.row, {zIndex:999}]}>\r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1 , marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Start date:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, App?{marginBottom:10}:{},{alignItems:'flex-start',}]}>\r\n                      <Datetime_Picker Selected={this.state.StartD}\r\n                        onValueChange={(date)=>{\r\n                          this.setState({\r\n                            StartD: date.getTime()\r\n                          })\r\n                      }}/>\r\n                    </View>\r\n                  </View>\r\n                  \r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Growth curve:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"center\"}]}>\r\n                      <Picker\r\n                        mode=\"dropdown\"\r\n                        selectedValue={this.state.Curve}\r\n                        style={[Helpers.fullWidth, {height: 30}]}\r\n                        onValueChange={(itemValue, itemIndex) => {\r\n                          this.setState({\r\n                            Curve: itemValue\r\n                          })\r\n                        }}\r\n                      >\r\n                        {Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').map((graph, i) => {\r\n                          return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                        })}\r\n                      </Picker>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, Helpers.row]}>\r\n                  <Input label={\"Deviance Min alert procentage\"}\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (isNaN(text)) {\r\n                        if (!text.endsWith(\".\")) return;\r\n                      }\r\n                      this.setState({\r\n                        DevianceMin: text\r\n                      })\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMin\r\n                    }\r\n                  />\r\n                  <Input label={\"Deviance Max alert procentage\"}\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (isNaN(text)) {\r\n                        if (!text.endsWith(\".\")) return;\r\n                      }\r\n                      this.setState({\r\n                        DevianceMax: text\r\n                      })\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMax\r\n                    }\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {borderWidth:1, marginTop:10, paddingHorizontal:10, paddingTop:5}]}>\r\n                  <SelectBox\r\n                    label=\"Pens in Batch..\"\r\n                    labelStyle={{color:Colors.input, fontSize: 15, fontWeight: \"bold\"}}\r\n                    optionsLabelStyle={{minWidth:100, color:\"black\", fontSize: 12, fontWeight: \"bold\"}}\r\n\r\n                    options={this.state.avaiblePens}\r\n                    selectedValues={this.state.selectedPens}\r\n                    onMultiSelect={this.onMultiChange}\r\n                    onTapClose={this.onMultiChange}\r\n                    isMulti\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                  {this.state.Display === 2?(\r\n                    <Button Text={\"Close Batch\"} onPress={() => {\r\n                      var Batch = localDataStore.batchs[this.state.BatchName];\r\n                      if (Batch) {\r\n                        var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = GetStats_FromBatch(Batch, localDataStore)\r\n                        if (Animals){\r\n                          this.props.setViewError(\"The batch still contains active pens, please clear pens before closing the batch\")\r\n                        }else {\r\n                          var newBatch = {name:this.state.BatchName, state:\"Closed\"}\r\n                          this.props.updateBatch(newBatch)\r\n                          this.setState({\r\n                            Display: 0\r\n                          })\r\n                          this.props.getPens(localDataStore.pens.update_time)\r\n                        }\r\n                      }\r\n                    }}/>\r\n                  ):(\r\n                    <></>\r\n                  )}\r\n                  <Button Text={\"Save\"} onPress={() => {\r\n                    var update = true;\r\n\r\n                    if (this.state.BatchName !== \"\") {\r\n                      var Name = this.state.BatchName;\r\n                      if (!Object.keys(this.state.BatchList).includes(Name)){\r\n                        if (this.state.Display === 2) { // update on non existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch does not exists\")\r\n                        }\r\n                      } \r\n                      else {\r\n                        if (this.state.Display === 1) { // create on allready existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch allready exists\")\r\n                        }\r\n                      }\r\n                    } else {\r\n                      update = false \r\n                      this.props.setViewError(\"BatchName error\")\r\n                    }\r\n\r\n                    if (this.state.StartD !== \"\") {\r\n                      /*var StartD = this.state.StartD.split(\".\")\r\n                      if (StartD.length !== 3 || StartD[0].length !== 4 || isNaN(StartD[0]) || \r\n                                                (StartD[1].length <= 0 && StartD[1].length >= 3) || isNaN(StartD[1]) ||\r\n                                                (StartD[2].length <= 0 && StartD[2].length >= 3)|| isNaN(StartD[2])) {\r\n                        update = false \r\n                        this.props.setViewError(\"Startdate error\")\r\n                      }*/\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"Startdate error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMin !== \"\") {\r\n                      var Dev = this.state.DevianceMin\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMin setting error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMax !== \"\") {\r\n                      var Dev = this.state.DevianceMax\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMax setting error\")\r\n                    }\r\n\r\n                    if (this.state.Curve === \"\"){\r\n                      update = false \r\n                      this.props.setViewError(\"Growth curve setting error, please reselect a curve\")\r\n                    }\r\n\r\n                    var Pens = {}\r\n                    if (this.state.selectedPens && this.state.selectedPens.length > 0) {\r\n                      this.state.selectedPens.forEach(element => {\r\n                        Pens[element.item] = true\r\n                      });\r\n                    }\r\n                    if (Object.keys(Pens).length !== this.state.selectedPens.length) {\r\n                      update = false\r\n                      this.props.setViewError(\"An error occurred during Pen assigning (please update the page)\")\r\n                    }\r\n\r\n                    if (update) {\r\n                      this.props.setViewLoading(true)\r\n                      var _Date = new Date(this.state.StartD)\r\n                      var StartD = new Date(_Date.getFullYear(), _Date.getMonth(), _Date.getDate()).getTime()\r\n                      var newBatch = {name:this.state.BatchName, gcurve:this.state.Curve, pens:Pens, time: StartD, datas:{devianceMin: this.state.DevianceMin, devianceMax: this.state.DevianceMax}}\r\n                      if (this.state.Display === 1) {\r\n                        this.props.setBatch(newBatch)\r\n                      }\r\n                      else if (this.state.Display === 2) {\r\n                        this.props.updateBatch(newBatch)\r\n                      }\r\n                      this.setState({\r\n                        Display: 0\r\n                      })\r\n                      this.props.getPens(localDataStore.pens.update_time)\r\n                      this.props.setViewError(null)\r\n                      this.props.setViewLoading(false)\r\n                    }\r\n                  }}/>\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            )}\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, { DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.BATCHS, {Batch: batch})),\r\n    updateBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.BATCHS, {BatchId: batch.name, Batch: batch})),\r\n    \r\n    setCurrentData: (batchId, curveId) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, batchId:batchId, curveId: curveId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Batchs);\r\n//export default Batchs;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, GetCurve_FromBatch, AccumulateTime, get_DataSpot, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\n\r\nfunction getRandomNumber(low, high) {\r\n  var r = Math.floor(Math.random() * (high - low + 1)) + low;\r\n  return r;\r\n}\r\n\r\nfunction getRandomColor() {\r\n  var red_range = [10, 250];\r\n  var green_range = [10, 250];\r\n  var blue_range = [10, 250];\r\n  var a_range = [0.2, 1];\r\n\r\n  var red = getRandomNumber(red_range[0], red_range[1]);\r\n  var green = getRandomNumber(green_range[0], green_range[1]);\r\n  var blue = getRandomNumber(blue_range[0], blue_range[1]);\r\n\r\n  var alpha = getRandomNumber(a_range[0] * 100, a_range[1] * 100) / 100;\r\n\r\n  return {\r\n    r: red,\r\n    g: green,\r\n    b: blue,\r\n    a: alpha,\r\n    rgbaValue: 'rgba(' + red + ',' + green + ',' + blue + ',' + alpha + ')'\r\n  }\r\n}\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nfunction WeightsToGraphData(localDataStore, Batch, TempGraph = null, StartDate = undefined, _EndDate = undefined, Prediction = false) {\r\n  var DataSets = []\r\n  var EndDate = 0;\r\n\r\n  var DoPredict = (Batch && (!Batch.state || Batch.state !== \"Closed\"))?true:false\r\n  var Legends = []\r\n  if (Batch.pens) Legends = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId')).reverse()\r\n  Legends.forEach(Pen => {\r\n    var BatchPen = Batch.pens[Pen]\r\n    var color = getRandomColor();\r\n\r\n    var DataSet = []\r\n    var DataSetX = []\r\n\r\n    if (localDataStore.weighings[Pen] || (Batch.state && Batch.state === \"Closed\")) {\r\n      var PenWeighings = localDataStore.weighings[Pen];\r\n      if (Batch.state && Batch.state === \"Closed\") {\r\n        PenWeighings = Batch.closed.weighings[Pen]\r\n      }\r\n\r\n      if (PenWeighings && Object.keys(PenWeighings).length >= 1) {\r\n        Object.keys(PenWeighings).sort(function(a, b) {\r\n          return PenWeighings[a].time - PenWeighings[b].time;\r\n        }).forEach(key => {\r\n          var data = PenWeighings[key]\r\n          if (data.weight) {\r\n            if ((!StartDate || data.time >= StartDate) && (!_EndDate || data.time <= _EndDate)) {\r\n              if ((!BatchPen.startdate || data.time >= BatchPen.startdate) && (!BatchPen.enddate || data.time <= BatchPen.enddate)) {\r\n                var weight = data.weight\r\n                if (data.count) {\r\n                  weight = weight / data.count\r\n                }\r\n                DataSet.push(weight)\r\n                var Time = new Date(data.time)\r\n                //Time = new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime() // allows midday placement\r\n                DataSetX.push(Time)\r\n                if (!_EndDate && data.time > EndDate) {\r\n                  EndDate = data.time\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n\r\n        if (DoPredict && Prediction) {\r\n          var Predict = CurvePredict(localDataStore, Pen)\r\n          if (Predict && Predict.lastWeighing) {\r\n            var Time = Predict.FirstSpot?new Date(Predict.FirstSpot):new Date(Predict.lastWeighing.time)\r\n            //var DatePredict = []\r\n            //var DataPredicttX = []\r\n            Predict.data.forEach((element,index) => {\r\n              DataSet.push(element)\r\n              Time = (index===0&&Predict.FirstSpot)?Time:AccumulateTime(Time, TempGraph.periode)\r\n              DataSetX.push(Time)\r\n              //DataSetX.push(new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime())\r\n            });\r\n            //if (Predict.length > 0){\r\n            //  DataSets.push({Pen: Pen + \"_Predict\", data: DatePredict, dataX: DataPredictX, color:(opacity = 0) => color.rgbaValue})\r\n            //}\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    while(DataSet.length < TempGraph.data.length) {\r\n      DataSet.push(null)\r\n      DataSetX.push(null)\r\n    }\r\n    DataSets.push({Pen: Pen, data: DataSet, dataX: DataSetX, color:(opacity = 1) => color.rgbaValue})\r\n  });\r\n  return {DataSets, EndDate};\r\n}\r\n\r\nclass CurveElement extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (!this.props.Display) {\r\n      const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(props)\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n\r\n        TempGraph: TempGraph,\r\n        Legends: Legends,\r\n        DataSets: DataSets,\r\n        StartDate: StartDate,\r\n        EndDate: EndDate,\r\n\r\n        Labels: [],\r\n        ActiveIndex: 0,\r\n        ActiveLength: \"Batch\",\r\n        ActiveDataSets: DataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n\r\n        ViewPoint: null,\r\n      }\r\n    } else {\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n      }\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var TempGraph = {periode:\"Weeks\", data: []} //Template Graph\r\n    var Legends = []     //Name lables\r\n    var DataSets = []    //Data Points\r\n\r\n    var D = new Date()\r\n    var StartDate = D.getTime()\r\n    var EndDate = new Date(D.setDate(D.getDate()+(7*8))) //Default timespand is 2 months or 8 weeks (will be changed acording to batch)\r\n\r\n    if (localDataStore && localDataStore.batchs && CurrentData && CurrentData.batchId) {\r\n      var Batch = localDataStore.batchs[CurrentData.batchId];\r\n      TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs, CurrentData.curveId)\r\n\r\n      if (TempGraph) {\r\n        if (CurrentData.curveId) TempGraph.name = CurrentData.curveId\r\n        else TempGraph.name = \"Template\"\r\n        //Find Startdate\r\n        StartDate = Batch.time\r\n        //Find Batch Pens (Legends)\r\n        if (Batch.pens) Legends = Legends.concat(Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')))\r\n\r\n        var DataX = []\r\n        //#region Find Template X values and EndDate\r\n        if (!TempGraph.periode){\r\n          TempGraph.periode = \"Weeks\"\r\n        }\r\n        var currentTime = new Date(StartDate)\r\n        for (var i = 0; i < TempGraph.data.length; i++) {\r\n          DataX.push(currentTime.getTime())\r\n          if (i < TempGraph.data.length -1) {\r\n            currentTime = new Date(AccumulateTime(currentTime, TempGraph.periode))\r\n          }\r\n        }\r\n        EndDate = currentTime.getTime();\r\n        DataX.push(EndDate)\r\n        //#endregion\r\n        \r\n        //Set TempGraph data\r\n        DataSets.push({\r\n          data: TempGraph.data,\r\n          dataX: DataX,\r\n          color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`, // optional\r\n        })\r\n\r\n        //Find DataSets from Legends\r\n        if (localDataStore.weighings) {\r\n          var TempData = DataSets\r\n          var TempEndDate = EndDate\r\n          var NextEnd = new Date(AccumulateTime(new Date(TempEndDate), TempGraph.periode)).getTime()\r\n          var {DataSets, EndDate} = WeightsToGraphData(localDataStore, Batch, TempGraph, StartDate, NextEnd, this.props.Predict)\r\n          DataSets = TempData.concat(DataSets)\r\n\r\n          if (TempEndDate > EndDate) {\r\n            EndDate = TempEndDate\r\n          }\r\n\r\n          Legends = Legends.filter(e => (e !== '__jsogObjectId' && (e === TempGraph.name || DataSets.some(i => i.Pen === e))));\r\n          Legends.unshift(TempGraph.name)\r\n        }\r\n      }\r\n    }\r\n    return {TempGraph, Legends, DataSets, StartDate, EndDate }\r\n  }\r\n\r\n  setGraphPeriode(ActiveLength = this.state.ActiveLength) {\r\n    var Labels = []\r\n\r\n    var StartDate = this.state.StartDate\r\n    var EndDate = this.state.EndDate\r\n    var ActiveIndex = this.state.ActiveIndex\r\n\r\n    var TemplatePeriode = \"Weeks\"\r\n    if (this.state.TempGraph && this.state.TempGraph.periode) TemplatePeriode = this.state.TempGraph.periode\r\n    var CurrentDate = new Date(StartDate)\r\n    var TempActiveDataSet = this.state.ActiveDataSets;\r\n\r\n    var Today = new Date().getTime()\r\n    switch(this.state.ActiveLength) {\r\n      case \"Days\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i-1;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n        \r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n\r\n        EndDate = CurrentDate.getTime();\r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        break;\r\n      case \"Weeks\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n\r\n        for (var i = 0; i <= 7; i++) {\r\n          Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n          EndDate = CurrentDate.getTime();\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, \"Days\"))\r\n        }\r\n        break;\r\n      case \"Batch\":\r\n      default:\r\n        while (CurrentDate.getTime() <= EndDate) {\r\n          switch (TemplatePeriode){\r\n            case \"Days\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Month\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Weeks\":\r\n            default:\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n          }\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, TemplatePeriode))\r\n        }\r\n        break;\r\n    }\r\n\r\n    var ActiveDataSets = []\r\n    if (!ActiveLength || ActiveLength === \"Batch\") {\r\n      ActiveDataSets = this.state.DataSets;\r\n    }\r\n    else {\r\n      var End = AccumulateTime(new Date(EndDate), this.state.ActiveLength).getTime()\r\n      this.state.DataSets.forEach(element => {\r\n        var NewData = {...element, data:[], dataX: []}\r\n\r\n        var first = null\r\n        var last = null\r\n        if (new Date(element.dataX[0]).getTime() <= EndDate) {\r\n          for(var i = 0; i < element.data.length; i++) {\r\n            if (new Date(element.dataX[i]).getTime() >= StartDate) {\r\n              NewData.data.push(element.data[i])\r\n              NewData.dataX.push(element.dataX[i])\r\n\r\n              var time = AccumulateTime(new Date(element.dataX[i]), this.state.ActiveLength)\r\n              if (time.getTime() > End){\r\n                if (element.dataX.length -1 >= i) last = i\r\n                break;\r\n              }\r\n            } else if (element.dataX[i] !== null) {\r\n              first = i\r\n            }\r\n          }\r\n          if (first !== null && NewData.dataX[0] > StartDate && element.data.length >= first+1) {\r\n            var DataSpot = get_DataSpot([element.dataX[first], element.dataX[first+1]], [element.data[first], element.data[first +1]], StartDate, element.data[first], element.dataX[first])\r\n            console.log(DataSpot)\r\n            NewData.data.unshift(DataSpot.ExValue)\r\n            NewData.dataX.unshift(StartDate)\r\n          }\r\n          if (last != null) {\r\n            //NewData.data.push(ExValue)\r\n            //NewData.dataX.push(StartDate)\r\n          }\r\n        }\r\n\r\n        ActiveDataSets.push(NewData)\r\n      });\r\n    }\r\n\r\n    //var lastDataPoint = this.state.DataSets[0].dataX[this.state.DataSets[0].dataX.length-1]\r\n    if (this.state.ActiveIndex > 0 && ActiveDataSets[0].data.length === 0){\r\n      var i = this.state.ActiveIndex\r\n      i = i-1;\r\n      this.setState({\r\n        ActiveIndex: i\r\n      })\r\n    } else {\r\n      this.setState({\r\n        ActiveLength: ActiveLength,\r\n        \r\n        Labels: Labels,\r\n        ActiveDataSets: ActiveDataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n        ActiveIndex: ActiveIndex,\r\n      }, () => {\r\n        this.forceUpdate()\r\n      })\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    /*if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      var WeightsMemTime = null\r\n      if (localDataStore.weighings) WeightsMemTime = localDataStore.weighings.update_time\r\n      Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n        this.props.getPen(Pen, PenMemTime)\r\n        this.props.getWeights(Pen, WeightsMemTime, localDataStore.sections)\r\n      })\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n        this.props.getCurve(TempGraph)\r\n      }\r\n    }*/\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (!this.props.Display && this.props !== prevProps) {\r\n      if (this.props.firebase.localDataStore) {\r\n        if (JSON.stringify(prevProps.firebase.localDataStore.weighings) !== JSON.stringify(this.props.firebase.localDataStore.weighings) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.pens) !== JSON.stringify(this.props.firebase.localDataStore.pens) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.graphs) !== JSON.stringify(this.props.firebase.localDataStore.graphs) || \r\n            prevProps.Predict !== this.props.Predict || \r\n            prevProps.weighings !== this.props.weighings) {\r\n          const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(this.props)\r\n          if (JSON.stringify(this.state.TempGraph)!==JSON.stringify(TempGraph) ||\r\n              JSON.stringify(this.state.Legends)!==JSON.stringify(Legends) ||\r\n              JSON.stringify(this.state.DataSets)!==JSON.stringify(DataSets) ||\r\n\r\n              JSON.stringify(this.state.StartDate)!==JSON.stringify(StartDate) ||\r\n              JSON.stringify(this.state.EndDate)!==JSON.stringify(EndDate)\r\n          ) {\r\n            this.setState({\r\n              TempGraph: TempGraph,\r\n              Legends: Legends,\r\n              DataSets: DataSets,\r\n        \r\n              StartDate: StartDate,\r\n              EndDate: EndDate,\r\n            }, () => {\r\n              this.setGraphPeriode(this.state.ActiveLength)\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (!this.props.Display && this.state !== prevState) {\r\n      if (this.state.ActiveLength != prevState.ActiveLength || this.state.ActiveIndex != prevState.ActiveIndex) {\r\n        this.setGraphPeriode(this.state.ActiveLength)\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n    if (!this.props.height) Dimensions.addEventListener(\"change\", this.onChange);\r\n    if (!this.props.Display) this.setGraphPeriode(this.state.ActiveLength)\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    if (!this.props.height) Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  render() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    var BatchIsOpen = false;\r\n    if (localDataStore.batchs && this.props.firebase.currentData && this.props.firebase.currentData.batchId) {\r\n      BatchIsOpen= ((localDataStore.batchs && localDataStore.batchs[this.props.firebase.currentData.batchId]) && (!localDataStore.batchs[this.props.firebase.currentData.batchId].state || localDataStore.batchs[this.props.firebase.currentData.batchId].state !== \"Closed\"))?true:false\r\n    }\r\n    var wide = this.state.dimensions.window.width>1000?true:false\r\n    if (this.props.Display) wide = false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    var height = this.state.dimensions.window.height //Full Screen\r\n    if (this.props.Height) {\r\n      height = this.props.Height;\r\n      //height = height - 100 // ?? beautify'er\r\n    } else {\r\n      height = 500 \r\n      /*if (Platform.OS !== 'ios' && Platform.OS !== 'android') height = height - 64 //Navigation title\r\n      height = height - 49 //TitleElement\r\n      height = height - 145 //Data Props\r\n      height = height - 71 //View Selector\r\n      if (BatchIsOpen) height = height - 74 //Editor\r\n\r\n      height = height - 100 // ?? beautify'er*/\r\n    }\r\n    //height = height - parseInt(10 + 15) //Margins \r\n\r\n    var width = this.state.dimensions.window.width * 2; //Full Screen\r\n    if (this.props.Width) {\r\n      width = this.props.Width;\r\n    } else {\r\n      width = width - (Metrics.normal * 4) // Margins\r\n      width = width / (wide?2.05:1) //If not WideScreen - Split diagram in 2\r\n    }\r\n    \r\n    var DataSets = this.props.Display?[{color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`,data:[],dataX:[]}]:this.state.ActiveDataSets\r\n    var Legends = this.props.Display?[]:this.state.Legends.slice(0, DataSets.length)\r\n    var StartDate = this.props.Display?1:this.state.ActiveStartDate\r\n    var EndDate = this.props.Display?this.props.DataPoints.length:this.state.ActiveEndDate\r\n    var Labels = [];\r\n    if (this.props.Display) {\r\n      this.props.DataPoints.forEach((point,index)=>{\r\n        DataSets[0].data.push(point.value)\r\n        DataSets[0].dataX.push(index +1)\r\n        Labels.push(index +1)\r\n      })\r\n    }else Labels = this.state.Labels\r\n\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n        <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n          <ScrollView horizontal={true} showsHorizontalScrollIndicator={wide||this.props.Display?false:true} style={[Helpers.fullSize, App&&!this.props.Display?{maxWidth:width/2, maxHeight:540}:{}]}>\r\n            {this.state.TempGraph||this.props.Display && (Labels && Labels.length > 0) && (DataSets && DataSets.length > 0)?(\r\n            <LineChart\r\n              //bezier\r\n              style={[{marginLeft: -15, minHeight: height, minWidth: width}]}\r\n              width={width}\r\n              height={height}\r\n\r\n              data={{\r\n                labels: Labels,\r\n                xMinMax: [StartDate, EndDate, Labels.length -1],\r\n                legend: Legends,\r\n                datasets: DataSets,\r\n              }}\r\n\r\n              onDataPointClick={(data) => {\r\n                this.setState({\r\n                  ViewPoint: data\r\n                })\r\n              }}\r\n\r\n              withShadow={false}\r\n              withVerticalLines={true}\r\n              fromZero={false}\r\n              segments={15} //Horizontal-Lines\r\n              \r\n              verticalLabelRotation={0} //Not Working in browser\r\n              xLabelsOffset={0}\r\n\r\n              chartConfig={{\r\n                backgroundColor: Colors.white,\r\n                backgroundGradientFrom: Colors.white,  //#FFFFFF\r\n                backgroundGradientTo: Colors.white,     \r\n                decimalPlaces: 1, // optional, defaults to 2dp\r\n                color: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`,  //Lines / Grid\r\n                labelColor: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`, //Lables\r\n                style: {\r\n                  borderRadius: 16,\r\n                  height: height,\r\n                },\r\n                propsForDots: {\r\n                  r: \"5\",\r\n                  strokeWidth: \"0.5\",\r\n                  stroke: Colors.white\r\n                }\r\n              }}\r\n            />):(<></>)}\r\n          </ScrollView>\r\n        </View>\r\n        {!this.props.Display?(\r\n          <View style={[Helpers.fullWidth, Helpers.mainCenter]}>\r\n            <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, ]}>\r\n              <View style={{paddingRight: 2.5}}>\r\n                <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  if (this.state.ActiveIndex != 0){\r\n                    var i = this.state.ActiveIndex;\r\n                    i = i-1;\r\n                    this.setState({\r\n                      ActiveIndex: i\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n              <Button Text=\"Day view\" buttonStyle={{width:wide?100:80}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Days\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Week view\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Weeks\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Full Batch\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: 0,\r\n                    ActiveLength: \"Batch\"\r\n                  })\r\n                } }/>\r\n              <View style={{paddingLeft: 2.5}}>\r\n                <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  var i = this.state.ActiveIndex;\r\n                  i = i+1;\r\n                  this.setState({\r\n                    ActiveIndex: i\r\n                  })\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            {BatchIsOpen&&!App?(\r\n              <View style={[Helpers.fullWidth, Helpers.rowCenter]}>\r\n                  <CurveEditor control={this} props={this.props} state={this.state} />\r\n              </View>\r\n            ):(<></>)}\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst CurveEditor = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    if (props.state.ViewPoint){\r\n      var TimeText = props.state.Labels[props.state.ViewPoint.index]\r\n      if (props.state.ViewPoint.dataset.dataX) {\r\n        var Time = new Date(props.state.ViewPoint.dataset.dataX[props.state.ViewPoint.index])\r\n        TimeText = Time.getFullYear() + \".\" + (Time.getMonth() +1) + \".\" + Time.getDate()\r\n      }\r\n\r\n      var Data = props.state.ViewPoint.value\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100}] }>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{TimeText}</Text>\r\n          </View>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{Data} Kg.</Text>\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n    else return(<></>)\r\n  } else {\r\n    const [Point, setPoint] = React.useState(0)\r\n    if (!props.state.TempGraph) {\r\n      return(<></>)\r\n    }\r\n    else {\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100,marginTop:10}] }>\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index -1\r\n              if (index < 0) {\r\n                index = props.state.TempGraph.data.length -1\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              type='number'\r\n              step=\"0.1\"\r\n\r\n              label={props.state.Labels[Point]}\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n\r\n              onChange= {(evt) => {\r\n                var text = evt.target.value\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  NewData[Point] = text\r\n                  \r\n                  props.control.setState({\r\n                    state: props.state,\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n                  props.control.setGraphPeriode(props.state.ActiveLength)\r\n                }\r\n              }}\r\n              /*onChangeText={text => {\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  if (text === \"\" || text === null) text = 0\r\n                  if (text.endsWith('.')) text = text + \"0\"\r\n                  NewData[Point] = parseFloat(text)\r\n                  console.log(NewData[Point], text)\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n\r\n                  props.control.forceUpdate()\r\n                }\r\n              }}*/\r\n              value={\r\n                props.state.TempGraph.data[Point]\r\n              }\r\n            />\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index +1\r\n              if (index > props.state.TempGraph.data.length -1){\r\n                index = 0\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              label=\"Curve Name\"\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n              \r\n              onChangeText={text => {\r\n                /*var name = text;\r\n                name = name.replace(' ', '_')\r\n                if (isNaN(name[0])){\r\n                  var NewLegends = props.state.Legends;\r\n                  NewLegends[0] = name\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, name: name},\r\n                    Legends: NewLegends\r\n                  })\r\n                }*/\r\n              }}\r\n              value={\r\n                props.state.TempGraph.name\r\n              }\r\n            />\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n} \r\n\r\n/*\r\n<Button Text=\"Save\" buttonStyle={{width:100, marginLeft:20}}\r\n            onPress={() => {\r\n              props.props.setCurve(props.state.TempGraph)\r\n            } }/>\r\n*/\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime, MemSections: MemSections})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CurveElement);\r\nexport {\r\n  WeightsToGraphData,\r\n}","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\nimport CurveElement from './CurveElement'\r\n\r\nclass GrowthCurve extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {CurveList} = this.setData(props)\r\n    var D = new Date()\r\n    this.state = {\r\n      CurveList: CurveList,\r\n\r\n      Display: 0,\r\n\r\n      CurveName: \"\",\r\n      DataPoints: [],\r\n      Periode: \"Weeks\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurveList = localDataStore.graphs\r\n    return { CurveList }\r\n  }\r\n\r\n  getData(){\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.graphs && JSON.stringify(this.state.CurveList)!==JSON.stringify(this.props.firebase.localDataStore.graphs)) {\r\n          const {CurveList} = this.setData(this.props)\r\n          this.setState({\r\n            CurveList: CurveList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var AverageGrowth = 0\r\n    for(var i = 0; i < this.state.DataPoints.length; i++){\r\n      var value = this.state.DataPoints[i].value\r\n      if (value === \"\" || value === null) value = 0\r\n      value = parseFloat(value)\r\n\r\n      if (i === 0) continue;\r\n      var Growth = value - this.state.DataPoints[i-1].value\r\n      AverageGrowth = (AverageGrowth + Growth) / 2\r\n    }\r\n    AverageGrowth = AverageGrowth.toFixed(3)\r\n\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {this.state.Display === 0?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n            {this.state.CurveList ? (\r\n              <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <FlatList\r\n                  data={Object.keys(this.state.CurveList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                  renderItem={({item})=>{\r\n                    return(\r\n                      <Button Text={item} onPress={() => {\r\n                        var CurveData = this.state.CurveList[item]\r\n\r\n                        var DataPoints = []\r\n                        CurveData.data.forEach(element => {\r\n                          DataPoints.push({value: element})\r\n                        });\r\n                        this.setState({\r\n                          Display: 2,\r\n                          CurveName: item,\r\n                          DataPoints: DataPoints,\r\n                          Periode: CurveData.periode\r\n                        })\r\n                      }}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n              <Button Text={\"New Curve\"} onPress={() => {\r\n                this.setState({\r\n                  Display: 1,\r\n                  DataPoints: [{value:\"0\"},{value:\"0\"}]\r\n                })\r\n              }}/>\r\n            </View>\r\n          </View>\r\n          ):(\r\n            //#region Edit or create\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n              {this.state.Display === 1?( // Create\r\n                <Input label={\"CurveName\"}\r\n                  containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                  style={[ApplicationStyles.input, ]}\r\n                  onChangeText={text => {\r\n                    if (text){\r\n                      if (DataStringCheck(text)){\r\n                        this.setState({CurveName: text})\r\n                      }\r\n                    }else {\r\n                      this.setState({CurveName: text})\r\n                    }\r\n                  }}\r\n                  value={\r\n                    this.state.CurveName\r\n                  }\r\n                />\r\n              ):( //Edit\r\n                <TitleElement Text={this.state.CurveName}/>\r\n              )}\r\n              <View style={[Helpers.fill, Helpers.fullWidth]}>\r\n                <ContentProp texts={[\"Data Points\"]} datas={[\"Periode: \" + this.state.Periode]} />\r\n                <ContentProp texts={[\"Average Growth: \" + AverageGrowth]} datas={[]} />\r\n                <View style={[Helpers.borderContainer, Helpers.fillCenter, Helpers.fullWidth, {alignSelf:'center'}]}>\r\n                  <CurveElement Display={true} DataPoints={this.state.DataPoints} Height={200} Width={455}/>\r\n                </View>\r\n                <View>\r\n                  <FlatList\r\n                    data={this.state.DataPoints}\r\n                    style={[App?styles.AppStyle:styles.WebStyle]}\r\n                    renderItem={({item, index}) => {\r\n                      return(\r\n                        <Input \r\n                          type='number'\r\n                          step=\"0.1\"\r\n\r\n                          label={\"Day: \" + (index)}\r\n                          containerStyle={[Helpers.fullWidth,{borderWidth:1, marginTop:10}]}\r\n                          style={[ApplicationStyles.input]}\r\n                          \r\n                          onChangeText={text => {\r\n                            if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                              var DataPoints = [ ...this.state.DataPoints ];\r\n                              DataPoints[index].value = text;\r\n                              this.setState({DataPoints});\r\n                            }\r\n                          }}\r\n                          value={\r\n                            \"\" + item.value\r\n                          }\r\n                        />\r\n                      )}\r\n                    }\r\n                      //Setting the number of column\r\n                      numColumns={1}\r\n                  />\r\n                </View>\r\n                <View style={{height:20}} />\r\n                <Button Text={\"New Point\"} onPress={() => {\r\n                  var DataPoints = [ ...this.state.DataPoints ];\r\n                  var value = this.state.DataPoints&&this.state.DataPoints.length >= 1?this.state.DataPoints[this.state.DataPoints.length-1].value:\"0\"\r\n                  DataPoints.push({value:value})\r\n                  this.setState({\r\n                    DataPoints\r\n                  })\r\n                }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                <Button Text={\"Save\"} onPress={() => {\r\n                  var update = true;\r\n\r\n                  if (this.state.CurveName !== \"\"){\r\n                    var Name = this.state.CurveName;\r\n                    if (!Object.keys(this.state.CurveList).includes(Name)){\r\n                      if (this.state.Display === 2) { // update on non existing\r\n                        this.props.setViewError(\"Cannot update non-existing Curve. (Please refresh)\")\r\n                        update = false \r\n                      }\r\n                    } \r\n                    else {\r\n                      if (this.state.Display === 1) { // create on allready existing\r\n                        this.props.setViewError(\"Cannot create allready existing Curve.\")\r\n                        update = false \r\n                      }\r\n                    }\r\n                  }else {\r\n                    this.props.setViewError(\"Curve template need a name.\")\r\n                    update = false\r\n                  }\r\n\r\n                  if (update) {\r\n                    this.props.setViewError(null)\r\n                    this.props.setViewLoading(true)\r\n                    var newCurve = {name:this.state.CurveName, periode:this.state.Periode}\r\n                    var Data = []\r\n                    var index = 0;\r\n                    this.state.DataPoints.forEach(element => {\r\n                      Data[index] = parseFloat(element.value)\r\n                      index++;\r\n                    });\r\n                    newCurve.data = Data;\r\n                    this.props.updateCurve(newCurve)\r\n                    \r\n                    this.setState({\r\n                      Display: 0\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            //#endregion\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  AppStyle: {\r\n    \r\n  },\r\n  WebStyle: {\r\n    height:400\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\"})),\r\n    updateCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.GRAPH, {Graph: curve})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(GrowthCurve);\r\n//export default GrowthCurve;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass Operations extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.setCurrentData({})\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, {marginBottom:60}] }>\r\n          </View>\r\n\r\n          <View style={[Helpers.buttonContainer, Helpers.halvWidth, Helpers.fillColMain]}>\r\n            <OperationsPanel section={true}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setCurrentData: actionType => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action: actionType})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Operations);\r\n//export default Operations;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Datetime_Picker } from '../../../Components'\r\nimport Style from '../CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Weighing extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      weight: \"\",\r\n      quantity: quantity,\r\n      date: new Date().getTime()\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = Sections? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.penId && Pens[CurrentData.penId] && CurrentData.penId != Pen){\r\n      Pen = CurrentData.penId\r\n    }\r\n    var quantity = 1\r\n    if (localDataStore && localDataStore.pens) {\r\n      var _Pen = localDataStore.pens[Pen]\r\n      if (_Pen && _Pen.datas && _Pen.datas.count) quantity = _Pen.datas.count\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen, quantity}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n\r\n          const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n\r\n          this.setState({\r\n            Sections: Sections,\r\n            Section: Section,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n\r\n            quantity: quantity,\r\n            weight: \"\",\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin] }>\r\n              <Button Text=\"Weighing\" buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            \r\n            <View style={[Helpers.borderContainer, Helpers.fullWidth, {marginBottom:20}] }>\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Section}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  if (this.state.Sections[itemValue]){\r\n                    const Pens = sortObject(this.state.Sections[itemValue].pens)\r\n                    var quantity = 1\r\n                    if (localDataStore && localDataStore.pens) {\r\n                      var Pen = localDataStore.pens[Object.keys(Pens)[0]]\r\n                      if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                    }\r\n                    this.setState({\r\n                      Section: itemValue,\r\n                      Pens: Pens,\r\n                      Pen: Object.keys(Pens)[0],\r\n                      quantity: quantity,\r\n                    })\r\n                  }\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Sections).map((Section, i) => {\r\n                    return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Pen}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  var quantity = 1\r\n                  if (localDataStore && localDataStore.pens) {\r\n                    var Pen = localDataStore.pens[itemValue]\r\n                    if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                  }\r\n                  this.setState({\r\n                    quantity: quantity,\r\n                    Pen: itemValue\r\n                  })\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Pens).map((Pen, i) => {\r\n                    return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <View style={[Helpers.fullWidth, {borderWidth:0 ,height: 65, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\"}]}>\r\n                <View style={[Helpers.fullWidth, {alignItems:\"flex-start\"}]}>\r\n                  <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Weight date:</Text>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {alignItems:'flex-start'}]}>\r\n                  <Datetime_Picker Selected={this.state.date}\r\n                      onValueChange={(date)=>{\r\n                        this.setState({\r\n                          date: date.getTime()\r\n                        })\r\n                    }}/>\r\n                </View>\r\n              </View>\r\n              \r\n              <Input\r\n                label=\"Animal quantity\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      quantity: text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.quantity}\r\n              />\r\n              <Input\r\n                label=\"Total Weight\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  this.setState({\r\n                    weight: text\r\n                  })\r\n                }}\r\n                value={this.state.weight}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\"\r\n                onPress={() => {\r\n                  if (!this.state.Section){\r\n                    this.props.setViewError(\"A section is needed\")\r\n                  } else if (!this.state.Pen){\r\n                    this.props.setViewError(\"A pen is needed\")\r\n                  } else if (isNaN(this.state.quantity) || this.state.quantity === \"\" || this.state.quantity <= 0){\r\n                    this.props.setViewError(\"Quantity have to be a number bigger than 0\")\r\n                  } else if (isNaN(this.state.weight) || this.state.weight === \"\") {\r\n                    this.props.setViewError(\"Weight have to be a number\")\r\n                  }\r\n                  else {\r\n                    this.props.setViewLoading(true)\r\n                    this.props.setViewError(null)\r\n                    this.props.newWeight(this.state.Pen, parseFloat(this.state.weight), this.state.date, parseFloat(this.state.quantity))\r\n                    this.setState({\r\n                      weight: \"\",\r\n                      date: new Date().getTime()\r\n                    })\r\n                  }\r\n                } }/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Weighing);\r\n//export default Weighing;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass DataEditor extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen} = this.setData(props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    \r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = (Sections&&Sections[Section])? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.dataId && Pens[CurrentData.dataId] && CurrentData.dataId != Pen){\r\n      Pen = CurrentData.dataId\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase)  {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n            \r\n            const {Sections, Section, Pens, Pen} = this.setData(this.props)\r\n\r\n            this.setState({\r\n              Sections: Sections,\r\n              Section: Section,\r\n              Pens: Pens,\r\n              Pen: Pen,\r\n              NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n            })\r\n          }\r\n        }\r\n        if (this.props.firebase.currentData) {\r\n          if (this.props.firebase.currentData != prevProps.firebase.currentData){\r\n            this.forceUpdate()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    var DataView = (<View></View>);\r\n\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = PenEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {DataView}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst PenEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <PenEditor_Titles CurrentAction={CurrentData.action}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {CurrentData.action === Actions.CREATE ?(\r\n          <Input\r\n            label=\"Pen name\"\r\n            style={{ ...Style.input}}\r\n            onChangeText={text => {\r\n              if (text){\r\n                if (DataStringCheck(text)){\r\n                  Control.setState({Pen: text})\r\n                }\r\n              }else {\r\n                Control.setState({Pen: text})\r\n              }\r\n            }}\r\n            value={Control.state.Pen}\r\n          />\r\n        ):(<></>)}\r\n        {CurrentData.action === Actions.DELETE ?(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        ):(<></>)}\r\n      </View>\r\n\r\n      {CurrentData.action === Actions.CREATE || CurrentData.action === Actions.DELETE ?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else if (!exists && CurrentData.action === Actions.DELETE){\r\n                  Control.props.setViewError(\"Cannot remove non-existing pen\")\r\n                }\r\n                else {\r\n                  Control.props.setViewError(null)\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.penAction(CurrentData.action, Control.state.Section, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n    </View>\r\n  )\r\n}\r\n\r\nconst PenEditor_Titles = (props) => {\r\n  switch(props.CurrentAction) {\r\n    case Actions.CREATE:\r\n      return(\r\n        <TitleElement Text={\"Add Pen\"}/>\r\n      )\r\n    case Actions.DELETE:\r\n      return(\r\n        <TitleElement Text={\"Remove Pen\"}/>\r\n      )\r\n    default:\r\n      return(<></>)\r\n  }\r\n}\r\n\r\nconst PigEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    //Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <TitleElement Text={\"Add Pig: \" + CurrentData.pigtag}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {Control.state.NewSection?(\r\n        <Input\r\n          label=\"Pen name\"\r\n          style={{ ...Style.input}}\r\n          onChangeText={text => {\r\n            if (text){\r\n              if (DataStringCheck(text)){\r\n                Control.setState({Pen: text})\r\n              }\r\n            }else {\r\n              Control.setState({Pen: text})\r\n            }\r\n          }}\r\n          value={Control.state.Pen}\r\n        />\r\n        ):(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        )}\r\n        {CurrentData.action === Actions.CREATE?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE && Control.state.NewSection) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else {\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.setViewError(null)\r\n                  Control.props.pigAction(CurrentData.action, CurrentData.pigtag, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst Section_Picker = ({Control, CurrentData, localDataStore}) => {\r\n  if (Control.state.NewSection && CurrentData.action === Actions.CREATE){\r\n    return(\r\n      <Input\r\n        label=\"Section Name\"\r\n        style={{ ...Style.input}}\r\n        onChangeText={text => {\r\n          if (text){\r\n            if (DataStringCheck(text)){\r\n              Control.setState({Section: text})\r\n            }\r\n          }else {\r\n            Control.setState({Section: text})\r\n          }\r\n        }}\r\n        value={Control.state.Section}\r\n      />\r\n    )\r\n  } else {\r\n    return(\r\n      <Picker\r\n        mode=\"dropdown\"\r\n        selectedValue={Control.state.Section}\r\n        style={{ height: 50, width: 150 }}\r\n        onValueChange={(itemValue, itemIndex) => {\r\n          var Section = itemValue\r\n          var NewSection = Control.state.NewSection\r\n          var Pens = Control.state.Pens\r\n          var Pen = Control.state.Pen\r\n\r\n          if (itemValue === \"New Section\"){\r\n            NewSection = true;\r\n            Section = \"Section_\" + Object.keys(Control.state.Sections).length\r\n          } else {\r\n            Pens = sortObject(Control.state.Sections[itemValue].pens)\r\n            \r\n            if (CurrentData.action === Actions.DELETE){\r\n              Pen = Object.keys(Pens)[Object.keys(Pens).length-1]\r\n            }\r\n            else {\r\n              if (CurrentData.type == DataRefs.PIGS){\r\n                Pen = Object.keys(Pens)[0]\r\n              }else {\r\n                Pen = \"Pen_\" + (Object.keys(Pens).length +1)\r\n              }\r\n            }\r\n          }\r\n          \r\n          Control.setState({\r\n            Section: Section,\r\n            NewSection: NewSection,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n          })\r\n        }}>\r\n        {Object.keys(Control.state.Sections).map((Section, i) => {\r\n            return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n        })}\r\n      </Picker>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    penAction: (action, senctionId, penId) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PENS, {SectionId:senctionId, PenId:penId})),\r\n    pigAction: (action, tagId, penId,) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PIGS, {TagId:tagId, PenId:penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataEditor);\r\n//export default DataEditor;\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pens extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n\r\n      CommentsList: CommentsList,\r\n      Comments: Comments,\r\n\r\n      action: \"\"\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pens = sortObject(localDataStore.pens)\r\n    if (Pens[CurrentData.penId]){\r\n      CurrentData.data = Pens[CurrentData.penId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    var CommentsList = [];\r\n    var Comments = [];\r\n    if (localDataStore && localDataStore.comments) {\r\n      if (localDataStore.comments[CurrentData.penId]) {\r\n        CommentsList = localDataStore.comments[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n          var name = Object.keys(CommentsList)[i]\r\n          if (!name) continue;\r\n          var object = CommentsList[name];\r\n          if (!object || !object.time) continue;\r\n          Comments.push({[name]:object})\r\n        }\r\n        Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Comments = Comments.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings, CommentsList, Comments}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n\r\n      var MemTime = null\r\n      if (localDataStore.weighings && localDataStore.weighings[this.state.currentData.penId]) MemTime = localDataStore.weighings.update_time\r\n      this.props.getWeights(this.state.currentData.penId, MemTime, localDataStore.sections)\r\n\r\n      this.props.getComments(this.state.currentData.penId)\r\n      this.props.getBatch(localDataStore.batchs.update_time)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings))) ||\r\n            (localDataStore.comments && JSON.stringify(this.state.Comments)!==JSON.stringify(sortObject(localDataStoree.comments)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n\r\n            CommentsList: CommentsList, \r\n            Comments: Comments,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      \r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        if (Predict && Predict.Now) displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n\r\n      var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Control weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Weighings}\r\n                renderItem={({item, index}) => {\r\n                  if (item === \"__jsogObjectId\") return (<></>);\r\n                  var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Weight.time)]}\r\n                                datas={[Weight.weight + \"   : \" + Weight.count + \" pigs\"]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Comments}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Comment = this.state.CommentsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                              datas={[(Comment.quantity?(Comment.quantity + \" * \"):(\"\")) + Comment.action + \":\\n\" + Comment.data]}\r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime,  MemSections: MemSections})),\r\n    getComments: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.COMMENTS, {PenId: penId})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pens);\r\n//export default DataDisplay_Pens;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../../Stores/Device/Actions'\r\n//import { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pigs extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n      this.props.getWeights(this.state.currentData.penId)\r\n      this.props.getBatch(null)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        var count = pigcount?pigcount:1\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Last weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Weighings}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Weight.time)]}\r\n                              datas={[Weight.weight]} \r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {BatchId: batchId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pigs);\r\n//export default DataDisplay_Pigs;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\nimport DataDisplay_Pens from './DataDisplay_Pens'\r\nimport DataDisplay_Pigs from './DataDisplay_Pigs'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData:{}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (this.props.firebase.currentData && this.props.firebase.currentData.type){\r\n        const CurrentData = this.props.firebase.currentData;\r\n        switch(CurrentData.type){\r\n          case DataRefs.PIGS:\r\n            //this.props.getWeights()\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (this.props.firebase.currentData && this.props.firebase.currentData.type &&\r\n            JSON.stringify(this.state.currentData)!==JSON.stringify(this.props.firebase.currentData)) {\r\n          \r\n          const CurrentData = this.props.firebase.currentData;\r\n\r\n          switch(CurrentData.type){\r\n            case DataRefs.PENS:\r\n              if (localDataStore.pens) {\r\n                var Pens = sortObject(localDataStore.pens)\r\n                if (Pens[CurrentData.penId]){\r\n                  if (JSON.stringify(CurrentData.data)!==JSON.stringify(Pens[CurrentData.penId])){\r\n                    CurrentData.data = Pens[CurrentData.penId]\r\n                  }\r\n                  \r\n                  this.props.setCurrentDataElement(CurrentData)\r\n                }\r\n              }\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            case DataRefs.PIGS:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            default:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const CurrentData = this.state.currentData\r\n\r\n    var DataView = (<View></View>);\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = (<DataDisplay_Pens currentData={this.state.currentData}/>)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigData_View(this, CurrentData, localDataStore) //(<DataDisplay_Pigs currentData={this.state.currentData}/>)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n              {DataView}\r\n          </View>\r\n          \r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst PigData_View = (Control, CurrentData, localDataStore) => {\r\n  /*const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n  const connectedState = useSelector((state) => state.device.connectionState)*/\r\n\r\n  var Pigs;\r\n  if (localDataStore && localDataStore.pigs) {\r\n    Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n  }\r\n  \r\n  if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n  if (!CurrentData.data) {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n        <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n      </View>\r\n    )\r\n  }\r\n  \r\n  /*\r\n    <Row size={1.3}>\r\n          <Col size={1.5} style={{backgroundColor:\"red\"}}>\r\n            <Row size={2.25} style={{backgroundColor:\"blue\"}}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </Row>\r\n            <Row size={1.50}>\r\n              <Col><Text>Messages</Text></Col>\r\n              <Col><Text>Errors</Text></Col>\r\n            </Row>\r\n          </Col>\r\n          <Col>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </Col>\r\n        </Row>\r\n  */\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      {App ? (\r\n        <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth]}>\r\n          <View style={[ Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[ Helpers.fill, Helpers.column]}>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      ):(<></>)}\r\n      <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n        <Button Text={CurrentData.TagId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n          onPress={() => {} }/>\r\n      </View>\r\n      <View style={[Helpers.fullWidth]}>\r\n        <ContentProp ingrid={true} texts={[\"Section\", \"Pen\"]} datas={[CurrentData.data.section, CurrentData.data.pen]} />\r\n        <View style={{height:20}}/>\r\n        <View style={Helpers.midWidth, Helpers.colCenter}>\r\n          <Input\r\n            label={\"Comment:\"}\r\n            multiline={true}\r\n            containerStyle={[{borderWidth:1}]}\r\n            style={[ApplicationStyles.input]}\r\n            onChangeText={text => {\r\n              \r\n            }}\r\n            value={\r\n              \"NONE\"\r\n            }\r\n          />\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, GetCurve_FromBatch, CurvePredict, GetBatchEnd, AccumulateTime, format_Time, GetStats_FromBatch, GetStats_FromPen } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\nimport CurveElement, { WeightsToGraphData } from './CurveElement'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var {isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments} = this.setData(props)\r\n    this.state = {\r\n      Prediction: false,\r\n\r\n      isClosed: isClosed,\r\n      isVirtual: isVirtual,\r\n\r\n      StartDate: StartDate,\r\n      EndDate: EndDate,\r\n      Animals: Animals,\r\n      TargetWeight: TargetWeight,\r\n      AverageWeight: AverageWeight, \r\n      AverageGrowth:AverageGrowth,\r\n      Comments_List: Comments_List,\r\n      Comments: Comments,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var Batch = localDataStore.batchs[this.props.firebase.currentData.batchId];\r\n    var StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual\r\n    var Data = GetStats_FromBatch(Batch, localDataStore)\r\n    if (Data) {\r\n      StartDate = Data.StartDate\r\n      EndDate = Data.EndDate\r\n      TargetWeight = Data.TargetWeight\r\n      PenCount = Data.PenCount\r\n      Animals = Data.Animals\r\n      AverageWeight = Data.AverageWeight\r\n      AverageGrowth = Data.AverageGrowth\r\n      isClosed = Data.isClosed \r\n      isVirtual = Data.isVirtual\r\n    }\r\n\r\n    var Comments_List = null\r\n    var Comments = [];\r\n    if (Batch && Batch.state && Batch.state === \"Closed\" && Batch.closed && Batch.closed.comments) {\r\n      Comments_List = []\r\n      Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(element => {\r\n        var CommentsList = [];\r\n        if (Batch.closed.comments[element]) {\r\n          CommentsList = Batch.closed.comments[element];\r\n          for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n            var name = Object.keys(CommentsList)[i]\r\n            if (!name) continue;\r\n            var object = CommentsList[name];\r\n            if (!object || !object.time) continue;\r\n            object.pen = element\r\n            Comments.push({[name]:object})\r\n          }\r\n        }\r\n        Comments_List = Comments_List.concat(CommentsList);\r\n      });\r\n    }\r\n    Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n    return { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n\r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      if (batchData.pens) {\r\n        Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n          this.props.getPen(Pen, PenMemTime)\r\n        })\r\n      }\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n      }\r\n      this.props.getCurve(TempGraph)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.localDataStore) {\r\n        var { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments } = this.setData(this.props)\r\n        this.setState({\r\n          Prediction: false,\r\n          isClosed: isClosed,\r\n          isVirtual: isVirtual,\r\n\r\n          StartDate: StartDate,\r\n          EndDate: EndDate,\r\n          Animals: Animals,\r\n          TargetWeight: TargetWeight,\r\n          AverageWeight: AverageWeight, \r\n          AverageGrowth:AverageGrowth,\r\n          Comments_List: Comments_List,\r\n          Comments: Comments,\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    var StartDate = this.state.StartDate\r\n\r\n    var Dif_Time = new Date().getTime() - StartDate\r\n    var Days = Dif_Time / (1000 * 3600 * 24);\r\n    Days = Days.toFixed(0) //TODO: closed date...\r\n\r\n    StartDate = new Date(StartDate).getDate() + \"/\" + (new Date(StartDate).getMonth() +1) + \"/\" + new Date(StartDate).getFullYear()\r\n\r\n    var EndDate = this.state.EndDate\r\n    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n\r\n    var Virtual = String(this.state.isVirtual)\r\n    Virtual = Virtual.charAt(0).toUpperCase() + Virtual.slice(1)\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <TitleElement Text={this.props.firebase.currentData.batchId?this.props.firebase.currentData.batchId:\"-NON-\"}/>\r\n          <View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Start', data: StartDate},\r\n                  {title: 'End Forecast', data: EndDate},\r\n                  {title: 'Target Weight', data: this.state.TargetWeight},\r\n                  //{title: 'Virtual cal', data: Virtual}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Animals', data: this.state.Animals},\r\n                  {title: 'Day', data: Days},\r\n                  {title: 'Avarage weight', data: this.state.AverageWeight},\r\n                  {title: 'Average growth', data: this.state.AverageGrowth}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <Button Text=\"Show Predict\"\r\n                onPress={() => {\r\n                  this.setState({\r\n                    Prediction: !this.state.Prediction\r\n                  })\r\n                } }/>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, {minHeight:750}]}>\r\n            <CurveElement Predict={this.state.Prediction} weighings={localDataStore.weighings}/>\r\n          </View>\r\n          {this.state.Comments_List?(\r\n            <View style={[Helpers.fill, Helpers.midWidth, {height:415}]}>\r\n              {/* diff for app / web here ^ */}\r\n              <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n              <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Comments.filter(e => (e !== '__jsogObjectId'))}\r\n                renderItem={({item, index}) => {\r\n                  var Comment = this.state.Comments_List[0][Object.keys(item)[0]]\r\n                  if (!Comment) return null\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                                datas={[Comment.pen + \": \" + Comment.action + \":\\n\" + Comment.data]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport UserFrontScreen from '../Containers/Cloud/UserPanel/FrontScreen'\r\nimport UserDashBoardScreen from '../Containers/Cloud/UserPanel/Dashboard'\r\nimport UserPigsScreen from '../Containers/Cloud/UserPanel/Pigs'\r\nimport UserPensScreen from '../Containers/Cloud/UserPanel/Pens'\r\nimport UserBatchsScreen from '../Containers/Cloud/UserPanel/Batchs'\r\nimport UserCurvesScreen from '../Containers/Cloud/UserPanel/GrowthCurves'\r\n\r\nimport UserOperationsScreen from '../Containers/Cloud/UserPanel/Operations'\r\nimport Weighing from '../Containers/Cloud/UserPanel/Weighing'\r\n\r\nimport UserDataEditor from '../Containers/Cloud/UserPanel/DataEditor'\r\nimport UserDataDisplay from '../Containers/Cloud/UserPanel/DataDisplay'\r\nimport UserDataPlotter from '../Containers/Cloud/UserPanel/DataPlotter'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    UserFront: {\r\n      screen: UserFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n        headerLeft: (props) => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => {\r\n              if (props.label === \"System Board\") {\r\n                NavigationService.nacigationPop()\r\n              }\r\n              else NavigationService.navigate('MainStack')\r\n            }}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'user_front',\r\n    },\r\n\r\n    UserDashBoard: {\r\n      screen: UserDashBoardScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Dash Board',\r\n      }),\r\n      path: 'user_dashboard',\r\n    },\r\n\r\n    UserPigs: {\r\n      screen: UserPigsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pigs',\r\n      }),\r\n      path: 'user_pigs',\r\n    },\r\n\r\n    UserPens: {\r\n      screen: UserPensScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pens',\r\n      }),\r\n      path: 'user_pens',\r\n    },\r\n\r\n    UserBatchs: {\r\n      screen: UserBatchsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Batchs',\r\n      }),\r\n      path: 'user_batchs',\r\n    },\r\n\r\n    UserCurves: {\r\n      screen: UserCurvesScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Curves',\r\n      }),\r\n      path: 'user_curves',\r\n    },\r\n\r\n    /**************** Operations */\r\n    UserOperations: {\r\n      screen: UserOperationsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    WeighingOperations: {\r\n      screen: Weighing,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    /**************** Data Displays */\r\n    DataEditor: {\r\n      screen: UserDataEditor,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_dataedtior',\r\n    },\r\n\r\n    DataDisplay: {\r\n      screen: UserDataDisplay,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_datadisplay',\r\n    },\r\n\r\n    DataPlotter: {\r\n      screen: UserDataPlotter,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_dataplotter',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './AdminPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData(){\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.props.clearDataMem()\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    \r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"User Board\", \"Systems\"]}\r\n            Images={[Images.DashBoard, Images.System,]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"User Board\":\r\n                  NavigationService.navigate(\"UserBoard\")\r\n                  break;\r\n                case \"Systems\":\r\n                  NavigationService.navigate(\"SystemBoard\")\r\n                  break;\r\n              }\r\n              ele.text\r\n            }}\r\n          />\r\n          \r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass UserListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {UserList} = this.setData(props)\r\n    this.state = {\r\n      UserList: UserList,\r\n      User: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getUsers()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var UserList = null\r\n    if (localDataStore && localDataStore.users) {\r\n      UserList = sortObject(localDataStore.users)\r\n    }\r\n    \r\n    return {UserList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.users && JSON.stringify(this.state.UserList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.users))) {\r\n            const {UserList} = this.setData(this.props)\r\n            this.setState({\r\n              UserList: UserList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.UserList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.UserList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var User = this.state.UserList[item];\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={User.name} itemStyle={[{minWidth: 190, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={\"\"} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={User.state} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"User-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  User: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.User\r\n              }\r\n            />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUsers: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERS, {UserId:\"\"})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserListBoard);","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass SystemListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {FarmList} = this.setData(props)\r\n    this.state = {\r\n      FarmList: FarmList,\r\n      Farm: {name: \"\"}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getFarms()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var FarmList = null\r\n    if (localDataStore && localDataStore.farms) {\r\n      FarmList = sortObject(localDataStore.farms)\r\n    }\r\n    return {FarmList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.farms && JSON.stringify(this.state.FarmList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.farms))) {\r\n            const {FarmList} = this.setData(this.props)\r\n            this.setState({\r\n              FarmList: FarmList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.FarmList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.FarmList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var Farm = this.state.FarmList[item];\r\n                      Farm.id = item\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={Farm.name} itemStyle={[{minWidth: 100, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35, justifyContent:\"center\"}]} Title={Farm.manager} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35}]} Title={Farm.email} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <View style={[Helpers.rowCenter, Helpers.fullWidth, {height:120}]}>\r\n              <Input\r\n                label={\"Farm-tag:\"}\r\n                containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                style={[ApplicationStyles.input, ]}\r\n                editable={false}\r\n                onChangeText={text => {\r\n                  var Farm = this.state.Farm;\r\n                  Farm.name = text;\r\n                  this.setState({\r\n                    Farm: Farm\r\n                  })\r\n                }}\r\n                value={\r\n                  this.state.Farm.name\r\n                }\r\n              />\r\n              <Button Text=\"Consys\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  //this.props.logOut()\r\n                }}/>\r\n              <Button Text=\"Farm Panel\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  if (this.state.Farm.id !== \"\") {\r\n                    this.props.setUserFarm(this.state.Farm.id)\r\n                    NavigationService.navigate(\"UserPanel\")\r\n                  }\r\n                }}/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getFarms: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {FarmId: \"\"})),\r\n    setUserFarm: (FarmId) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {farms:{[FarmId]: true}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SystemListBoard);","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport AdminFrontScreen from '../Containers/Cloud/AdminPanel/FrontScreen'\r\n\r\nimport AdminUserBoard from '../Containers/Cloud/AdminPanel/UserBoard'\r\nimport AdminSystemBoard from '../Containers/Cloud/AdminPanel/SystemBoard'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    AdminFront: {\r\n      screen: AdminFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n\r\n    UserBoard: {\r\n      screen: AdminUserBoard,\r\n      navigationOptions: () => ({\r\n        title: 'User Board',\r\n      }),\r\n      path: 'admin_user_board',\r\n    },\r\n    SystemBoard: {\r\n      screen: AdminSystemBoard,\r\n      navigationOptions: () => ({\r\n        title: 'System Board',\r\n      }),\r\n      path: 'admin_system_board',\r\n    },\r\n\r\n    UserPanel: {\r\n      screen: UserPanelNavigation,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('SystemBoard')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'AdminFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport SplashScreen from '../Containers/SplashScreen/SplashScreen'\r\nimport DeepLinkingScreen from '../Containers/DeepLinking/DeepLinkingScreen'\r\n\r\nimport FrontNavigation from '../Navigators/FrontNavigator'\r\nimport AuthNavigation from '../Navigators/AuthNavigator'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\nimport AdminPanelNavigator from '../Navigators/AdminPanelNavigator'\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    SplashScreen: {\r\n      screen: SplashScreen,\r\n      navigationOptions: () => ({\r\n        headerShown: false,\r\n      }),\r\n    },\r\n\r\n    MainStack: {\r\n      screen: FrontNavigation, // Called By StartupSaga.js\r\n      path: 'Front',\r\n    },\r\n    \r\n    AuthStack: AuthNavigation, // All user pages\r\n\r\n    UserPanel: UserPanelNavigation, // 'Free' Users Pages... \r\n\r\n    AdminPanel: AdminPanelNavigator, // Admin Pages\r\n\r\n    DeepLinkingScreen: {\r\n      screen: DeepLinkingScreen,\r\n      path: 'deeplink',\r\n    },\r\n  },\r\n  {\r\n    // By default the application will show the splash screen\r\n    initialRouteName: 'SplashScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'none',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default createAppContainer(StackNavigator)\r\n","import React, { useEffect } from 'react'\r\nimport { View } from 'react-native'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\nimport AppNavigator from '../../Navigators/AppNavigator'\r\n\r\nimport StartupActions from '../../Stores/Startup/Actions'\r\nimport { Helpers } from '../../Theme'\r\n\r\nconst RootScreen = () => {\r\n  // Deep linking prefix\r\n  const prefix = 'agrisysapp://';\r\n  \r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n    dispatch(StartupActions.startup())\r\n  }, [])\r\n\r\n  return (\r\n    <View style={Helpers.fill}>\r\n      <AppNavigator\r\n        // Initialize the NavigationService (see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html)\r\n        ref={(navigatorRef) => {\r\n          NavigationService.setTopLevelNavigator(navigatorRef)\r\n        }}\r\n        uriPrefix={prefix}\r\n      />\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default RootScreen\r\n","import { combineReducers } from 'redux'\r\nimport configureStore from './CreateStore'\r\nimport rootSaga from '../Sagas'\r\n\r\nimport { reducer as ExampleReducer } from './Example/Reducers'\r\nimport { reducer as DeviceReducer } from './Device/Reducers'\r\nimport { reducer as FirebaseReducer } from './Firebase/Reducers'\r\n\r\nexport default () => {\r\n  const rootReducer = combineReducers({\r\n    /**\r\n     * Register your reducers here.\r\n     * @see https://redux.js.org/api-reference/combinereducers\r\n     */\r\n    example: ExampleReducer,\r\n    device: DeviceReducer,\r\n    firebase: FirebaseReducer,\r\n  })\r\n\r\n  return configureStore(rootReducer, rootSaga)\r\n}\r\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/lib/integration/react'\n\nimport createStore from './Src/Stores'\nimport RootScreen from './Src/Containers/Root/RootScreen'\n\nconst { store, persistor } = createStore()\n\nconst App = () => (\n  <Provider store={store}>\n    {/**\n     * PersistGate delays the rendering of the app's UI until the persisted state has been retrieved\n     * and saved to redux.\n     * The `loading` prop can be `null` or any react instance to show during loading (e.g. a splash screen),\n     * for example `loading={<SplashScreen />}`.\n     * @see https://github.com/rt2zz/redux-persist/blob/master/docs/PersistGate.md\n     */}\n    <PersistGate loading={null} persistor={persistor}>\n      <RootScreen />\n    </PersistGate>\n  </Provider>\n);\n\nexport default App\n","module.exports = __webpack_public_path__ + \"static/media/Home.1fff8434.png\";","module.exports = __webpack_public_path__ + \"static/media/Dashboard.26766c7a.png\";","module.exports = __webpack_public_path__ + \"static/media/System.7e4af00c.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Curves.da739887.png\";","module.exports = __webpack_public_path__ + \"static/media/Growth-curve.7f9a7fea.png\";","module.exports = __webpack_public_path__ + \"static/media/User.d73be9fd.png\";","module.exports = __webpack_public_path__ + \"static/media/Sow.beff0aff.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABRCAYAAACuepoLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAq9JREFUeNrsnT1Lw1AUhk9FRFEhDhV0qgouLlrcjYOLi3XpasEfYjo62X/Quorg5iS0P0D8GBzVOAkWP6CVigg1197E0Naa3ER7b/K+cLig3tP4eJJz8g5XIig0JRS8Zr3Pn1+JUgE0JYgjK1JRqEz2y9DE1IJwgrdalRr1BxoZm6Th8aTvfVwvVqxacaE8zLXtQ+EEN+cHdH12QHPpLM0uZX3tbdSrdHmyS7VH0wY6w1caQNvwp5GxJC2v57+q2pJmRc7+HmAKaHBolGbTTkVvAGYIFdoBucfPp7p1rH8efwr280iJiu3ytUUr9iSY5+yZrqIqTAayzB+sIgOqHtJgq7vGD1IRpsaHUY3PTptWmCJjC5+/Ao8/7hlONZgZ/ow0OQylqkIGubv5Cl/3ATI4zFQUX+T7BRMCTMCM5mumqhf+fH8lvLdRqzqraJ7aU++pscznuyBvPk3XjEh/lKcpWZSVr8x+mMNufby/2p6m+rc58xRFZZvD0/O6b3PY/Zg5Pd5BA0I3B0yMRlsU3Ms0ALOlXAh5dwCzpZIVdwEh5uP4x+gGk1lwlYAQjDjCRAMCTMAETAgwARMwoZ5zphJiNpqonri73lrF8thu/U+C0x5Dpz0v2fWYKlcmGhC6OQSYMo1GMjnthkSsfr2WRFsD0lFfnlh5rswSyeO0y5BHyKiO4mgURh7POdCA0M0BEzAhwARMwIQAEzABEzAhwARMwIQ6FRen3fgPmHDaxVh5rswSwWnvlsOX4LQHzIEGhG4OmIAJASZgAiYEmIAJmPGEafJVBxZHi21sPCvH30Fv8W7uqMj3F/1uZCe6PtP3vxvQYg7TcO33dLe6LTh2ACk7Gpe5RxkeFcELKYd0m/UrT4q+zxMtBODgHOLcjHnc8oLyrMQvUDWKr3xX46cAAwCxt3YCfnN46AAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/Area_Colour.f4a4e098.png\";","module.exports = __webpack_public_path__ + \"static/media/AutoPig.ec16c410.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Components.224ca1b3.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexagon-globe.fce26805.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexa-icon.5129d536.png\";","module.exports = __webpack_public_path__ + \"static/media/Logo.9b051259.png\";","module.exports = __webpack_public_path__ + \"static/media/TOM.c88886f3.png\";"],"sourceRoot":""}