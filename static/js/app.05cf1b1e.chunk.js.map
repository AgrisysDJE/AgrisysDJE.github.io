{"version":3,"sources":["Src/Stores/CreateStore.js","Src/Stores/Startup/Actions.js","Src/Stores/Example/Actions.js","Src/Stores/Device/BLE/Actions.js","Src/Stores/Device/BlueTooth/Actions.js","Src/Stores/Device/Actions.js","Src/Services/NavigationService.js","Src/Stores/Firebase/Actions.js","Src/Sagas/StartupSaga.js","Src/Config/index.js","Src/Services/UserService.js","Src/Sagas/Example/ExampleSaga.js","Src/Services/DeviceService.js","Src/Stores/Device/Selectors.js","Src/Sagas/Device/BLE/BLESaga.js","Src/Sagas/Device/BlueTooth/BlueToothSaga.js","Src/Sagas/Device/DeviceSaga.js","Src/Stores/Firebase/Selectors.js","Src/Services/FirebaseService.js","Src/Services/ConsysService.js","Src/Sagas/Firebase/FirebaseSaga.js","Src/Sagas/index.js","Src/Stores/Example/InitialState.js","Src/Stores/Example/Reducers.js","Src/Stores/Device/BLE/InitialState.js","Src/Stores/Device/BlueTooth/InitialState.js","Src/Stores/Device/InitialState.js","Src/Stores/Device/BLE/Reducers.js","Src/Stores/Device/BlueTooth/Reducers.js","Src/Stores/Device/Reducers.js","Src/Stores/Firebase/Reducers.js","Src/Stores/Firebase/InitialState.js","Src/Theme/Colors.js","Src/Theme/Fonts.js","Src/Theme/Metrics.js","Src/Theme/Images.js","Src/Theme/Helpers.js","Src/Theme/ApplicationStyles.js","Src/Containers/SplashScreen/SplashScreen.js","Src/Containers/SplashScreen/SplashScreenStyle.js","Src/Containers/DeepLinking/DeepLinkingScreen.js","Src/Components/Button.js","Src/Components/Button_Panel.js","Src/Components/TitleElement.js","Src/Components/CustomListItem.js","Src/Components/ContentProp.js","Src/Components/Loading.js","Src/Components/OperationsPanel.js","Src/Components/Progressbar.js","Src/Components/DateTime_Picker.js","Src/Components/Comment_Module.js","Src/Containers/Agrisys/FrontScreenStyle.js","Src/Containers/Agrisys/FrontScreen.js","Src/Stores/Example/Selectors.js","Src/Containers/Example/ExampleScreenStyle.js","Src/Containers/Example/ExampleScreen.js","Src/Containers/Device/DeviceScreenStyle.js","Src/Containers/Device/DeviceScreen.js","Src/Navigators/FrontNavigator.js","Src/Containers/Cloud/AuthScreens/UserLoadingScreen.js","Src/Containers/Cloud/AuthScreens/AuthStyle.js","Src/Containers/Cloud/AuthScreens/VerifyScreen.js","Src/Containers/Cloud/AuthScreens/UserLoginScreen.js","Src/Containers/Cloud/UserPanel/UserPanelStyle.js","Src/Containers/Cloud/UserPanel/UserInformation.js","Src/Containers/Cloud/UserPanel/Subscription.js","Src/Containers/Cloud/UserPanel/FarmInformation.js","Src/Containers/Cloud/AuthScreens/CreateUserDataScreen.js","Src/Navigators/AuthNavigator.js","Src/Containers/Cloud/UserPanel/FrontScreen.js","Src/Containers/Cloud/UserPanel/Dashboard.js","Src/Containers/Cloud/CloudScreenStyle.js","Src/Containers/Cloud/UserPanel/Pigs.js","Src/Containers/Cloud/UserPanel/Pens.js","Src/Containers/Cloud/UserPanel/Batchs.js","Src/Containers/Cloud/UserPanel/CurveElement.js","Src/Containers/Cloud/UserPanel/GrowthCurves.js","Src/Containers/Cloud/UserPanel/AutoPig.js","Src/Containers/Cloud/UserPanel/Operations.js","Src/Containers/Cloud/UserPanel/Weighing.js","Src/Containers/Cloud/UserPanel/DataEditor.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pens.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pigs.js","Src/Containers/Cloud/UserPanel/DataDisplay.js","Src/Containers/Cloud/UserPanel/DataPlotter.js","Src/Navigators/UserPanelNavigator.js","Src/Containers/Cloud/AdminPanel/AdminPanelStyle.js","Src/Containers/Cloud/AdminPanel/FrontScreen.js","Src/Containers/Cloud/AdminPanel/UserBoard.js","Src/Containers/Cloud/AdminPanel/SystemBoard.js","Src/Navigators/AdminPanelNavigator.js","Src/Navigators/AppNavigator.js","Src/Containers/Root/RootScreen.js","Src/Stores/index.js","App.tsx","Src/Assets/Images/Home.png","Src/Assets/Images/Dashboard.png","Src/Assets/Images/System.png","Src/Assets/Images/Feed-Curves.png","Src/Assets/Images/Growth-curve.png","Src/Assets/Images/User.png","Src/Assets/Images/Sow.png","Src/Assets/Images/Section.png","Src/Assets/Images/Area_Colour.png","Src/Assets/Images/AutoPig.png","Src/Assets/Images/Feed-Components.png","Src/Assets/Images/Hexagon-globe.png","Src/Assets/Images/Hexa-icon.png","Src/Assets/Images/Logo.png","Src/Assets/Images/TOM.png"],"names":["JSOGTransform","createTransform","inboundState","key","JSOG","encode","outboundState","decode","persistConfig","storage","transforms","blacklist","createActions","startup","Types","Creators","StartupTypes","fetchUser","fetchUserLoading","fetchUserSuccess","fetchUserFailure","ExampleTypes","bleStartup","bleStateUpdated","startBleScan","stopBleScan","readBleDeviceData","BleTypes","bluetoothStartup","startBluetoothScan","stopBluetoothScan","bluetoothScanAble","readBlueDeviceData","BluetoothTypes","deviceStartup","setDeviceError","scannerStateUpdated","addDevice","removeDevice","clearDevices","connectedDeviceUpdated","connectionStateUpdated","connectionMethodeUpdated","setDeviceData","updateDeviceData","connectDevice","disconnectDevice","readDeviceData","fetchDevice","DeviceTypes","BleCreators","BlueToothCreators","navigator","firebaseStartup","firebaseIsLoading","setFirebaseError","setViewError","viewIsLoading","setCurrentData","actionStarting","fetchStarting","dataFetchSuccess","fetchSuccess","fetchFailure","FirebaseTypes","navigate","routeName","params","dispatch","NavigationActions","replace","StackActions","navigateAndReset","reset","index","actions","setTopLevelNavigator","navigatorRef","nacigationPop","back","console","log","Platform","OS","put","DeviceActions","FirebaseActions","NavigationService","Config","API_URL","HTTPS_START","CONSYS_CLIENT_ID","CONSYS_CLIENT_SECRET","CONSYS_AUTH","CONSYS_API","GetCheckToken_URL","Site_URL","GetConsumtion_URL","GetConsumtionData_URL","Consumptiontype","SystemId","Offset","Limit","Starttime","Stoptime","Lastid","res","GetConsumtionData_Var","in200s","curryN","min","max","value","isNumber","is","Number","gte","isWithin","userApiClient","axios","create","baseURL","headers","Accept","timeout","userService","Math","random","Promise","resolve","reject","number","floor","get","toString","then","response","status","data","ExampleActions","call","user","deviceService","Version","a","async","PermissionsAndroid","check","PERMISSIONS","ACCESS_COARSE_LOCATION","request","RESULTS","GRANTED","ScannerState","ConnectionState","ConnectionMethode","handleBleState","connectBle","handleConnection","handleScanning","scanBle","setBleScannerStart","sagaArgs","permitError","fork","BLEManager","manager","eventChannel","emit","subscription","onStateChange","state","remove","buffers","expanding","stateChannel","take","newState","BleActions","cancelled","close","device","select","connectionMethode","connectedDevice","_manager","isConnected","onDisconnected","error","type","disconnectedChannel","actionChannel","deviceActionChannel","connect","discoverAllServicesAndCharacteristics","_device","race","deviceAction","disconnected","cancelConnection","KnownUUIDS","services","_services","serviceUUIDs","filter","service","includes","uuid","monitor","characteristics","characteristic","push","forEach","i","monitorCharacteristicForService","readingChannel","TempData_Reading","Buffer","from","length","PacketId","BatteryLevel","base64","charCodeAt","Battery","RawData","header","slice","compare","parseInt","NewData","concat","TagId","tagid","FatLayers","FatL1","FatL2","FatL3","layers","layer1","layer2","layer3","scanTask","bleState","scannerState","connectionState","channel","action","State","PoweredOn","cancel","startDeviceScan","allowDuplicates","scannedDevice","localName","stopDeviceScan","scanningChannel","scanBluetooth","setBlueScannerStart","BlueManager","PairDevice","id","receiveData","Message","TAGId","Discover","NativeEventEmitter","addListener","Device","address","name","alias","bluetoothChannel","StopDiscovery","BluetoothSearchAble","methode","UserStates","DataStates","DataRefs","FIREBASEUSER","USERSDATA","USERS","FARMS","SECTIONS","PENS","PIGS","BATCHS","WEIGHING","GRAPH","COMMENTS","FARMDATAS","SHARES","CONSYS","ConsysRefs","VALVEFEED","SCALE","Actions","SIGN","FETCH","CREATE","UPDATE","MOVE","DELETE","CLEAR","ADD","Operations","ErrorTypes","format_num","num","format_Time","time","s","Date","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","auth","messaging","database","reA","reN","sortAlphaNum","b","aA","bA","aN","bN","sortObject","o","sorted","hasOwnProperty","sort","DataStringCheck","Check_num","first","numbers","specialChars","indexOf","GetWeight_FromPen","PenId","WeighingsStore","AfterTime","BeforeTime","Weighing","_weighing","weighing","GetBatch_FromPen","localDataStore","batchs","_batch","batch","pens","GetStats_FromPen","PenData","StartDate","EndDate","PenWeighings","Animals","PenWeight","PenGrowth","AveragePenGrowth","datas","count","weighings","GrowthCount","lastDate","LastWeight","undefined","LastWeightDay","FirstWeight","Object","keys","weight","Weight","now","getTime","isVirtual","Batch","TempGraph","GetCurve_FromBatch","graphs","BatchEndDate","Predict","CurvePredict","Now","_date","lastWeighing","Addition","setDate","days","tempEnd","date","Growth","GetStats_FromBatch","PenCount","CollectedWeight","CollectedGrowth","isClosed","TargetWeight","target","GetBatchEnd","PenEnds","reverse","e","Batch_Pen","Pen","closed","PenStats","AverageWeight","parseFloat","toFixed","AverageGrowth","GraphsStore","CurrentData","Garph","gcurve","curveId","Id","DataPoints","_index","map","TempCurve","currentTime","AccumulateTime","periode","Time","PeriodeLength","NewTime","setMonth","get_DataSpot","MinMax_Time","MinMax_Data","FindTime","Data","DataTime","ExValue","VirData","ExTime","slope","GetSlope_Between","minX","maxX","minY","Weighing2","weight2","StartIndex","PredictCurve","CurrentTime","Temp_CurrentIndex","unshift","PredictStart","TempEx","DataSpot","FirstSpot","Temp_CurrentTime","WeightNow","CurrentIndex","require","default","_firebase","apps","Constants","manifest","web","config","firebase","initializeApp","isSupported","createFirebaseUserWithemailandpassword","Email","Pass","createUserWithEmailAndPassword","User","currentUser","Name","displayName","email","UserId","uid","_data","updateProfile","sendEmailVerification","catch","code","viewError","message","signinWithemailandpassword","logoutUser","signInWithEmailAndPassword","sendResetPassword","sendPasswordResetEmail","signOut","path","refreshUser","reload","ref","CurrentUser","createFarm","Farms","farmid","updateFarmData","FarmId","sections","Sections","Pens","updateUserData","UserData","farms","fetchFarm","updateFarm","fetchSections","fetchPens","createNewPen","deletePen","updatePen","fetchPigs","updatePigdata","fetchBatchs","createBatchs","updateBatchs","fetchWeights","createWeight","fetchComments","createComment","fetchGraphData","updateGraphData","SetUpdateTime","DataRef","update","update_time","ServerValue","TIMESTAMP","CheckDataTime","once","_Time","UpdateTime","val","List","userData","_farmData","farm","set","SectionId","DoFetch","_sectionidData","_pensData","penData","pen","ref2","section","_Pen","Datas","_pigsData","pigData","pig","updatePigPen","Action","counts","isNaN","pigs","BatchId","_batchdata","curve","batchdata","devianceMin","devianceMax","BatchPens","JSON","stringify","RemovedPens","x","enddate","NewPens","SamePens","pendata","startdate","CurveId","comments","p","_","_resolve","setTimeout","weights","limitStart","limitTo","MemSections","orderByChild","limitToLast","snapshot","c","_weighingTime","Weighings_Time","itemsProcessed","newWeights","Quantity","weightRef","comment","commentRef","quantity","GraphId","graph","Graphs","GraphVal","newGraph","Agraph","AgraphVal","Graph","_Graph","firebaseService","requestPermission","authStatus","AuthorizationStatus","AUTHORIZED","PROVISIONAL","isPermit_UserPermission","title","okText","_cancelable","Alert","alert","text","onPress","cancelable","onDismiss","Create_Axios","Acc_Token","getAccessToken","SiteUrl","Ref_Token","Refresh_Token","GetToken_URL","access_token","checkRenew_AccessToken","consysService","limit","starttime","stoptime","offset","lastid","Token","Feed_Data","ResData","result","consumptiondata","element","amount","dataid","valve","unit","silono","timestamp","token","Scale_Data","handleAuthState","handleActions","onMessageHandler","onBackgroundMessageHandler","disableYellowBox","onAuthStateChanged","authChannel","newAuth","firebaseUser","values","FirebaseUser","FarmsData","FarmData","site","refToken","Params","sysId","start","stop","lastId","feedData","scaleData","messageListener","onMessage","remoteMessage","onMessageChannel","notification","body","onNotificationOpenedApp","setBackgroundMessageHandler","root","all","takeLatest","STARTUP","StartupSaga","FETCH_USER","ExampleSaga","DEVICE_STARTUP","DeviceSaga","CONNECT_DEVICE","DISCONNECT_DEVICE","READ_DEVICE_DATA","FETCH_DEVICE","BLE_STARTUP","START_BLE_SCAN","STOP_BLE_SCAN","READ_BLE_DEVICE_DATA","BLUETOOTH_STARTUP","START_BLUETOOTH_SCAN","STOP_BLUETOOTH_SCAN","BLUETOOTH_SCAN_ABLE","READ_BLUE_DEVICE_DATA","FIREBASE_STARTUP","FirebaseSaga","reducer","createReducer","userIsLoading","userErrorMessage","FETCH_USER_LOADING","FETCH_USER_SUCCESS","FETCH_USER_FAILURE","errorMessage","INITIAL_STATE","PoweredOff","deviceIsLoading","deviceErrorMessage","DeviceList","deviceData","BLE_INITIAL_STATE","BLUETOOTH_INITIAL_STATE","HANDLERS","BLE_STATE_UPDATED","SET_DEVICE_ERROR","SCANNER_STATE_UPDATED","ADD_DEVICE","some","NewList","REMOVE_DEVICE","splice","CLEAR_DEVICES","CONNECTED_DEVICE_UPDATED","CONNECTION_STATE_UPDATED","CONNECTION_METHODE_UPDATED","SET_DEVICE_DATA","UPDATE_DEVICE_DATA","newData","BLEReducers","BluetoothReducers","FIREBASE_IS_LOADING","loadingstate","SET_FIREBASE_ERROR","firebaseErrorMessage","SET_VIEW_ERROR","VIEW_IS_LOADING","SET_CURRENT_DATA","currentData","ACTION_STARTING","FETCH_STARTING","DATA_FETCH_SUCCESS","NewDataStore","NewFirebaseUser","_user","_auth","Values","users","consys","FETCH_SUCCESS","newlocalDataStore","_newState","mergeDeep","source","isObject","obj","targetValue","sourceValue","Array","isArray","append","FETCH_FAILURE","h1","fontSize","h2","h3","normal","tiny","small","medium","tinyBottomMargin","marginBottom","smallBottomMargin","bottomMargin","mediumBottomMargin","tinyVerticalMargin","marginVertical","smallVerticalMargin","verticalMargin","mediumVerticalMargin","tinyHorizontalMargin","marginHorizontal","smallHorizontalMargin","horizontalMargin","mediumHorizontalMargin","tinyHorizontalPadding","paddingHorizontal","smallHorizontalPadding","horizontalPadding","mediumHorizontalPadding","tinyVerticalPadding","paddingVertical","smallVerticalPadding","verticalPadding","mediumVerticalPadding","Home","DashBoard","System","Curves","GCurves","Sow","Section","AutoPig","Feed","Haxa_globe","Hexa_icon","Logo","logo","column","flexDirection","colMain","justifyContent","colCenter","alignItems","colCross","columnReverse","row","rowMain","rowCenter","rowCross","rowReverse","center","crossCenter","crossEnd","crossStart","crossStretch","fill","flex","fillCenter","fillCol","fillColCenter","fillColCross","fillColMain","fillColReverse","fillRow","fillRowCenter","fillRowCross","fillRowMain","fillRowReverse","fullSize","height","width","halvWidth","midWidth","fullWidth","mainCenter","mainEnd","mainSpaceAround","mainSpaceBetween","mainStart","mainContainer","Metrics","contentContainer","marginTop","borderContainer","borderWidth","borderColor","borderRadius","maxWidth","zIndex","textContainer","Fonts","buttonContainer","loadingContainer","position","left","right","top","bottom","backgroundColor","logoContainer","backgroundReset","Colors","rotate90","transform","rotate","rotate90Inverse","mirror","scaleX","scrollSpaceAround","flexGrow","scrollSpaceBetween","selfStretch","alignSelf","textCenter","textAlign","textJustify","textLeft","textRight","button","color","buttonText","input","navigationHeader","StyleSheet","container","SplashScreen","props","getInitialNotification","this","checkData","getData","prevProps","prevState","View","style","Helpers","Style","Image","Images","resizeMode","Component","DeepLinkingScreen","Text","styles","boxContainer","ApplicationStyles","icon","Button","TextView","textStyle","ImageView","_Image","iconStyle","TouchableOpacity","boxStyle","buttonStyle","Button_Panel","Texts","Buttons","image","itemStyle","TitleElement","listitem","CustomListItem","containerStyle","Content","Title","Subtitle","contentBox","minHeight","ContentProp","texts","textsStyle","datasStyle","onLongPress","view","dataRow","OperationsPanel","pigTag","PigsList","newPig","getPenAndSection","setCurrentPig","editPens","onDone","charAt","toUpperCase","newWeight","penId","newComment","newPigCount","setState","ScrollView","paddingRight","setCurrentDataElement","pigtag","dataId","countChange","ProgressBar","animation","useRef","Animated","Value","progress","Color","useEffect","timing","current","toValue","duration","interpolate","inputRange","outputRange","extrapolate","paddingBottom","alignContent","progressBar","absoluteFill","paddingTop","padding","monthNames","DateTime_Picker","getStates","year","month","day","Selected","Year","Month","Day","forceUpdate","changed","Today","YearItems","String","Picker","Item","label","MonthItems","DayItems","selectedValue","minWidth","marginRight","onValueChange","_year","_month","_day","textAreaContainer","textArea","Comment_Module","useState","InputText","setInputText","QuantityText","setQuantityText","WeightText","setWeightText","App","marginLeft","TextInput","multiline","onChangeText","underlineColorAndroid","placeholder","placeholderTextColor","numberOfLines","FrontScreen","ShowMainError","FocusSubscription","Props","navigation","payload","setViewLoading","ErrorMessage","ele","liveInEurope","entries","example","city","instructions","fontStyle","ios","android","ExampleScreen","useDispatch","useSelector","ActivityIndicator","size","deviceContainer","deviceDataContainer","text2","DeviceScreen","DeviceData","Devices","Unknown","ConnectedDevice_View","Dev","StackNavigator","createStackNavigator","screen","Front","navigationOptions","headerMode","headerShown","headerTitleStyle","Example","initialRouteName","defaultNavigationOptions","headerTitleAlign","headerRight","PanelsSorter","userType","UserLoadingScreen","ISLOADPAGE","firebaseData","page","emailVerified","prev","getUser","IsLoading","clearDataMem","UserLoginScreen","CreateUser","secureTextEntry","createUser","signIN","resetPass","VerifyScreen","setUser","Verified","UserInformation","setData","FirstN","LastN","Contact","ContactP","Address","Country","lastN","contact","phoneNumber","F_FirstN","React","createRef","F_LastN","F_Contact","F_ContactP","F_Address","test","_UserData","phone","country","updateUser","OnDone","window","Dimensions","Subscription","onChange","dimensions","CurrentSub","Billing","addEventListener","removeEventListener","wide","fontWeight","CheckBox","FarmInformation","FarmName","Cvr","Manager","cvr","getFarm","_FarmData","_sections","_pens","i2","sectionPens","CreateNewUserData","ViewState","Display","precreateUserData","Subsc","LoadingUserScreen","LoginUser","LoginUserScreen","headerLeft","paddingLeft","CreateUserData","CreateUserDataScreen","logOut","getAutoPig","Dashboard","Mail","BatchList","SectionsList","MaxCap","CurCap","farmName","farmManager","farmMail","Farm","BatchID","End","getSections","getPens","getBatch","getWeights","getCurve","FarmProgress","FlatList","renderItem","item","keyExtractor","loading","inputContainer","Pigs","PigTag","getPigs","connectedState","SafeAreaView","tagId","pigId","Device_Display","circle","Scanner_Display","known","Weighings","Mid","property","itemDimension","spacing","renderSectionHeader","displayWeight","round","Batchs","onMultiChange","items","xorBy","selectedPens","freePens","BatchName","ShowPicker","StartD","Curve","DevianceMin","DevianceMax","avaiblePens","add","scrollEnabled","batchName","_pen","mode","itemValue","itemIndex","step","endsWith","split","labelStyle","optionsLabelStyle","options","selectedValues","onMultiSelect","onTapClose","isMulti","newBatch","updateBatch","_Date","setBatch","batchId","getRandomNumber","low","high","getRandomColor","red_range","green_range","blue_range","a_range","red","green","blue","alpha","r","g","rgbaValue","CurveElement","Legends","DataSets","Labels","ActiveIndex","ActiveLength","ActiveDataSets","ActiveStartDate","ActiveEndDate","ViewPoint","D","DataX","dataX","opacity","TempData","TempEndDate","NextEnd","_EndDate","Prediction","DoPredict","BatchPen","DataSet","DataSetX","WeightsToGraphData","TemplatePeriode","CurrentDate","getNewDate","setGraphPeriode","BatchIsOpen","Height","Width","point","horizontal","showsHorizontalScrollIndicator","maxHeight","labels","xMinMax","legend","datasets","onDataPointClick","withShadow","withVerticalLines","fromZero","segments","verticalLabelRotation","xLabelsOffset","chartConfig","backgroundGradientFrom","backgroundGradientFromOpacity","backgroundGradientTo","backgroundGradientToOpacity","decimalPlaces","labelColor","propsForDots","strokeWidth","stroke","control","CurveEditor","TimeText","dataset","Point","setPoint","evt","getPen","curveid","setCurve","GrowthCurve","CurveList","CurveName","Periode","dataindex","nestedScrollEnabled","CurveData","AppStyle","WebStyle","onFocus","onBlur","editable","_Selected","FirstData","pop","nativeEvent","numColumns","lastDataIndex","Eindex","newCurve","updateCurve","ValveData","ScaleData","series","categories","SysId","STime","ETime","LastId","chart","plotOptions","bar","columnWidth","markers","fillOpacity","strokeOpacity","hover","yaxis","tickAmount","xaxis","find","y","DataSet2","getValveFeed","actionType","DataEditor","NewSection","DataView","PenEditor_View_Creator","PigEditor_View_Creator","Control","CurrentAction","exists","penAction","PenEditor_Titles","pigAction","Section_Picker","senctionId","DataDisplay_Pens","WeighingsList","CommentsList","Comments","object","MemTime","getComments","localDataStoree","pigcount","penWeight","batch_name","age","StartTime","onPageSwipe","sender","onDataPress","Comment","dir","DataDisplay_Pigs","DataDisplay","PigData_View","ingrid","Comments_List","batchData","PenMemTime","Days","Virtual","UserFront","UserFrontScreen","UserDashBoard","UserDashBoardScreen","UserPigs","UserPigsScreen","UserPens","UserPensScreen","UserBatchs","UserBatchsScreen","UserCurves","UserCurvesScreen","AutoPigScreen","UserOperations","UserOperationsScreen","WeighingOperations","UserDataEditor","UserDataDisplay","DataPlotter","UserDataPlotter","UserListBoard","UserList","getUsers","SystemListBoard","FarmList","getFarms","setUserFarm","AdminFront","AdminFrontScreen","UserBoard","AdminUserBoard","SystemBoard","AdminSystemBoard","UserPanel","UserPanelNavigation","MainStack","FrontNavigation","AuthStack","AuthNavigation","AdminPanel","AdminPanelNavigator","createAppContainer","RootScreen","StartupActions","AppNavigator","uriPrefix","rootReducer","rootSaga","middleware","enhancers","sagaMiddleware","createSagaMiddleware","applyMiddleware","persistedReducer","persistReducer","store","createStore","compose","persistor","persistStore","blemanager","BleManager","setLogLevel","LogLevel","Verbose","NativeModules","BlueToothControl","run","configureStore","combineReducers","ExampleReducer","DeviceReducer","FirebaseReducer","module","exports"],"mappings":"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","file":"static/js/app.05cf1b1e.chunk.js","sourcesContent":["import { Platform } from 'react-native'\r\n\r\nimport { applyMiddleware, compose, createStore } from 'redux'\r\nimport createSagaMiddleware from 'redux-saga'\r\nimport { persistReducer, persistStore, createTransform } from 'redux-persist'\r\n\r\nimport { NativeModules } from 'react-native'\r\nimport { BleManager, BleError, LogLevel } from 'react-native-ble-plx'\r\n\r\n//** fix: error serializing state TypeError: Converting circular structure to JSON  */\r\n// https://www.npmjs.com/package/jsog\r\n// https://www.npmjs.com/package/flatted\r\nimport JSOG from 'jsog';\r\nexport const JSOGTransform = createTransform(\r\n  (inboundState, key) => JSOG.encode(inboundState),\r\n  (outboundState, key) => JSOG.decode(outboundState),\r\n)\r\n\r\n/**\r\n * This import defaults to localStorage for web and AsyncStorage for react-native.\r\n *\r\n * Keep in mind this storage *is not secure*. Do not use it to store sensitive information\r\n * (like API tokens, private and sensitive data, etc.).\r\n *\r\n * If you need to store sensitive information, use redux-persist-sensitive-storage.\r\n * @see https://github.com/CodingZeal/redux-persist-sensitive-storage\r\n */\r\nimport storage from 'redux-persist/lib/storage'\r\n\r\nconst persistConfig = {\r\n  key: 'root',\r\n  storage: storage,\r\n  transforms: [JSOGTransform],\r\n  /**\r\n   * Blacklist state that we do not need/want to persist\r\n   */\r\n  blacklist: [\r\n    // 'auth',\r\n  ],\r\n}\r\n\r\nexport default (rootReducer, rootSaga) => {\r\n  const middleware = []\r\n  const enhancers = []\r\n\r\n  // Connect the sagas to the redux store\r\n  const sagaMiddleware = createSagaMiddleware()\r\n  middleware.push(sagaMiddleware)\r\n\r\n  enhancers.push(applyMiddleware(...middleware))\r\n\r\n  // Redux persist\r\n  const persistedReducer = persistReducer(persistConfig, rootReducer)\r\n\r\n  const store = createStore(persistedReducer, compose(...enhancers))\r\n  const persistor = persistStore(store)\r\n\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    // First step is to create BleManager which should be used as an entry point\r\n    // to all BLE related functionalities\r\n    const blemanager = new BleManager();\r\n    blemanager.setLogLevel(LogLevel.Verbose);\r\n\r\n    const bluemanager = NativeModules.BlueToothControl;\r\n\r\n    // SagaArgs Construcktor\r\n    const sagaArgs = {BLEManager: blemanager, BlueManager: bluemanager}\r\n\r\n    // Kick off the root saga\r\n    sagaMiddleware.run(rootSaga, sagaArgs)\r\n  }else {\r\n    sagaMiddleware.run(rootSaga)\r\n  }\r\n  \r\n  return { store, persistor }\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\nconst { Types, Creators } = createActions({\r\n  // This action is triggered when the application starts\r\n  startup: null,\r\n})\r\n\r\nexport const StartupTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  // Fetch user informations\r\n  fetchUser: null,\r\n  // The operation has started and is loading\r\n  fetchUserLoading: null,\r\n  // User informations were successfully fetched\r\n  fetchUserSuccess: ['user'],\r\n  // An error occurred\r\n  fetchUserFailure: ['errorMessage'],\r\n})\r\n\r\nexport const ExampleTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bleStartup: null,\r\n  bleStateUpdated: ['bleState'],\r\n\r\n  startBleScan: null,\r\n  stopBleScan: null,\r\n\r\n  readBleDeviceData: null,\r\n})\r\n\r\nexport const BleTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bluetoothStartup: null,\r\n\r\n  startBluetoothScan: null,\r\n  stopBluetoothScan: null,\r\n  \r\n  bluetoothScanAble: null,\r\n\r\n  readBlueDeviceData: null,\r\n})\r\n\r\nexport const BluetoothTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\nimport BleCreators, {BleTypes} from './BLE/Actions'\r\nimport BlueToothCreators, {BluetoothTypes} from './BlueTooth/Actions'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Device Saga\r\n  deviceStartup: null,\r\n  setDeviceError: ['errorMessage'], // Device-saga error occurred\r\n\r\n  scannerStateUpdated: ['scannerState'],\r\n\r\n  addDevice: ['device'],\r\n  removeDevice: ['device'],\r\n  clearDevices: null,\r\n\r\n  connectedDeviceUpdated: ['connectedDevice'], \r\n\r\n  connectionStateUpdated: ['connectionState'],\r\n  connectionMethodeUpdated: ['connectionMethode'],\r\n\r\n  setDeviceData: ['data'],\r\n  updateDeviceData: ['data'],\r\n\r\n  connectDevice: ['device'],\r\n  disconnectDevice: ['methode'],\r\n  readDeviceData: null,\r\n\r\n  fetchDevice: null, // Fetch device informations\r\n})\r\n\r\nexport const DeviceTypes = {...Types, ...BleTypes, ...BluetoothTypes}\r\nexport default {...Creators, ...BleCreators, ...BlueToothCreators}","import React from 'react'\r\nimport { BackHandler } from 'react-native'\r\nimport { NavigationActions, StackActions } from 'react-navigation'\r\n\r\n/**\r\n * The navigation is implemented as a service so that it can be used outside of components, for example in sagas.\r\n *\r\n * @see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html\r\n */\r\n\r\nlet navigator\r\nvar LastPage\r\n/**\r\n * This function is called when the RootScreen is created to set the navigator instance to use.\r\n */\r\nfunction setTopLevelNavigator(navigatorRef) {\r\n  navigator = navigatorRef\r\n\r\n  /*BackHandler.addEventListener('hardwareBackPress', () => {\r\n    console.log(navigator._navigation)\r\n    if (navigator && navigator._navigation && navigator._navigation.state) {\r\n      var Stackindex = navigator._navigation.state.index\r\n      var Stack = navigator._navigation.state.routes[Stackindex]\r\n      if (Stack.routes){\r\n        var index = Stack.index;\r\n        var routeName = Stack.routes[index].routeName;\r\n        if (routeName === 'UserFront' || routeName === 'LoginUser'){\r\n          navigator.dispatch(\r\n            NavigationActions.back()\r\n          )\r\n          //navigate('FrontScreen');\r\n          //return true;\r\n        }\r\n      }\r\n    }\r\n  });*/\r\n}\r\n\r\nfunction replace(routeName, params){\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.replace({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigate(routeName, params) {\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      NavigationActions.navigate({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route AND reset the navigation history.\r\n *\r\n * That means the user cannot go back. This is useful for example to redirect from a splashscreen to\r\n * the main screen: the user should not be able to go back to the splashscreen.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigateAndReset(routeName, params) {\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.reset({\r\n        index: 0,\r\n        key: null,\r\n        actions: [\r\n          NavigationActions.navigate({\r\n            routeName,\r\n            params,\r\n          }),\r\n        ],\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\nfunction nacigationPop() {\r\n  LastPage = \"\";\r\n  navigator.dispatch(NavigationActions.back())\r\n}\r\n\r\nexport default {\r\n  navigate,\r\n  replace,\r\n  navigateAndReset,\r\n  setTopLevelNavigator,\r\n  nacigationPop,\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Firebase Saga events\r\n  firebaseStartup: null,\r\n  //Firebase Saga and service\r\n  firebaseIsLoading: ['loadingstate'],\r\n  setFirebaseError: ['errorMessage'], // Firebase-saga error occurred\r\n\r\n  setViewError: ['errorMessage'], // view error\r\n  viewIsLoading: ['loadingstate'],\r\n  \r\n  setCurrentData: ['data'],\r\n\r\n  //Firebase Data fetches\r\n  actionStarting: ['action', 'ref', 'params'], // Data action (create, singin, share)\r\n  fetchStarting: ['action', 'ref', 'params'], // Fetch data informations\r\n  dataFetchSuccess: ['params'],\r\n  fetchSuccess: ['data'], // Informations were successfully fetched\r\n  fetchFailure: ['errorMessage'], // An error occurred\r\n})\r\n\r\nexport const FirebaseTypes = {...Types }\r\nexport default {...Creators }","import { Platform } from 'react-native';\r\n\r\nimport { put, call } from 'redux-saga/effects'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport ExampleActions from '../Stores/Example/Actions'\r\nimport DeviceActions from '../Stores/Device/Actions'\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\n\r\n/**\r\n * The startup saga is the place to define behavior to execute when the application starts.\r\n */\r\nexport function* startup() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  console.log(\"Starting sagas\")\r\n  \r\n  // Add more operations you need to do at startup here\r\n  //yield put(ExampleActions.fetchUser())\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    yield put(DeviceActions.deviceStartup())\r\n  }\r\n  yield put(FirebaseActions.firebaseStartup())\r\n\r\n  // When those operations are finished we redirect to the main screen\r\n  NavigationService.navigateAndReset('MainStack')\r\n}\r\n","const HTTPS_START = 'https://';\r\nexport const Config = {\r\n  API_URL: HTTPS_START+ 'jsonplaceholder.typicode.com/users/',\r\n\r\n  CONSYS_CLIENT_ID: 'consysapp',\r\n  CONSYS_CLIENT_SECRET: 'Kjsd832n8DIO32kmsdds3',\r\n  CONSYS_AUTH: '.agrisys.cloud/oauthserver/getaccesstoken/?redirect_uri=urn:ietf:wg:oauth:2.0:oob',\r\n  CONSYS_API: '.agrisys.cloud/consys-api-v1/',\r\n}\r\n\r\nexport function GetToken_URL(Site_URL, Refresh_Token) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_AUTH\r\n  res = res + '&client_id='+Config.CONSYS_CLIENT_ID+'&client_secret='+Config.CONSYS_CLIENT_SECRET+'&refresh_token=' + Refresh_Token\r\n  return res;\r\n}\r\n\r\nexport function GetCheckToken_URL(Site_URL) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_API + 'checkaccesstoken'\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtion_URL(Site_URL) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_API + 'getconsumptiondata?'\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtionData_URL(Site_URL, Consumptiontype, SystemId, Offset=null, Limit=null, Starttime=null, Stoptime=null, Lastid=null){\r\n  var res = GetConsumtion_URL(Site_URL)\r\n  res = res + GetConsumtionData_Var(Consumptiontype, SystemId, Offset, Limit, Starttime, Stoptime, Lastid)\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtionData_Var(Consumptiontype, SystemId, Offset=null, Limit=null, Starttime=null, Stoptime=null, Lastid=null){\r\n  var res = 'consumptiontype=' + Consumptiontype + '&systemid=' + SystemId;\r\n  if (Offset) res = res + '&offset=' + Offset;\r\n  if (Limit) res = res + '&limit=' + Limit;\r\n  if (Starttime) res = res + '&starttime=' + Starttime;\r\n  if (Stoptime) res = res + '&stoptime=' + Stoptime;\r\n  if (Lastid) res = res + '&lastid=' + Lastid;\r\n  return res;\r\n}","import axios from 'axios'\r\nimport { Config } from '../Config'\r\nimport { is, curryN, gte } from 'ramda'\r\n\r\nconst isWithin = curryN(3, (min, max, value) => {\r\n  const isNumber = is(Number)\r\n  return isNumber(min) && isNumber(max) && isNumber(value) && gte(value, min) && gte(max, value)\r\n})\r\nconst in200s = isWithin(200, 299)\r\n\r\n/**\r\n * This is an example of a service that connects to a 3rd party API.\r\n *\r\n * Feel free to remove this example from your application.\r\n */\r\nconst userApiClient = axios.create({\r\n  /**\r\n   * Import the config from the App/Config/index.js file\r\n   */\r\n  baseURL: Config.API_URL,\r\n  headers: {\r\n    Accept: 'application/json',\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 3000,\r\n})\r\n\r\nfunction fetchUser() {\r\n  // Simulate an error 50% of the time just for testing purposes\r\n  console.log(\"user fetch test\");\r\n  if (Math.random() > 0.5) {\r\n    return new Promise((resolve, reject) => {\r\n      console.log(\"error\");\r\n      resolve(null)\r\n    })\r\n  }\r\n\r\n  const number = Math.floor(Math.random() / 0.1) + 1\r\n\r\n  return userApiClient.get(number.toString()).then((response) => {\r\n    if (in200s(response.status)) {\r\n      return response.data\r\n    }\r\n\r\n    return null\r\n  })\r\n}\r\n\r\nexport const userService = {\r\n  fetchUser,\r\n}\r\n","import { put, call } from 'redux-saga/effects'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { userService } from '../../Services/UserService'\r\n\r\n/**\r\n * A saga can contain multiple functions.\r\n *\r\n * This example saga contains only one to fetch fake user informations.\r\n * Feel free to remove it.\r\n */\r\nexport function* fetchUser() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  yield put(ExampleActions.fetchUserLoading())\r\n\r\n  // Fetch user informations from an API\r\n  const user = yield call(userService.fetchUser)\r\n  if (user) {\r\n    yield put(ExampleActions.fetchUserSuccess(user))\r\n  } else {\r\n    yield put(\r\n      ExampleActions.fetchUserFailure('There was an error while fetching user informations.')\r\n    )\r\n  }\r\n}\r\n","import { Platform, PermissionsAndroid } from 'react-native'\r\nimport { Config } from '../Config'\r\n\r\nasync function isPermit_Android() {\r\n  if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n    const Have_Coarse_Location = await PermissionsAndroid.check(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n   if (!Have_Coarse_Location) {\r\n      const Got_Access = await PermissionsAndroid.request(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n      if (Got_Access !== PermissionsAndroid.RESULTS.GRANTED) {\r\n        console.log(\"No Ble Permission granted : Android\");\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction isBlePermitted() {\r\n  return new Promise((resolve, reject) => {\r\n    if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n      if (!isPermit_Android()){\r\n        resolve('This application needs premissions to be using BLE');\r\n      }\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nexport const deviceService = {\r\n  isBlePermitted,\r\n  //isPermit_Android,\r\n}\r\n","export const ScannerState = {\r\n  IDLE: 'IDLE',\r\n  AVAILABLE: 'AVAILABLE',\r\n  SCANNING: 'SCANNING',\r\n};\r\n\r\nexport const ConnectionState = {\r\n  DISCONNECTED: 'DISCONNECTED',\r\n  CONNECTING: 'CONNECTING',\r\n  DISCOVERING: 'DISCOVERING',\r\n  CONNECTED: 'CONNECTED',\r\n  DISCONNECTING: 'DISCONNECTING',\r\n};\r\n\r\nexport const ConnectionMethode = {\r\n  NONE: 'NONE',\r\n  BLE: 'BLE',\r\n  SERIAL: 'SERIAL',\r\n  BLUETOOTH: 'BLUETOOTH',\r\n  WIFI: 'WIFI',\r\n};","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\nimport base64 from 'react-native-base64'\r\nimport { Buffer } from 'buffer'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BleActions from '../../../Stores/Device/BLE/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device, State, Service, Characteristic, Descriptor } from 'react-native-ble-plx'\r\n\r\nexport function* bleStartup(sagaArgs) {\r\n  //Check and setup BLE....\r\n  const permitError = yield call(deviceService.isBlePermitted)\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BLEManager)\r\n    yield fork(handleBleState, sagaArgs.BLEManager)\r\n    yield fork(handleConnection, sagaArgs.BLEManager)\r\n  }\r\n  \r\n  console.log('BLE Startup : Done');\r\n}\r\n\r\n// This generator tracks our BLE state. Based on that we can enable scanning, get rid of devices etc.\r\n// eventChannel allows us to wrap callback based API which can be then conveniently used in sagas.\r\nfunction* handleBleState(manager: BleManager) {\r\n  console.log(\"Handle BLE State...\")\r\n\r\n  const stateChannel = yield eventChannel((emit) => {\r\n    const subscription = manager.onStateChange((state) => {\r\n      emit(state)\r\n    }, true)\r\n    return () => {\r\n      subscription.remove()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newState = yield take(stateChannel)\r\n      console.log(\"New BLE state: \" + newState)\r\n      yield put(BleActions.bleStateUpdated(newState))\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      stateChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* connectBle(device: Device) {\r\n  //dummy function\r\n}\r\n\r\nfunction* handleConnection(manager: BleManager) {\r\n  console.log(\"Handle BLE Connection...\")\r\n  \r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_DEVICE');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLE) continue;\r\n\r\n    var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n    //if (connectedDevice != null) return;  // TODO: Allready connected ? if problem\r\n\r\n    if (device === null || device._manager === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    if (device.isConnected()) {\r\n      console.log(\"is connected ??\");\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        yield call([device, device.connect]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        var _device = device;\r\n\r\n        yield fork(readBleDeviceData, manager)\r\n\r\n        for (; ;) {\r\n          const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });\r\n\r\n          if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield call([_device, _device.cancelConnection]);\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              //TODO: search for lost \"connected\" device..\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        /*yield put(\r\n            DeviceActions.setDeviceError(error)\r\n        )*/\r\n      } finally {\r\n        disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions...');\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBleDeviceData(manager: BleManager) {\r\n  // TODO: read service .... se Tests SensorTag-master project ... or try following\r\n  // or https://stackoverflow.com/questions/50137867/send-data-using-react-native-ble-plx-package\r\n  // or https://github.com/Polidea/react-native-ble-plx/issues/392\r\n  // or https://stackoverflow.com/questions/63012926/how-to-read-ble-peripheral-characteristics-in-react-native-using-react-native-bl\r\n  \r\n  // Better jet: https://www.polidea.com/blog/ReactNative_and_Bluetooth_to_An_Other_level/\r\n\r\n  \r\n  // Explanation of plx ble.. notify changes for characteristics and reading / writing\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Notifying\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Reading\r\n  \r\n  const KnownUUIDS = [\r\n    '0000fff0-0000-1000-8000-00805f9b34fb', //* BF-8 EarTag reader Service's\r\n    '0000fff1-0000-1000-8000-00805f9b34fb',\r\n\r\n    '0000180f-0000-1000-8000-00805f9b34fb', //* Battery service (General BLE)\r\n    '00002a19-0000-1000-8000-00805f9b34fb',\r\n  ];\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const _services: Array<Service> = yield call([device, device.services]);\r\n  const serviceUUIDs = device.serviceUUIDs;\r\n\r\n  const services: Array<Service> = _services.filter(service => serviceUUIDs.includes(service.uuid))\r\n\r\n  var monitor = [];\r\n\r\n  for (const service of services) {\r\n    console.log('Device had service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      console.log('  characteristic: ' + characteristic.uuid);\r\n\r\n      if (KnownUUIDS.includes(service.uuid) && KnownUUIDS.includes(characteristic.uuid)) {\r\n        monitor.push([service.uuid, characteristic.uuid])\r\n      }\r\n    }\r\n  }\r\n\r\n  //const services: Array<Service> = yield call([device, device.services]);\r\n  //TODO: merch with KnownUUIDS and withouth monitor.. (append services)\r\n  /*for (const service of services) {\r\n    console.log('Found service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      const descriptors: Array<Descriptor> = yield call([characteristic, characteristic.descriptors]);\r\n\r\n      for (const descriptor of descriptors) {\r\n        //Can contain value...\r\n        console.log('* Found descriptor: ' + descriptor.uuid);\r\n        const d: Descriptor = yield call([descriptor, descriptor.read]);\r\n        console.log('  ** Descriptor value: ' + (d.value || 'null'));\r\n\r\n        //yield call([descriptor, descriptor.write], 'AAA=');\r\n      }\r\n      if (characteristic.isReadable) {\r\n        //Can contain value...\r\n        var c = yield call([characteristic, characteristic.read]);\r\n        console.log('? characteristic: ' + characteristic.uuid);\r\n        if (characteristic.isNotifiable) {\r\n          console.log('  Is Notifiable');\r\n        }\r\n        //var basevalue = base64.decode(c.value);\r\n        //basevalue = basevalue.charCodeAt(0);\r\n        console.log('  ** Got base64 value: ' + c.value);\r\n        //if (characteristic.isWritableWithResponse) {\r\n      }\r\n    }\r\n  }*/\r\n\r\n  const readingChannel = yield eventChannel((emit) => {\r\n    monitor.forEach((service, i) => {\r\n      device.monitorCharacteristicForService(\r\n        service[0], service[1],\r\n        (error, characteristic) => {\r\n          if (error) {\r\n            emit([error, characteristic]);\r\n            return;\r\n          }\r\n          // ************************\r\n          if (characteristic != null) {\r\n            emit([error, characteristic]);\r\n          }\r\n          // *************************\r\n        },\r\n      );\r\n    });\r\n    \r\n    return () => {\r\n      // ****\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    // Used to receive multiple data packets\r\n    var TempData_Reading = Buffer.from([]);\r\n    var length = 0;\r\n    var PacketId = 0;\r\n\r\n    for (; ;) {\r\n      if (readingChannel != null) {\r\n        const [error, characteristic] = yield take(readingChannel);\r\n        if (error != null) {\r\n          yield put(DeviceActions.setDeviceError(error))\r\n        }\r\n        if (characteristic != null) {\r\n          //console.log(characteristic.uuid);\r\n          // Handler for Battery state Change\r\n          if (characteristic.uuid == \"00002a19-0000-1000-8000-00805f9b34fb\") {\r\n            var BatteryLevel = base64.decode(characteristic.value);\r\n            BatteryLevel = BatteryLevel.charCodeAt(0);\r\n            yield put(DeviceActions.updateDeviceData({Battery: BatteryLevel}))\r\n          } \r\n          // Handler for BF-8 EarTag reader Data\r\n          else if (characteristic.uuid == \"0000fff1-0000-1000-8000-00805f9b34fb\") {\r\n            //console.log(\"Raw \", characteristic.value);                        //Display data raw\r\n            var RawData = Buffer.from(characteristic.value, 'base64');    \r\n            //console.log(\"Base64 Decoded Buffer: \", RawData)               //Display data base64 decoded\r\n            //console.log(\"ascii: \", RawData.toString('ascii'));            //Display string\r\n\r\n            if (PacketId === 0) {                                         // If no data is processing (New Data read)\r\n              var header = RawData.slice(0,4)\r\n              if (Buffer.compare(header, Buffer.from([170,170,170,170])) == 0) {  // Data Read header [AA AA AA AA / -1431655766]\r\n                length = (parseInt(RawData.slice(4,8).toString(\"hex\"), 16) - 8)   // Next int is the data length (-8 for PacketId 8 bit)\r\n                PacketId = parseInt(RawData.slice(8,12).toString(\"hex\"), 16)      // Packet type id [Recv RFID Packet / Recv Fat Layers ID] = [251658240 / 2315255808]\r\n                RawData = RawData.slice(12,RawData.length)                        // Last of packet is filled with data\r\n\r\n                //console.log(\"Id = \", PacketId);\r\n                //console.log(\"data length = \", length);\r\n              }\r\n            }\r\n\r\n            var NewData = Buffer.concat([TempData_Reading, RawData])     // else append data string\r\n            //console.log(\"NewData: \", NewData);\r\n            //console.log(\"NewData base64: \", NewData.toString('base64'));\r\n            //console.log(\"ascii: \", NewData.toString('ascii'));\r\n            \r\n            //console.log(\"new length \", (NewData.length * 8));\r\n            if (NewData.length < 4 || Buffer.compare(NewData.slice(NewData.length -4, NewData.length), Buffer.from([85,85,85,85])) != 0) { // Data Read End [55 55 55 55]\r\n              TempData_Reading = NewData;\r\n            }\r\n            else {\r\n              while (NewData.length * 8 > length || Buffer.compare(NewData.slice(NewData.length-1, NewData.length), Buffer.from([85])) == 0){\r\n                NewData = NewData.slice(0, NewData.length -1)\r\n              }\r\n              if (PacketId == 251658240) { // Recv RFID Packet\r\n                var TagId = NewData.toString('ascii')\r\n                TagId = TagId.slice(0,3) + \"-\" + TagId.slice(3,TagId.length)\r\n                console.log(\"Read Tag: \", TagId);\r\n                yield put(DeviceActions.updateDeviceData({tagid: TagId, FatLayers: 0, FatL1: 0, FatL2: 0, FatL3: 0}))\r\n              } \r\n              else if (PacketId == 2315255808) { //Recv Fat Layers ID\r\n                console.log(\"Fat done\");\r\n                var layers = parseInt(NewData.slice(0,1).toString(\"hex\"), 16);    // First byte is Layer count\r\n                var layer1 = parseInt(NewData.slice(3,4).toString(\"hex\"), 16);    // 4th. byte is layer one fat layer (data is value in mm)\r\n                var layer2 = parseInt(NewData.slice(5,6).toString(\"hex\"), 16);    // 6th. byte is layer two fat layer (data is value in mm)\r\n                var layer3 = parseInt(NewData.slice(7,8).toString(\"hex\"), 16);    // 8th. byte is layer third fat layer (data is value in mm)\r\n\r\n                console.log(\"layers: \" + layers + \" layer1: \" + layer1);\r\n                console.log(\"layer2: \" + layer2 + \" layer3: \" + layer3);\r\n                console.log(\"NewData: \", NewData);\r\n\r\n                yield put(DeviceActions.updateDeviceData({FatLayers: layers, FatL1: layer1, FatL2: layer2, FatL3: layer3}))\r\n                /*var FatData = NewData.toString('ascii')\r\n                console.log(\"Read Data: \", FatData);*/\r\n\r\n                /*\r\n                getRealLayerDepthMM_1() {\r\n                return (((float) this.mRawLayerData1) * 1.0f) / 256.0f;\r\n                */\r\n              }\r\n\r\n              PacketId = 0;\r\n              length = 0;\r\n              TempData_Reading = Buffer.from([]);\r\n            }\r\n\r\n            /*const TestValue = Buffer.from(characteristic.value, 'base64').readUInt16LE(0);\r\n            console.log(\"Test Value: \" + TestValue);*/\r\n            \r\n            /*if (value.startsWith(\"****\")) {\r\n              var TagType = value.slice(value.length - 8, value.length - 5);\r\n              var TagId = value.slice(value.length - 5, value.length);\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGType: TagType}))\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            } else if (value.endsWith(\"UUUU\")){\r\n              var TagId = yield select((state) => state.device.deviceData)\r\n              TagId = TagId.TAGId + value;\r\n\r\n              while (TagId.startsWith('0')){\r\n                TagId = TagId.slice(1, TagId.length);\r\n              }\r\n              while (TagId.endsWith('U')){\r\n                TagId = TagId.slice(0, TagId.length -1)\r\n              }\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            }\r\n            else {\r\n              console.log(value);\r\n              yield put(DeviceActions.updateDeviceData({Unknown: value}))\r\n            }*/\r\n          } else {\r\n            console.log(\"unknown char: \", characteristic.uuid);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  } catch (error) {\r\n    //yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      if (readingChannel != null) readingChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * BLE state is in PoweredOn state\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLE\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager: BleManager) {\r\n  console.log(\"Handle BLE Scanning...\")\r\n\r\n  var scanTask = null\r\n  var bleState: $Keys<typeof State> = yield select((state) => state.device.bleState);\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'BLE_STATE_UPDATED',\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | BLE_STATE_UPDATED\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'BLE_STATE_UPDATED':\r\n        bleState = action.bleState\r\n        break;\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      bleState === State.PoweredOn && \r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLE &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n    \r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBle, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBle(manager: BleManager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n  \r\n  console.log(\"Scanning started\");\r\n\r\n  const scanningChannel = yield eventChannel((emit) => {\r\n    manager.startDeviceScan(\r\n      null,\r\n      { allowDuplicates: true },\r\n      (error, scannedDevice) => {\r\n        if (error) {\r\n          emit([error, scannedDevice]);\r\n          return;\r\n        }\r\n        // ************************\r\n        if (scannedDevice != null) {\r\n          if (scannedDevice.localName != null) {\r\n            //TODO: auto list only supported devices...\r\n            //TODO: auto connect \"missing / disconnected\" divece..\r\n\r\n            /*if (scannedDevice.id === TagId && TagId != null) { // Catch Specefic SensorTag\r\n              emit([error, scannedDevice]);\r\n            } else { //Else if not ....*/\r\n              emit([error, scannedDevice]);\r\n            //}\r\n          } \r\n          /*else if (scannedDevice.name != null && scannedDevice.name != \"\"){\r\n            console.log(\"Device found Name: \" + scannedDevice.name);\r\n          }\r\n          // Test\r\n          if (scannedDevice.isConnectable != null && scannedDevice.id != null){\r\n            console.log(\"Connect ??: \" + scannedDevice.id);\r\n          }*/\r\n        }\r\n        // *************************\r\n      },\r\n    );\r\n    return () => {\r\n      manager.stopDeviceScan();\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    for (; ;) {\r\n      const [error, scannedDevice]: [?BleError,?Device] = yield take(scanningChannel);\r\n      if (error != null) {\r\n        console.log(\"Ble Scan Error: \", error);\r\n        yield put(DeviceActions.setDeviceError(error))\r\n      }\r\n      if (scannedDevice != null) {\r\n        //console.log(\"Interest Device Found: \" + scannedDevice.localName);\r\n        yield put(DeviceActions.addDevice(scannedDevice));\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.log(\"Ble Scan Error: \", error);\r\n    yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      scanningChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBleScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBleScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBleScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\n\r\nexport function* stopBleScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}","import { PermissionsAndroid, NativeModules, NativeEventEmitter } from 'react-native'\r\nimport {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BluetoothActions from '../../../Stores/Device/BlueTooth/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { Device } from 'react-native-ble-plx'\r\n\r\nexport function* bluetoothStartup(sagaArgs) {\r\n  //Check and setup Bluetooth....\r\n  const permitError = yield call(deviceService.isBlePermitted) //BLE permits is same for bluetooth\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BlueManager)\r\n    yield fork(handleConnection, sagaArgs.BlueManager)\r\n  }\r\n  \r\n  console.log('BlueTooth Startup : Done');\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLUETOOTH\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager) {\r\n  console.log(\"Handle Bluetooh Scanning...\")\r\n\r\n  var scanTask = null\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLUETOOTH &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n\r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBluetooth, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//** Todo: Be done... (code is not touched... can contain lots of error) */\r\nfunction* handleConnection(manager) {\r\n  console.log(\"Handle Bluetooth Connection...\")\r\n\r\n  var testTask = null;\r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_BLUETOOTH');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLUETOOTH) continue;\r\n\r\n    if (device === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      // TODO: handle disconnect\r\n\r\n      /*const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);*/\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        const res = yield call(manager.PairDevice, device.id);\r\n        console.log(\"\",res);\r\n        //yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        //yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        //for (; ;) {\r\n          /*const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });*/\r\n\r\n          /*if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              yield call([device, device.cancelConnection]);\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }*/\r\n\r\n        //}\r\n      } catch (error) {\r\n        console.log(\"?: \", error);\r\n        //yield put(DeviceActions.setDeviceError(error))\r\n      } finally {\r\n        //disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions... ', error);\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBlueDeviceData(sagaArgs) {\r\n  console.log(\"Blue Read\");\r\n  const manager = sagaArgs.BlueManager;\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const Message = yield call(manager.receiveData, device.id);\r\n  console.log(Message);\r\n  if (Message != \"\") {\r\n    yield put(DeviceActions.updateDeviceData({TAGId: Message}))\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBluetooth(manager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n\r\n  console.log(\"Scanning started\");\r\n\r\n  yield call(manager.Discover);\r\n  const bluetoothChannel = yield eventChannel((emit) => {\r\n    const blueTootControlEmitter = new NativeEventEmitter(manager);\r\n    const subscription = blueTootControlEmitter.addListener('blueToothDeviceFound', (device) => {\r\n      if (device != null){\r\n        var scannedDevice = new Device();\r\n        scannedDevice.id = device.address\r\n        scannedDevice.localName = (device.name != null ? device.name : \"NONE\");\r\n        scannedDevice.name = device.alias\r\n        \r\n        if (scannedDevice.localName != null) {\r\n          if (scannedDevice.localName === 'SensorTag') { // Catch Specefic SensorTag\r\n            //console.log(\"Device with Tag found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          } else { //Else if not ....\r\n            //console.log(\"Device found localName: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          }\r\n        } \r\n        else if (device.alias != null && device.alias != \"\"){\r\n          scannedDevice.name = device.alias\r\n          emit(scannedDevice);\r\n          //console.log(\"Device found Name: \" + scannedDevice.name);\r\n        }\r\n      }\r\n    })\r\n    return () => {\r\n      subscription.remove();\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const scannedDevice: Device = yield take(bluetoothChannel);\r\n      if (scannedDevice != null) {\r\n        console.log(\"Interest Device Found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n        yield put(DeviceActions.addDevice(scannedDevice))\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield call(manager.StopDiscovery);\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      bluetoothChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBluetoothScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLUETOOTH)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBlueScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBlueScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\nexport function* stopBluetoothScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}\r\n\r\nexport function* bluetoothScanAble(sagaArgs){\r\n  yield call(sagaArgs.BlueManager.BluetoothSearchAble);\r\n}","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { deviceService } from '../../Services/DeviceService'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device} from 'react-native-ble-plx'\r\n//Include BLE Saga\r\nimport * as BLE from './BLE/BLESaga'\r\nexport {BLE}\r\n//Include BlueTooth Saga\r\nimport * as BlueTooth from './BlueTooth/BlueToothSaga'\r\nexport {BlueTooth}\r\n\r\nexport function* deviceStartup() {\r\n  //Check and setup BLE.... / Bluetooth\r\n  yield put(DeviceActions.setDeviceError(\"\"))\r\n  yield put(DeviceActions.clearDevices());\r\n  yield put(DeviceActions.connectedDeviceUpdated(null)); // TODO: load connected device if possible\r\n  yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n\r\n  yield put(DeviceActions.bleStartup());\r\n  yield put(DeviceActions.bluetoothStartup());\r\n  \r\n  console.log('Device Startup : Done');\r\n}\r\n\r\nexport function* connectDevice(device: Device){\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n  //console.log(\"Device: \", device); // dummy call to connect...\r\n}\r\n\r\nexport function* disconnectDevice(methode){\r\n  //console.log(\"Device: \", device); // dummy call to disconnect...\r\n}\r\n\r\nexport function* readDeviceData(){\r\n  var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n  if (connectedDevice != null) {\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode == ConnectionMethode.BLE) {\r\n      yield put(DeviceActions.readBleDeviceData())\r\n    } else if (connectionMethode == ConnectionMethode.BLUETOOTH) {\r\n      yield put(DeviceActions.readBlueDeviceData())\r\n    }\r\n  }\r\n}\r\n\r\nexport function* fetchDevice(sagaArgs) {\r\n  console.log(\"??\");\r\n  //yield put(DeviceActions.fetchDeviceLoading())\r\n  //yield call(scan_BLE, sagaArgs);\r\n}","//#region Defines\r\nexport const UserStates = {\r\n  STARTER: 'starter',\r\n  FREE: 'free',\r\n  WORKER: 'worker',\r\n  OWNER: 'owner',\r\n  ADMIN: 'admin',\r\n}\r\n\r\nexport const DataStates = {\r\n  CLOSED: 'Closed'\r\n}\r\n\r\nexport const DataRefs = {\r\n  FIREBASEUSER: 'firebaseuser',\r\n  USERSDATA: 'usersdata',\r\n  USERS: 'users',\r\n  FARMS: 'farms',\r\n  SECTIONS: 'farms_data/$farmid/sections',\r\n  PENS: 'farms_data/$farmid/pens',\r\n  PIGS: 'farms_data/$farmid/pigs',\r\n  BATCHS: 'farms_data/$farmid/batchs',\r\n\r\n  WEIGHING: 'farms_data/$farmid/pens/$penid/weighings/',\r\n  GRAPH: 'farms_data/$farmid/Graph/$graphid/',\r\n\r\n  COMMENTS: 'farms_data/$farmid/datas/comments/',\r\n  FARMDATAS: 'farms_data/$farmid/datas/',\r\n  SHARES: 'shareData',\r\n\r\n  CONSYS: 'consys',\r\n}\r\n\r\nexport const ConsysRefs = {\r\n  VALVEFEED: 100,\r\n  SCALE: 700,\r\n}\r\n\r\nexport const Actions = {\r\n  SIGN: 'sign',\r\n\r\n  FETCH: 'fetch',\r\n  CREATE: 'create',\r\n  UPDATE: 'update',\r\n  MOVE: 'move',\r\n  DELETE: 'delete',\r\n  CLEAR: 'clear',\r\n  ADD: 'add',\r\n}\r\n\r\nexport const Operations = {\r\n  ADD: 'Add pig',\r\n  MOVE: 'Move pig',\r\n  LOST: 'Lost pig',\r\n  SOLD: 'Sold pig',\r\n  NOTE: 'Pen Note',\r\n}\r\n\r\nexport const ErrorTypes = {\r\n  SYSTEM: 'System',\r\n  EMAIL: 'Email',\r\n  PASSWORD: 'Password',\r\n  FORMAT: 'Format',\r\n}\r\n//#endregion\r\n\r\n//#region Formaters\r\nfunction format_num(num) {\r\n  if (num < 10){\r\n    num = \"0\"+num\r\n  }\r\n  return num;\r\n}\r\nexport function format_Time(time) {\r\n  var s = new Date(parseInt(time));\r\n  var datetime = format_num(s.getDate()) + \"/\" + format_num(s.getMonth() +1) + \"/\" + s.getFullYear() + \" \" \r\n                  + format_num(s.getHours()) + \":\" + format_num(s.getMinutes()) + \":\" + format_num(s.getSeconds());\r\n  return datetime\r\n}\r\n\r\nvar reA = /[^a-zA-Z]/g;\r\nvar reN = /[^0-9]/g;\r\nfunction sortAlphaNum(a, b) {\r\n  var aA = a.replace(reA, \"\");\r\n  var bA = b.replace(reA, \"\");\r\n  if (aA === bA) {\r\n    var aN = parseInt(a.replace(reN, \"\"), 10);\r\n    var bN = parseInt(b.replace(reN, \"\"), 10);\r\n    return aN === bN ? 0 : aN > bN ? 1 : -1;\r\n  } else {\r\n    return aA > bA ? 1 : -1;\r\n  }\r\n}\r\n\r\nexport function sortObject(o) {\r\n  var sorted = {},\r\n  key, a = [];\r\n\r\n  for (key in o) {\r\n    if (o.hasOwnProperty(key) && key !== \"__jsogObjectId\" && key !== \"update_time\") {\r\n      a.push(key);\r\n    }\r\n  }\r\n  a.sort(sortAlphaNum);\r\n\r\n  for (key = 0; key < a.length; key++) {\r\n    sorted[a[key]] = o[a[key]];\r\n  }\r\n  return sorted;\r\n}\r\n\r\nexport function DataStringCheck(data, Check_num = true) {\r\n  if (!data || data === \"\"){\r\n    return false\r\n  }\r\n  if (!typeof(data) === 'string'){\r\n    return false\r\n  }else {\r\n    if (Check_num) {\r\n      var first = data[0]\r\n      var numbers = '0123456789';\r\n      for(var i = 0; i < numbers.length;i++){\r\n        if(first === numbers[i]){\r\n          return false\r\n        }\r\n      }\r\n    }\r\n\r\n    var specialChars = '/[`!@#$%^&*()+\\-=\\[\\]{};\\':\"\\\\|,.<>\\/?~]/';\r\n    for(var i = 0; i < specialChars.length;i++){\r\n      if(data.indexOf(specialChars[i]) > -1){\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  return true\r\n}\r\n//#endregion\r\n\r\n//#region Data gets\r\nexport function GetWeight_FromPen(PenId, WeighingsStore = null, AfterTime = null, BeforeTime = null) {\r\n  //PenId: Parrent Get ellement (ID),\r\n  //WeighingsStore: LocalDataStore.weighings,\r\n  //AfterTime: Only data after specefied Time,\r\n  //BeforeTime: Only data before specefied Time\r\n  var Weighing = null;\r\n\r\n  if (PenId, WeighingsStore){\r\n    for (const _weighing in WeighingsStore[PenId]) {\r\n      var weighing = WeighingsStore[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) {\r\n        if ((!AfterTime || weighing.time >= AfterTime) &&\r\n          (!BeforeTime || weighing.time <= BeforeTime)) {\r\n          Weighing = weighing\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return Weighing;\r\n}\r\n\r\nexport function GetBatch_FromPen(localDataStore, PenId) {\r\n  if (localDataStore.batchs) {\r\n    //Get batch form pen\r\n    for (const _batch in localDataStore.batchs) {\r\n      var batch = localDataStore.batchs[_batch]\r\n      if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n        return localDataStore.batchs[_batch]\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetStats_FromPen(PenId, PenData, localDataStore, StartDate, EndDate, PenWeighings = null){\r\n  var Animals = 0;\r\n  var PenWeight = 0\r\n  var PenGrowth = 0\r\n  var AveragePenGrowth = 0;\r\n\r\n  if (PenData.datas && PenData.datas.count || PenData.count) {\r\n    if (PenData.count) Animals += PenData.count\r\n    else Animals += PenData.datas.count\r\n  }\r\n  \r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var GrowthCount = 0\r\n\r\n    var lastDate = 0\r\n    var LastWeight = undefined;\r\n    var LastWeightDay = undefined;\r\n    var FirstWeight = undefined;\r\n\r\n    if (!PenWeighings) PenWeighings = localDataStore.weighings[PenId]\r\n    if (PenWeighings) {\r\n      Object.keys(PenWeighings).forEach((weight) => {\r\n        var Weight = PenWeighings[weight]\r\n        if (Weight.time >= StartDate && Weight.time <= EndDate && Weight.time > lastDate) {\r\n          PenWeight = Weight.weight\r\n          if (Weight.count) PenWeight = Weight.weight / Weight.count;\r\n\r\n          if (LastWeight !== undefined) {\r\n            PenGrowth = PenWeight - LastWeight\r\n            GrowthCount++;\r\n          }\r\n\r\n          lastDate = Weight.time\r\n          LastWeight = PenWeight\r\n          LastWeightDay = Weight.time\r\n          if (!FirstWeight) FirstWeight = Weight.time;\r\n        }\r\n      })\r\n    }\r\n\r\n    var now = new Date().getTime()\r\n    var isVirtual = false;\r\n    if (StartDate && EndDate) {\r\n      var Batch = GetBatch_FromPen(localDataStore,PenId)\r\n      var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      var BatchEndDate = EndDate;\r\n      var Predict = CurvePredict(localDataStore, PenId, Batch, TempGraph)\r\n      if (Predict != null && Predict.Now && now > new Date(lastDate).getDate()) {\r\n        PenWeight = Predict.Now\r\n        if (LastWeight !== undefined) {\r\n          PenGrowth += PenWeight - LastWeight\r\n          GrowthCount++;\r\n        }\r\n        var _date = new Date(Predict.lastWeighing.time + Predict.Addition)\r\n        _date.setDate(_date.getDate() + Predict.days)\r\n        LastWeightDay = _date.getTime()\r\n        isVirtual = true\r\n      }\r\n      if (Predict && Predict.lastWeighing && Predict.days) {\r\n        var tempEnd = new Date(EndDate).getTime()\r\n        var date = new Date(Predict.lastWeighing.time)\r\n        date.setDate(date.getDate() + Predict.days)\r\n        tempEnd = date.getTime()\r\n        if (Predict.Addition) {\r\n          tempEnd += Predict.Addition\r\n        }\r\n        if (EndDate === BatchEndDate || EndDate < tempEnd) {\r\n          EndDate = tempEnd;\r\n        }\r\n      }\r\n    }\r\n    if (GrowthCount > 0) {\r\n      var Growth = (PenGrowth / GrowthCount)\r\n      var days = (LastWeightDay - FirstWeight) / 86400000\r\n      Growth = Growth / days\r\n      AveragePenGrowth += Growth //AverageGrowth for specefic pen\r\n    }\r\n  }\r\n  return { Animals, PenWeight, AveragePenGrowth, EndDate, isVirtual }\r\n}\r\n\r\nexport function GetStats_FromBatch(Batch, localDataStore, Closed=true) {\r\n  var isVirtual = false;\r\n  var PenCount = 0;\r\n  var Animals = 0\r\n  var CollectedWeight = 0;\r\n  var CollectedGrowth = 0;\r\n  \r\n  var isClosed = (Batch.state && Batch.state === \"Closed\")?true:false\r\n\r\n  var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n  if (!TempGraph) return null;\r\n  var TargetWeight = (Batch && Batch.datas && Batch.datas.target)?Batch.datas.target:TempGraph.data[TempGraph.data.length -1]\r\n  var EndDate = GetBatchEnd(Batch, TempGraph)\r\n  var StartDate = Batch.time;\r\n\r\n  var PenEnds = 0\r\n  if (Batch && Batch.pens && localDataStore.pens) {\r\n    Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(Batch_Pen => {\r\n      if (localDataStore && localDataStore.pens && localDataStore.pens[Batch_Pen] && localDataStore.weighings && localDataStore.weighings[Batch_Pen] || isClosed) {\r\n        var Pen = isClosed?Batch.pens[Batch_Pen]:localDataStore.pens[Batch_Pen]\r\n        PenCount++\r\n        \r\n        var PenWeighings = isClosed?Batch.closed.weighings[Batch_Pen]:localDataStore.weighings[Batch_Pen]\r\n        if (PenWeighings) {\r\n          var PenStats = GetStats_FromPen(Batch_Pen, Pen, localDataStore, StartDate, EndDate, PenWeighings)\r\n          Animals += PenStats.Animals;\r\n          var PenWeight = PenStats.PenWeight\r\n          if (PenWeight === 0) {\r\n            PenCount--\r\n          } else {\r\n            CollectedWeight += PenWeight\r\n            CollectedGrowth += PenStats.AveragePenGrowth\r\n            if (PenEnds < PenStats.EndDate) PenEnds = PenStats.EndDate\r\n            if (!isVirtual) isVirtual = PenStats.isVirtual\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  if (PenEnds > 0) EndDate = PenEnds\r\n  var AverageWeight = CollectedWeight / PenCount\r\n  AverageWeight = parseFloat(AverageWeight).toFixed(2)\r\n  var AverageGrowth = CollectedGrowth / PenCount\r\n  AverageGrowth = parseFloat(AverageGrowth).toFixed(2)\r\n\r\n  return {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual}\r\n}\r\n\r\nexport function GetCurve_FromBatch(Batch, GraphsStore = null, CurrentData = null) {\r\n  //Batch: Parrent Get ellement,\r\n  //GraphsStore: LocalDataStore.graphs,\r\n  //CurrentData: Data state get,\r\n  if (Batch) {\r\n    var Garph = null\r\n    console.log(Batch)\r\n    if (Batch.gcurve && Batch.state && Batch.state === DataStates.CLOSED) {\r\n      Garph = Batch.gcurve;\r\n    } else if (GraphsStore) {\r\n      if (CurrentData && (typeof CurrentData === 'string' || CurrentData.curveId)) {\r\n        var Id = (typeof CurrentData === 'string')? CurrentData: CurrentData.curveId\r\n        Garph = GraphsStore[Id]\r\n      }\r\n      if (Batch.gcurve) {\r\n        Garph = GraphsStore[Batch.gcurve];\r\n      }\r\n    }\r\n    if (Garph) {\r\n      var DataPoints = []\r\n      var _index = 0;\r\n      Object.keys(Garph.data).filter(e => e !== '__jsogObjectId').map((index) => {\r\n        DataPoints[index] = Garph.data[index]\r\n        for(var i = index-1; i > _index;i--) {\r\n          DataPoints[i] = null\r\n        }\r\n        _index = index\r\n      })\r\n      Garph.data = DataPoints\r\n      return Garph;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetBatchEnd(Batch, TempCurve) {\r\n  if (Batch && Batch.time && TempCurve) {\r\n    var currentTime = new Date(Batch.time) //Does not allow weight's after Batch end\r\n    for (var i = 0; i < TempCurve.data.length; i++) {\r\n      if (i < TempCurve.data.length -1) {\r\n        currentTime = new Date(AccumulateTime(currentTime, TempCurve.periode))\r\n      }\r\n    }\r\n    return currentTime.getTime();\r\n  }\r\n  return null\r\n}\r\n//#endregion\r\n\r\n//#region Curve Functions\r\nexport function AccumulateTime(Time, PeriodeLength) {\r\n  var NewTime = new Date(Time.getTime())\r\n  switch(PeriodeLength) {\r\n    case \"Days\":\r\n    //86.400.000 ms\r\n    NewTime.setDate(NewTime.getDate() + 1)\r\n    break;\r\n    case \"Month\":\r\n    NewTime.setMonth(NewTime.getMonth() + 1)\r\n    break;\r\n    case \"Weeks\":\r\n    default:\r\n    NewTime.setDate(NewTime.getDate() + 7)\r\n    break;\r\n  }\r\n  return NewTime;\r\n}\r\n\r\n//Get Today-point expected data and virtual simulation For PenId with Batch / or given\r\nexport function get_DataSpot_FromData(localDataStore, PenId, Batch, Closed = false) {\r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var Weighing = null;\r\n\r\n    //get newest weighing\r\n    for (const _weighing in localDataStore.weighings[PenId]) {\r\n      var weighing = localDataStore.weighings[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) { \r\n        Weighing = weighing\r\n      }\r\n    }\r\n\r\n    if (Weighing) {\r\n      var weight = Weighing.weight\r\n      weight = weight / Weighing.count\r\n      if (weight && !isNaN(weight)) {\r\n        if (!Batch) {\r\n          //Get batch form pen\r\n          for (const _batch in localDataStore.batchs) {\r\n            var batch = localDataStore.batchs[_batch]\r\n            if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n              Batch = localDataStore.batchs[_batch]\r\n              //break; //diffrenc from web ??? (needed in mobile..)\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Batch && Batch.time && Batch.datas \r\n          && localDataStore.graphs && localDataStore.graphs[Batch.gcurve]) {\r\n          var Curve = localDataStore.graphs[Batch.gcurve]\r\n          var WeighingTime = Weighing.time\r\n\r\n          if (Closed || (WeighingTime > Batch.time && (!Batch.state || Batch.state !== \"Closed\"))) {\r\n            var StartTime = Batch.time\r\n            var EndTime = Batch.time\r\n            var index = 0;\r\n            var currentTime = new Date(StartTime)\r\n            for (index = 0; index < Curve.data.length-1; index++) {\r\n              currentTime = new Date(AccumulateTime(currentTime, Curve.periode))\r\n              EndTime = currentTime.getTime()\r\n              if (EndTime >= WeighingTime) {\r\n                break;\r\n              } else {\r\n                StartTime = EndTime\r\n              }\r\n            }\r\n            //var EndDate = EndDate = currentTime.getTime();\r\n            \r\n            var Keys = Object.keys(Curve.data);\r\n            var DataSpot = get_DataSpot([StartTime, EndTime], [Curve.data[Keys[index]], Curve.data[index +1]], new Date().getTime(), weight, WeighingTime)\r\n            DataSpot.Batch = Batch\r\n            return DataSpot\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\n//Get point expected data and virtual simulation from data.\r\n//ExValue = Expected value if slope continues, for spots given (or inbetween).\r\n//VirData = Virtual calculation for Data progress to DataTime, if slope continues.\r\nexport function get_DataSpot(MinMax_Time, MinMax_Data, FindTime, Data, DataTime) {\r\n  var ExValue = null\r\n  var VirData = null\r\n  var ExTime = null\r\n  if (FindTime) {\r\n    var slope = GetSlope_Between(MinMax_Time, MinMax_Data)\r\n    var FindX = FindTime- MinMax_Time[0]\r\n    // ExValue = (FindX * Slope) + MinY             // Setting FindTime, due b then = Min data.. (b is y = 0)\r\n    ExValue = (FindX * slope) + MinMax_Data[0]          // ( X * a ) + b = Expeted data for spot on CalcTime\r\n    \r\n    if (Data && DataTime) {\r\n      var Findx2 = DataTime- MinMax_Time[0]\r\n      var ExData = (Findx2 * slope) + MinMax_Data[0]    //Expeted data for given Time 2\r\n      \r\n      var DataDiff = ExData - Data;\r\n      VirData = ExValue + DataDiff;\r\n\r\n      ExTime = (Data - MinMax_Data[0]) / slope          // (y-b)/a = Expeted time for data\r\n      ExTime = MinMax_Time[0] + ExTime\r\n      ExTime = Math.floor(ExTime)\r\n    }\r\n  }\r\n  return {ExValue, VirData, ExTime}\r\n}\r\n\r\n//Get Slope Between two points\r\nfunction GetSlope_Between(MinMax_Time, MinMax_Data){\r\n  var minX = MinMax_Time[0]\r\n  var maxX = MinMax_Time[1]\r\n  var minY = MinMax_Data[0]\r\n  var maxY = MinMax_Data[1]\r\n\r\n  //Slope = DeltaY / DeltaX\r\n  var slope = (maxY - minY) / (maxX - minX)\r\n  if (minY > minX) slope = -slope;\r\n  return slope\r\n}\r\n\r\nexport function CurvePredict(localDataStore, PenId, Batch, TempCurve) {\r\n  if (localDataStore) {\r\n    /* Get data */\r\n    if (!PenId && Batch && Batch.pens){\r\n      PenId = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId'))[0]\r\n    }\r\n    if (!Batch) {\r\n      Batch = GetBatch_FromPen(localDataStore, PenId)\r\n    }\r\n    if (Batch && Batch.time) {\r\n      if (!TempCurve) {\r\n          TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      }\r\n      if (TempCurve && TempCurve.data) {\r\n        var BatchEndDate = GetBatchEnd(Batch, TempCurve)\r\n        var Weighing = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, BatchEndDate);\r\n        if (Weighing && Weighing.weight) {\r\n          var weight = Weighing.weight\r\n          if (Weighing.count) weight = weight / Weighing.count\r\n          var Weighing2 = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, Weighing.time -1);\r\n          var weight2 = Weighing2?Weighing2.weight:0\r\n          if (Weighing2 && Weighing2.count) weight2 = weight2 / Weighing2.count\r\n\r\n          var StartIndex = \"none\";\r\n          var PredictCurve = { periode: TempCurve.periode, data: [] }\r\n          var now = new Date(Date.now())\r\n          now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n          var CurrentTime = new Date(Batch.time)\r\n          var Temp_CurrentIndex = 0;\r\n\r\n          /* find template fit */\r\n          for (var index = 0; index < TempCurve.data.length; index++) {\r\n            if (CurrentTime.getTime() <= now) {\r\n              CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n              Temp_CurrentIndex++;\r\n            }\r\n\r\n            if (weight <= TempCurve.data[index]) {\r\n              if (StartIndex === \"none\") {\r\n                StartIndex = index\r\n                if (index === 0) {\r\n                  var slope = GetSlope_Between([Weighing.time,AccumulateTime(new Date(Weighing.time), TempCurve.periode)],[TempCurve.data[0], TempCurve.data[1]])\r\n                  var time = (TempCurve.data[0]- weight)/slope\r\n                  Weighing2 = Weighing\r\n                  weight2 = weight\r\n                  Weighing = {weight: TempCurve.data[0], time: Math.floor(Weighing.time + time)}\r\n                  weight = TempCurve.data[0]\r\n                }\r\n              }\r\n              PredictCurve.data.push(TempCurve.data[index])\r\n            }\r\n          }\r\n\r\n          if (weight < weight2) {\r\n            StartIndex = StartIndex -1\r\n            PredictCurve.data.unshift(TempCurve.data[StartIndex])\r\n          }\r\n\r\n          var PredictStart = new Date(Batch.time)\r\n          for (let index = 0; index < StartIndex; index++) {\r\n            PredictStart = new Date(AccumulateTime(PredictStart, TempCurve.periode))\r\n          }\r\n\r\n          PredictCurve.Now = weight\r\n          PredictCurve.TempEx = TempCurve.data[Temp_CurrentIndex]\r\n          if (StartIndex !== \"none\") {\r\n            var DataSpot = null\r\n            if (Weighing2) {\r\n              DataSpot = get_DataSpot([Weighing2.time, Weighing.time], [weight2, weight], Weighing.time, TempCurve.data[StartIndex], PredictStart.getTime())\r\n            }\r\n            if (DataSpot && DataSpot.ExTime) {\r\n              PredictCurve.FirstSpot = DataSpot.ExTime \r\n              PredictCurve.Addition = DataSpot.ExTime - Weighing.time\r\n            } else {\r\n              PredictCurve.FirstSpot = new Date(Weighing.time + 86400000)\r\n              PredictCurve.Addition = 86400000\r\n            }\r\n\r\n            if (BatchEndDate) {\r\n              var now = new Date(Date.now())\r\n              /*if (BatchEndDate <= now) {\r\n                now = new Date(BatchEndDate)\r\n              }*/\r\n\r\n              now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n              var Temp_CurrentTime\r\n              CurrentTime = new Date(Weighing.time)\r\n              var CurrentIndex = 0;\r\n              for (var index = 0; index < PredictCurve.data.length; index++) {\r\n                if (CurrentTime.getTime() < now) {\r\n                  Temp_CurrentTime = CurrentTime\r\n                  CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n                  CurrentIndex ++;\r\n                }\r\n              }\r\n              var WeightNow\r\n              if (CurrentIndex >= PredictCurve.data.length) {\r\n                DataSpot = get_DataSpot([Temp_CurrentTime, CurrentTime], [PredictCurve.data[PredictCurve.data.length-2], PredictCurve.data[PredictCurve.data.length-1]], Date.now())\r\n                WeightNow = DataSpot.ExValue\r\n              } else {\r\n                CurrentIndex--\r\n                WeightNow = PredictCurve.data[CurrentIndex];\r\n              }\r\n              if (WeightNow) PredictCurve.Now = WeightNow\r\n              else PredictCurve.Now = weight\r\n            }\r\n          }\r\n\r\n          var days = 0;\r\n          if (TempCurve.periode === \"Days\") days = PredictCurve.data.length\r\n          else if (TempCurve.periode === \"Weeks\") days = (PredictCurve.data.length) * 7\r\n          PredictCurve.days = days\r\n          PredictCurve.lastWeighing = Weighing\r\n\r\n          Batch.datas.target = (Batch.datas.target)?Batch.datas.target:TempCurve.data[TempCurve.data.length-1]\r\n          PredictCurve.Batch = Batch;\r\n          return PredictCurve;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n//#endregion","import { Platform, Alert } from 'react-native'\r\n\r\nimport { UserStates } from '../Stores/Firebase/Selectors'\r\nimport { Actions, DataRefs, DataStates, format_Time } from '../Stores/Firebase/Selectors';\r\n\r\nlet auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  console.log(\"firebase load\")\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase\r\n\r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n\r\n  auth = _firebase.auth;\r\n  if (_firebase.messaging.isSupported()){\r\n    messaging = _firebase.messaging;\r\n  }\r\n  database = _firebase.database;\r\n  console.log(\"Started\")\r\n  //#endregion\r\n}\r\n\r\n//#region Firebase specefic services\r\nasync function isPermit_UserPermission() {\r\n  console.log(\"permit test\")\r\n  if (messaging) {\r\n    const authStatus = await messaging().requestPermission();\r\n    const enabled =\r\n      authStatus === messaging.AuthorizationStatus.AUTHORIZED ||\r\n      authStatus === messaging.AuthorizationStatus.PROVISIONAL;\r\n\r\n    if (!enabled) {\r\n      console.log('Authorization status:', authStatus);\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction requestUserPermission() {\r\n  return new Promise((resolve, reject) => {\r\n    if ((Platform.OS === \"ios\" || Platform.OS == \"android\") && !isPermit_UserPermission()) {\r\n      resolve('This application needs premissions to be using notifications')\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nasync function is_getToken() {\r\n  var fcmToken = \"\"\r\n  if (messaging) {\r\n    try{\r\n      fcmToken = await messaging().getToken();\r\n      console.log('Device_token: ', fcmToken)\r\n    }catch(error){\r\n      console.log(error)\r\n    }\r\n  }\r\n  return fcmToken;\r\n}\r\n\r\nfunction requestFirebaseToken() {\r\n  return new Promise((resolve, reject) => {\r\n    var token;\r\n    if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    } else if (messaging && messaging.isSupported()) {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    }\r\n    if (!token) {\r\n      resolve('Could not find Firebase messaging Token')\r\n    }\r\n    resolve(token)\r\n  })\r\n}\r\n\r\nfunction wrappedAlert(title, message, okText, _cancelable) {\r\n  return new Promise(resolve => {\r\n    Alert.alert(\r\n      title,\r\n      message,\r\n      [{text: okText, onPress: function() { resolve(); }}],\r\n      {cancelable: _cancelable, onDismiss: function() {resolve(); }},\r\n    );\r\n  });\r\n}\r\n//#endregion\r\n\r\n//#region Firebase Auth services\r\nfunction createFirebaseUserWithemailandpassword({Email, Pass}) {\r\n  return new Promise((resolve, reject) => {\r\n    auth().createUserWithEmailAndPassword(Email,Pass).then(() => {\r\n      var User = auth().currentUser;\r\n      var Name = User.displayName ? User.displayName : User.email\r\n      actionStarting(DataRefs.USERSDATA, Actions.UPDATE, {UserId: User.uid, Data: {\r\n        name: Name,\r\n        state: UserStates.STARTER,\r\n      }}).then((_data) => {\r\n        User.updateProfile({\r\n          displayName: Name\r\n        }).then((data) => {\r\n          User.sendEmailVerification().then(function() {\r\n            // Email sent.\r\n            resolve(null)\r\n          }).catch(function(error) {\r\n            console.log(\"error in send EmailVerification\", error)\r\n            resolve({error:error.code, viewError:'Verification could not be send'})\r\n          });\r\n        }).catch(function(error) {\r\n          console.log(\"update profile\")\r\n          resolve({error:error.code, viewError:'Update error, please refresh'})\r\n        });\r\n      })\r\n      \r\n    }).catch(error => {\r\n      console.log(\"UserCreate Error: \", error);\r\n      if (error.code === 'auth/email-already-in-use') {\r\n        resolve({error:error.code, viewError:'The email address is already in use.'})\r\n        //Should not exploid the users... (this could be used as a find user-mails) ???\r\n      }\r\n      else if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else if (error.code === 'auth/weak-password') {\r\n        resolve({error:error.code, viewError: error.message})\r\n      } else {\r\n        resolve({error:error.code, viewError: 'Something went wrong'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction signinWithemailandpassword({Email, Pass}){\r\n  if (auth().currentUser){\r\n    if (auth().currentUser.email != Email){\r\n      const res = logoutUser()\r\n    }\r\n    else {\r\n      return new Promise((resolve, reject) => {\r\n        resolve(true)\r\n      })\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    auth().signInWithEmailAndPassword(Email,Pass).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User Signin Error: \", error);\r\n\r\n      if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else {\r\n        resolve({error:'Could not singin', viewError:'Could not singin'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction sendResetPassword({Email}){\r\n  return new Promise((resolve, reject) => {\r\n    auth().sendPasswordResetEmail(Email).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User resetPass error:\", error);\r\n      if (error.code === 'auth/user-not-found'){\r\n        //Should not exploid the users... (this could be used as a find user-mails)\r\n      }\r\n      resolve(null)\r\n    })\r\n  })\r\n}\r\n\r\nfunction logoutUser(){\r\n  return new Promise((resolve, reject) => {\r\n    auth().signOut().then(() => {\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    }).catch(error => {\r\n      console.log(\"User logout error:\", error);\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    })\r\n  })\r\n}\r\n\r\nfunction refreshUser(){\r\n  return new Promise((resolve, reject) => {\r\n    var user = auth().currentUser\r\n    if (user){\r\n      auth().currentUser.reload().then((data) => {\r\n        user = auth().currentUser\r\n        console.log(data, user)\r\n        //resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n      })\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Master Control\r\nfunction actionStarting(ref, action, params = null){\r\n  const CurrentUser = auth().currentUser;\r\n  switch(ref){\r\n    case DataRefs.USERSDATA:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"UserData\")) {\r\n            return new Promise((resolve, reject) => {\r\n              var Data = params[0]\r\n              createFarm({Data:{name: params.Farms.name}}).then((farmid) => {\r\n                updateFarmData({FarmId:farmid, Data:{sections:params.Sections, pens: params.Pens}}).then(() => {\r\n                  updateUserData({Data:{state: params.UserData.state, farms: {[farmid]: true}}}).then(() => {\r\n                    fetchUser(CurrentUser.uid).then((data) => {\r\n                      var Data = data.data\r\n                      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:Data })\r\n                    });\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          }\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateUserData(params)\r\n        case Actions.SIGN:\r\n          if (!params){\r\n            return logoutUser()\r\n          }else {\r\n            if (params.hasOwnProperty(\"refresh\")){ // TODO: verify\r\n              return refreshUser()\r\n            } else return signinWithemailandpassword(params)\r\n          }\r\n          break;\r\n        case Actions.CLEAR:\r\n          if (!CurrentUser) {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n          } else {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERSDATA, data:{}}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n\r\n    case DataRefs.USERS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params, true)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"Email\") && params.hasOwnProperty(\"Pass\")) return createFirebaseUserWithemailandpassword(params)\r\n          else if (params.hasOwnProperty(\"Email\")) return sendResetPassword(params)\r\n          break;\r\n        case Actions.UPDATE:\r\n          return {type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:params}\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchFarm(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateFarm(params)\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.FARMS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMDATAS:\r\n      switch(action) {\r\n        case Actions.UPDATE:\r\n          return updateFarmData(params)\r\n      }\r\n      break;\r\n\r\n    case DataRefs.SECTIONS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchSections(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.SECTIONS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PENS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPens(params);\r\n        case Actions.CREATE:\r\n          return createNewPen(params);\r\n        case Actions.DELETE:\r\n          return deletePen(params)\r\n        case Actions.UPDATE:\r\n          return updatePen(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PENS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PIGS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPigs(params);\r\n        case Actions.CREATE:\r\n          return updatePigdata(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PIGS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.BATCHS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchBatchs(params)\r\n        case Actions.CREATE:\r\n          return createBatchs(params)\r\n        case Actions.UPDATE:\r\n          return updateBatchs(params)\r\n        case Actions.DELETE:\r\n          //return deleteBatch(params)\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.BATCHS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.WEIGHING:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchWeights(params);\r\n        case Actions.CREATE:\r\n          return createWeight(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.WEIGHING, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.COMMENTS:\r\n      switch(action) {\r\n        case Actions.FETCH:\r\n          return fetchComments(params);\r\n        case Actions.CREATE:\r\n          return createComment(params);\r\n      }\r\n      break;\r\n\r\n    case DataRefs.GRAPH:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchGraphData(params);\r\n        case Actions.CREATE:\r\n          return updateGraphData(params);\r\n        case Actions.UPDATE:\r\n          return updateGraphData(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.GRAPH, data:{}}\r\n      }\r\n      break;\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    resolve({error: \"Unknown Action\"})\r\n  })\r\n}\r\n//#endregion\r\n\r\nfunction SetUpdateTime(DataRef) {\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Setting Update Time\")\r\n    database().ref(DataRef).update({\r\n      update_time: database.ServerValue.TIMESTAMP,\r\n    }).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(error)\r\n      /*if (error.code === 'database/permission-denied') {\r\n        console.log(\"Batch update was permission denied. \");\r\n      }else if (error.code) {\r\n        console.log(\"Batch update Error: \", error);\r\n      }*/\r\n      resolve(true)\r\n    });\r\n  })\r\n}\r\nfunction CheckDataTime(DataRef, DataTime) {\r\n  return new Promise((resolve, reject) => {\r\n    if (!DataTime) resolve(true)\r\n    database().ref(DataRef + \"/update_time\").once('value').then((_Time) => {\r\n      var UpdateTime = _Time.val()\r\n      if (!UpdateTime) {\r\n        SetUpdateTime(DataRef).then((res) => {\r\n          resolve(true)\r\n        })\r\n      } else {\r\n        if (DataTime) {\r\n          if (DataTime === \"SET\"){\r\n            SetUpdateTime(DataRef).then((res) => {\r\n              resolve(res)\r\n            })\r\n          } else if (DataTime < UpdateTime){\r\n            resolve(true)\r\n          }\r\n          else resolve(false)\r\n        }else resolve(true)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n//#region User data Controls\r\nfunction fetchUser({UserId}, List = false) {\r\n  var user = \"\";\r\n  if (UserId) user = UserId\r\n  else if (!List && auth().currentUser) user = auth().currentUser.uid;\r\n\r\n  if (user || List) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).once('value').then((userData) => {\r\n        var data = userData.val()\r\n        if (!List) {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:{data}})\r\n        } else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.USERS, data:{data}})\r\n        }\r\n      }).catch(error => {\r\n        console.log(error)\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    })\r\n  }\r\n  else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateUserData({UserId, Data}) {\r\n  const user = UserId? UserId: auth().currentUser.uid;\r\n  if (user) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then((data) => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    }) \r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm info data Controls\r\nfunction fetchFarm({FarmId}) {\r\n  var ref = \"farms/\" + FarmId\r\n  return database().ref(ref).once('value').then((_farmData) => {\r\n    //TODO:Multiple farms\r\n    var data = _farmData.val()\r\n    if (FarmId) {\r\n      data = {[FarmId]:data}\r\n    }\r\n    return {type:Actions.UPDATE, path:DataRefs.FARMS, data: data}\r\n  })\r\n  /*} else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })*/\r\n}\r\n\r\nfunction updateFarm({FarmId, Data}) {\r\n  return new Promise((resolve, reject) => {\r\n    if (FarmId){\r\n      database().ref('farms/'+ FarmId).update({\r\n        ...Data\r\n      }).then(()=> {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    } else {\r\n      const farm = database().ref('farms/').push()\r\n      const farmid = farm.key\r\n      farm.set({\r\n        Data\r\n      }).then(() => {\r\n        resolve(farmid)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nfunction createFarm({Data}){\r\n  const user = auth().currentUser;\r\n  const ref = \"users/\" + user.uid;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const farm = database().ref('farms/').push()\r\n    const farmid = farm.key\r\n    \r\n    farm.set({\r\n      email: user.email,\r\n      manager: user.displayName ? user.displayName : user.email,\r\n      name: Data.name\r\n    }).then(() => {\r\n      resolve(farmid)\r\n    }).catch(error => {\r\n      console.log(\"Create Farm Error: \", error);\r\n      resolve(false)\r\n    })\r\n  })\r\n}\r\n\r\nfunction updateFarmData({FarmId, Data}) {\r\n  if (FarmId) {\r\n    const ref = \"farms_data/\" + FarmId;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then(() => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"Farm data update was permission denied.\");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n\r\n        resolve(false)\r\n      })\r\n    })\r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm data Controls\r\n\r\n//#region Sections\r\nfunction fetchSections({FarmId, SectionId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/sections\";\r\n    if (SectionId){\r\n      ref += \"/\" + SectionId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/sections\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          console.log(\"Sections fetch called\")\r\n          return database().ref(ref).once('value').then((_sectionidData) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.SECTIONS, data:_sectionidData.val()})\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Sections Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Pens\r\nfunction fetchPens({FarmId, PenId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pens\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/pens\", DataTime).then((DoFetch) => {\r\n        if (DoFetch){\r\n          console.log(\"Pens fetch Called\")\r\n\r\n          database().ref(ref).once('value').then((_pensData) => {\r\n            if (PenId) {\r\n              var penData = _pensData.val()\r\n              if (!penData) penData = {}\r\n              if (!penData.datas) penData.datas = {}\r\n              //if (!penData.datas.gcurve) penData.datas.gcurve = \"default\";\r\n      \r\n              var pen = {[PenId]: penData};\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen})\r\n            } else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_pensData.val()})\r\n            }\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  } \r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pens Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createNewPen({FarmId, PenId, SectionId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n        database().ref(ref2).set({\r\n          section: SectionId,\r\n        }).then(() => {\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n            [PenId]: true,\r\n          }).then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              });\r\n            });\r\n          });\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction deletePen({FarmId, PenId, SectionId}){\r\n  if (FarmId && PenId){\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref + \"pens/\" + PenId).remove().then(() => {\r\n        if (SectionId){\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens/\" + PenId).remove().then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              })\r\n            });\r\n          })\r\n        }else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePen({FarmId, PenId, Pen}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId){\r\n        fetchPens({FarmId: FarmId, PenId: PenId}).then((_Pen) => {\r\n          var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n          var data = Pen.datas\r\n          var Datas = {..._Pen.data[PenId].datas, ...data}\r\n          database().ref(ref2).update({\r\n            ...Pen,\r\n            datas: Datas\r\n          }).then(() => {\r\n            if (Pen.section) {\r\n              database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n                [PenId]: true,\r\n              }).then(() => {\r\n                database().ref(ref + \"sections/\").update({\r\n                  update_time: database.ServerValue.TIMESTAMP,\r\n                }).then(() => {\r\n                  resolve(null)\r\n                });\r\n              });\r\n            }\r\n          });\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Pigs\r\nfunction fetchPigs({FarmId, TagId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pigs\";\r\n    if (TagId){\r\n      ref += \"/\" + TagId\r\n    }\r\n\r\n    return database().ref(ref).once('value').then((_pigsData) => {\r\n      if (TagId) {\r\n        var pigData = _pigsData.val()\r\n        if (!pigData) return null;\r\n        if (!pigData.datas) pigData.datas = {}\r\n        if (!pigData.datas.gcurve) pigData.datas.gcurve = \"default\";\r\n\r\n        var pig = {[TagId]: pigData};\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:pig}\r\n      } else {\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:_pigsData.val()}\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pigs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updatePigPen({FarmId, TagId, PenId, Action}) {\r\n  if (PenId) {\r\n    var ref2 = \"farms_data/\" + FarmId + \"/\" + \"pens/\" + PenId + \"/datas\"\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref2 + \"/count\").once('value').then((counts) => {\r\n        var val = counts.val()\r\n        if (!val) val = 0\r\n        if (Action && !isNaN(Action)) {\r\n          val = parseInt(val) + parseInt(Action)\r\n        } else {\r\n          val = parseInt(val) +1\r\n        }\r\n        database().ref(ref2).update({\r\n          count: val,\r\n        }).then(() => {\r\n          fetchPens({FarmId: FarmId, PenId: PenId}).then((pen) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen.data})\r\n          })\r\n        });\r\n      }).catch(error => {\r\n        console.log(\"Update pig pen Error: \", error);\r\n        resolve(null)\r\n      })\r\n    })\r\n  }else {\r\n    return new Promise((resolve, reject) => {\r\n      resolve(null)\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePigdata({FarmId, TagId, PenId, Action}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    if (TagId) {\r\n      return new Promise((resolve, reject) => {\r\n        var ref2 = ref + \"pigs/\" + TagId + \"/\"\r\n        fetchPigs({FarmId: FarmId, TagId: TagId}).then((pig) => {\r\n          if (pig && pig.data) {\r\n            pig = pig.data[TagId]?pig.data[TagId]:null\r\n          }\r\n          if (!pig || !pig.hasOwnProperty('pen')){\r\n            database().ref(ref2).update({\r\n              pen: 0,\r\n            }).then(() => {\r\n              fetchPigs({FarmId: FarmId}).then((pigs) => {\r\n                console.log(\"?\", pigs)\r\n                resolve(null)\r\n                //resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs})\r\n              })\r\n            })\r\n          }\r\n          else if (PenId && PenId != pig.pen) {\r\n            updatePigPen({FarmId: FarmId, TagId: TagId, PenId: pig.pen, Action:-1}).then((data)=>{\r\n              updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:+1}).then((data)=>{\r\n                database().ref(ref2).update({\r\n                  pen: PenId\r\n                }).then(() => {\r\n                  fetchPigs({FarmId: FarmId}).then((pigs)=> {\r\n                    resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs.data})\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        })\r\n      })\r\n    } else {\r\n      return new Promise((resolve, reject) => {\r\n        updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:Action}).then((data) => {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:data.data})\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Batchs\r\nfunction fetchBatchs({FarmId, BatchId, Data, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    if (BatchId){\r\n      ref += \"/\" + BatchId\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/batchs\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (!Data) {\r\n            database().ref(ref).once('value').then((_batchdata) => {\r\n              if (BatchId) {\r\n                var batchdata = _batchdata.val()\r\n                if (!batchdata) return null;\r\n                if (!batchdata.datas) batchdata.datas = {}\r\n                if (!batchdata.pens) batchdata.pens = []\r\n                if (!batchdata.datas.gcurve) batchdata.datas.gcurve = \"default\";\r\n\r\n                var batch = {[BatchId]: batchdata};\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:batch})\r\n              } else {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:_batchdata.val()})\r\n              }\r\n            })\r\n          }\r\n          else if (BatchId) {\r\n            switch(Data){\r\n              case DataRefs.BATCHS:\r\n                ref += \"/\" + \"datas\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var data = {[BatchId]: {datas: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:data})\r\n                })\r\n              case DataRefs.PENS:\r\n                ref += \"/\" + \"pens\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var pens = {[BatchId]: {pens: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:pens})\r\n                })\r\n              case DataRefs.GRAPH:\r\n                ref += \"/\" + \"gcurve\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var curve = {[BatchId]: {gcurve: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:curve})\r\n                })\r\n            }\r\n          }\r\n\r\n        } else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Batchs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createBatchs({FarmId, BatchId, Batch}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (Batch && Batch.name) {\r\n        BatchId = Batch.name;\r\n        ref += \"/\" + Batch.name + \"/\"\r\n        delete Batch.name;\r\n        database().ref(ref).set({\r\n          ...Batch,\r\n        }).then(() => {\r\n          Object.keys(Batch.pens).forEach(pen => {\r\n            updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n          })\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        }).catch(error => {\r\n          if (error.code === 'database/permission-denied') {\r\n            console.log(\"Batch update was permission denied. \");\r\n          }else if (error.code) {\r\n            console.log(\"Batch update Error: \", error);\r\n          }\r\n          resolve({error:\"An error occurred\"})\r\n        })\r\n      } else if (BatchId) { //added else ??? still cleanup ??\r\n        console.log(\"???\") //TODO: why id.. mabye cleanup\r\n        ref += \"/\" + BatchId + \"/\"\r\n        database().ref(ref).set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          pens:[],\r\n          datas:{\r\n            devianceMin:1,\r\n            devianceMax:2,\r\n          }\r\n        }).then(() => {\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction updateBatchs({FarmId, BatchId, Batch, Data}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (BatchId && Batch) {\r\n        ref += \"/\" + BatchId\r\n        fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.PENS}).then((_batch) => {\r\n          var Pens = _batch.data[BatchId].pens\r\n          if (Batch.name) delete Batch.name\r\n\r\n          var BatchPens = {}\r\n          if (Batch.pens && JSON.stringify(Batch.pens)!==JSON.stringify(Pens)) {\r\n            if (!Pens) Pens = []\r\n            var RemovedPens = Object.keys(Pens).filter(x => !Object.keys(Batch.pens).includes(x) && !Pens[x].enddate);\r\n            var NewPens = Object.keys(Batch.pens).filter(x => !Object.keys(Pens).includes(x) || Pens[x].enddate);\r\n            var SamePens = Object.keys(Pens).filter(x => !Object.keys(RemovedPens).includes(x) && !Object.keys(NewPens).includes(x));\r\n\r\n            if (RemovedPens && RemovedPens.length > 0) {\r\n              RemovedPens.forEach(pen => {\r\n                if (Pens[pen]) {\r\n                  var Pen = Pens[pen]\r\n                  Pen.enddate = Date.now()\r\n                  BatchPens[pen] = Pen\r\n                  fetchPens({FarmId: FarmId, PenId:pen}).then((pendata) => {\r\n                    var count = 0\r\n                    if (pendata.data[pen] && pendata.data[pen].datas && pendata.data[pen].datas.count)count=pendata.data[pen].datas.count\r\n                    BatchPens[pen].count = count\r\n                  })\r\n                  updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:\"\"}}})\r\n                }\r\n              })\r\n            }\r\n            if (NewPens && NewPens.length > 0) {\r\n              NewPens.forEach(pen => {\r\n                var Pen = Pens[pen]?Pens[pen]:{startdate:Date.now()}\r\n                if (Pen.enddate) delete Pen.enddate\r\n                BatchPens[pen] = Pen\r\n                updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n              })\r\n            }\r\n\r\n            if (SamePens && SamePens.length > 0) {\r\n              SamePens.forEach(pen => {\r\n                BatchPens[pen] = Pens[pen]\r\n              })\r\n            }\r\n          }\r\n          Batch.pens = BatchPens\r\n\r\n          if (Batch.state && Batch.state === DataStates.CLOSED) {\r\n            fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.GRAPH}).then((curve) => {\r\n              var CurveId = curve.data[BatchId].gcurve\r\n              fetchGraphData({FarmId: FarmId}).then((curve) => {\r\n                Batch.gcurve = curve.data[CurveId]\r\n                Batch.closed = {comments: [], weighings: []}\r\n                \r\n                for (let i = 0, p = Promise.resolve(); i <= Object.keys(Pens).length; i++) {\r\n                  p = p.then(_ => new Promise(_resolve => {\r\n                    setTimeout(function () {\r\n                      if (i !== Object.keys(Pens).length) {\r\n                        var PenId = Object.keys(Pens)[i]\r\n                        Batch.pens[PenId] = Pens[PenId]\r\n                        if (!Batch.pens[PenId].hasOwnProperty(\"startdate\")){\r\n                          Batch.pens[PenId] = {startdate:Batch.time}\r\n                        }\r\n\r\n                        fetchPens({FarmId: FarmId, PenId:PenId}).then((pendata) => {\r\n                          var count = 0\r\n                          if (pendata.data[PenId] && pendata.data[PenId].datas && pendata.data[PenId].datas.count) count=pendata.data[PenId].datas.count\r\n                          \r\n                          Batch.pens[PenId].count = count\r\n                        })\r\n                        if (!Batch.pens[PenId].enddate) {\r\n                          Batch.pens[PenId].enddate = Date.now()\r\n                        }\r\n                        updatePen({FarmId:FarmId, PenId:PenId, Pen:{datas:{batch:\"\", count:0}}})\r\n\r\n                        fetchComments({FarmId: FarmId, PenId: PenId}).then((comments) => {\r\n                          Batch.closed.comments[PenId] = comments.data[PenId]\r\n                          database().ref(\"farms_data/\" + FarmId + \"/datas/comments/\" + PenId).remove()\r\n                          \r\n                          fetchWeights({FarmId: FarmId, PenId: PenId}).then((weights) => {\r\n                            Batch.closed.weighings[PenId] = weights.data[PenId]\r\n                            database().ref(\"farms_data/\" + FarmId + \"/weighings/\" + PenId).remove()\r\n                            _resolve();\r\n                          })\r\n                        })\r\n                      }\r\n                      else {\r\n                        database().ref(ref).update({\r\n                          ...Batch\r\n                        }).then(()=>{\r\n                          database().ref(ref + \"/closed\").set(\r\n                            Batch.closed\r\n                          ).then(() => {\r\n                            fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                              resolve(data)\r\n                            })\r\n                          }).catch(error => {\r\n                            if (error.code === 'database/permission-denied') {\r\n                              console.log(\"Batch update was permission denied. \");\r\n                            }else if (error.code) {\r\n                              console.log(\"Batch update Error: \", error);\r\n                            }\r\n                            console.log(error)\r\n                            resolve({error:\"An error occurred\"})\r\n                          })\r\n                        })\r\n                      }\r\n                    })\r\n                  }));\r\n                }\r\n              })\r\n            })\r\n          } else {\r\n            database().ref(ref).update({\r\n              ...Batch,\r\n            }).then(() => {\r\n              fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                resolve(data)\r\n              })\r\n            }).catch(error => {\r\n              if (error.code === 'database/permission-denied') {\r\n                console.log(\"Batch update was permission denied. \");\r\n              }else if (error.code) {\r\n                console.log(\"Batch update Error: \", error);\r\n              }\r\n              console.log(error)\r\n              resolve({error:\"An error occurred\"})\r\n            })\r\n          }\r\n        })\r\n      }else {\r\n        console.log(\"Update Batchs Error\");\r\n        resolve(null)\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Weights\r\nfunction fetchWeights({FarmId, PenId, SectionId, limitStart = 0, limitTo = 9999, DataTime, MemSections}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/weighings\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (PenId) {\r\n            console.log(\"Weight fetch called, getting Pen\")\r\n            ref += \"/\" + PenId\r\n            database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n              var weighing = {[snapshot.key]:{}}\r\n              snapshot.forEach(c => {\r\n                weighing[snapshot.key][c.key] = c.val()\r\n              })\r\n              resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:weighing})\r\n            })\r\n          } else {\r\n            console.log(\"Weight fetch called, getting Sections\")\r\n            database().ref(ref + \"/update_time\").once('value').then((_weighingTime) => {\r\n              //TODO: Section fetch cast :: in mem check ??\r\n              var Weighings_Time = _weighingTime.val()\r\n              fetchSections({FarmId, SectionId, DataTime: MemSections?MemSections.update_time:null}).then((sections) => {\r\n                var itemsProcessed = 0;\r\n                var length = 0;\r\n                var newWeights = {}\r\n                var Sections = sections?sections.data:MemSections\r\n                Object.keys(Sections).forEach(section => {\r\n                  if (Sections[section] && Sections[section].pens) {\r\n                    length += Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').length\r\n                    Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').forEach(pen => {\r\n                      fetchWeights({FarmId:FarmId, PenId:pen, limitStart:0, limitTo:limitTo}).then((weights) => {\r\n                        itemsProcessed++\r\n                        newWeights = {...newWeights, ...weights.data}\r\n                        if (itemsProcessed === length) {\r\n                          newWeights.update_time = Weighings_Time\r\n                          resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                        }\r\n                      }).catch(error => {\r\n                        console.log(error)\r\n                        resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                      })\r\n                    })\r\n                  }\r\n                })\r\n              }).catch(error => {\r\n                console.log(error)\r\n              })\r\n            })\r\n          }\r\n\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createWeight({FarmId, PenId, Weight, Quantity, Date}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const weightRef = database().ref(ref).push()\r\n        const weightId = weightRef.key\r\n        weightRef.set({\r\n          time: Date,\r\n          weight: Weight,\r\n          count: Quantity,\r\n        }).then(() => {\r\n          fetchWeights({FarmId:FarmId, PenId:PenId, DataTime: \"SET\"}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Weight Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Comments\r\nfunction fetchComments({FarmId, PenId, limitStart = 0, limitTo = 5}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        ref += \"/\" + PenId\r\n        database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n          var comment = {[snapshot.key]:{}}\r\n          snapshot.forEach(c => {\r\n            comment[snapshot.key][c.key] = c.val()\r\n          }) \r\n          resolve({type:Actions.UPDATE, path:DataRefs.COMMENTS, data:comment})\r\n        })\r\n      } else {\r\n        //TODO: ...Comment other than PenId\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createComment({FarmId, PenId, Action, Data, Quantity, Weight}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const commentRef = database().ref(ref).push()\r\n        const commentId = commentRef.key\r\n\r\n        commentRef.set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          user: auth().currentUser.email,\r\n          action: Action,\r\n          quantity: Quantity,\r\n          weight: Weight,\r\n          data: Data,\r\n        }).then(() => {\r\n          fetchComments({FarmId:FarmId, PenId:PenId}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Comment Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    } else {\r\n      //TODO: ...Comment other than PenId\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Graphs\r\nfunction fetchGraphData({FarmId, GraphId, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    ref = ref + \"/\" + GraphId;\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/graph\", DataTime).then((DoFetch) => {\r\n        console.log(\"Doing Graphs fetch\", DoFetch, \"Always..\")\r\n        //if (DoFetch){\r\n\r\n          database().ref(ref).once('value').then((graph) => {\r\n            var Graphs = null\r\n            var GraphVal = graph.val()\r\n            if (GraphVal) {\r\n              if (GraphId) {\r\n                var newGraph = {[graph.key]: GraphVal}\r\n                Graphs = {...Graphs, ...newGraph}\r\n              }else {\r\n                Graphs = {...Graphs, ...GraphVal}\r\n              }\r\n            }\r\n            if (!GraphId) {\r\n              database().ref(\"farms_data/Agrisys/graph\").once('value').then((Agraph) => {\r\n                var AgraphVal = Agraph.val();\r\n                if (AgraphVal) {\r\n                  Graphs = {...AgraphVal, ...Graphs}\r\n                }\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              }).catch(error => {\r\n                console.log(\"Get Agrisys graph Error: \", error);\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              })\r\n            }else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n            }\r\n          }).catch(error => {\r\n            console.log(\"Get farm graph Error: \", error);\r\n            resolve(null)\r\n          })\r\n\r\n        /*}\r\n        else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:{}})\r\n        }*/\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateGraphData({FarmId, Graph}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    if (Graph.name) {\r\n      ref += \"/\" + Graph.name + \"/\"\r\n      return new Promise((resolve, reject) => {\r\n        database().ref(ref).update({\r\n          data: Graph.data,\r\n          periode: Graph.periode\r\n        }).then(() => {\r\n          fetchGraphData({FarmId: FarmId, GraphId: Graph.name}).then((_Graph)=>{\r\n            resolve(_Graph)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Graph Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n//#endregion\r\n\r\nexport const firebaseService = {\r\n  //Firebase\r\n  requestUserPermission,\r\n  requestFirebaseToken,\r\n  wrappedAlert,\r\n\r\n  //Firebase Auth (could be moved to fetch / action)\r\n  createFirebaseUserWithemailandpassword,\r\n  signinWithemailandpassword,\r\n  sendResetPassword,\r\n  logoutUser,\r\n  refreshUser,\r\n\r\n  //Commnads\r\n  actionStarting,\r\n}\r\n","import axios from 'axios'\r\nimport { Config, GetToken_URL, GetCheckToken_URL, GetConsumtionData_URL } from '../Config'\r\nimport { is, curryN, gte } from 'ramda'\r\n\r\nconst isWithin = curryN(3, (min, max, value) => {\r\n  const isNumber = is(Number)\r\n  return isNumber(min) && isNumber(max) && isNumber(value) && gte(value, min) && gte(max, value)\r\n})\r\nconst in200s = isWithin(200, 299)\r\n\r\nfunction Create_Axios(baseURL, Acc_Token = null) {\r\n  var Consys_ApiClient;\r\n  if (Acc_Token){\r\n    Consys_ApiClient = axios.create({\r\n      /**\r\n       * Import the config from the App/Config/index.js file\r\n       */\r\n      baseURL: baseURL,\r\n      headers: {\r\n        Accept: 'application/json',\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${Acc_Token}`\r\n      },\r\n      timeout: 3000,\r\n    })\r\n  }else {\r\n    Consys_ApiClient = axios.create({\r\n      /**\r\n       * Import the config from the App/Config/index.js file\r\n       */\r\n      baseURL: baseURL,\r\n      headers: {\r\n        Accept: 'application/json',\r\n        'Content-Type': 'application/json',\r\n      },\r\n      timeout: 3000,\r\n    })\r\n  }\r\n  return Consys_ApiClient\r\n}\r\n\r\nfunction getAccessToken(SiteUrl, Ref_Token){\r\n  return new Promise((resolve, reject) => {\r\n    Create_Axios(GetToken_URL(SiteUrl, Ref_Token)).get().then((response) => {\r\n      if (response && response.data && response.data.access_token) {\r\n        resolve(response.data.access_token)\r\n      }else {\r\n        resolve(null)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction checkRenew_AccessToken(SiteUrl, Ref_Token, Acc_Token=null) {\r\n  return new Promise((resolve, reject) => {\r\n    if (Acc_Token) {\r\n      Create_Axios(GetCheckToken_URL(SiteUrl),Acc_Token).get().then((response) => {\r\n        if (response.status === 200){\r\n          resolve(Acc_Token)\r\n        } else {\r\n          resolve(getAccessToken(SiteUrl, Ref_Token))\r\n        }\r\n      })\r\n    }else {\r\n      resolve(getAccessToken(SiteUrl, Ref_Token))\r\n    }\r\n  })\r\n}\r\n\r\nfunction fetch_ValveConsumption(SiteUrl, Ref_Token, limit, SystemId=1, starttime=null, stoptime=null, offset=null, lastid=null, Acc_Token=null){\r\n  return new Promise((resolve, reject) => {\r\n    if (!SystemId) SystemId = 1\r\n    checkRenew_AccessToken(SiteUrl, Ref_Token, Acc_Token).then((Token)=>{\r\n      if (Token) {\r\n        var baseURL = GetConsumtionData_URL(SiteUrl, 100, SystemId, offset, limit, starttime, stoptime, lastid)\r\n        console.log(\"fetch\", baseURL, Token)\r\n        Create_Axios(baseURL, Token).get().then((response)=>{\r\n          if (response && response.data) {\r\n            var Feed_Data = {}\r\n            var ResData = response.data\r\n            if (ResData.result === \"OK\"){\r\n              //console.log(ResData)\r\n              if (ResData.consumptiondata) {\r\n                ResData.consumptiondata.forEach(element => {\r\n                  var weight = element.amount /1000\r\n                  Feed_Data[element.dataid] = {valve:element.valve, unit:element.unit, silono:element.silono, amount: weight, timestamp: element.timestamp}\r\n                });\r\n              }\r\n            }\r\n\r\n            resolve({data: Feed_Data, token:Token})\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        }).catch(error => {\r\n          console.log(\"fetch AutoPig Error: \", error);\r\n          resolve(null)\r\n        })\r\n      }else {\r\n        resolve(null)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction fetch_AutoPig(SiteUrl, Ref_Token, limit, SystemId=1, starttime=null, stoptime=null, offset=null, lastid=null, Acc_Token=null) {\r\n  return new Promise((resolve, reject) => {\r\n    if (!SystemId) SystemId = 1\r\n    checkRenew_AccessToken(SiteUrl, Ref_Token, Acc_Token).then((Token)=>{\r\n      if (Token) {\r\n        var baseURL = GetConsumtionData_URL(SiteUrl, 700, SystemId, offset, limit, starttime, stoptime, lastid)\r\n        console.log(\"fetch\", baseURL, Token)\r\n        Create_Axios(baseURL, Token).get().then((response)=>{\r\n          if (response && response.data) {\r\n            var Scale_Data = {}\r\n            var ResData = response.data\r\n            if (ResData.result === \"OK\"){\r\n              //console.log(ResData)\r\n              if (ResData.consumptiondata) {\r\n                ResData.consumptiondata.forEach(element => {\r\n                  var weight = element.amount /1000\r\n                  Scale_Data[element.dataid] = {amount: weight, timestamp: element.timestamp}\r\n                });\r\n              }\r\n            }\r\n\r\n            resolve({data: Scale_Data, token:Token})\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        }).catch(error => {\r\n          console.log(\"fetch AutoPig Error: \", error);\r\n          resolve(null)\r\n        })\r\n      }else {\r\n        resolve(null)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nexport const consysService = {\r\n  fetch_ValveConsumption,\r\n  fetch_AutoPig,\r\n}\r\n","import { Platform, Alert } from 'react-native'\r\nimport {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\nimport { firebaseService } from '../../Services/FirebaseService'\r\nimport { consysService } from '../../Services/ConsysService'\r\n\r\nvar auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require( '@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase;\r\n  \r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n  \r\n  auth = _firebase.auth;\r\n  if (_firebase.messaging.isSupported()) {\r\n    messaging = _firebase.messaging;\r\n  }\r\n  database = _firebase.database;\r\n  console.log(\"Started\")\r\n  //#endregion\r\n}\r\n\r\nimport { UserStates, DataRefs, Actions, ConsysRefs } from '../../Stores/Firebase/Selectors'\r\n\r\nexport function* firebaseStartup() {\r\n  console.log(\"Starting firebase saga\")\r\n  //Check and setup Firebase and permissions\r\n  yield put(FirebaseActions.setFirebaseError(null))\r\n\r\n  /*console.log(\"test\")\r\n  if (Platform.OS !== 'ios' && Platform.OS !== 'android') {\r\n    console.log(\"Starting\")\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }*/\r\n\r\n  const permitError = yield call(firebaseService.requestUserPermission)\r\n  if (permitError) {\r\n    yield put(FirebaseActions.fetchFailure(permitError))\r\n  }else {\r\n    //yield put(FirebaseActions.firebaseIsLoading(true))\r\n    console.log(\"Starting handlers\")\r\n    //yield put(FirebaseActions.firebaseIsLoading(true))\r\n    yield fork(handleAuthState)\r\n    yield fork(handleActions)\r\n    console.log(\"auth & actions\")\r\n\r\n    if (messaging && messaging.isSupported()) {\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        yield fork(onMessageHandler)\r\n        yield fork(onBackgroundMessageHandler)\r\n      }\r\n      else {\r\n        yield fork(onMessageHandler)\r\n        yield fork(onBackgroundMessageHandler)\r\n      }\r\n    }\r\n\r\n    //var FirebaseToken = yield call(firebaseService.requestFirebaseToken);\r\n    //console.log('Firebase Token: ', FirebaseToken);\r\n    \r\n    //yield fork(testmessage,FirebaseToken)\r\n  }\r\n\r\n  console.log('Firebase Startup : Done');\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    console.log('Firebase will disable yellow box debug')\r\n    console.disableYellowBox = true;\r\n  }\r\n}\r\n\r\n//Somehow works ??? but should only work at server hosting XMPP, try firebase functions insted if nessasary\r\n//TODO: check this more... SendNotification to device\r\n//it seams to work ... but slow ???\r\n/*function* testmessage(token) {\r\n  if (messaging) {\r\n    ///////\r\n    messaging().sendMessage({\r\n        to: '11111111111111@fcm.googleapis.com',\r\n        messageId: 'test1',\r\n        messageType: 'test2',\r\n        notification: {\r\n            title: 'Foo',\r\n            body: 'Bar',\r\n        }\r\n      });\r\n    ///////\r\n      //to: 'worker@agrisys.dk',\r\n    var message = {\r\n      to: token,\r\n      messageId: 'test1',\r\n      messageType: 'test2',\r\n      notification: {\r\n          title: 'Foo',\r\n          body: 'Bar',\r\n      }\r\n    }\r\n    messaging().sendMessage(message).then(msg => {\r\n      console.log(msg)\r\n    })\r\n  }\r\n}*/\r\n\r\nexport function* handleAuthState() {\r\n  const authChannel = yield eventChannel((emit) => {\r\n    const subscription = auth().onAuthStateChanged((user) => {\r\n      if (user == null){\r\n        emit(\"NONE\")\r\n      }else {\r\n        emit(user)\r\n      }\r\n    })\r\n    return () => {\r\n      subscription()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newAuth = yield take(authChannel)\r\n      var firebaseUser = newAuth === \"NONE\"?null:newAuth;\r\n      if (firebaseUser) {\r\n        const userData = yield call(firebaseService.actionStarting, DataRefs.USERSDATA, Actions.FETCH, {UserId: firebaseUser.uid})\r\n        if (userData.data) {\r\n          firebaseUser.farms = userData.data.data.farms\r\n          firebaseUser.state = userData.data.data.state\r\n          yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: firebaseUser}))\r\n          //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: userData.data}))    //TODO: mabye moved to firebaseUser..\r\n        }\r\n      } else {\r\n        yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: {}}))\r\n        //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: {}}))    //TODO: mabye moved to firebaseUser..\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      authChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* handleActions() {\r\n  const channel = yield actionChannel([\r\n    'ACTION_STARTING',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action: ACTION_STARTING = yield take(channel)\r\n\r\n    //console.log(action.ref, action.action, action.params)\r\n\r\n    if (action.ref === DataRefs.CONSYS && Object.values(ConsysRefs).includes(action.action)) {\r\n      const FirebaseUser = yield select((state) => state.firebase.firebaseUser);\r\n      if (FirebaseUser && FirebaseUser.farms) {\r\n        const FarmsData = yield select((state) => state.firebase.localDataStore.farms);\r\n        if (FarmsData && FarmsData[Object.keys(FirebaseUser.farms)[0]]) {\r\n          const FarmData = FarmsData[Object.keys(FirebaseUser.farms)[0]]\r\n          if (FarmData.site && FarmData.refToken) {\r\n            var Token = FarmData.token?FarmData.token:null\r\n            var Params = action.params\r\n\r\n            var ResData = {};\r\n            switch (action.action) {\r\n              case ConsysRefs.VALVEFEED:\r\n                ResData = yield call(consysService.fetch_ValveConsumption, FarmData.site,FarmData.refToken, Params.limit, Params.sysId, Params.start, Params.stop, Params.offset, Params.lastId, Token)\r\n                if (ResData && ResData.data) {\r\n                  yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.CONSYS, data: {feedData: ResData.data}}))\r\n                }\r\n                break;\r\n              case ConsysRefs.SCALE:\r\n                ResData = yield call(consysService.fetch_AutoPig, FarmData.site,FarmData.refToken, Params.limit, Params.sysId, Params.start, Params.stop, Params.offset, Params.lastId, Token)\r\n                if (ResData && ResData.data) {\r\n                  yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.CONSYS, data: {scaleData: ResData.data}}))\r\n                }\r\n                break;\r\n              default:\r\n                break;\r\n            }\r\n            if (ResData && ResData.token) {\r\n              FarmData.token = ResData.token\r\n              yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FARMS, data: {FarmData}}))\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } else if (Object.values(Actions).includes(action.action) && Object.values(DataRefs).includes(action.ref)) {\r\n      const FirebaseUser = yield select((state) => state.firebase.firebaseUser);\r\n      if (action.action != Actions.SIGN && FirebaseUser && FirebaseUser.farms) {\r\n        if (!action.params) action.params = {}\r\n        if (!action.params.FarmId) action.params.FarmId = [Object.keys(FirebaseUser.farms)[0]]\r\n      }\r\n\r\n      const NewData = yield call(firebaseService.actionStarting, action.ref, action.action, action.params)\r\n      if (NewData && (NewData.error || NewData.viewError)) {\r\n        yield put(FirebaseActions.fetchFailure(NewData.error))\r\n        yield put(FirebaseActions.setViewError(NewData.viewError))\r\n      } else {\r\n        //console.log(\"resCall: \", NewData)\r\n        if (NewData && NewData.hasOwnProperty(\"type\") && NewData.hasOwnProperty(\"path\") && NewData.hasOwnProperty(\"data\")) {\r\n          yield put(FirebaseActions.dataFetchSuccess(NewData))\r\n        }\r\n        else {\r\n          //console.log(\"Old Path: \", action.ref, action.action, params, NewData)\r\n          yield put(FirebaseActions.fetchSuccess({localDataStore:NewData}))\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Foreground State\r\nexport function* onMessageHandler() {\r\n  if (messaging) {\r\n    const onMessageChannel = yield eventChannel((emit) => {\r\n      const messageListener = messaging().onMessage((remoteMessage) => {\r\n        //console.log(\"message ? \", remoteMessage);\r\n        emit(remoteMessage);\r\n      });\r\n      return () => {\r\n        messageListener();\r\n      };\r\n    }, buffers.expanding(1));\r\n\r\n    try {\r\n      for (;;) {\r\n        const remoteMessage = yield take(onMessageChannel)\r\n        console.log(\"New Firebase message: \", remoteMessage)\r\n        if (remoteMessage.notification && remoteMessage.notification.title && remoteMessage.notification.body){\r\n          yield call(firebaseService.wrappedAlert, remoteMessage.notification.title, remoteMessage.notification.body, \"Ok\", false)\r\n        }else {\r\n          console.log(\"New Firebase data message: \", remoteMessage)\r\n        }\r\n      }\r\n    } finally {\r\n      if (yield cancelled()) {\r\n        onMessageChannel.close()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Background & Quit state\r\nexport function* onBackgroundMessageHandler() {\r\n  if ((Platform.OS === 'ios' || Platform.OS === 'android') && messaging) {\r\n    // Assume a message-notification contains a \"type\" property in the data payload of the screen to open\r\n    messaging().onNotificationOpenedApp(remoteMessage => {\r\n      console.log(\r\n        'Notification caused app to open from background state:',\r\n        remoteMessage.notification,\r\n      );\r\n      //NavigationService.navigate(remoteMessage.data.type); // this is not view..\r\n    });\r\n\r\n    const onMessageChannel = yield eventChannel((emit) => {\r\n      messaging().setBackgroundMessageHandler((remoteMessage) => {\r\n        emit(remoteMessage);\r\n      });\r\n      return () => {\r\n        //\r\n      };\r\n    }, buffers.expanding(1));\r\n\r\n    try {\r\n      for (;;) {\r\n        const remoteMessage = yield take(onMessageChannel)\r\n        console.log(\"New background Firebase message: \", remoteMessage)\r\n      }\r\n    } finally {\r\n      if (yield cancelled()) {\r\n        onMessageChannel.close()\r\n      }\r\n    }\r\n  }\r\n}","import { takeLatest, all, take } from 'redux-saga/effects'\r\n\r\nimport { StartupTypes } from '../Stores/Startup/Actions'\r\nimport { ExampleTypes } from '../Stores/Example/Actions'\r\nimport { DeviceTypes } from '../Stores/Device/Actions'\r\nimport { FirebaseTypes } from '../Stores/Firebase/Actions'\r\n\r\nimport * as StartupSaga from './StartupSaga'\r\nimport * as ExampleSaga from './Example/ExampleSaga'\r\nimport * as DeviceSaga from './Device/DeviceSaga'\r\nimport * as FirebaseSaga from './Firebase/FirebaseSaga'\r\n\r\nexport default function* root(sagaArgs) {\r\n  yield all([\r\n    /**\r\n     * @see https://redux-saga.js.org/docs/basics/UsingSagaHelpers.html\r\n     */\r\n    // Run the startup saga when the application starts\r\n    takeLatest(StartupTypes.STARTUP, StartupSaga.startup), //Initer\r\n    \r\n\r\n    //Example\r\n    takeLatest(ExampleTypes.FETCH_USER, ExampleSaga.fetchUser), // Call `fetchUser()` when a `FETCH_USER` action is triggered\r\n    \r\n    //Device Main Saga\r\n    takeLatest(DeviceTypes.DEVICE_STARTUP, DeviceSaga.deviceStartup), //Initer\r\n\r\n    takeLatest(DeviceTypes.CONNECT_DEVICE, DeviceSaga.connectDevice),\r\n    takeLatest(DeviceTypes.DISCONNECT_DEVICE, DeviceSaga.disconnectDevice),\r\n    takeLatest(DeviceTypes.READ_DEVICE_DATA, DeviceSaga.readDeviceData),\r\n\r\n    takeLatest(DeviceTypes.FETCH_DEVICE, DeviceSaga.fetchDevice, sagaArgs),\r\n\r\n    //BLE Saga\r\n    takeLatest(DeviceTypes.BLE_STARTUP, DeviceSaga.BLE.bleStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLE_SCAN, DeviceSaga.BLE.startBleScan),\r\n    takeLatest(DeviceTypes.STOP_BLE_SCAN, DeviceSaga.BLE.stopBleScan),\r\n    takeLatest(DeviceTypes.READ_BLE_DEVICE_DATA, DeviceSaga.BLE.readBleDeviceData, sagaArgs),\r\n    \r\n    //Android BlueThooth Saga\r\n    takeLatest(DeviceTypes.BLUETOOTH_STARTUP, DeviceSaga.BlueTooth.bluetoothStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.startBluetoothScan),\r\n    takeLatest(DeviceTypes.STOP_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.stopBluetoothScan),\r\n    takeLatest(DeviceTypes.BLUETOOTH_SCAN_ABLE, DeviceSaga.BlueTooth.bluetoothScanAble, sagaArgs),\r\n    takeLatest(DeviceTypes.READ_BLUE_DEVICE_DATA, DeviceSaga.BlueTooth.readBlueDeviceData, sagaArgs),\r\n    \r\n\r\n    //Firebase Saga\r\n    takeLatest(FirebaseTypes.FIREBASE_STARTUP, FirebaseSaga.firebaseStartup), //Initer\r\n  ])\r\n}\r\n","/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n}\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\nimport { createReducer } from 'reduxsauce'\r\nimport { ExampleTypes } from './Actions'\r\n\r\nexport const fetchUserLoading = (state) => ({\r\n  ...state,\r\n  userIsLoading: true,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserSuccess = (state, { user }) => ({\r\n  ...state,\r\n  user: user,\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: errorMessage,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const reducer = createReducer(INITIAL_STATE, {\r\n  [ExampleTypes.FETCH_USER_LOADING]: fetchUserLoading,\r\n  [ExampleTypes.FETCH_USER_SUCCESS]: fetchUserSuccess,\r\n  [ExampleTypes.FETCH_USER_FAILURE]: fetchUserFailure,\r\n})\r\n","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n  bleState: State.PoweredOff, // status of the BLE manger\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from './Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n//BLE Saga's\r\nimport { INITIAL_STATE as BLE_INITIAL_STATE } from './BLE/InitialState'\r\n//BlueTooth Saga's\r\nimport { INITIAL_STATE as BLUETOOTH_INITIAL_STATE} from './BlueTooth/InitialState'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Device Main Info\r\n  deviceIsLoading: false,\r\n  deviceErrorMessage: null,\r\n\r\n  //Device list Info... (only one ???)\r\n  scannerState: ScannerState.IDLE, // status of BLE scanner\r\n  DeviceList: [], //An Array of Discovered Devices\r\n\r\n  //Connection info...\r\n  connectedDevice: {}, // the current connected device element\r\n  connectionState: ConnectionState.DISCONNECTED, // the status of the current device connection\r\n  connectionMethode: ConnectionMethode.NONE,  //the current connected Methode\r\n\r\n  deviceData: {}, // Something\r\n\r\n  //BLE specefic\r\n  ...BLE_INITIAL_STATE,\r\n  //BlueTooth specefic\r\n  ...BLUETOOTH_INITIAL_STATE,\r\n}","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BleTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const bleStateUpdated = (state, {bleState}) => {\r\n  return({\r\n    ...state,\r\n    bleState: bleState,\r\n  })\r\n}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n  [BleTypes.BLE_STATE_UPDATED]: bleStateUpdated,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BluetoothTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from './Selectors'\r\nimport { DeviceTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n//BLE Saga's\r\nimport * as BLEReducers from './BLE/Reducers'\r\n//BlueTooth Saga's\r\nimport * as BluetoothReducers from './BlueTooth/Reducers'\r\n\r\nexport const setDeviceError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  deviceErrorMessage: errorMessage,\r\n})\r\n\r\nexport const scannerStateUpdated = (state, {scannerState}) => {\r\n  return({\r\n    ...state,\r\n    scannerState: scannerState,\r\n  })\r\n}\r\n\r\nexport const addDevice = (state, {device}) => {\r\n  if (state.DeviceList.some(Device => Device.id === device.id )) { //&& device.isConnectable)){\r\n    return({...state});\r\n  } else {\r\n    //device._manager = null; // Type.script Stringify ... not allowing function callback (fix see CreateStore.js)\r\n    var NewList = [...state.DeviceList];\r\n    NewList.push(device);\r\n\r\n    return({\r\n      ...state,\r\n      DeviceList: NewList,\r\n    });\r\n  }\r\n}\r\n\r\nexport const removeDevice = (state, {device}) => {\r\n  var NewList = [...state.DeviceList];\r\n  for( var i = 0; i < NewList.length; i++){ \r\n    if ( NewList[i] === device) {\r\n      NewList.splice(i, 1); \r\n    }\r\n  }\r\n\r\n  return ({\r\n    ...state,\r\n    DeviceList: NewList,\r\n  });\r\n}\r\n\r\nexport const clearDevices = (state) => ({\r\n  ...state,\r\n  DeviceList: [],\r\n  deviceData: {}\r\n})\r\n\r\nexport const connectedDeviceUpdated = (state, {connectedDevice}) => {\r\n  if (!connectedDevice) {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice,\r\n      //deviceData: {}\r\n    })\r\n  } else {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice\r\n    })\r\n  }\r\n}\r\n\r\n// Connections *******************************************\r\nexport const connectionStateUpdated = (state, {connectionState}) => ({\r\n  ...state,\r\n  connectionState: connectionState\r\n})\r\nexport const connectionMethodeUpdated = (state, {connectionMethode}) => ({\r\n  ...state,\r\n  connectionMethode: connectionMethode\r\n})\r\n\r\nexport const setDeviceData = (state, {data}) => ({\r\n  ...state,\r\n  deviceData: data\r\n})\r\nexport const updateDeviceData = (state, {data}) => {\r\n  const newData = {...state.deviceData, ...data}\r\n  return({\r\n  ...state,\r\n  deviceData: newData\r\n})}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [DeviceTypes.SET_DEVICE_ERROR]: setDeviceError,\r\n  \r\n  //Managers...\r\n  [DeviceTypes.SCANNER_STATE_UPDATED]: scannerStateUpdated,\r\n\r\n  [DeviceTypes.ADD_DEVICE]: addDevice,\r\n  [DeviceTypes.REMOVE_DEVICE]: removeDevice,\r\n  [DeviceTypes.CLEAR_DEVICES]: clearDevices,\r\n\r\n  [DeviceTypes.CONNECTED_DEVICE_UPDATED]: connectedDeviceUpdated,\r\n  \r\n  //Connection...\r\n  [DeviceTypes.CONNECTION_STATE_UPDATED]: connectionStateUpdated,\r\n  [DeviceTypes.CONNECTION_METHODE_UPDATED]: connectionMethodeUpdated,\r\n\r\n  //Data...\r\n  [DeviceTypes.SET_DEVICE_DATA]: setDeviceData,\r\n  [DeviceTypes.UPDATE_DEVICE_DATA]: updateDeviceData,\r\n\r\n  //BLE Saga\r\n  ...BLEReducers.HANDLERS,\r\n\r\n  //Android BlueTooth Saga\r\n  ...BluetoothReducers.HANDLERS,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\nimport { append } from 'funcadelic';\r\n\r\nimport { Actions, DataRefs } from './Selectors'\r\nimport { FirebaseTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const firebaseIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  firebaseIsLoading: loadingstate,\r\n})\r\n\r\nexport const setFirebaseError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseErrorMessage: errorMessage,\r\n})\r\n\r\nexport const setViewError = (state, { errorMessage }) => {\r\n  return({\r\n    ...state,\r\n    viewError: errorMessage,\r\n  })\r\n}\r\n\r\nexport const viewIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  viewIsLoading: loadingstate,\r\n})\r\n\r\nexport const setCurrentData = (state, {data}) => {\r\n  return({\r\n    ...state,\r\n    currentData: data\r\n  })\r\n}\r\n\r\nfunction IDGenerate(){\r\n  return Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\nexport const actionStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nexport const fetchStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nfunction mergeDeep(target, source) {\r\n  const isObject = (obj) => obj && typeof obj === 'object';\r\n\r\n  if (!isObject(target) || !isObject(source)) {\r\n    return source;\r\n  }\r\n\r\n  Object.keys(source).forEach(key => {\r\n    const targetValue = target[key];\r\n    const sourceValue = source[key];\r\n\r\n    if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\r\n      //target[key] = targetValue.concat(sourceValue);  //Mercing value of arrays would creates doubles.. like curve data..\r\n    } else if (isObject(targetValue) && isObject(sourceValue)) {\r\n      target[key] = mergeDeep(Object.assign({}, targetValue), sourceValue);\r\n    } else {\r\n      target[key] = sourceValue;\r\n    }\r\n  });\r\n\r\n  return target;\r\n}\r\n\r\nexport const dataFetchSuccess = (state, { params }) => {\r\n  const {type, path, data} = params\r\n  var NewDataStore = state.localDataStore;\r\n  var NewFirebaseUser = {...state.firebaseUser};\r\n  switch(type) {\r\n    case Actions.UPDATE:\r\n    case Actions.ADD:\r\n      var newData = {...data}\r\n      if (path === DataRefs.FIREBASEUSER) {\r\n        if (data && data.data) newData = {...data.data}\r\n        if (data && data._user) {\r\n          Object.keys(data._user).forEach(element => {\r\n            newData[element] = data._user[element]\r\n          })\r\n          delete newData._user\r\n          delete newData._auth\r\n        }\r\n        if (newData && Object.keys(newData).length > 0) {\r\n          var Values = [\"displayName\", \"name\", \"lastN\", \"email\", \"emailVerified\", \"address\", \"country\", \"farms\", \"isAnonymous\", \"phoneNumber\", \"photoURL\", \"refreshToken\", \"state\", \"uid\"]\r\n          Object.keys(newData).forEach(element => {\r\n            for (var index = 0; index < Values.length; index++) {\r\n              if (Values[index] === element) {\r\n                NewFirebaseUser[element] = newData[element]\r\n                break;\r\n              }\r\n            }\r\n          });\r\n        }else {\r\n          NewFirebaseUser = newData;\r\n        }\r\n      }\r\n      if (!data) break;\r\n      switch(path){\r\n        case DataRefs.FIREBASEUSER:\r\n          //Done above\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          Object.keys(newData).forEach(element => {\r\n            if (!NewDataStore.userData) NewDataStore.userData = {};\r\n            NewDataStore.userData[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.users) NewDataStore.users = {};\r\n          if (data.data) newData = data.data\r\n          if (newData.users) newData = newData.users\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.users[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.FARMS:\r\n          if (!NewDataStore.farms) NewDataStore.farms = {};\r\n          if (data.farms) newData = data.farms\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.farms[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.BATCHS:\r\n          if (!NewDataStore.batchs) NewDataStore.batchs = {};\r\n          if (data.batchs) newData = data.batchs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.batchs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.SECTIONS:\r\n          if (!NewDataStore.sections) NewDataStore.sections = {};\r\n          if (data.sections) newData = data.sections\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.sections[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PENS:\r\n          if (!NewDataStore.pens) NewDataStore.pens = {};\r\n          if (data.pens) newData = data.pens\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pens[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PIGS:\r\n          if (!NewDataStore.pigs) NewDataStore.pigs = {};\r\n          if (data.pigs) newData = data.pigs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pigs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.COMMENTS:\r\n          if (!NewDataStore.comments) NewDataStore.comments = {};\r\n          if (data.comments) newData = data.comments\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.comments[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.GRAPH:\r\n          if (!NewDataStore.graphs) NewDataStore.graphs = {};\r\n          if (data.graphs) newData = data.graphs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.graphs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.WEIGHING:\r\n          if (!NewDataStore.weighings) NewDataStore.weighings = {};\r\n          if (data.weighings) newData = data.weighings\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.weighings[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.CONSYS:\r\n          if (!NewDataStore.consys) NewDataStore.consys = {};\r\n          if (data.consys) newData = data.consys\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.consys[element] = newData[element]\r\n          });\r\n          break;\r\n      }\r\n      //console.log(path, data)\r\n      break;\r\n    case Actions.CLEAR:\r\n      switch(path){\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.userData) NewDataStore.userData = {};\r\n          NewDataStore.userData.action = \"CLEAR\";\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          console.log(\"CLEAR\")\r\n          if (NewDataStore.batchs) NewDataStore.batchs = {}\r\n          if (NewDataStore.sections) NewDataStore.sections = {}\r\n          if (NewDataStore.pens) NewDataStore.pens = {}\r\n          if (NewDataStore.pigs) NewDataStore.pigs = {}\r\n          if (NewDataStore.graphs) NewDataStore.graphs = {}\r\n          if (NewDataStore.weighings) NewDataStore.weighings = {}\r\n          if (NewDataStore.consys) NewDataStore.consys = {}\r\n          if (NewDataStore.userData && NewDataStore.userData.action) {\r\n            NewDataStore.userData.action = {}\r\n            //NewDataStore.userData = {}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n    default:\r\n      console.log(\"DataFetch Not created / default\")\r\n      break;\r\n  }\r\n  return({\r\n    ...state,\r\n    firebaseUser: NewFirebaseUser,\r\n    localDataStore: NewDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchSuccess = (state, { data }) => {\r\n  var newlocalDataStore = {...state.localDataStore}\r\n  var newState = {...state}\r\n\r\n  if (data) {\r\n    let {localDataStore, ..._newState} = data;\r\n\r\n    if (localDataStore) {\r\n      if (Object.keys(localDataStore).length !== 0) {\r\n        newlocalDataStore = mergeDeep(localDataStore, newlocalDataStore)\r\n      }\r\n      else {\r\n        newlocalDataStore = {...localDataStore}\r\n      }\r\n    }\r\n    newState = append(state,_newState)\r\n  }\r\n  return({\r\n    ...newState,\r\n    localDataStore: newlocalDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseIsLoading: false,\r\n  firebaseErrorMessage: errorMessage,\r\n  viewIsLoading: false,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [FirebaseTypes.FIREBASE_IS_LOADING]: firebaseIsLoading,\r\n  [FirebaseTypes.SET_FIREBASE_ERROR]: setFirebaseError,\r\n\r\n  [FirebaseTypes.SET_VIEW_ERROR]: setViewError,\r\n  [FirebaseTypes.VIEW_IS_LOADING]: viewIsLoading,\r\n\r\n  [FirebaseTypes.SET_CURRENT_DATA]: setCurrentData,\r\n\r\n  [FirebaseTypes.ACTION_STARTING]: actionStarting,\r\n  [FirebaseTypes.FETCH_STARTING]: fetchStarting,\r\n  [FirebaseTypes.DATA_FETCH_SUCCESS]: dataFetchSuccess,\r\n  [FirebaseTypes.FETCH_SUCCESS]: fetchSuccess,\r\n  [FirebaseTypes.FETCH_FAILURE]: fetchFailure,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","import { UserStates } from './Selectors'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  firebaseIsLoading: false,     //SystemLoading\r\n  firebaseErrorMessage: null,   //SystemError\r\n\r\n  firebaseUser: null,           //UserData\r\n\r\n  localDataStore: {},           //Full DataStore\r\n  currentData: null,            //State DataStore\r\n\r\n  viewIsLoading: false,         //View / state - waiting for action\r\n  viewError: null,              //View / state - error display\r\n}","/**\r\n * This file contains the application's colors.\r\n *\r\n * Define color here instead of duplicating them throughout the components.\r\n * That allows to change them more easily later on.\r\n */\r\n\r\nexport default {\r\n  transparent: 'rgba(0,0,0,0)',\r\n  white: '#ffffff',\r\n  gray: '#a6a6a6',\r\n\r\n  text: '#4a4a49',\r\n  secountText: '#ffffff',\r\n\r\n  primary: '#a3b9cf',\r\n\r\n  success: '#03a489',\r\n  error: '#dc3545',\r\n  overest: '#4cafea',\r\n  pigpink: '#FFAA95',\r\n\r\n  input: '#86939e',\r\n\r\n  AgriGreen: '#03a489',\r\n  AgriDarkblue: '#4463ab',\r\n  AgriLightblue: '#a3b9cf',\r\n  AgriDark: '#4a4a49',\r\n}\r\n","import { StyleSheet } from 'react-native'\r\n\r\nconst size = {\r\n  h1: 38,\r\n  h2: 34,\r\n  h3: 30,\r\n  input: 18,\r\n  regular: 17,\r\n  medium: 14,\r\n  small: 12,\r\n}\r\n\r\nexport default {\r\n  h1: {\r\n    fontSize: size.h1,\r\n  },\r\n  h2: {\r\n    fontSize: size.h2,\r\n  },\r\n  h3: {\r\n    fontSize: size.h3,\r\n  },\r\n  normal: {\r\n    fontSize: size.regular,\r\n  },\r\n}","/**\r\n * This file contains metric values that are global to the application.\r\n */\r\n\r\n// Examples of metrics you can define:\r\nexport const tiny = 5\r\nexport const small = tiny * 2 // 10\r\nexport const normal = tiny * 3 // 15\r\nexport const medium = normal * 2 // 30\r\n\r\nexport default {\r\n  tiny,\r\n  small,\r\n  normal,\r\n  medium,\r\n  \r\n  tinyBottomMargin: {\r\n    marginBottom: tiny,\r\n  },\r\n  smallBottomMargin: {\r\n    marginBottom: small,\r\n  },\r\n  bottomMargin: {\r\n    marginBottom: normal,\r\n  },\r\n  mediumBottomMargin: {\r\n    marginBottom: medium,\r\n  },\r\n\r\n  tinyVerticalMargin: {\r\n    marginVertical: tiny,\r\n  },\r\n  smallVerticalMargin: {\r\n    marginVertical: small,\r\n  },\r\n  verticalMargin: {\r\n    marginVertical: normal,\r\n  },\r\n  mediumVerticalMargin: {\r\n    marginVertical: medium,\r\n  },\r\n\r\n  tinyHorizontalMargin: {\r\n    marginHorizontal: tiny,\r\n  },\r\n  smallHorizontalMargin: {\r\n    marginHorizontal: small,\r\n  },\r\n  horizontalMargin: {\r\n    marginHorizontal: normal,\r\n  },\r\n  mediumHorizontalMargin: {\r\n    marginHorizontal: medium,\r\n  },\r\n\r\n  tinyHorizontalPadding: {\r\n    paddingHorizontal: tiny,\r\n  },\r\n  smallHorizontalPadding: {\r\n    paddingHorizontal: small,\r\n  },\r\n  horizontalPadding: {\r\n    paddingHorizontal: normal,\r\n  },\r\n  mediumHorizontalPadding: {\r\n    paddingHorizontal: medium,\r\n  },\r\n\r\n  tinyVerticalPadding: {\r\n    paddingVertical: tiny,\r\n  },\r\n  smallVerticalPadding: {\r\n    paddingVertical: small,\r\n  },\r\n  verticalPadding: {\r\n    paddingVertical: normal,\r\n  },\r\n  mediumVerticalPadding: {\r\n    paddingVertical: medium,\r\n  },\r\n}\r\n","/**\r\n * Images should be stored in the `App/Images` directory and referenced using variables defined here.\r\n */\r\n\r\nexport default {\r\n  Home: require('../Assets/Images/Home.png'),\r\n\r\n  DashBoard: require('../Assets/Images/Dashboard.png'),\r\n  System: require('../Assets/Images/System.png'),\r\n  Curves: require('../Assets/Images/Feed-Curves.png'),\r\n  GCurves: require('../Assets/Images/Growth-curve.png'),\r\n\r\n  User: require('../Assets/Images/User.png'),\r\n  Sow: require('../Assets/Images/Sow.png'),\r\n  Section: require('../Assets/Images/Section.png'),\r\n  Pens: require('../Assets/Images/Area_Colour.png'),\r\n  AutoPig: require('../Assets/Images/AutoPig.png'),\r\n  Feed: require('../Assets/Images/Feed-Components.png'),\r\n\r\n  Haxa_globe: require('../Assets/Images/Hexagon-globe.png'),\r\n  Hexa_icon: require('../Assets/Images/Hexa-icon.png'),\r\n  Logo: require('../Assets/Images/Logo.png'),\r\n\r\n  logo: require('../Assets/Images/TOM.png'),\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  //********************** col sets */\r\n  column: {\r\n    flexDirection: 'column',\r\n  },\r\n  colMain: {\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  colCenter: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  colCross: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  columnReverse: {\r\n    flexDirection: 'column-reverse',\r\n  },\r\n\r\n  //********************** Row sets */\r\n  row: {\r\n    flexDirection: 'row',\r\n  },\r\n  rowMain: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCenter: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCross: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  rowReverse: {\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Cross sets */\r\n  center: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  crossCenter: {\r\n    alignItems: 'center',\r\n  },\r\n  crossEnd: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  crossStart: {\r\n    alignItems: 'flex-start',\r\n  },\r\n  crossStretch: {\r\n    alignItems: 'stretch',\r\n  },\r\n\r\n  //********************** Fill sets */\r\n  fill: {\r\n    flex: 1,\r\n  },\r\n  fillCenter: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillCol: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n  },\r\n  fillColCenter: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColCross: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  fillColMain: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColReverse: {\r\n    flex: 1,\r\n    flexDirection: 'column-reverse',\r\n  },\r\n  fillRow: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n  },\r\n  fillRowCenter: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowCross: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  fillRowMain: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowReverse: {\r\n    flex: 1,\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Size sets */\r\n  fullSize: {\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  halvWidth: {\r\n    width: '50%',\r\n  },\r\n  midWidth: {\r\n    width: '75%',\r\n  },\r\n  fullWidth: {\r\n    width: '100%',\r\n  },\r\n\r\n  //********************** Main sets */\r\n  mainCenter: {\r\n    justifyContent: 'center',\r\n  },\r\n  mainEnd: {\r\n    justifyContent: 'flex-end',\r\n  },\r\n  mainSpaceAround: {\r\n    justifyContent: 'space-around',\r\n  },\r\n  mainSpaceBetween: {\r\n    justifyContent: 'space-between',\r\n  },\r\n  mainStart: {\r\n    justifyContent: 'flex-start',\r\n  },\r\n\r\n  //********************** Container sets */\r\n  mainContainer:{\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n  },\r\n  contentContainer:{\r\n    flex:1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n    marginTop: Metrics.small,\r\n    ...Metrics.bottomMargin,\r\n  },\r\n  borderContainer: {\r\n    borderWidth: 1,\r\n    borderColor: '#000',\r\n    borderRadius: 15,\r\n    ...Metrics.tinyHorizontalPadding,\r\n    ...Metrics.tinyVerticalPadding,\r\n    maxWidth:450,\r\n    zIndex: 1,\r\n  },\r\n  textContainer:{\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n    alignItems: 'center',\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.small,\r\n    maxWidth:450,\r\n  },\r\n  loadingContainer: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n  logoContainer: {\r\n    width: '100%',\r\n    height: 220,\r\n  },\r\n\r\n  //**********************  */\r\n  backgroundReset: {\r\n    backgroundColor: Colors.transparent,\r\n  },\r\n\r\n  rotate90: {\r\n    transform: [{ rotate: '90deg' }],\r\n  },\r\n  rotate90Inverse: {\r\n    transform: [{ rotate: '-90deg' }],\r\n  },\r\n  mirror: {\r\n    transform: [{ scaleX: -1 }],\r\n  },\r\n\r\n  scrollSpaceAround: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-around',\r\n  },\r\n  scrollSpaceBetween: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-between',\r\n  },\r\n\r\n  selfStretch: {\r\n    alignSelf: 'stretch',\r\n  },\r\n\r\n  textCenter: {\r\n    textAlign: 'center',\r\n  },\r\n  textJustify: {\r\n    textAlign: 'justify',\r\n  },\r\n  textLeft: {\r\n    textAlign: 'left',\r\n  },\r\n  textRight: {\r\n    textAlign: 'right',\r\n  },\r\n};\r\n","/**\r\n * This file defines the base application styles.\r\n *\r\n * Use it to define generic component styles (e.g. the default text styles, default button styles...).\r\n */\r\nimport { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  button: {\r\n    backgroundColor: Colors.primary,\r\n    color: Colors.secountText,\r\n  },\r\n  buttonText: {\r\n    color: Colors.secountText,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n\r\n  navigationHeader:{\r\n    textAlign: 'center',\r\n    alignSelf:'center',\r\n    flexGrow:1,\r\n  }\r\n};\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, Image, Platform } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nlet messaging;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/messaging').default;\r\n\r\n  if (firebase.messaging.isSupported()) {\r\n    messaging = firebase.messaging();\r\n  }\r\n  //#endregion\r\n}\r\n\r\nimport Style from './SplashScreenStyle'\r\nimport { Helpers, Images } from '../../Theme'\r\n\r\nclass SplashScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    /*this.state = {\r\n    }*/\r\n  }\r\n\r\n  getData(){\r\n    if ((Platform.OS === \"android\" || Platform.OS === \"ios\") && messaging) {\r\n      messaging().onNotificationOpenedApp(remoteMessage => {\r\n        console.log(\r\n          'Notification caused app to open from background state:',\r\n          remoteMessage.notification,\r\n        );\r\n        NavigationService.navigate(remoteMessage.data.type);\r\n      });\r\n\r\n      // Check whether an initial notification is available\r\n      messaging().getInitialNotification().then(remoteMessage => {\r\n        if (remoteMessage) {\r\n          console.log(\r\n            'Notification caused app to open from quit state:',\r\n            remoteMessage.notification,\r\n          );\r\n          NavigationService.navigate(remoteMessage.data.type); // e.g. \"Settings\"\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount(){\r\n    //this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Style.container]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    //setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SplashScreen);\r\n//export default SplashScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n})\r\n","import React from 'react'\r\nimport { Text, View } from 'react-native'\r\nimport { Helpers, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component with a deep link.\r\n */\r\nconst DeepLinkingScreen = () => (\r\n  <View style={[Helpers.fillCenter, Helpers.rowMain, Metrics.mediumHorizontalMargin]}>\r\n    <Text>\r\n      This is deep linking example screen which can be accessed using agrissysapp://deeplink scheme!\r\n    </Text>\r\n  </View>\r\n)\r\n\r\nexport default DeepLinkingScreen\r\n","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst Button = props => {\r\n  var TextView = [<Text style={[styles.text, props.textStyle]} key={0}>{props.Text}</Text>]\r\n\r\n  var ImageView = []\r\n  if (props.icon) {\r\n    var _Image = <Image style={Helpers.fullSize} source={props.icon} resizeMode={'contain'} />\r\n    ImageView = (\r\n      <View style={[styles.icon, props.iconStyle]}>\r\n        {_Image}\r\n      </View>\r\n    )\r\n  }\r\n  return (\r\n    <TouchableOpacity style={[styles.boxContainer, props.boxStyle]} onPress={props.onPress}>\r\n      {props.icon?(\r\n        <View style={[styles.button, props.buttonStyle, Helpers.rowCenter]}>\r\n          <View style={[Helpers.colCenter, Helpers.fill]}>\r\n            {TextView}\r\n          </View>\r\n            {ImageView}\r\n        </View>\r\n      ):(\r\n        <View style={[styles.button, props.buttonStyle]}>\r\n          {TextView}\r\n        </View>\r\n      )}\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  boxContainer:{\r\n    ...Helpers.center,\r\n    ...Metrics.tinyVerticalMargin,\r\n  },\r\n  button: {\r\n    borderRadius: 15,\r\n    ...Helpers.center,\r\n    ...Helpers.fullWidth,\r\n    ...Metrics.horizontalPadding,\r\n    ...ApplicationStyles.button,\r\n  },\r\n  text: {\r\n    ...ApplicationStyles.buttonText,\r\n    ...Metrics.verticalPadding,\r\n    ...Helpers.center,\r\n    textAlign:\"center\",\r\n  },\r\n  icon: {\r\n    ...Helpers.colCenter,\r\n    ...Metrics.smallVerticalMargin,\r\n    width: '25%', \r\n    height: 50,\r\n  },\r\n});\r\n\r\nexport default Button;","import React from 'react';\r\nimport { View, Text, Image} from 'react-native';\r\nimport Button from './Button'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst Button_Panel = props => {\r\n  const Texts = props.Texts;\r\n  const Images = props.Images;\r\n\r\n  const onPress = props.onPress;\r\n\r\n  var Buttons = []\r\n\r\n  Texts.forEach((element, index) => {\r\n    var image = null\r\n    if (Images && Images[index]){\r\n      image = Images[index]\r\n    }\r\n    Buttons.push(\r\n      <Button key={index} Text={element} icon={image}\r\n        iconStyle={props.iconStyle} itemStyle={props.itemStyle}\r\n        onPress={() => {\r\n          if (onPress) {\r\n            onPress({index: index, text: element})\r\n          }\r\n        }}/>\r\n    )\r\n  });\r\n\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:30}, props.style] }>\r\n      {Buttons}\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default Button_Panel;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport Button from './Button';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst TitleElement = props => {\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin,] }>\r\n      <Button Text={props.Text} icon={props.icon} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n        onPress={() => {\r\n          if (props.onPress){\r\n            props.onPress()\r\n          }\r\n        } }/>\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default TitleElement;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text} from 'react-native';\r\nimport { ListItem } from 'react-native-elements'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst CustomListItem = props => {\r\n  const key = props.key? props.key : 0\r\n  return (\r\n    <ListItem key={key} containerStyle={[styles.listitem, {flexDirection:\"column\", borderRadius:0}, props.itemStyle]} button onPress={props.onPress}>\r\n      <ListItem.Content>\r\n        <ListItem.Title>{props.Title}</ListItem.Title>\r\n        {props.hasOwnProperty(\"Subtitle\") ? <ListItem.Subtitle>{props.Subtitle}</ListItem.Subtitle>\r\n        :(<></>)}\r\n      </ListItem.Content>\r\n    </ListItem>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  listitem: {\r\n    flex: 1,\r\n    ...Helpers.borderContainer,\r\n    ...Helpers.center,\r\n    backgroundColor: '#fff',\r\n    paddingVertical: 5,\r\n    paddingHorizontal: 5,\r\n  },\r\n});\r\n\r\nexport default CustomListItem;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, FlatList} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst ContentProp = props => {\r\n  var texts = [];\r\n  if (props.texts){\r\n    props.texts.forEach((element,i) => {\r\n      texts.push(\r\n        (<View style={[styles.contentBox, props.textsStyle]} key={\"text_\" + i}>\r\n          <Text>{element}</Text>\r\n        </View>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var datas = [];\r\n  if (props.datas) {\r\n    props.datas.forEach((element,i) => {\r\n      datas.push(\r\n        (<TouchableOpacity style={[styles.contentBox, props.datasStyle]} onLongPress={() => {\r\n          if (props.onPress){\r\n            props.onPress({data: element, index: i})\r\n          }\r\n        }} key={\"data_\" + i}>\r\n          <Text>{element}</Text>\r\n        </TouchableOpacity>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var length = texts.length > datas.length? texts.length : datas.length\r\n  \r\n  var view = [];\r\n  for(var i = 0; i < length; i++) {\r\n    var dataRow = [];\r\n    if (i < texts.length) {\r\n      dataRow.push(texts[i])\r\n    } else {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"leftSpace_\" + i}/>))\r\n    }\r\n\r\n    if (datas.length > 0) {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter, {maxWidth:20}]} key={\"seperator_\" + view.length}/>))\r\n\r\n      if (i < datas.length) {\r\n        dataRow.push(datas[i])\r\n      } else {\r\n        dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"rightSpace_\" + i}/>))\r\n      }\r\n    }\r\n\r\n    view.push(\r\n      (<View style={[props.datas?Helpers.rowCenter:Helpers.halvWidth, Metrics.tinyVerticalMargin]} key={\"row_\" + view.length}>\r\n        {dataRow}\r\n      </View>)\r\n    )\r\n  }\r\n  \r\n  return (view);\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  contentBox: {\r\n    ...Helpers.fill,\r\n    ...Helpers.colCenter,\r\n    ...Helpers.borderContainer,\r\n    borderRadius: 0,\r\n    minHeight:30,\r\n  }\r\n});\r\n\r\n\r\nexport default ContentProp;","import React, { useEffect } from 'react'\r\nimport { StyleSheet, Text, View, Image, ActivityIndicator } from 'react-native'\r\n\r\nimport { Helpers, Images, Colors } from '../Theme'\r\n\r\nconst Loading = props => {\r\n  if (props.loading){\r\n    var styles = props.back ? styles.container: {}\r\n    return (\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer, styles]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  } else return null;\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n});\r\n\r\nexport default Loading\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Comment_Module } from '../Components'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nclass OperationsPanel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      View:1,\r\n    }\r\n  }\r\n\r\n  getPenAndSection() {\r\n    var Section, Pen = undefined\r\n    if (this.props.pig && this.props.pigTag && this.props.PigsList) {\r\n      if (this.props.PigsList[this.props.pigTag] && this.props.PigsList[this.props.pigTag].pen && this.props.PigsList[this.props.pigTag].pen != 0) {\r\n        Pen = this.props.PigsList[this.props.pigTag].pen\r\n\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (localDataStore && localDataStore.pens && localDataStore.pens[Pen]) {\r\n          var PenData = localDataStore.pens[Pen];\r\n          Section = PenData.section;\r\n        }\r\n      }\r\n    }\r\n    return {Section, Pen}\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    if (this.props.pig) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Add Pig\"\r\n            onPress={() => {\r\n              if (this.props.pigTag !== \"\" ) {\r\n                if (Object.keys(this.props.PigsList).filter(e => e === this.props.pigTag).length > 0){\r\n                  this.props.setFirebaseError(\"Can not add Tag already exist\")\r\n                } else {\r\n                  this.props.setFirebaseError(\"\")\r\n                  this.props.newPig(this.props.pigTag)\r\n                }\r\n              }\r\n              else this.props.setFirebaseError(\"A Tag is needed\")\r\n            } }/>\r\n          <Button Text=\"Move Pig\"\r\n            onPress={() => {\r\n              var {Section, Pen} = this.getPenAndSection()\r\n              this.props.setCurrentPig(this.props.pigTag, Section, Pen)\r\n              NavigationService.navigate(\"DataEditor\")\r\n            } }/>\r\n        </View>\r\n      )\r\n    } else if (this.props.section) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Weight\"\r\n              onPress={() => {\r\n                NavigationService.navigate(\"WeighingOperations\")\r\n              }}/>\r\n          <View style={[{marginTop:40}]}>\r\n            <Button Text=\"Add Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.CREATE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n            <Button Text=\"Remove Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.DELETE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n          </View>\r\n        </View>\r\n      )\r\n    } else {\r\n      var Action = 1;\r\n      switch(this.state.View) {\r\n        case Operations.MOVE:\r\n        case Operations.LOST:\r\n        case Operations.SOLD:\r\n          Action = -1\r\n        case Operations.ADD:\r\n          return(\r\n            <Comment_Module Title={\"Operations comment:\"} Quantity={true} Weight={true} onDone={(res) => {\r\n              if (res.res) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                var quantity = res.quantity\r\n                if (isNaN(quantity)) quantity = 1\r\n                Action = Action * quantity\r\n                if (res.weight && res.weight !== \"\") {\r\n                  var weight = res.weight\r\n                  if (this.state.View === Operations.ADD) {\r\n                    this.props.newWeight(CurrentData.penId, weight, Date.now(),1)\r\n                  }\r\n                }\r\n\r\n                this.props.newComment(CurrentData.penId, action, res.data, quantity, weight)\r\n                this.props.newPigCount(CurrentData.penId, Action)\r\n              }\r\n\r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          //this.props.newPigCount(CurrentData.penId, Action * \"count_input\", comment)\r\n        case Operations.NOTE:\r\n          return(\r\n            <Comment_Module Title={\"Pen Note:\"} onDone={(res) => {\r\n              if (res.res && res.data) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                \r\n                this.props.newComment(CurrentData.penId, action, res.data)\r\n              }\r\n              \r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          break;\r\n        default:\r\n          return(\r\n            <ScrollView style={{paddingRight: 5}}>\r\n              <View style={[Helpers.buttonContainer]}>\r\n                <Button Text=\"Weight\"\r\n                    onPress={() => {\r\n                      NavigationService.navigate(\"WeighingOperations\")\r\n                    }}/>\r\n                <Button Text=\"Note\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.NOTE,\r\n                      })\r\n                    }\r\n                  }/>\r\n                <View style={[{marginTop:10}]}>\r\n                  <Button Text=\"Add Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.ADD,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Move Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.MOVE,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Lost Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.LOST,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Sold Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.SOLD,\r\n                      })\r\n                    } }/>\r\n                </View>\r\n              </View>\r\n            </ScrollView>\r\n          )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n\r\n    editPens: (action) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action:action})),\r\n\r\n    setCurrentPig: (pigTag, Section, Pen) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PIGS, action:Actions.CREATE, pigtag:pigTag, data:{section:Section}, dataId:Pen})),\r\n    newPig: (pigTag) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {TagId: pigTag})),\r\n    newPigCount: (penId, countChange) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {PenId: penId, Action:countChange})),\r\n\r\n    newComment: (penId, action, data, quantity=null, weight=null) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.COMMENTS, {PenId: penId, Action: action, Data: data, Quantity:quantity, Weight:weight})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OperationsPanel);\r\n//export default OperationsPanel","import React, {useRef, useState, useEffect} from 'react';\r\nimport { Text, View, StyleSheet, Animated } from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst ProgressBar = props => {\r\n  let animation = useRef(new Animated.Value(0));\r\n  const progress = props.progress\r\n  const Color = props.color?props.color:\"#8BED4F\"\r\n  \r\n  useEffect(() => {\r\n    Animated.timing(animation.current, {\r\n      toValue: progress,\r\n      duration: 100\r\n    }).start();\r\n  },[progress])\r\n\r\n  const width = animation.current.interpolate({\r\n    inputRange: [0, 100],\r\n    outputRange: [\"0%\", \"100%\"],\r\n    extrapolate: \"clamp\"\r\n  })\r\n  return (\r\n    <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, minHeight:45, paddingBottom:10}]}>\r\n      <View style={[Helpers.fill, Helpers.fullWidth, Helpers.colMain, {alignContent:'center'}]}>\r\n        {props.text?(\r\n        <Text style={{alignSelf:'flex-start', minHeight:20}}>\r\n          {props.text}\r\n        </Text>):(<></>)}\r\n        <View style={styles.progressBar}>\r\n          <Animated.View style={[StyleSheet.absoluteFill], {backgroundColor: Color, width }}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ProgressBar;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingTop: 5,\r\n    padding: 8,\r\n  },\r\n  progressBar: {\r\n    flexDirection: 'row',\r\n    height: 20,\r\n    width: '100%',\r\n    borderColor: '#000',\r\n    borderWidth: 2,\r\n    borderRadius: 5\r\n  }\r\n});\r\n","import React, { Component } from 'react'\r\nimport { StyleSheet, View, TouchableOpacity, Picker, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n];\r\n\r\nclass DateTime_Picker extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n      \r\n    const {year, month, day} = this.getStates(props)\r\n    this.state = {\r\n      year: year,\r\n      month: month,\r\n      day: day,\r\n    }\r\n  }\r\n\r\n  getStates(props) {\r\n    var Today = new Date();\r\n    var Selected = new Date();\r\n    if (props.Selected) {\r\n      Selected = new Date(props.Selected)\r\n    }\r\n\r\n    var year, month, day;\r\n    year = Selected.getFullYear()\r\n    month = Selected.getMonth()\r\n    day = Selected.getDate()\r\n\r\n    if (!props.Selected) {\r\n      if (props.Year){\r\n        year = this.props.Year\r\n      }\r\n      if (props.Month){\r\n        month = this.props.Month\r\n      }\r\n      if (props.Day){\r\n        day = this.props.Day\r\n      }\r\n    }\r\n    return {year, month, day}\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevProps.Selected){\r\n      if (prevProps.Selected != this.props.Selected){\r\n        const {year, month, day} = this.getStates(this.props)\r\n        this.setState({\r\n          year: year,\r\n          month: month,\r\n          day: day,\r\n        }, this.forceUpdate())\r\n      }\r\n    } else {\r\n      var changed = false;\r\n      if (prevProps.Year != this.props.Year) changed = true\r\n      if (prevProps.Month != this.props.Month) changed = true\r\n      if (prevProps.Day != this.props.Day) changed = true\r\n      if (changed) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    var Today = new Date();\r\n\r\n    var year = Today.getFullYear()\r\n    var YearItems = []\r\n    for (let index = year + 25; index > year - 25; index--) {\r\n      var val = String(index)\r\n      YearItems.push(<Picker.Item key={\"Year_\" + index} value={index} label={val} />)\r\n    }\r\n      \r\n    var MonthItems = []\r\n    var month = Today.getMonth()\r\n    for (let index = 0; index < monthNames.length; index++) {\r\n      var val = String(index)\r\n      MonthItems.push(<Picker.Item key={\"Month_\" + index} value={index} label={monthNames[index]} />)\r\n    }\r\n  \r\n    var DayItems = []\r\n    var days = new Date(year, month + 1, 0).getDate()\r\n    for (let index = 1; index <= days; index++) {\r\n      var val = String(index)\r\n      DayItems.push(<Picker.Item key={\"Day_\" + index} value={index} label={val} />)\r\n    }\r\n\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.row, {marginBottom:-10,}, this.props.style]}>\r\n        <Picker selectedValue={this.state.year} style={[{minWidth: 101, marginRight:5}]}\r\n          onValueChange={(_year) => {\r\n            year = _year\r\n            this.props.onValueChange(new Date(year, this.state.month, this.state.day))\r\n          }}>\r\n          {YearItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.month} style={[{minWidth: 110, marginRight:5}]}\r\n          onValueChange={(_month) => {\r\n            month = _month\r\n            this.props.onValueChange(new Date(this.state.year, month, this.state.day))\r\n          }}>\r\n          {MonthItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.day} style={[{minWidth: 83}]}\r\n          onValueChange={(_day) => {\r\n            days = parseInt(_day)\r\n            this.props.onValueChange(new Date(this.state.year, this.state.month, days))\r\n          }}>\r\n          {DayItems}\r\n        </Picker>\r\n      </View>\r\n    )\r\n  }\r\n}\r\nexport default DateTime_Picker;","import React, { useState } from 'react';\r\nimport { Platform, View, Text, TextInput, Image, StyleSheet, RecyclerViewBackedScrollViewComponent} from 'react-native';\r\nimport Button from './Button'\r\nimport { Icon, Input } from 'react-native-elements'\r\nimport { Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst Comment_Module = props => {\r\n  const Title = props.Title;\r\n  const Quantity = props.Quantity?props.Quantity:false\r\n  const Weight = props.Weight?props.Weight:false\r\n  \r\n  const onDone = props.onDone;\r\n  var Button1 = \"Done\";\r\n  var Button2 = \"Cancel\";\r\n  const [InputText, setInputText] = useState(\"\");\r\n  const [QuantityText, setQuantityText] = useState(\"1\");\r\n  const [WeightText, setWeightText] = useState(\"\");\r\n\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.buttonContainer, props.style] }>\r\n      <View style={styles.textAreaContainer} >\r\n        <View style={[App?{}:Helpers.row]}>\r\n          {Title?(<Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>{Title}</Text>):(<></>)}\r\n          {Quantity?(\r\n            <View style={[Helpers.row, App?{}:{marginLeft:50, marginBottom:4}]}>\r\n              <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Quantity:</Text>\r\n              <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n                multiline={false}\r\n                onChangeText={(text) => {\r\n                  if (text === \"\" || !isNaN(text)) setQuantityText(text)\r\n                }}\r\n                value={QuantityText}\r\n              />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {Weight?(\r\n          <View style={[Helpers.row, App?{}:{marginBottom:4}]}>\r\n            <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Average Weight:</Text>\r\n            <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n              multiline={false}\r\n              onChangeText={(text) => {\r\n                if (text === \"\" || !isNaN(text)) setWeightText(text)\r\n              }}\r\n              value={WeightText}\r\n            />\r\n          </View>\r\n        ):(<></>)}\r\n        <TextInput\r\n          style={styles.textArea}\r\n          underlineColorAndroid=\"transparent\"\r\n          placeholder=\"Type something\"\r\n          placeholderTextColor=\"grey\"\r\n          numberOfLines={10}\r\n          multiline={true}\r\n          onChangeText={(text) => setInputText(text)}\r\n          value={InputText}\r\n        />\r\n      </View>\r\n      <Button key={\"_Done\"} Text={Button1}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: true, data: InputText, quantity: QuantityText, weight: WeightText})\r\n          }\r\n        }}/>\r\n      <Button key={\"_Cancel\"} Text={Button2}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: false, data: InputText})\r\n          }\r\n        }}/>\r\n    </View>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  textAreaContainer: {\r\n    borderColor: Colors.gray,\r\n    borderWidth: 1,\r\n    padding: 5\r\n  },\r\n  textArea: {\r\n    height: 150,\r\n    justifyContent: \"flex-start\",\r\n    borderColor: \"black\",\r\n    borderWidth: 0.5,\r\n    padding: 5,\r\n  }\r\n})\r\n\r\nexport default Comment_Module;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 190,\r\n    marginTop: Metrics.medium * 2, \r\n    marginBottom: Metrics.medium,\r\n  },\r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../Stores/Device/Actions'\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\n\r\nimport { Button_Panel } from '../../Components'\r\nimport Style from './FrontScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images } from '../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      ShowMainError: false,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseErrorMessage = this.props.firebase.firebaseErrorMessage\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Style.logoContainer]}>\r\n          <Image style={[Helpers.fullSize]} source={Images.Logo} resizeMode={'contain'} />\r\n        </View>\r\n\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize]}>\r\n          <View style={[Helpers.textContainer, Helpers.fullWidth]}>\r\n            {this.state.ShowMainError && firebaseErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <Text style={ApplicationStyles.text}>Welcome to Agrisys App</Text>\r\n            <Text style={ApplicationStyles.text}>Please choose your action</Text>\r\n          </View>\r\n\r\n          <Button_Panel \r\n            Texts={[\"Connect to Agrisys Cloud\", \"Connect to Device\"]}\r\n            Images={[Images.Haxa_globe, null]}\r\n            onPress={(ele) => {\r\n              switch(ele.index){\r\n                case 0:\r\n                  NavigationService.navigate('AuthStack')\r\n                  break;\r\n                case 1:\r\n                  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n                    NavigationService.navigate(\"DeviceScreen\")\r\n                  }\r\n                  break;\r\n              }\r\n              /*<Button Text=\"Example\"\r\n              onPress={() => NavigationService.navigate(\"ExampleScreen\")}/>*/\r\n            }}\r\n          />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","/**\r\n * Selectors let us factorize logic that queries the state.\r\n *\r\n * Selectors can be used in sagas or components to avoid duplicating that logic.\r\n *\r\n * Writing selectors is optional as it is not always necessary, we provide a simple example below.\r\n */\r\n\r\nexport const liveInEurope = (state) => {\r\n  if (Object.entries(state.example.user).length <= 0) return null\r\n\r\n  // For this example, we imagine this cities are european cities\r\n  const europeanCities = [\r\n    'Gwenborough',\r\n    'Wisokyburgh',\r\n    'McKenziehaven',\r\n    'South Elvis',\r\n    'Roscoeview',\r\n  ]\r\n\r\n  return europeanCities.includes(state.example.user.address.city)\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  instructions: {\r\n    ...Fonts.normal,\r\n    fontStyle: 'italic',\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 300,\r\n    marginBottom: 25,\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, Button, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { liveInEurope } from '../../Stores/Example/Selectors'\r\n\r\nimport Style from './ExampleScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component.\r\n *\r\n * This screen displays a little help message and informations about a fake user.\r\n * Feel free to remove it.\r\n */\r\nconst instructions = Platform.select({\r\n  ios: 'Press Cmd+R to reload,\\nCmd+D or shake for dev menu.',\r\n  android: 'Double tap R on your keyboard to reload,\\nShake or press menu button for dev menu.',\r\n})\r\n\r\nconst ExampleScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const user = useSelector((state) => state.example.user)\r\n  const userIsLoading = useSelector((state) => state.example.userIsLoading)\r\n  const userErrorMessage = useSelector((state) => state.example.userErrorMessage)\r\n\r\n  useEffect(() => {\r\n    dispatch(ExampleActions.fetchUser())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fillCenter,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      {userIsLoading ? (\r\n        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\r\n      ) : (\r\n        <View>\r\n          <View style={Style.logoContainer}>\r\n            <Image style={Helpers.fullSize} source={Images.logo} resizeMode={'contain'} />\r\n          </View>\r\n          <Text style={Style.text}>To get started, edit App.js</Text>\r\n          <Text style={Style.instructions}>{instructions}</Text>\r\n          {userErrorMessage ? (\r\n            <Text style={Style.error}>{userErrorMessage}</Text>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.result}>\r\n                {\"I'm a fake user, my name is \"}\r\n                {user.name}\r\n              </Text>\r\n              <Text style={Style.result}>\r\n                {liveInEurope ? 'I live in Europe !' : \"I don't live in Europe.\"}\r\n              </Text>\r\n            </View>\r\n          )}\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => dispatch(ExampleActions.fetchUser())}\r\n            title=\"Refresh\"\r\n          />\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => NavigationService.navigate(\"TestScreen\") }\r\n            title=\"Test\"\r\n          />\r\n        </View>\r\n      )}\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ExampleScreen\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 220,\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.small,\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  deviceContainer: {\r\n    flex: 1,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n  deviceDataContainer: {\r\n    borderWidth: 1,\r\n    borderColor: \"#000\",\r\n    marginTop: Metrics.normal,\r\n    paddingTop: Metrics.small,\r\n    paddingHorizontal: Metrics.normal,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text2: {\r\n    ...Fonts.normal,\r\n    marginRight: Metrics.small,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, FlatList, SafeAreaView, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { ScannerState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { Button, CustomListItem } from '../../Components'\r\nimport Style from './DeviceScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../Theme'\r\n\r\nimport { Service, } from 'react-native-ble-plx'\r\n\r\nconst BLEButton = (dispatch, Active = false) => {\r\n  if (!Active) {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n              onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n    )\r\n  } else {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n              onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n    )\r\n  }\r\n} \r\n\r\nconst ConnectedDevice_View = (connectedDevice, DeviceData) => {\r\n  const dispatch = useDispatch()\r\n  return (\r\n    <View>\r\n      <CustomListItem Title={connectedDevice.localName} Subtitle={connectedDevice.id} itemStyle={{marginBottom: 10}} onPress={() => dispatch(DeviceActions.disconnectDevice())}/>\r\n      { DeviceData && Object.keys(DeviceData).length > 1 ? (\r\n        <View style={Style.deviceDataContainer}>\r\n          {/* if battery is presented */}\r\n          {DeviceData && DeviceData.Battery ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Device battery level</Text>\r\n              <Text>{DeviceData.Battery + \"%\"}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n\r\n          {/* App scanners data */}\r\n          {DeviceData.tagid ? (\r\n          <View style={Style.textContainer}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n          {DeviceData.Unknown ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>unknon Id:</Text>\r\n              <Text>{DeviceData.Unknown}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n      ):(<></>)\r\n      }\r\n    </View>\r\n  )\r\n}\r\n\r\nconst DeviceScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const deviceErrorMessage = useSelector((state) => state.device.deviceErrorMessage)\r\n\r\n  const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n\r\n  const scannerState = useSelector((state) => state.device.scannerState)\r\n  const connectionMethode = useSelector((state) => state.device.connectionMethode)\r\n  const Devices = useSelector((state) => state.device.DeviceList)\r\n\r\n  useEffect(() => {\r\n    //dispatch(DeviceActions.fetchDevice())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fill,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      <View>\r\n        <View style={Style.textContainer}>\r\n          {deviceErrorMessage ? (\r\n            <View>\r\n              <Text>There was a error while retrieving conected device</Text>\r\n              \r\n            </View>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.text}>Corrently connected:</Text>\r\n              <Text style={Style.text}>{connectedDevice && connectedDevice.name ? (connectedDevice.name):(\"None\") /*mabye use localname*/}</Text>\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.buttonContainer}>\r\n          {connectedDevice ? (\r\n            <View>\r\n              <Button buttonStyle={ApplicationStyles.button} Text=\"Disconnect Device\" \r\n                onPress={() => dispatch(DeviceActions.disconnectDevice(connectionMethode))}/>\r\n              {/*<Button buttonStyle={ApplicationStyles.button} Text=\"Activate device reading\"\r\n                onPress={() => {\r\n                  dispatch(DeviceActions.readDeviceData())\r\n                }}\r\n              />*/}\r\n            </View>\r\n            ): (\r\n            <View>\r\n              {connectionMethode == ConnectionMethode.BLE && scannerState != ScannerState.IDLE ? (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n                  onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n                  ) : (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n                  onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n                )\r\n              }\r\n              \r\n              {Platform.OS === 'ios' ? (<></>):(\r\n                <View>\r\n                  {connectionMethode == ConnectionMethode.BLUETOOTH && scannerState != ScannerState.IDLE ? (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Stop Bluetooth Search\" \r\n                      onPress={() => dispatch(DeviceActions.stopBluetoothScan())}/>\r\n                      ) : (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Search Bluetooth devices\" \r\n                      onPress={() => dispatch(DeviceActions.startBluetoothScan())}/>\r\n                    )\r\n                  }\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"Make Discoverable (Blu 30sec)\" \r\n                      onPress={() => dispatch(DeviceActions.bluetoothScanAble())}/>\r\n\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"OnDevice-serial\" \r\n                      onPress={() => {}}/>\r\n                </View>\r\n              )}\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.deviceContainer}>\r\n          <Text style={Style.text2}>Device List:</Text>\r\n            { connectedDevice ? \r\n              ConnectedDevice_View(connectedDevice, DeviceData)\r\n              : (\r\n                <ScrollView style={{paddingRight: 5}}>\r\n                  {Devices.map((Dev, i) => (\r\n                    <CustomListItem key={i} Title={Dev.localName} Subtitle={Dev.id} onPress={() => dispatch(DeviceActions.connectDevice(Dev))}/>\r\n                  ))}\r\n                </ScrollView> \r\n              )\r\n            }\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nexport default DeviceScreen;\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport Front from '../Containers/Agrisys/FrontScreen'\r\nimport Example from '../Containers/Example/ExampleScreen'\r\nimport Device from '../Containers/Device/DeviceScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // The main application screen is our \"ExampleScreen\". Feel free to replace it with your\r\n    // own screen and remove the example.\r\n    FrontScreen: {\r\n      screen: Front,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n        headerShown: false,\r\n      }),\r\n      path: 'main',\r\n    },\r\n    \r\n    DeviceScreen: {\r\n      screen: Device,\r\n      navigationOptions: () => ({\r\n        title: 'Device',\r\n        headerTitleStyle:{\r\n          ...ApplicationStyles.navigationHeader\r\n        },\r\n      }),\r\n    },\r\n\r\n    ExampleScreen: {\r\n      screen: Example,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n      }),\r\n      path: 'example',\r\n    }\r\n  },\r\n  {\r\n    initialRouteName: 'FrontScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, Image, View, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport {Actions, DataRefs, UserStates} from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Loading } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  /*require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;*/\r\n  //#endregion\r\n}\r\n\r\nconst PanelsSorter = (userType) => {\r\n  switch(userType) {\r\n    case UserStates.ADMIN:\r\n      return \"AdminPanel\"\r\n    case UserStates.OWNER:\r\n      return \"ConsysPanel\"\r\n    case UserStates.FREE:\r\n      return \"UserPanel\"\r\n    case UserStates.STARTER:\r\n      return \"CreateUserData\"\r\n    default:\r\n      return \"LoginUser\"\r\n  }\r\n};\r\n\r\nclass UserLoadingScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    const firebaseData = this.props.firebase;\r\n    if (!firebaseData) {\r\n      this.props.setFirebaseError(\"Internal rootdata Error\")\r\n      NavigationService.navigate('MainStack')\r\n      return;\r\n    }\r\n    \r\n    var page = \"LoginUser\";\r\n    const firebaseUser = firebaseData.firebaseUser\r\n    if (firebaseUser && Object.keys(firebaseUser).length > 1) {\r\n      if (firebaseUser.state === UserStates.STARTER && !firebaseUser.emailVerified) {\r\n        var User = auth().currentUser;\r\n        if(!User.emailVerified) {\r\n          page = \"VerifyScreen\";\r\n        }else {\r\n          page = PanelsSorter(firebaseUser.state)\r\n        }\r\n      } else {\r\n        page = PanelsSorter(firebaseUser.state)\r\n      }\r\n    }\r\n\r\n    NavigationService.navigate(page)\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      if (this.props.firebase.firebaseUser != prevProps.firebase.firebaseUser) { //Only checking user changes\r\n        var now = this.props.firebase.firebaseUser\r\n        var prev = prevProps.firebase.firebaseUser\r\n        if (!now || now.uid !== prev.uid || (now.state !== prev.state && prev.state !== UserStates.STARTER) || now.emailVerified != prev.emailVerified) {\r\n          console.log(\"UserLoading\")\r\n          this.checkData(this.props);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.props.getUser(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ISLOADPAGE = this.state.ISLOADPAGE;\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        {!ISLOADPAGE ?(\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            <Text style={ApplicationStyles.text}>This page contains an error.</Text>\r\n            <Text style={ApplicationStyles.text}>If you are going back, please press back again.</Text>\r\n          </View>\r\n        ):(\r\n          <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n            <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n          </View>\r\n        )}\r\n        {(IsLoading || ISLOADPAGE) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})), //TODO: mabye not get user \r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoadingScreen);\r\n//export default UserLoadingScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  \r\n})\r\n","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Platform } from 'react-native'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;\r\n  //#endregion\r\n}\r\n\r\nclass VerifyScreen extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    \r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    if (props.firebase && props.firebase.firebaseUser) {\r\n      var User = auth().currentUser;\r\n\r\n      if (User && !props.firebase.firebaseUser.emailVerified && !props.firebase.viewIsLoading){\r\n        User.reload().then((data)=>{\r\n          if(User.emailVerified) {\r\n            this.props.setViewLoading(true)\r\n            this.props.setUser(User.emailVerified)\r\n            console.log(\"Verified\")\r\n            NavigationService.navigate(\"AuthStack\")\r\n          }\r\n        })\r\n      }\r\n      \r\n      if (props.firebase.firebaseUser.emailVerified) NavigationService.navigate(\"AuthStack\")\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          <View>\r\n            <Text>Please verify your account by accepting the email, sent to your current account</Text>\r\n            <Text>This page will not refresh itself...</Text>\r\n            <Button Text=\"Resend verification\"\r\n              onPress={() => {\r\n                console.log(\"send\", firebaseUser, this.state.User)\r\n                if (firebaseUser && this.state.User) {\r\n                  this.state.User.sendEmailVerification()\r\n                }\r\n              }}/>\r\n            <Button Text=\"Refresh\"\r\n              onPress={() => {\r\n                this.checkData(this.props, this.state)\r\n              }}/>\r\n          </View>\r\n          \r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setUser: (Verified) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {emailVerified:Verified, })),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VerifyScreen);\r\n//export default VerifyScreen;","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass UserLoginScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      Email: \"\",\r\n      Pass: \"\",\r\n      CreateUser: false,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          {!this.state.CreateUser?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={[Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Username\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Email: text})\r\n                  }}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Pass:text})\r\n                  }}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n                <Button Text=\"Login\" icon={Images.User}\r\n                  onPress={() => {\r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setViewError(\"Email is needed\")\r\n                    else if (this.state.Email === \"CLEAR\") this.props.clearDataMem()\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setViewError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.signIN(this.state.Email, this.state.Pass)\r\n                    }\r\n                  }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Send reset password\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    if (this.state.Email) {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.resetPass(this.state.Email)\r\n                    } else {\r\n                      this.props.setViewError(\"Please provide an Email\")\r\n                    }\r\n                  }}/>\r\n                <Button Text=\"Create New User\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    this.setState({\r\n                      Email: \"\",\r\n                      Pass: \"\",\r\n                      CreateUser: true,\r\n                    })\r\n                  }}/>\r\n              </View>\r\n            </View>\r\n          ):(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Email\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Email:text})}}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Pass:text})}}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n              </View>\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Create User\" \r\n                  onPress={() => { \r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setFirebaseError(\"Email is needed\")\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setFirebaseError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.createUser(this.state.Email,this.state.Pass)\r\n                    }\r\n                  }}\r\n                />\r\n              </View>\r\n            </View>\r\n          )}\r\n\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    signIN: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA, {Email: Email, Pass: Pass})),\r\n    resetPass: (Email) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email})),\r\n    createUser: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email, Pass: Pass})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoginScreen);\r\n//export default UserLoginScreen;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass UserInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FirstN, LastN, Contact, ContactP, Address} = this.setData(props)\r\n    this.state = {\r\n      FirstN: FirstN,\r\n      LastN: LastN,\r\n      Contact: Contact,\r\n      ContactP: ContactP,\r\n      Address: Address,\r\n      Country: \"\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FirstN = \"\"\r\n    var LastN = \"\"\r\n    var Contact = \"\"\r\n    var ContactP = \"\"\r\n    var Address = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.name && DataStringCheck(firebaseUser.name)){\r\n          FirstN = firebaseUser.name\r\n        }\r\n        if (firebaseUser.lastN){\r\n          LastN = firebaseUser.lastN\r\n        }\r\n        if (firebaseUser.contact){\r\n          Contact = firebaseUser.contact\r\n        }\r\n        if (firebaseUser.phoneNumber) {\r\n          ContactP = firebaseUser.phoneNumber\r\n        }\r\n        if (firebaseUser.address){\r\n          Address = firebaseUser.address\r\n        }\r\n      }\r\n    }\r\n    return {FirstN, LastN, Contact, ContactP, Address}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FirstN, LastN, Contact, ContactP, Address} = this.setData(this.props)\r\n          this.setState({\r\n            FirstN: FirstN,\r\n            LastN: LastN,\r\n            Contact: Contact,\r\n            ContactP: ContactP,\r\n            Address: Address,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    //TODO: Test more with input error display ??\r\n    const F_FirstN = React.createRef();\r\n    const F_LastN = React.createRef();\r\n    const F_Contact = React.createRef();\r\n    const F_ContactP = React.createRef();\r\n    const F_Address = React.createRef();\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"User Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input ref={F_FirstN}\r\n                label=\"First Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FirstN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FirstN:text})\r\n                  }\r\n                }}\r\n                value={this.state.FirstN}\r\n\r\n              />\r\n              <Input ref={F_LastN}\r\n                label=\"Last Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({LastN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({LastN:text})\r\n                  }\r\n                }}\r\n                value={this.state.LastN}\r\n              />\r\n              <Input ref={F_Contact}\r\n                label=\"Contact Email\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Contact:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Contact:text})\r\n                  }\r\n                }}\r\n                value={this.state.Contact}\r\n              />\r\n              <Input ref={F_ContactP}\r\n                label=\"Contact Phone\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text, false)){\r\n                      this.setState({ContactP:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({ContactP:text})\r\n                  }\r\n                }}\r\n                value={this.state.ContactP}\r\n              />\r\n              <Input ref={F_Address}\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save User information\" \r\n                onPress={() => {\r\n                  var _UserData = {}\r\n\r\n                  if (!this.state.FirstN || this.state.FirstN === \"\"){\r\n                    this.props.setViewError(\"First name is needed\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps:\"First name is needed\" })\r\n                    F_FirstN.current.shake();*/\r\n                  } else if (!DataStringCheck(this.state.FirstN)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps: \"First name contains invalid characters\" })\r\n                    F_FirstN.current.shake();*/\r\n                  }\r\n                  \r\n                  else if (!this.state.LastN || this.state.LastN === \"\"){\r\n                    this.props.setViewError(\"Last name is needed\")\r\n                  } else if (!DataStringCheck(this.state.LastN)) {\r\n                    this.props.setViewError(\"Last name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _UserData = {name: this.state.FirstN, lastN: this.state.LastN}\r\n                    if (this.state.Contact !== \"\") _UserData.contact = this.state.Contact\r\n                    if (this.state.ContactP !== \"\") _UserData.phone = this.state.ContactP\r\n                    if (this.state.Address !== \"\") _UserData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _UserData.country = this.state.Country\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateUser(_UserData)\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserInformation);\r\n//export default UserInformation;","import React, { Component } from 'react'\r\nimport { Platform, Dimensions, Text, CheckBox, View, ScrollView, ActivityIndicator, TouchableOpacity } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Subscription extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {CurrentSub} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      CurrentSub: CurrentSub,\r\n\r\n      Billing: 0,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var CurrentSub = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.state && firebaseUser.state != UserStates.STARTER){\r\n          CurrentSub = firebaseUser.state\r\n        }\r\n      }\r\n    }\r\n    return { CurrentSub }\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.state != this.state.CurrentSub && this.state.CurrentSub === \"\")\r\n          ) {\r\n          const {CurrentSub} = this.setData(this.props)\r\n          this.setState({\r\n            CurrentSub: CurrentSub,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n    \r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            \r\n            <TitleElement Text=\"Subscription plan\"/>\r\n            <View style={[!App?Helpers.fillRowCenter:{}, {marginBottom:20}]}>\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.WORKER?{backgroundColor: Colors.AgriGreen}:{}]} \r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.WORKER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Staff</Text>\r\n                  {this.state.CurrentSub===UserStates.WORKER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.WORKER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to assign as staff of an existing farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.FREE?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.FREE\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Owner</Text>\r\n                  {this.state.CurrentSub===UserStates.FREE?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.FREE?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to create and manage own farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.OWNER?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.OWNER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Manager</Text>\r\n                  {this.state.CurrentSub===UserStates.OWNER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.OWNER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>9999.99</Text>\r\n                  <Text>Access to manage own farm, and assing staff</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===\"Contact\"?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: \"Contact\"\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Get contacted</Text>\r\n                  {this.state.CurrentSub===\"Contact\"?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===\"Contact\"?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                <Text style={{fontWeight:\"bold\", height:20}}></Text>\r\n                  <Text>We will contact you, and tell more about our offers</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\" \r\n                onPress={() => {\r\n                  if (!this.state.CurrentSub || this.state.CurrentSub === \"\"){\r\n                    this.props.setViewError(\"Please choose a subscription type.\")\r\n                  }\r\n\r\n                  else if (this.props.OnDone) {\r\n                    this.props.OnDone(this.state.CurrentSub)\r\n                  } else {\r\n                    //TODO: something.. validate buy and update user state\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n\r\n    //updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n    //createUserData: (Userdata, Farm, Sections, Pens) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: Userdata, Farms:{name:Farm}, Sections:Sections, Pens:Pens})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Subscription);\r\n//export default Subscription;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass FarmInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FarmName, Address, Country, Cvr, Manager} = this.setData(props)\r\n    this.state = {\r\n      FarmName: FarmName,\r\n      Address: Address,\r\n      Country: Country,\r\n      Cvr: Cvr,\r\n      Manager: Manager,\r\n\r\n      Sections: \"0\",\r\n      Pens: \"0\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FarmName = \"\"\r\n    var Address = \"\"\r\n    var Country = \"\"\r\n    var Cvr = \"\"\r\n    var Manager = \"\"\r\n\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    if (firebaseUser) {\r\n      if (firebaseUser.lastN !== \"\") {\r\n        FarmName = firebaseUser.lastN\r\n      }\r\n      if (firebaseUser.address !== \"\") {\r\n        Address = firebaseUser.address\r\n      }\r\n      if (firebaseUser.country) {\r\n        Country = firebaseUser.country\r\n      }\r\n      if (firebaseUser.email != \"\") {\r\n        Manager = firebaseUser.email\r\n      }\r\n    }\r\n\r\n    if (localDataStore && firebaseUser && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var FarmData = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n      if (FarmData.name) FarmName = FarmData.name\r\n      if (FarmData.address) Address = FarmData.address\r\n      if (FarmData.country) Country = FarmData.country\r\n      if (FarmData.cvr) Cvr = FarmData.cvr\r\n      if (FarmData.manager) Manager = FarmData.manager\r\n    }\r\n\r\n    return {FarmName, Address, Country, Cvr, Manager}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n    this.props.getFarm()\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        /*if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FarmName, Address, Cvr, Manager} = this.setData(this.props)\r\n          this.state = {\r\n            FarmName: FarmName,\r\n            Address: Address,\r\n            Cvr: Cvr,\r\n            Manager: Manager,\r\n          }\r\n        }*/\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"Farm Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input\r\n                label=\"Farm Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FarmName:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FarmName:text})\r\n                  }\r\n                }}\r\n                value={this.state.FarmName}\r\n              />\r\n              <Input\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n              <Input\r\n                label=\"Cvr\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Cvr:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Cvr}\r\n              />\r\n              <Input\r\n                label=\"Manager contact\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text) {\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Manager:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Manager:text})\r\n                  }\r\n                }}\r\n                value={this.state.Manager}\r\n              />\r\n              <Input\r\n                label=\"Number of Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Sections:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Sections}\r\n              />\r\n              <Input\r\n                label=\"Number of Pens in each Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Pens:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Pens}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save Farm information\" \r\n                onPress={() => {\r\n                  var _FarmData = {}\r\n                  var _sections = {};\r\n                  var _pens = {};\r\n\r\n                  if (!this.state.FarmName || this.state.FarmName === \"\"){\r\n                    this.props.setViewError(\"Farm name is needed\")\r\n                  } else if (!DataStringCheck(this.state.FarmName)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _FarmData = {name: this.state.FarmName}\r\n\r\n                    if (this.state.Address !== \"\") _FarmData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _FarmData.country = this.state.Country\r\n                    if (this.state.Cvr !== \"\") _FarmData.cvr = this.state.Cvr\r\n                    if (this.state.Manager !== \"\") _FarmData.manager = this.state.Manager\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateFarm(_FarmData)\r\n\r\n                    if (this.state.Sections && this.state.Pens) {\r\n                      this.props.setViewLoading(true)\r\n                      var Pen = 1;\r\n                      var i, i2;\r\n                      for (i = 1; i <= this.state.Sections; i++) {\r\n                        var sectionPens = {};\r\n                        for (i2 = 1; i2 <= this.state.Pens; i2++) {\r\n                          _pens['Pen_' + Pen] = {section: 'Section_' + i}\r\n                          sectionPens['Pen_' + Pen] = true\r\n                          Pen++;\r\n                        }\r\n                        \r\n                        _sections['Section_' + i] = {pens: sectionPens}\r\n                      }\r\n                      console.log(\"Set\", _sections, _pens)\r\n                      this.props.updateFarmData(_sections, _pens)\r\n                    }\r\n\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n\r\n    updateFarm: (FarmData) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMS, {Data: FarmData})),\r\n    updateFarmData: (sections, pens) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMDATAS, {Data:{sections:sections, pens:pens}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FarmInformation);\r\n//export default FarmInformation;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport UserInformation from '../UserPanel/UserInformation'\r\nimport Subscription from '../UserPanel/Subscription'\r\nimport FarmInformation from '../UserPanel/FarmInformation'\r\n\r\nclass CreateNewUserData extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ViewState: 1,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    //this.props.setViewError(null)\r\n\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      /*if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }*/\r\n      if (this.props.firebase.firebaseUser !== prevProps.firebase.firebaseUser) {\r\n        if (prevProps.firebase.firebaseUser.state !== UserStates.STARTER && this.state.ViewState !== 3) {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    var Display = [];\r\n    if (this.state.ViewState === 1) {\r\n      Display = [(<UserInformation key={\"View1\"} OnDone={res => {\r\n        if (res) {\r\n          this.setState({\r\n            ViewState:2\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 2) {\r\n      Display = [(<Subscription key={\"View2\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          var FarmName = \"Not set\"\r\n          if (this.props.firebase.firebaseUser.lastN) FarmName = this.props.firebase.firebaseUser.lastN;\r\n          this.props.precreateUserData(res, FarmName)\r\n\r\n          this.setState({\r\n            ViewState:3\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 3) {\r\n      Display = [(<FarmInformation key={\"View3\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          this.props.clearDataMem()\r\n          NavigationService.navigateAndReset('AuthStack')\r\n        }\r\n      }}/>)]\r\n    } else {\r\n      this.props.clearDataMem()\r\n      NavigationService.navigateAndReset('AuthStack')\r\n    }\r\n\r\n    return(\r\n      <View>\r\n        {Display}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data})),\r\n    precreateUserData: (Subsc, FarmName) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: {state:Subsc}, Farms:{name:FarmName}, Sections:{}, Pens:{}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateNewUserData);\r\n//export default CreateNewUserData;","import React from 'react'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport LoadingUserScreen from '../Containers/Cloud/AuthScreens/UserLoadingScreen'\r\nimport LoginUserScreen from '../Containers/Cloud/AuthScreens/UserLoginScreen'\r\nimport VerifyScreen from '../Containers/Cloud/AuthScreens/VerifyScreen'\r\nimport CreateUserDataScreen from '../Containers/Cloud/AuthScreens/CreateUserDataScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    UserLoadingScreen: {\r\n      screen: LoadingUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User loading',\r\n      }),\r\n    },\r\n    LoginUser: {\r\n      screen: LoginUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Login',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n    },\r\n    VerifyScreen: {\r\n      screen: VerifyScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Verification',\r\n      }),\r\n    },\r\n    CreateUserData: {\r\n      screen: CreateUserDataScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Create Data',\r\n      }),\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserLoadingScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerLeft: () => (\r\n        <View style={{padding:6, paddingLeft: 15}}>\r\n          <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n        </View>\r\n      ),\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getFarm() //for future control\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const firebase = this.props.firebase;\r\n\r\n    const IsLoading = firebase.firebaseIsLoading\r\n    const firebaseErrorMessage = firebase.firebaseErrorMessage\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseUser = firebase.firebaseUser\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"Dashboard\", \"Pens\", \"Batchs\", \"Growth curves\", \"Operations\", \"AutoPigs\", \"Feeding\", \"Pigs\"]}\r\n            Images={[Images.DashBoard, Images.Pens, Images.Section, Images.GCurves, Images.System, Images.AutoPig, Images.Feed, Images.Sow ]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"Dashboard\":\r\n                  NavigationService.navigate(\"UserDashBoard\")\r\n                  break;\r\n                case \"Pens\":\r\n                  NavigationService.navigate(\"UserPens\")\r\n                  break;\r\n                case \"Batchs\":\r\n                  NavigationService.navigate(\"UserBatchs\")\r\n                  break;\r\n                case \"Growth curves\":\r\n                  NavigationService.navigate(\"UserCurves\")\r\n                  break;\r\n                case \"Operations\":\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                  break;\r\n                case \"AutoPigs\":\r\n                  NavigationService.navigate(\"AutoPig\")\r\n                  //this.props.getAutoPig()\r\n                  break;\r\n                case \"Feeding\":\r\n                  break;\r\n                case \"Pigs\":\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                  break;\r\n              }\r\n            }}\r\n          />\r\n          \r\n          {firebaseUser && firebaseUser.state === \"admin\"?(<></>):(\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n\r\n    getAutoPig: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.CONSYS, {sysId:2}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { DataRefs, Actions, GetBatchEnd, CurvePredict, GetCurve_FromBatch, GetStats_FromBatch  } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, ContentProp, ProgressBar } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Name, Manager, Mail, SectionsList, BatchList, MaxCap, CurCap} = this.setData(props)\r\n    this.state = {\r\n      farmName: Name,\r\n      farmManager: Manager,\r\n      farmMail: Mail, \r\n\r\n      BatchList: BatchList,\r\n\r\n      MaxCap:MaxCap, \r\n      CurCap:CurCap,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    var Name = \"Not set\"\r\n    var Manager = \"Not set\"\r\n    var Mail = \"Not set\"\r\n\r\n    if (localDataStore && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n      Name = Farm.name?Farm.name: Name\r\n      Manager = Farm.name?Farm.manager: Manager\r\n      Mail = Farm.name?Farm.email: Mail\r\n    }\r\n\r\n    var BatchList = {}//localDataStore.batchs\r\n    var MaxCap = 0;\r\n    var CurCap = 0;\r\n\r\n    if (localDataStore.batchs) {\r\n      Object.keys(localDataStore.batchs).filter(e => e !== '__jsogObjectId' && e !== 'update_time').map((BatchID) => {\r\n        var Batch = localDataStore.batchs[BatchID]\r\n        var Data = GetStats_FromBatch(Batch, localDataStore)\r\n        if (Data) {\r\n          var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = Data\r\n          \r\n          if (Batch.pens) {\r\n            MaxCap += Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).length * 1;\r\n          }\r\n          CurCap += Animals;\r\n\r\n          Batch.count = Animals\r\n          Batch.weight = AverageWeight\r\n          Batch.target = TargetWeight\r\n          Batch.End = EndDate\r\n\r\n          BatchList[BatchID] = Batch\r\n        }\r\n      })\r\n    }\r\n\r\n    if (MaxCap === 0) MaxCap++;\r\n    return { Name, Manager, Mail, BatchList, MaxCap, CurCap }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getFarm()\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getBatch()\r\n    this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore && prevProps.firebase.localDataStore) {\r\n        const firebaseUser = this.props.firebase.firebaseUser\r\n        const localDataStore = this.props.firebase.localDataStore;\r\n\r\n        if (localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n          var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n          if ((this.state.farmName !== Farm.name || this.state.farmManager !== Farm.manager || this.state.farmMail !== Farm.email) ||\r\n              localDataStore.batchs && JSON.stringify(this.state.BatchList) !== JSON.stringify(localDataStore.batchs) ||\r\n              localDataStore.graphs && localDataStore.graphs !== prevProps.firebase.localDataStore.graphs) {\r\n            const {Name, Manager, Mail, BatchList, MaxCap, CurCap} = this.setData(this.props)\r\n            this.setState({\r\n              farmName: Name,\r\n              farmManager: Manager,\r\n              farmMail: Mail,\r\n        \r\n              BatchList: BatchList,\r\n\r\n              MaxCap:MaxCap, \r\n              CurCap:CurCap,\r\n            }, () => {\r\n              this.forceUpdate()\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var FarmProgress = 0\r\n    if (this.state.BatchList) {\r\n      var BatchList = Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))\r\n      BatchList.forEach(element => {\r\n        var Batch = this.state.BatchList[element]\r\n        FarmProgress += (Batch.weight/Batch.target)*100;\r\n      });\r\n      FarmProgress = (FarmProgress/(100*BatchList.length))*100\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n            <TitleElement Text=\"Farm description\"/>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.fullWidth, {height:110,}]}>\r\n              <ContentProp texts={[\"Farm name\", \"Manager\", \"E-mail\"]} datas={[this.state.farmName, this.state.farmManager, this.state.farmMail ]} />\r\n            </View>\r\n            <View style={{height:20}}/>\r\n            <ProgressBar text={\"Farm capacity: \" + this.state.CurCap + \" of \" + this.state.MaxCap} progress={(this.state.CurCap/this.state.MaxCap) * 100 }/>\r\n            <ProgressBar text={\"Farm performance:\"} progress={FarmProgress}/>\r\n\r\n            {this.state.BatchList?(\r\n              <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, marginTop:10}]}>\r\n                <Text>Batches:</Text>\r\n                <FlatList\r\n                  data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && \r\n                                                                (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))}\r\n                  renderItem={({item, i}) => {\r\n                    var Batch = this.state.BatchList[item]\r\n                    var TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n                    var End = GetBatchEnd(Batch, TempCurve)\r\n                    var EndDate = Batch.End;\r\n                    var Color = Colors.AgriGreen\r\n                    if (EndDate > End) Color = Colors.error\r\n                    var count = Batch.count\r\n                    if (!count) count = 0\r\n                    var progress = (Batch.weight/Batch.target)*100;\r\n\r\n                    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n                    var StartDate = new Date(Batch.time).getDate() + \"/\" + (new Date(Batch.time).getMonth() +1) + \"/\" + new Date(Batch.time).getFullYear()\r\n                    return(\r\n                      <ProgressBar text={item + \" Startdate: \" + StartDate + \" EndForcast: \" + EndDate + \", \" + count + \" pigs\"} progress={progress} color={Color}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <Button Text=\"Clear local datastore\"\r\n              onPress={() => {\r\n                this.props.clearDataMem()\r\n                this.getData()\r\n              }}/>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\r\n//export default Dashboard;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  loading: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  inputContainer: {\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n  \r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pigs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {PigsList} = this.setData(props)\r\n    this.state = {\r\n      PigsList: PigsList,\r\n      PigTag: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    this.props.getPigs()\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var PigsList = null\r\n    if (localDataStore && localDataStore.pigs) {\r\n      PigsList = sortObject(localDataStore.pigs)\r\n    }\r\n    \r\n    return {PigsList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.pigs && JSON.stringify(this.state.PigsList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.pigs))) {\r\n            const {PigsList} = this.setData(this.props)\r\n            this.setState({\r\n              PigsList: PigsList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    const connectedDevice = null\r\n    const connectedState = null\r\n    const DeviceData = null\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            <Device_Display connectedState={connectedState}/>\r\n            <Scanner_Display DeviceData={DeviceData}/>\r\n            {this.state.PigsList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.PigsList)}\r\n                    renderItem={({item})=>{\r\n                      var Pen = \"-\"\r\n                      var Section = \"-\"\r\n                      if (this.state.PigsList[item].pen && this.state.PigsList[item].pen != 0) {\r\n                        Pen = this.state.PigsList[item].pen\r\n                        if (localDataStore.pens && localDataStore.pens[Pen]){\r\n                          var PenData = localDataStore.pens[Pen];\r\n                          Section = PenData.section;\r\n                        }\r\n                      }\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={item} itemStyle={[{height:35,}]} onPress={() => {\r\n                              this.props.setData(item, Section, Pen)\r\n                              NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={Pen} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={Section} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={item => \"PigTag_\" + item}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"Pig-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  PigTag: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.PigTag\r\n              }\r\n            />\r\n            <OperationsPanel pig={true} pigTag={this.state.PigTag} PigsList={this.state.PigsList} />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getPigs: (tagId = null) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PIGS, {TagId: tagId})),\r\n    setData: (pigId, Section, Pen) => dispatch(FirebaseActions.setCurrentData({pigId:pigId, type:DataRefs.PIGS, section:Section, dataId:Pen})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pigs);\r\n//export default Pigs;\r\n\r\n//TODO extract to own component also used in DataDisplay\r\nconst Device_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    return(\r\n      <View style={[Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.rowCenter, ]}>\r\n        <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowMain]}>\r\n          <View style={[Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, {maxWidth:150}]}>\r\n            {props && props.connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst Scanner_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    const dispatch = useDispatch()\r\n    const DeviceData = (props && props.DeviceData)?props.DeviceData:null\r\n    return(\r\n      <View style={{flexDirection: 'row',justifyContent: 'space-between', borderWidth:1, borderColor:'#000', borderRadius: 25, paddingHorizontal:15, paddingVertical:10, marginBottom:10}}>\r\n        <View style={Style.textContainer, {paddingTop: 10}}>\r\n          {\r\n            // App scanners data\r\n          }\r\n          {DeviceData&&DeviceData.tagid? (\r\n          <View style={{marginBottom:5}}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData&& DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={{marginBottom:5}}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {DeviceData&& DeviceData.tagid ? (\r\n          <View style={{flexDirection: 'row',justifyContent: 'space-between'}}>\r\n            {known ?(\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Open data\" onPress={() => {\r\n              dispatch(FirebaseActions.setCurrentData({pigId:known, type:DataRefs.PIGS}))\r\n              NavigationService.navigate(\"DataDisplay\")\r\n            }}/>\r\n            ):(<></>)}\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Save Tag\" onPress={() => {\r\n              //dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {FarmId: Object.keys(localDataStore.userData.farms)[0]}))\r\n            }}/>\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList, TouchableOpacity, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nimport { SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pens extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Weighings, Mid} = this.setData(props)\r\n    this.state = {\r\n      Mid: Mid,\r\n      Sections: Sections,\r\n      Weighings: Weighings\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var Sections = {}\r\n    if (localDataStore && localDataStore.sections) {\r\n      Sections = sortObject(Props.firebase.localDataStore.sections)\r\n    }\r\n\r\n    var Mid = 0;\r\n    var Weighings = {}\r\n    if (localDataStore && localDataStore.weighings) {\r\n      Weighings = localDataStore.weighings\r\n      for (const property in localDataStore.weighings) {\r\n        if (localDataStore.weighings[property] && Object.keys(localDataStore.weighings[property]).length > 0){\r\n          var weight = localDataStore.weighings[property][Object.keys(localDataStore.weighings[property])[0]].weight\r\n          if (weight){\r\n            if (Mid > 0){\r\n              Mid = ((Mid + weight)/2)\r\n            } else {\r\n              Mid = (Mid + weight)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return {Sections, Weighings, Mid}\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    if (!localDataStore.weighings) localDataStore.weighings = {}\r\n    if (!localDataStore.batchs) localDataStore.batchs = {}\r\n    if (!localDataStore.graphs) localDataStore.graphs = {}\r\n\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n    this.props.getWeights(localDataStore.weighings.update_time, localDataStore.sections)\r\n\r\n    this.props.getBatch(localDataStore.batchs.update_time)\r\n    this.props.getCurve(localDataStore.graphs.update_time)\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) ||\r\n            (this.props.firebase.localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.weighings)))\r\n        ) {\r\n          const {Sections, Mid} = this.setData(this.props)\r\n          this.setState({\r\n            Mid: Mid,\r\n            Sections: Sections\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.fullSize, Helpers.fill]}>\r\n          {this.state.Sections? (\r\n            <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n              <SectionGrid\r\n                itemDimension={70}\r\n                spacing={10}\r\n                sections={\r\n                  Object.keys(this.state.Sections).filter(e => e !== 'update_time').map((Section) => {\r\n                    var Pens = sortObject(this.state.Sections[Section].pens)\r\n                    return(\r\n                      {\r\n                        title: Section,\r\n                        data: Object.keys(Pens)\r\n                      }\r\n                    )\r\n                  })\r\n                }\r\n\r\n                renderSectionHeader={({ section }) => (\r\n                  <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:0}]}>\r\n                    <Button Text={section.title} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                      onPress={() => {} }/>\r\n                  </View>\r\n                )}\r\n\r\n                renderItem={({ item }) => {\r\n                  var color = Colors.gray\r\n                  var displayWeight = null\r\n\r\n                  var Predict = CurvePredict(localDataStore, item)\r\n                  if (Predict != null) color = Colors.pigpink\r\n                  if (Predict && Predict.Now) {\r\n                    var Batch = Predict.Batch  //Mabye optain batch self ??\r\n\r\n                    var devianceMin = 2\r\n                    var devianceMax = 5\r\n                    if (Batch.datas.devianceMin) {\r\n                      devianceMin = Batch.datas.devianceMin\r\n                    }\r\n                    if (Batch.datas.devianceMax) {\r\n                      devianceMax = Batch.datas.devianceMax\r\n                    }\r\n                    var ExValue = Predict.TempEx\r\n                    var Weight = Predict.Now;\r\n                    \r\n                    var TargetWeight = (Batch.datas.target)?Batch.datas.target:Predict.Batch.datas.target\r\n                    if (Weight >= TargetWeight) {\r\n                      color = Colors.pigpink\r\n                    } else {\r\n                      var devianceValMin = (ExValue/100)* devianceMin\r\n                      var devianceValMax = (ExValue/100)* devianceMax\r\n                      if (ExValue && Weight < ExValue && Weight < ExValue - devianceValMin) {\r\n                        color = Colors.error\r\n                      } else if (ExValue && Weight > ExValue && Weight > ExValue + devianceValMax) {\r\n                        color = Colors.overest\r\n                      } else {\r\n                        color = Colors.success\r\n                      }\r\n                    }\r\n                    displayWeight = Math.round(Weight * 100) / 100\r\n                  }\r\n\r\n                  return(\r\n                    <TouchableOpacity style={[Helpers.borderContainer, {width:70, height:70, alignItems:\"center\", justifyContent:\"center\", backgroundColor:color}]}\r\n                      onPress={() => {\r\n                        this.props.setCurrentData(item)\r\n                        NavigationService.navigate(\"DataDisplay\")\r\n                      }}>\r\n                      <Text>{item}</Text>\r\n                      {displayWeight?(<Text>{displayWeight + \" kg\"}</Text>):(<></>)}\r\n                    </TouchableOpacity>\r\n                  )\r\n                }}\r\n              />\r\n            </ScrollView>\r\n          ):(\r\n            <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n              <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n            </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n    getCurve: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\", DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pens);\r\n//export default Pens;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, GetStats_FromBatch, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, CustomListItem, Datetime_Picker } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport Icon from 'react-native-vector-icons/MaterialIcons'\r\nimport SectionedMultiSelect from 'react-native-sectioned-multi-select'\r\n\r\n//import moment from 'moment';\r\n//import SimplerDatePicker from '@cawfree/react-native-simpler-date-picker';\r\n//import DatePicker from 'react-native-simple-date-picker';\r\n\r\n//import DateTimePicker from '@react-native-community/datetimepicker';\r\n\r\n//Genneral test for submodule merge (please delete this line)\r\n\r\nimport SelectBox from 'react-native-multi-selectbox'\r\nimport { xorBy } from 'lodash'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Batchs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {BatchList, freePens} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      BatchList: BatchList,\r\n\r\n      Display: 0,\r\n\r\n      BatchName: \"\",\r\n      ShowPicker: false,\r\n      StartD: new Date().getTime(),\r\n      Curve: \"\",\r\n      TargetWeight: \"\",\r\n      DevianceMin: \"\",\r\n      DevianceMax: \"\",\r\n\r\n      freePens: freePens,\r\n      avaiblePens: freePens,\r\n      selectedPens: [],\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var BatchList = localDataStore.batchs\r\n    \r\n    var freePens = []\r\n    if (BatchList && localDataStore.sections) {\r\n      Object.keys(localDataStore.sections).forEach(section => {\r\n        if (localDataStore.sections[section].pens) {\r\n          var pens = []\r\n          Object.keys(localDataStore.sections[section].pens).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').forEach(pen => {\r\n            var add = true\r\n            Object.keys(BatchList).forEach(batch => {\r\n              if (!BatchList[batch].state || BatchList[batch].state !== \"Closed\") {\r\n                if (BatchList[batch].pens && BatchList[batch].pens[pen] && !BatchList[batch].pens[pen].enddate) {\r\n                  add = false;\r\n                }\r\n              }\r\n            });\r\n            if (add) {\r\n              var item = {\r\n                item: pen,\r\n                id: section + \"_\" + pen\r\n              }\r\n              freePens.push(item)\r\n            }\r\n          })\r\n        }\r\n      });\r\n    }\r\n    return { BatchList, freePens }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getBatch(localDataStore.batchs?localDataStore.batchs.update_time:null)\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.batchs && JSON.stringify(this.state.BatchList)!==JSON.stringify(this.props.firebase.localDataStore.batchs)) ||\r\n            (this.props.firebase.localDataStore.pens && JSON.stringify(this.state.pens)!==JSON.stringify(this.props.firebase.localDataStore.pens))) {\r\n          const {BatchList, freePens} = this.setData(this.props)\r\n          this.setState({\r\n            freePens: freePens,\r\n            BatchList: BatchList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  onMultiChange = (item) => {\r\n    var items = xorBy(this.state.selectedPens, [item], 'id')\r\n    this.setState({\r\n      selectedPens: items\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {this.state.Display === 0?(\r\n              //#region Normal Front View to display all batches.\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.BatchList ? (\r\n                  <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                    <FlatList scrollEnabled={true} style={[Helpers.fill]}\r\n                      data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                      renderItem={({item, i})=>{\r\n                        var name = item;\r\n                        if (this.state.BatchList[item] && this.state.BatchList[item].state && this.state.BatchList[item].state === \"Closed\") {\r\n                          name += \"  Closed\"\r\n                        }\r\n                        return(\r\n                          <Button Text={name} onPress={() => {\r\n                            var curveId = \"default\"\r\n                            if (this.state.BatchList[item] && this.state.BatchList[item].gcurve) {\r\n                              curveId = this.state.BatchList[item].gcurve\r\n                              if (typeof curveId !== 'string') curveId = null\r\n                            }\r\n                            this.props.setCurrentData(item, curveId)\r\n                            \r\n                            NavigationService.navigate('DataPlotter')\r\n                          }}/>\r\n                        )\r\n                      }}\r\n                      keyExtractor={(item, index) => index.toString()}\r\n                    />\r\n                  </View>\r\n                ):(<></>)}\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n                  <Button Text={\"New Batch\"} onPress={() => {\r\n                    var graph = 0\r\n                    if (localDataStore && localDataStore.graphs) {\r\n                      graph = Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time')[0]\r\n                    }\r\n                    this.setState({\r\n                      Display: 1,\r\n\r\n                      DevianceMin: String(2),\r\n                      DevianceMax: String(2),\r\n                      Curve: graph,\r\n\r\n                      freePens: this.state.freePens,\r\n                      avaiblePens: this.state.freePens,\r\n                      selectedPens: [],\r\n                    })\r\n                  }}/>\r\n                  {this.state.BatchList?(\r\n                  <Button Text={\"Edit or Close Batch\"} onPress={() => {\r\n                    var batchName = Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      )[0]\r\n                    var batch = this.state.BatchList[batchName]\r\n                    if (batch) {\r\n                      var Pens = []\r\n                      var pens = sortObject(batch.pens)\r\n                      Object.keys(pens).forEach(element => {\r\n                        if (!batch.pens[element].enddate) {\r\n                          if (localDataStore.pens && localDataStore.pens[element]){\r\n                            var _pen = localDataStore.pens[element]\r\n                            var item = {}\r\n                            item.item = element;\r\n                            item.id = _pen.section + \"_\" + element;\r\n                            Pens.push(item)\r\n                          }\r\n                        }\r\n                      });\r\n\r\n                      this.setState({\r\n                        Display: 2,\r\n                        BatchName: batchName,\r\n                        StartD: batch.time,\r\n                        Curve: batch.gcurve,\r\n                        TargetWeight: String(batch.datas.target),\r\n                        DevianceMin: String(batch.datas.devianceMin),\r\n                        DevianceMax: String(batch.datas.devianceMax),\r\n                        avaiblePens: this.state.freePens.concat(Pens),\r\n                        selectedPens: Pens\r\n                      })\r\n                    }\r\n                  }}/>):(<></>)}\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            ):(\r\n              //#region Edit or create\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.Display === 1?( // Create\r\n                  <Input label={\"BatchName\"}\r\n                    containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, ]}\r\n                    onChangeText={text => {\r\n                      if (text){\r\n                        if (DataStringCheck(text)){\r\n                          this.setState({BatchName: text})\r\n                        }\r\n                      }else {\r\n                        this.setState({BatchName: text})\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.BatchName\r\n                    }\r\n                  />\r\n                ):( // Edit\r\n                  <View style={[Helpers.borderContainer, Helpers.fullWidth, {height:60, borderRadius:0, alignItems:\"center\"}]}>\r\n                    <Picker\r\n                      mode=\"dropdown\"\r\n                      selectedValue={this.state.BatchName}\r\n                      style={[Helpers.fullWidth, { height: 50, justifyContent:\"flex-end\"}]}\r\n                      onValueChange={(itemValue, itemIndex) => {\r\n                        if (this.state.BatchList && this.state.BatchList[itemValue]) {\r\n                          var batch = this.state.BatchList[itemValue]\r\n\r\n                          var Pens = []\r\n                          var pens = sortObject(batch.pens)\r\n                          Object.keys(pens).forEach(element => {\r\n                            if (!batch.pens[element].enddate) {\r\n                              if (localDataStore.pens && localDataStore.pens[element]){\r\n                                var _pen = localDataStore.pens[element]\r\n                                var item = {}\r\n                                item.item = element;\r\n                                item.id = _pen.section + \"_\" + element;\r\n                                Pens.push(item)\r\n                              }\r\n                            }\r\n                          });\r\n\r\n                          this.setState({\r\n                            BatchName: itemValue,\r\n                            StartD: batch.time,\r\n                            Curve: batch.gcurve,\r\n                            DevianceMin: String(batch.datas.devianceMin),\r\n                            DevianceMax: String(batch.datas.devianceMax),\r\n                            avaiblePens: this.state.freePens.concat(Pens),\r\n                            selectedPens: Pens,\r\n                          })\r\n                        }\r\n                      }}\r\n                    >\r\n                      {Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      ).map((graph, i) => {\r\n                        return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                      })}\r\n                    </Picker>\r\n                  </View>\r\n                )}\r\n                <View style={[Helpers.fullWidth, App?{}:Helpers.row, {zIndex:999}]}>\r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1 , marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Start date:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, App?{marginBottom:10}:{},{alignItems:'flex-start',}]}>\r\n                      <Datetime_Picker Selected={this.state.StartD}\r\n                        onValueChange={(date)=>{\r\n                          this.setState({\r\n                            StartD: date.getTime()\r\n                          })\r\n                      }}/>\r\n                    </View>\r\n                  </View>\r\n                  \r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Growth curve:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"center\"}]}>\r\n                      <Picker\r\n                        mode=\"dropdown\"\r\n                        selectedValue={this.state.Curve}\r\n                        style={[Helpers.fullWidth, {height: 30}]}\r\n                        onValueChange={(itemValue, itemIndex) => {\r\n                          this.setState({\r\n                            Curve: itemValue\r\n                          })\r\n                        }}\r\n                      >\r\n                        {Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').map((graph, i) => {\r\n                          return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                        })}\r\n                      </Picker>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, Helpers.row]}>\r\n                <Input label={\"Target weight\"}\r\n                    type='number'\r\n                    step=\"0.1\"\r\n\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                        this.setState({\r\n                          TargetWeight: text\r\n                        })\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.TargetWeight\r\n                    }\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.fullWidth, Helpers.row]}>\r\n                  <Input label={\"Deviance Min alert procentage\"}\r\n                    type='number'\r\n                    step=\"0.1\"\r\n\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                        this.setState({\r\n                          DevianceMin: text\r\n                        })\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMin\r\n                    }\r\n                  />\r\n                  <Input label={\"Deviance Max alert procentage\"}\r\n                    type='number'\r\n                    step=\"0.1\"\r\n\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                        this.setState({\r\n                          DevianceMax: text\r\n                        })\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMax\r\n                    }\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {borderWidth:1, marginTop:10, paddingHorizontal:10, paddingTop:5}]}>\r\n                  <SelectBox\r\n                    label=\"Pens in Batch..\"\r\n                    labelStyle={{color:Colors.input, fontSize: 15, fontWeight: \"bold\"}}\r\n                    optionsLabelStyle={{minWidth:100, color:\"black\", fontSize: 12, fontWeight: \"bold\"}}\r\n\r\n                    options={this.state.avaiblePens}\r\n                    selectedValues={this.state.selectedPens}\r\n                    onMultiSelect={this.onMultiChange}\r\n                    onTapClose={this.onMultiChange}\r\n                    isMulti\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                  {this.state.Display === 2?(\r\n                    <Button Text={\"Close Batch\"} onPress={() => {\r\n                      var Batch = localDataStore.batchs[this.state.BatchName];\r\n                      if (Batch) {\r\n                        var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = GetStats_FromBatch(Batch, localDataStore)\r\n                        if (Animals){\r\n                          this.props.setViewError(\"The batch still contains active pens, please clear pens before closing the batch\")\r\n                        }else {\r\n                          var newBatch = {name:this.state.BatchName, time:StartDate, state:\"Closed\"}\r\n                          this.props.updateBatch(newBatch)\r\n                          this.setState({\r\n                            Display: 0\r\n                          })\r\n                          this.props.getPens(localDataStore.pens.update_time)\r\n                        }\r\n                      }\r\n                    }}/>\r\n                  ):(\r\n                    <></>\r\n                  )}\r\n                  <Button Text={\"Save\"} onPress={() => {\r\n                    var update = true;\r\n\r\n                    if (this.state.BatchName !== \"\") {\r\n                      var Name = this.state.BatchName;\r\n                      if (!Object.keys(this.state.BatchList).includes(Name)){\r\n                        if (this.state.Display === 2) { // update on non existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch does not exists\")\r\n                        }\r\n                      } \r\n                      else {\r\n                        if (this.state.Display === 1) { // create on allready existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch allready exists\")\r\n                        }\r\n                      }\r\n                    } else {\r\n                      update = false \r\n                      this.props.setViewError(\"BatchName error\")\r\n                    }\r\n\r\n                    if (this.state.StartD !== \"\") {\r\n                      /*var StartD = this.state.StartD.split(\".\")\r\n                      if (StartD.length !== 3 || StartD[0].length !== 4 || isNaN(StartD[0]) || \r\n                                                (StartD[1].length <= 0 && StartD[1].length >= 3) || isNaN(StartD[1]) ||\r\n                                                (StartD[2].length <= 0 && StartD[2].length >= 3)|| isNaN(StartD[2])) {\r\n                        update = false \r\n                        this.props.setViewError(\"Startdate error\")\r\n                      }*/\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"Startdate error\")\r\n                    }\r\n\r\n                    if (this.state.TargetWeight !== \"\") {\r\n                      var Dev = this.state.TargetWeight\r\n                      if (Dev.length > 3 || isNaN(Dev)) {\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"Tartget weight setting error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMin !== \"\") {\r\n                      var Dev = this.state.DevianceMin\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMin setting error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMax !== \"\") {\r\n                      var Dev = this.state.DevianceMax\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMax setting error\")\r\n                    }\r\n\r\n                    if (this.state.Curve === \"\"){\r\n                      update = false \r\n                      this.props.setViewError(\"Growth curve setting error, please reselect a curve\")\r\n                    }\r\n\r\n                    var Pens = {}\r\n                    if (this.state.selectedPens && this.state.selectedPens.length > 0) {\r\n                      this.state.selectedPens.forEach(element => {\r\n                        Pens[element.item] = true\r\n                      });\r\n                    }\r\n                    if (Object.keys(Pens).length !== this.state.selectedPens.length) {\r\n                      update = false\r\n                      this.props.setViewError(\"An error occurred during Pen assigning (please update the page)\")\r\n                    }\r\n\r\n                    if (update) {\r\n                      this.props.setViewLoading(true)\r\n                      var _Date = new Date(this.state.StartD)\r\n                      var StartD = new Date(_Date.getFullYear(), _Date.getMonth(), _Date.getDate()).getTime()\r\n                      var newBatch = {name:this.state.BatchName, gcurve:this.state.Curve, pens:Pens, time: StartD, datas:{target: this.state.TargetWeight, devianceMin: this.state.DevianceMin, devianceMax: this.state.DevianceMax}}\r\n                      if (this.state.Display === 1) {\r\n                        this.props.setBatch(newBatch)\r\n                      }\r\n                      else if (this.state.Display === 2) {\r\n                        this.props.updateBatch(newBatch)\r\n                      }\r\n                      this.setState({\r\n                        Display: 0\r\n                      })\r\n                      this.props.getPens(localDataStore.pens.update_time)\r\n                      this.props.setViewError(null)\r\n                      this.props.setViewLoading(false)\r\n                    }\r\n                  }}/>\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            )}\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, { DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.BATCHS, {Batch: batch})),\r\n    updateBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.BATCHS, {BatchId: batch.name, Batch: batch})),\r\n    \r\n    setCurrentData: (batchId, curveId) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, batchId:batchId, curveId: curveId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Batchs);\r\n//export default Batchs;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, DataStates, GetCurve_FromBatch, AccumulateTime, get_DataSpot, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\nimport Batchs from './Batchs';\r\n\r\nfunction getRandomNumber(low, high) {\r\n  var r = Math.floor(Math.random() * (high - low + 1)) + low;\r\n  return r;\r\n}\r\n\r\nfunction getRandomColor() {\r\n  var red_range = [10, 250];\r\n  var green_range = [10, 250];\r\n  var blue_range = [10, 250];\r\n  var a_range = [0.2, 1];\r\n\r\n  var red = getRandomNumber(red_range[0], red_range[1]);\r\n  var green = getRandomNumber(green_range[0], green_range[1]);\r\n  var blue = getRandomNumber(blue_range[0], blue_range[1]);\r\n\r\n  var alpha = getRandomNumber(a_range[0] * 100, a_range[1] * 100) / 100;\r\n\r\n  return {\r\n    r: red,\r\n    g: green,\r\n    b: blue,\r\n    a: alpha,\r\n    rgbaValue: 'rgba(' + red + ',' + green + ',' + blue + ',' + alpha + ')'\r\n  }\r\n}\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nfunction WeightsToGraphData(localDataStore, Batch, TempGraph = null, StartDate = undefined, _EndDate = undefined, Prediction = false) {\r\n  var DataSets = []\r\n  var EndDate = 0;\r\n\r\n  var DoPredict = (Batch && (!Batch.state || Batch.state !== DataStates.CLOSED))?true:false\r\n  var Legends = []\r\n  if (Batch.pens) Legends = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId')).reverse()\r\n  Legends.forEach(Pen => {\r\n    var BatchPen = Batch.pens[Pen]\r\n    var color = getRandomColor();\r\n\r\n    var DataSet = []\r\n    var DataSetX = []\r\n\r\n    console.log(Batch)\r\n    if (localDataStore.weighings[Pen] || (Batch.state && Batch.state === DataStates.CLOSED)) {\r\n      var PenWeighings = []\r\n      if (Batch.state && Batch.state === DataStates.CLOSED) {\r\n        PenWeighings = Batch.closed.weighings[Pen]\r\n      }else {\r\n        PenWeighings = localDataStore.weighings[Pen];\r\n      }\r\n      console.log(PenWeighings)\r\n      if (PenWeighings && Object.keys(PenWeighings).length >= 1) {\r\n        Object.keys(PenWeighings).sort(function(a, b) {\r\n          return PenWeighings[a].time - PenWeighings[b].time;\r\n        }).forEach(key => {\r\n          var data = PenWeighings[key]\r\n          if (data.weight) {\r\n            if ((!StartDate || data.time >= StartDate) && (!_EndDate || data.time <= _EndDate)) {\r\n              if ((!BatchPen.startdate || data.time >= BatchPen.startdate) && (!BatchPen.enddate || data.time <= BatchPen.enddate)) {\r\n                var weight = data.weight\r\n                if (data.count) {\r\n                  weight = weight / data.count\r\n                }\r\n                DataSet.push(weight)\r\n                var Time = new Date(data.time)\r\n                //Time = new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime() // allows midday placement\r\n                DataSetX.push(Time)\r\n                if (!_EndDate && data.time > EndDate) {\r\n                  EndDate = data.time\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n\r\n        if (DoPredict && Prediction) {\r\n          var Predict = CurvePredict(localDataStore, Pen)\r\n          if (Predict && Predict.lastWeighing) {\r\n            var Time = Predict.FirstSpot?new Date(Predict.FirstSpot):new Date(Predict.lastWeighing.time)\r\n            //var DatePredict = []\r\n            //var DataPredicttX = []\r\n            Predict.data.forEach((element,index) => {\r\n              DataSet.push(element)\r\n              Time = (index===0&&Predict.FirstSpot)?Time:AccumulateTime(Time, TempGraph.periode)\r\n              DataSetX.push(Time)\r\n              //DataSetX.push(new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime())\r\n            });\r\n            //if (Predict.length > 0){\r\n            //  DataSets.push({Pen: Pen + \"_Predict\", data: DatePredict, dataX: DataPredictX, color:(opacity = 0) => color.rgbaValue})\r\n            //}\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    console.log(DataSet)\r\n    while(DataSet.length < TempGraph.data.length) {\r\n      DataSet.push(null)\r\n      DataSetX.push(null)\r\n    }\r\n    DataSets.push({Pen: Pen, data: DataSet, dataX: DataSetX, color:(opacity = 1) => color.rgbaValue})\r\n  });\r\n  return {DataSets, EndDate};\r\n}\r\n\r\nclass CurveElement extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (!this.props.Display) {\r\n      const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(props)\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n\r\n        TempGraph: TempGraph,\r\n        Legends: Legends,\r\n        DataSets: DataSets,\r\n        StartDate: StartDate,\r\n        EndDate: EndDate,\r\n\r\n        Labels: [],\r\n        ActiveIndex: 0,\r\n        ActiveLength: \"Batch\",\r\n        ActiveDataSets: DataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n\r\n        ViewPoint: null,\r\n      }\r\n    } else {\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n      }\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var TempGraph = {periode:\"Days\", data: []} //Template Graph\r\n    var Legends = []     //Name lables\r\n    var DataSets = []    //Data Points\r\n\r\n    var D = new Date()\r\n    var StartDate = D.getTime()\r\n    var EndDate = new Date(D.setDate(D.getDate()+(7*8))) //Default timespand is 2 months or 8 weeks (will be changed acording to batch)\r\n\r\n    if (localDataStore && localDataStore.batchs && CurrentData && CurrentData.batchId) {\r\n      var Batch = localDataStore.batchs[CurrentData.batchId];\r\n      TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs, CurrentData.curveId)\r\n\r\n      console.log(\"???\", TempGraph)\r\n      if (TempGraph) {\r\n        if (CurrentData.curveId) TempGraph.name = CurrentData.curveId\r\n        else TempGraph.name = \"Template\"\r\n        //Find Startdate\r\n        StartDate = Batch.time\r\n        //Find Batch Pens (Legends)\r\n        if (Batch.pens) Legends = Legends.concat(Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')))\r\n\r\n        var DataX = []\r\n        //#region Find Template X values and EndDate\r\n        var currentTime = new Date(StartDate)\r\n        for (var i = 0; i < TempGraph.data.length; i++) {\r\n          DataX.push(currentTime.getTime())\r\n          if (i < TempGraph.data.length -1) {\r\n            currentTime = new Date(AccumulateTime(currentTime, TempGraph.periode))\r\n          }\r\n        }\r\n        EndDate = currentTime.getTime();\r\n        DataX.push(EndDate)\r\n        //#endregion\r\n        \r\n        //Set TempGraph data\r\n        DataSets.push({\r\n          data: TempGraph.data,\r\n          dataX: DataX,\r\n          color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`, // optional\r\n        })\r\n\r\n        //Find DataSets from Legends\r\n        if (localDataStore.weighings || (Batch.state && Batch.state === DataStates.CLOSED)) {\r\n          console.log(\"???\")\r\n          var TempData = DataSets\r\n          var TempEndDate = EndDate\r\n          var NextEnd = new Date(AccumulateTime(new Date(TempEndDate), TempGraph.periode)).getTime()\r\n          var {DataSets, EndDate} = WeightsToGraphData(localDataStore, Batch, TempGraph, StartDate, NextEnd, this.props.Predict)\r\n          DataSets = TempData.concat(DataSets)\r\n\r\n          if (TempEndDate > EndDate) {\r\n            EndDate = TempEndDate\r\n          }\r\n\r\n          Legends = Legends.filter(e => (e !== '__jsogObjectId' && (e === TempGraph.name || DataSets.some(i => i.Pen === e))));\r\n          Legends.unshift(TempGraph.name)\r\n        }\r\n      }\r\n    }\r\n    return {TempGraph, Legends, DataSets, StartDate, EndDate }\r\n  }\r\n\r\n  setGraphPeriode(ActiveLength = this.state.ActiveLength) {\r\n    var Labels = []\r\n\r\n    var StartDate = this.state.StartDate\r\n    var EndDate = this.state.EndDate\r\n    var ActiveIndex = this.state.ActiveIndex\r\n\r\n    var TemplatePeriode = \"Weeks\"\r\n    if (this.state.TempGraph && this.state.TempGraph.periode) TemplatePeriode = this.state.TempGraph.periode\r\n    var CurrentDate = new Date(StartDate)\r\n    var TempActiveDataSet = this.state.ActiveDataSets;\r\n\r\n    var Today = new Date().getTime()\r\n    switch(this.state.ActiveLength) {\r\n      case \"Days\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i-1;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n        \r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n\r\n        EndDate = CurrentDate.getTime();\r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        break;\r\n      case \"Weeks\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n\r\n        for (var i = 0; i <= 7; i++) {\r\n          Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n          EndDate = CurrentDate.getTime();\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, \"Days\"))\r\n        }\r\n        break;\r\n      case \"Batch\":\r\n      default:\r\n        while (CurrentDate.getTime() <= EndDate) {\r\n          switch (TemplatePeriode){\r\n            case \"Days\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Month\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Weeks\":\r\n            default:\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n          }\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, TemplatePeriode))\r\n        }\r\n        break;\r\n    }\r\n\r\n    var ActiveDataSets = []\r\n    if (!ActiveLength || ActiveLength === \"Batch\") {\r\n      ActiveDataSets = this.state.DataSets;\r\n    }\r\n    else {\r\n      var End = AccumulateTime(new Date(EndDate), this.state.ActiveLength).getTime()\r\n      this.state.DataSets.forEach(element => {\r\n        var NewData = {...element, data:[], dataX: []}\r\n\r\n        var first = null\r\n        var last = null\r\n        if (new Date(element.dataX[0]).getTime() <= EndDate) {\r\n          for(var i = 0; i < element.data.length; i++) {\r\n            if (new Date(element.dataX[i]).getTime() >= StartDate) {\r\n              NewData.data.push(element.data[i])\r\n              NewData.dataX.push(element.dataX[i])\r\n\r\n              var time = AccumulateTime(new Date(element.dataX[i]), this.state.ActiveLength)\r\n              if (time.getTime() > End){\r\n                if (element.dataX.length -1 >= i) last = i\r\n                break;\r\n              }\r\n            } else if (element.dataX[i] !== null) {\r\n              first = i\r\n            }\r\n          }\r\n          if (first !== null && NewData.dataX[0] > StartDate && element.data.length >= first+1) {\r\n            var DataSpot = get_DataSpot([element.dataX[first], element.dataX[first+1]], [element.data[first], element.data[first +1]], StartDate, element.data[first], element.dataX[first])\r\n            console.log(DataSpot)\r\n            NewData.data.unshift(DataSpot.ExValue)\r\n            NewData.dataX.unshift(StartDate)\r\n          }\r\n          if (last != null) {\r\n            //NewData.data.push(ExValue)\r\n            //NewData.dataX.push(StartDate)\r\n          }\r\n        }\r\n\r\n        ActiveDataSets.push(NewData)\r\n      });\r\n    }\r\n\r\n    //var lastDataPoint = this.state.DataSets[0].dataX[this.state.DataSets[0].dataX.length-1]\r\n    if (this.state.ActiveIndex > 0 && ActiveDataSets.length > 0 && ActiveDataSets[0].data && ActiveDataSets[0].data.length === 0){\r\n      var i = this.state.ActiveIndex\r\n      i = i-1;\r\n      this.setState({\r\n        ActiveIndex: i\r\n      })\r\n    } else {\r\n      this.setState({\r\n        ActiveLength: ActiveLength,\r\n        \r\n        Labels: Labels,\r\n        ActiveDataSets: ActiveDataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n        ActiveIndex: ActiveIndex,\r\n      }, () => {\r\n        this.forceUpdate()\r\n      })\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    /*if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      var WeightsMemTime = null\r\n      if (localDataStore.weighings) WeightsMemTime = localDataStore.weighings.update_time\r\n      Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n        this.props.getPen(Pen, PenMemTime)\r\n        this.props.getWeights(Pen, WeightsMemTime, localDataStore.sections)\r\n      })\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n        this.props.getCurve(TempGraph)\r\n      }\r\n    }*/\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (!this.props.Display && this.props !== prevProps) {\r\n      if (this.props.firebase.localDataStore) {\r\n        /*if (JSON.stringify(prevProps.firebase.localDataStore.weighings) !== JSON.stringify(this.props.firebase.localDataStore.weighings) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.pens) !== JSON.stringify(this.props.firebase.localDataStore.pens) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.graphs) !== JSON.stringify(this.props.firebase.localDataStore.graphs) || \r\n            prevProps.Predict !== this.props.Predict || \r\n            prevProps.weighings !== this.props.weighings || !this.state.TempGraph) {*/\r\n          const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(this.props)\r\n          if (JSON.stringify(this.state.TempGraph)!==JSON.stringify(TempGraph) ||\r\n              JSON.stringify(this.state.Legends)!==JSON.stringify(Legends) ||\r\n              JSON.stringify(this.state.DataSets)!==JSON.stringify(DataSets) ||\r\n\r\n              JSON.stringify(this.state.StartDate)!==JSON.stringify(StartDate) ||\r\n              JSON.stringify(this.state.EndDate)!==JSON.stringify(EndDate)\r\n          ) {\r\n            this.setState({\r\n              TempGraph: TempGraph,\r\n              Legends: Legends,\r\n              DataSets: DataSets,\r\n        \r\n              StartDate: StartDate,\r\n              EndDate: EndDate,\r\n            }, () => {\r\n              this.setGraphPeriode(this.state.ActiveLength)\r\n            });\r\n          }\r\n        //}\r\n      }\r\n    }\r\n    if (!this.props.Display && this.state !== prevState) {\r\n      if (this.state.ActiveLength != prevState.ActiveLength || this.state.ActiveIndex != prevState.ActiveIndex) {\r\n        this.setGraphPeriode(this.state.ActiveLength)\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n    if (!this.props.height) Dimensions.addEventListener(\"change\", this.onChange);\r\n    if (!this.props.Display) this.setGraphPeriode(this.state.ActiveLength)\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    if (!this.props.height) Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  render() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    var BatchIsOpen = false;\r\n    if (localDataStore.batchs && this.props.firebase.currentData && this.props.firebase.currentData.batchId) {\r\n      BatchIsOpen= ((localDataStore.batchs && localDataStore.batchs[this.props.firebase.currentData.batchId]) && (!localDataStore.batchs[this.props.firebase.currentData.batchId].state || localDataStore.batchs[this.props.firebase.currentData.batchId].state !== \"Closed\"))?true:false\r\n    }\r\n    var wide = this.state.dimensions.window.width>1000?true:false\r\n    if (this.props.Display) wide = false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    var height = this.state.dimensions.window.height //Full Screen\r\n    if (this.props.Height) {\r\n      height = this.props.Height;\r\n      //height = height - 100 // ?? beautify'er\r\n    } else {\r\n      height = 500 \r\n      /*if (Platform.OS !== 'ios' && Platform.OS !== 'android') height = height - 64 //Navigation title\r\n      height = height - 49 //TitleElement\r\n      height = height - 145 //Data Props\r\n      height = height - 71 //View Selector\r\n      if (BatchIsOpen) height = height - 74 //Editor\r\n\r\n      height = height - 100 // ?? beautify'er*/\r\n    }\r\n    //height = height - parseInt(10 + 15) //Margins \r\n\r\n    var width = this.state.dimensions.window.width * 2; //Full Screen\r\n    if (this.props.Width) {\r\n      width = this.props.Width;\r\n    } else {\r\n      width = width - (Metrics.normal * 4) // Margins\r\n      width = width / (wide?2.05:1) //If not WideScreen - Split diagram in 2\r\n    }\r\n    \r\n    var DataSets = this.props.Display?[{color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`,data:[],dataX:[]}]:this.state.ActiveDataSets\r\n    var Legends = this.props.Display?[]:this.state.Legends.slice(0, DataSets.length)\r\n\r\n    var StartDate//= this.props.Display?1:this.state.ActiveStartDate\r\n    if (this.props.Display) {\r\n      StartDate = 1\r\n      if (this.props.DataPoints[0] && this.props.DataPoints[0].time){\r\n        StartDate = this.props.DataPoints[0].time\r\n      }\r\n    }\r\n    else StartDate = this.state.ActiveStartDate\r\n    var EndDate//= this.props.Display?this.props.DataPoints.length:this.state.ActiveEndDate\r\n    if (this.props.Display) {\r\n      EndDate = 1\r\n      if (this.props.DataPoints[0] && this.props.DataPoints[this.props.DataPoints.length -1].time){\r\n        EndDate = this.props.DataPoints[this.props.DataPoints.length -1].time\r\n      }\r\n    }\r\n    else EndDate = this.state.ActiveEndDate\r\n    var Labels = [];\r\n    if (this.props.Display) {\r\n      this.props.DataPoints.forEach((point,index)=>{\r\n        DataSets[0].data.push(point.value)\r\n        if (this.props.DataPoints[index].time){\r\n          DataSets[0].dataX.push(this.props.DataPoints[index].time)\r\n        }\r\n        else DataSets[0].dataX.push(index+1)\r\n        Labels.push(index)\r\n      })\r\n    }else Labels = this.state.Labels\r\n\r\n    //console.log(this.state.TempGraph, Labels, DataSets)\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n        <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n          <ScrollView horizontal={true} showsHorizontalScrollIndicator={wide||this.props.Display?false:true} style={[Helpers.fullSize, App&&!this.props.Display?{maxWidth:width/2, maxHeight:540}:{}]}>\r\n            {this.state.TempGraph||this.props.Display && (Labels && Labels.length > 0) && (DataSets && DataSets.length > 0)?(\r\n            <LineChart\r\n              //bezier\r\n              style={[{marginLeft: -15, minHeight: height, minWidth: width}]}\r\n              width={width}\r\n              height={height}\r\n\r\n              data={{\r\n                labels: Labels,\r\n                xMinMax: [StartDate, EndDate, Labels.length -1],\r\n                legend: Legends,\r\n                datasets: DataSets,\r\n              }}\r\n\r\n              onDataPointClick={(data) => {\r\n                this.setState({\r\n                  ViewPoint: data\r\n                })\r\n              }}\r\n\r\n              withShadow={false}\r\n              withVerticalLines={true}\r\n              fromZero={false}\r\n              segments={15} //Horizontal-Lines\r\n              \r\n              verticalLabelRotation={0} //Not Working in browser\r\n              xLabelsOffset={0}\r\n\r\n              chartConfig={{\r\n                backgroundColor: Colors.white,\r\n                backgroundGradientFrom: Colors.white,  //#FFFFFF\r\n                backgroundGradientFromOpacity: 0,\r\n                backgroundGradientTo: Colors.white,\r\n                backgroundGradientToOpacity: 0,\r\n                decimalPlaces: 1, // optional, defaults to 2dp\r\n                color: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`,  //Lines / Grid\r\n                labelColor: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`, //Lables\r\n                style: {\r\n                  borderRadius: 16,\r\n                  height: height,\r\n                },\r\n                propsForDots: {\r\n                  r: \"5\",\r\n                  strokeWidth: \"0.5\",\r\n                  stroke: Colors.white\r\n                }\r\n              }}\r\n            />):(<></>)}\r\n          </ScrollView>\r\n        </View>\r\n        {!this.props.Display?(\r\n          <View style={[Helpers.fullWidth, Helpers.mainCenter]}>\r\n            <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, ]}>\r\n              <View style={{paddingRight: 2.5}}>\r\n                <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  if (this.state.ActiveIndex != 0){\r\n                    var i = this.state.ActiveIndex;\r\n                    i = i-1;\r\n                    this.setState({\r\n                      ActiveIndex: i\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n              <Button Text=\"Day view\" buttonStyle={{width:wide?100:80}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Days\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Week view\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Weeks\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Full Batch\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: 0,\r\n                    ActiveLength: \"Batch\"\r\n                  })\r\n                } }/>\r\n              <View style={{paddingLeft: 2.5}}>\r\n                <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  var i = this.state.ActiveIndex;\r\n                  i = i+1;\r\n                  this.setState({\r\n                    ActiveIndex: i\r\n                  })\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            {BatchIsOpen&&!App?(\r\n              <View style={[Helpers.fullWidth, Helpers.rowCenter]}>\r\n                  <CurveEditor control={this} props={this.props} state={this.state} />\r\n              </View>\r\n            ):(<></>)}\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst CurveEditor = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    if (props.state.ViewPoint){\r\n      var TimeText = props.state.Labels[props.state.ViewPoint.index]\r\n      if (props.state.ViewPoint.dataset.dataX) {\r\n        var Time = new Date(props.state.ViewPoint.dataset.dataX[props.state.ViewPoint.index])\r\n        TimeText = Time.getFullYear() + \".\" + (Time.getMonth() +1) + \".\" + Time.getDate()\r\n      }\r\n\r\n      var Data = props.state.ViewPoint.value\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100}] }>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{TimeText}</Text>\r\n          </View>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{Data} Kg.</Text>\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n    else return(<></>)\r\n  } else {\r\n    const [Point, setPoint] = React.useState(0)\r\n    if (!props.state.TempGraph) {\r\n      return(<></>)\r\n    }\r\n    else {\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100,marginTop:10}] }>\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index -1\r\n              if (index < 0) {\r\n                index = props.state.TempGraph.data.length -1\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              type='number'\r\n              step=\"0.1\"\r\n\r\n              label={props.state.Labels[Point]}\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n\r\n              onChange= {(evt) => {\r\n                var text = evt.target.value\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  NewData[Point] = text\r\n                  \r\n                  props.control.setState({\r\n                    state: props.state,\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n                  props.control.setGraphPeriode(props.state.ActiveLength)\r\n                }\r\n              }}\r\n              /*onChangeText={text => {\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  if (text === \"\" || text === null) text = 0\r\n                  if (text.endsWith('.')) text = text + \"0\"\r\n                  NewData[Point] = parseFloat(text)\r\n                  console.log(NewData[Point], text)\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n\r\n                  props.control.forceUpdate()\r\n                }\r\n              }}*/\r\n              value={\r\n                props.state.TempGraph.data[Point]\r\n              }\r\n            />\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index +1\r\n              if (index > props.state.TempGraph.data.length -1){\r\n                index = 0\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              label=\"Curve Name\"\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n              \r\n              onChangeText={text => {\r\n                /*var name = text;\r\n                name = name.replace(' ', '_')\r\n                if (isNaN(name[0])){\r\n                  var NewLegends = props.state.Legends;\r\n                  NewLegends[0] = name\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, name: name},\r\n                    Legends: NewLegends\r\n                  })\r\n                }*/\r\n              }}\r\n              value={\r\n                props.state.TempGraph.name\r\n              }\r\n            />\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n} \r\n\r\n/*\r\n<Button Text=\"Save\" buttonStyle={{width:100, marginLeft:20}}\r\n            onPress={() => {\r\n              props.props.setCurve(props.state.TempGraph)\r\n            } }/>\r\n*/\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime, MemSections: MemSections})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CurveElement);\r\nexport {\r\n  WeightsToGraphData,\r\n}","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\nimport CurveElement from './CurveElement'\r\n\r\nclass GrowthCurve extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {CurveList} = this.setData(props)\r\n    var D = new Date()\r\n    this.state = {\r\n      CurveList: CurveList,\r\n\r\n      Display: 0,\r\n\r\n      CurveName: \"\",\r\n      DataPoints: [],\r\n      Periode: \"Days\",\r\n\r\n      Selected: {dataindex:null, index:null, error:false}\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurveList = localDataStore.graphs\r\n    return { CurveList }\r\n  }\r\n\r\n  getData(){\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.graphs && JSON.stringify(this.state.CurveList)!==JSON.stringify(this.props.firebase.localDataStore.graphs)) {\r\n          const {CurveList} = this.setData(this.props)\r\n          this.setState({\r\n            CurveList: CurveList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var AverageGrowth = 0\r\n    for(var i = 0; i < this.state.DataPoints.length; i++) {\r\n      if (!this.state.DataPoints[i] || !this.state.DataPoints[i].hasOwnProperty(\"value\")) continue;\r\n      var value = this.state.DataPoints[i].value\r\n      if (value === \"\" || value === null) value = 0\r\n      value = parseFloat(value)\r\n\r\n      for(var i2 = i-1; i2 >= 0; i2--) {\r\n        if (this.state.DataPoints[i2] && this.state.DataPoints[i2].hasOwnProperty(\"value\")){\r\n          var Growth = value - this.state.DataPoints[i2].value\r\n          AverageGrowth = (AverageGrowth + Growth) / 2\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    AverageGrowth = AverageGrowth.toFixed(3)\r\n\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]} nestedScrollEnabled={true}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {this.state.Display === 0?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n            {this.state.CurveList ? (\r\n              <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <FlatList nestedScrollEnabled={true}\r\n                  data={Object.keys(this.state.CurveList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                  renderItem={({item})=>{\r\n                    return(\r\n                      <Button Text={item} onPress={() => {\r\n                        var CurveData = this.state.CurveList[item]\r\n\r\n                        var DataPoints = []\r\n                        if (!CurveData || !CurveData.hasOwnProperty(\"data\")){\r\n                          this.props.viewError(\"DataFetch error, please try to refresh\")\r\n                        }else {\r\n                          var _index = 0;\r\n                          Object.keys(CurveData.data).filter(e => e !== '__jsogObjectId').map((index) => {\r\n                            DataPoints[index] = { value: CurveData.data[index]}\r\n                            for(var i = index-1; i > _index;i--){\r\n                              DataPoints[i] = { value:null}\r\n                            }\r\n                            _index = index\r\n                          })\r\n                        }\r\n                        this.setState({\r\n                          Display: 2,\r\n                          CurveName: item,\r\n                          DataPoints: DataPoints,\r\n                          Periode: CurveData.periode\r\n                        })\r\n                      }}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n              <Button Text={\"New Curve\"} onPress={() => {\r\n                this.setState({\r\n                  Display: 1,\r\n                  DataPoints: [{value:\"0\"},{value:\"0\"}]\r\n                })\r\n              }}/>\r\n            </View>\r\n          </View>\r\n          ):(\r\n            //#region Edit or create\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n              {this.state.Display === 1?( // Create\r\n                <Input label={\"CurveName\"}\r\n                  containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                  style={[ApplicationStyles.input, ]}\r\n                  onChangeText={text => {\r\n                    if (text){\r\n                      if (DataStringCheck(text)){\r\n                        this.setState({CurveName: text})\r\n                      }\r\n                    }else {\r\n                      this.setState({CurveName: text})\r\n                    }\r\n                  }}\r\n                  value={\r\n                    this.state.CurveName\r\n                  }\r\n                />\r\n              ):( //Edit\r\n                <TitleElement Text={this.state.CurveName}/>\r\n              )}\r\n              <View style={[Helpers.fill, Helpers.fullWidth]}>\r\n                <ContentProp texts={[\"Periode: \" + this.state.Periode]} datas={[\"Average Growth: \" + AverageGrowth]} />\r\n                <View style={[Helpers.borderContainer, Helpers.fillCenter, Helpers.fullWidth, {alignSelf:'center'}]}>\r\n                  <CurveElement Display={true} DataPoints={this.state.DataPoints} Height={200} Width={455}/>\r\n                </View>\r\n                <View>\r\n                  <FlatList nestedScrollEnabled={true}\r\n                    data={this.state.DataPoints}\r\n                    style={[App?styles.AppStyle:styles.WebStyle]}\r\n                    renderItem={({item, index}) => {\r\n                      if (!item || item.value === null || item.value === undefined) return null;\r\n                      var Selected = index===this.state.Selected.dataindex\r\n                      return(\r\n                        <View style={[Helpers.fullWidth, Helpers.row]} \r\n                          onFocus={() => {\r\n                            this.setState({\r\n                              Selected: {dataindex:index, index:index, error:false}\r\n                            })\r\n                          }}\r\n                          onBlur={() => {\r\n                            this.setState({\r\n                              Selected: {dataindex:null, index:null, error:false}\r\n                            })\r\n                          }}\r\n                        >\r\n                          <Input label={\"Day:\"}\r\n                            type='number'\r\n                            step=\"0.1\"\r\n\r\n                            containerStyle={[{width:120, borderWidth:1, marginTop:10, marginRight:10}]}\r\n                            style={[ApplicationStyles.input, {width:100}]}\r\n                            \r\n                            errorMessage={Selected&&this.state.Selected.error?\"Value error\":\"\"}\r\n                            editable={index===0?false:true}\r\n                            onChangeText={text => {\r\n                              if (!isNaN(text)) {\r\n                                var _Selected = this.state.Selected\r\n                                _Selected.index = text\r\n                                _Selected.error = false\r\n                                if (this.state.DataPoints[text] && this.state.DataPoints[text].hasOwnProperty(\"value\") && this.state.DataPoints[text].value) {\r\n                                  _Selected.error = true\r\n                                }\r\n                                this.setState({\r\n                                  Selected: _Selected\r\n                                });\r\n                              }\r\n                            }}\r\n\r\n                            onBlur={() => {\r\n                              if (!this.state.Selected.error && this.state.Selected.dataindex !== this.state.Selected.index) {\r\n                                var DataPoints = [ ...this.state.DataPoints ];\r\n                                DataPoints[this.state.Selected.index] = {value: item.value.toString()};\r\n                                DataPoints[this.state.Selected.dataindex].value = null\r\n\r\n                                var FirstData = false\r\n                                for(var i = DataPoints.length-1; i>1;i--) {\r\n                                  if (!DataPoints[i] || !DataPoints[i].hasOwnProperty(\"value\") || !DataPoints[i].value) {\r\n                                    if (FirstData) {\r\n                                      DataPoints[i] = {value: null}\r\n                                    }\r\n                                    else DataPoints.pop()\r\n                                  } else {\r\n                                    FirstData = true;\r\n                                  }\r\n                                }\r\n                                this.setState({DataPoints});\r\n                              }\r\n                            }}\r\n\r\n                            value={\r\n                              \"\" + (Selected?this.state.Selected.index:index)\r\n                            }\r\n                          />\r\n                          <Input label={\"Weight:\"}\r\n                            type='number'\r\n                            step=\"0.1\"\r\n\r\n                            containerStyle={[Helpers.fill,{borderWidth:1, marginTop:10}]}\r\n                            style={[ApplicationStyles.input]}\r\n                            \r\n                            onChangeText={text => {\r\n                              if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                                var DataPoints = [ ...this.state.DataPoints ];\r\n                                DataPoints[index].value = text;\r\n                                this.setState({DataPoints});\r\n                              }\r\n                            }}\r\n\r\n                            onBlur={(e:any) => {\r\n                              var text = e.nativeEvent.text\r\n                              if (text === undefined || text === null || text === \"\") {\r\n\r\n                                var DataPoints = [ ...this.state.DataPoints ];\r\n                                DataPoints[index].value = \"0\";\r\n                                this.setState({DataPoints});\r\n                              }\r\n                            }}\r\n\r\n                            value={\r\n                              \"\" + item.value\r\n                            }\r\n                          />\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                    //Setting the number of column\r\n                    numColumns={1}\r\n                  />\r\n                </View>\r\n                <View style={{height:20}} />\r\n                <Button Text={\"New Point\"} onPress={() => {\r\n                  var DataPoints = [ ...this.state.DataPoints ];\r\n                  var value = this.state.DataPoints&&this.state.DataPoints.length >= 1?this.state.DataPoints[this.state.DataPoints.length-1].value:\"0\"\r\n                  DataPoints.push({value:value})\r\n                  this.setState({\r\n                    DataPoints\r\n                  })\r\n                }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                <Button Text={\"Save\"} onPress={() => {\r\n                  var update = true;\r\n\r\n                  if (this.state.CurveName !== \"\"){\r\n                    var Name = this.state.CurveName;\r\n                    if (!Object.keys(this.state.CurveList).includes(Name)) {\r\n                      if (this.state.Display === 2) { // update on non existing\r\n                        this.props.setViewError(\"Cannot update non-existing Curve. (Please refresh)\")\r\n                        update = false \r\n                      }\r\n                    } \r\n                    else {\r\n                      if (this.state.Display === 1) { // create on allready existing\r\n                        this.props.setViewError(\"Cannot create allready existing Curve.\")\r\n                        update = false \r\n                      }\r\n                    }\r\n                  }else {\r\n                    this.props.setViewError(\"Curve template need a name.\")\r\n                    update = false\r\n                  }\r\n\r\n                  var lastDataIndex = 0\r\n                  this.state.DataPoints.forEach((element,index) => {\r\n                    if (update && element.value !== null && element.value !== undefined){\r\n                      if (index > 0 && parseInt(element.value) <= parseInt(this.state.DataPoints[lastDataIndex].value)) {\r\n                        var Eindex = lastDataIndex\r\n                        if (element.value === this.state.DataPoints[lastDataIndex].value) Eindex = index\r\n                        this.props.setViewError(\"Curve template needs to be incremental: error at day: \" + Eindex)\r\n                        update = false;\r\n                      } else {\r\n                        lastDataIndex = index\r\n                      }\r\n                    }\r\n                  })\r\n\r\n                  if (update) {\r\n                    this.props.setViewError(null)\r\n                    this.props.setViewLoading(true)\r\n                    var newCurve = {name:this.state.CurveName, periode:this.state.Periode}\r\n                    var Data = []\r\n                    var index = 0;\r\n                    this.state.DataPoints.forEach(element => {\r\n                      if (element.value) Data[index] = parseFloat(element.value)\r\n                      index++;\r\n                    });\r\n                    newCurve.data = Data;\r\n                    this.props.updateCurve(newCurve)\r\n                    \r\n                    this.setState({\r\n                      Display: 0\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            //#endregion\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  AppStyle: {\r\n    \r\n  },\r\n  WebStyle: {\r\n    height:400\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\"})),\r\n    updateCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.GRAPH, {Graph: curve})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(GrowthCurve);\r\n//export default GrowthCurve;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList, SafeAreaView } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, ConsysRefs, GetCurve_FromBatch, CurvePredict, GetBatchEnd, AccumulateTime, format_Time, GetStats_FromBatch, GetStats_FromPen } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\nimport CurveElement, { WeightsToGraphData } from './CurveElement'\r\nimport { BarChart } from 'react-native-chart-kit'\r\n\r\nimport PureChart from 'react-native-pure-chart';\r\nimport Chart from 'react-apexcharts'\r\n\r\nclass AutoPig extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var { FarmData, ValveData, ScaleData, categories, series } = this.setData(props)\r\n    this.state = {\r\n      FarmData: FarmData,\r\n      ValveData: ValveData,\r\n      ScaleData: ScaleData,\r\n\r\n      Limit: 300,\r\n      SysId: 2,\r\n      STime: undefined,\r\n      ETime: undefined,\r\n      LastId: undefined,\r\n\r\n      options: {\r\n        chart: {\r\n          id: 'AutoPigChart'\r\n        },\r\n        plotOptions: {\r\n          bar: {\r\n            columnWidth: \"50%\"\r\n          }\r\n        },\r\n        stroke: {\r\n          width: [2, 0, 0]\r\n        },\r\n        markers: {\r\n          size: 3.5,\r\n          strokeWidth: 2,\r\n          fillOpacity: 0,\r\n          strokeOpacity: 0,\r\n          hover: {\r\n            size: 6\r\n          }\r\n        },\r\n        yaxis: {\r\n          tickAmount: 20,\r\n        },\r\n        xaxis: {\r\n          type: 'datetime'\r\n          //categories: categories,\r\n        }\r\n      },\r\n      series: series,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const FirebaseUser = this.props.firebase.firebaseUser;\r\n    var Site = null, refToken = null, accessToken = null;\r\n    var FarmData = null, ValveData = {}, ScaleData = {};\r\n    var categories = [], series = [];\r\n\r\n    if (FirebaseUser && FirebaseUser.farms && localDataStore && localDataStore.farms) {\r\n      const FarmsData = localDataStore.farms\r\n      if (FarmsData && FarmsData[Object.keys(FirebaseUser.farms)[0]]) {\r\n        FarmData = FarmsData[Object.keys(FirebaseUser.farms)[0]]\r\n        /*if (FarmData.site && FarmData.refToken) {\r\n          Site = FarmData.site\r\n          refToken = FarmData.refToken\r\n          if (FarmData.token) accessToken = FarmData.token\r\n        }*/\r\n      }\r\n    }\r\n    if (localDataStore && localDataStore.consys) {\r\n      if (localDataStore.consys.feedData) {\r\n        ValveData = localDataStore.consys.feedData\r\n\r\n        Object.keys(ValveData).filter(e => (e !== '__jsogObjectId')).forEach(element => {\r\n          var data = ValveData[element]\r\n          if (series) {\r\n            var DataSet = series.find(x => x.name === data.valve)\r\n            if (DataSet) {\r\n              DataSet.data.push(data.amount)\r\n            } else {\r\n              series.push({name:data.valve, type:\"column\", data:[{x:data.timestamp, y:data.amount}]})\r\n            }\r\n          }\r\n        });\r\n      }\r\n      if (localDataStore.consys.scaleData){\r\n        ScaleData = localDataStore.consys.scaleData\r\n\r\n        var DataSet2 = []\r\n        Object.keys(ScaleData).filter(e => (e !== '__jsogObjectId')).forEach(element => {\r\n          var data = ScaleData[element]\r\n          console.log(new Date(data.timestamp * 1000));\r\n          DataSet2.push({x: (data.timestamp*1000), y:data.amount})\r\n        });\r\n        if (DataSet2.length > 0) series.push({name:'AutoScale', type:\"line\", data:DataSet2})\r\n      }\r\n    }\r\n    console.log(series)\r\n    return { FarmData, ValveData, ScaleData, categories, series }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const FirebaseUser = this.props.firebase.firebaseUser;\r\n\r\n    this.props.getFarm()\r\n\r\n    /*if (FirebaseUser && FirebaseUser.farms && localDataStore && localDataStore.farms) { \r\n      const FarmsData = localDataStore.farms\r\n      if (FarmsData && FarmsData[Object.keys(FirebaseUser.farms)[0]]) {\r\n        const FarmData = FarmsData[Object.keys(FirebaseUser.farms)[0]]\r\n        if (FarmData.site && FarmData.refToken) {\r\n          this.props.getAutoPig()\r\n        }\r\n      }\r\n    }*/\r\n  }\r\n\r\n  checkData(props) {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const FirebaseUser = this.props.firebase.firebaseUser;\r\n\r\n    //THIS check is used many times and in future wil be unnessasary as this page is not shown unless all is true\r\n    //Can provoke loopback pages..\r\n    if (FirebaseUser && FirebaseUser.farms && localDataStore && localDataStore.farms) { \r\n      const FarmsData = localDataStore.farms\r\n      if (FarmsData && FarmsData[Object.keys(FirebaseUser.farms)[0]]) {\r\n        const FarmData = FarmsData[Object.keys(FirebaseUser.farms)[0]]\r\n        if (!FarmData.site || !FarmData.refToken) {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.localDataStore && prevProps.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore;\r\n        const firebaseUser = this.props.firebase.firebaseUser\r\n        \r\n        if (localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n          var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n          if ((this.state.FarmData.site !== Farm.site || this.state.FarmData.refToken !== Farm.refToken || this.state.FarmData.token !== Farm.token) ||\r\n              (localDataStore.consys && localDataStore.consys.scaleData && JSON.stringify(this.state.ScaleData) !== JSON.stringify(localDataStore.consys.scaleData)) ||\r\n              (localDataStore.consys && localDataStore.consys.feedData && JSON.stringify(this.state.ValveData) !== JSON.stringify(localDataStore.consys.feedData))) {\r\n           \r\n            var { FarmData, ValveData, ScaleData, categories, series } = this.setData(this.props)\r\n            console.log(ValveData, ScaleData)\r\n            this.setState({\r\n              FarmData: FarmData,\r\n              ValveData: ValveData,\r\n              ScaleData: ScaleData,\r\n\r\n              options: {\r\n                ...this.state.options,\r\n                xaxis: {\r\n                  ...this.state.options.xaxis,\r\n                  categories: categories\r\n                }\r\n              },\r\n              series:series\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var Token = (this.state.FarmData.token)?this.state.FarmData.token:null\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text={\"AutoPigs\"}/>\r\n            <View>\r\n              <View style={[Helpers.rowCenter]}>\r\n                <Input label=\"SysId\"\r\n                  containerStyle={[{maxWidth:100}]}\r\n                  style={[ApplicationStyles.input,{maxWidth:90}]}\r\n                  onChangeText={text => {\r\n                    if (!isNaN(text)) {\r\n                      this.setState({\r\n                        SysId:text\r\n                      })\r\n                    }\r\n                  }}\r\n                  value={this.state.SysId}\r\n                />\r\n                <Input label=\"Data Limit\"\r\n                  containerStyle={[{maxWidth:150}]}\r\n                  style={[ApplicationStyles.input,{maxWidth:140}]}\r\n                  onChangeText={text => {\r\n                    if (!isNaN(text) || text === \"\") {\r\n                      if (text === \"\") text = undefined\r\n                      this.setState({\r\n                        Limit:text\r\n                      })\r\n                    }\r\n                  }}\r\n                  value={this.state.Limit}\r\n                />\r\n                <Input label=\"LastId (Ids newer than)\"\r\n                  containerStyle={[{maxWidth:200}]}\r\n                  style={[ApplicationStyles.input,{maxWidth:190}]}\r\n                  onChangeText={text => {\r\n                    if (text === \"\") text = undefined\r\n                    if (text) {\r\n                      //if (DataStringCheck(text)){\r\n                        this.setState({LastId:text})\r\n                      //}\r\n                    }else {\r\n                      this.setState({LastId:text})\r\n                    }\r\n                  }}\r\n                  value={this.state.LastId}\r\n                />\r\n              </View>\r\n              <View style={[Helpers.rowCenter]}>\r\n                <Input label=\"Start Time : Epoch-sec (newest)\"\r\n                  containerStyle={[Helpers.halvWidth]}\r\n                  style={[ApplicationStyles.input]}\r\n                  onChangeText={text => {\r\n                    if (text === \"\") {\r\n                      this.setState({\r\n                        STime:undefined\r\n                      })\r\n                    }\r\n                    else if (!isNaN(text)) {\r\n                      this.setState({\r\n                        STime:text\r\n                      })\r\n                    }\r\n                  }}\r\n                  value={this.state.STime}\r\n                />\r\n                <Input label=\"End Time : Epoch-sec (oldest)\"\r\n                  containerStyle={[Helpers.halvWidth]}\r\n                  style={[ApplicationStyles.input]}\r\n                  onChangeText={text => {\r\n                    if (text === \"\") {\r\n                      this.setState({\r\n                        ETime:undefined\r\n                      })\r\n                    }\r\n                    else if (!isNaN(text)) {\r\n                      this.setState({\r\n                        ETime:text\r\n                      })\r\n                    }\r\n                  }}\r\n                  value={this.state.ETime}\r\n                />\r\n              </View>\r\n              <View style={[Helpers.rowCenter]}>\r\n                <Button Text=\"Fetch Scale_Data\"\r\n                  onPress={() => {\r\n                    this.props.getAutoPig(this.state.Limit, this.state.SysId, this.state.STime, this.state.ETime, null, this.state.LastId)\r\n                  }}/>\r\n                <Button Text=\"Fetch Valve_Data\"\r\n                  onPress={() => {\r\n                    this.props.getValveFeed(this.state.Limit, this.state.SysId, this.state.STime, this.state.ETime, null, this.state.LastId)\r\n                  }}/>\r\n              </View>\r\n            </View>\r\n            <View style={[Helpers.borderContainer, Helpers.fillCenter, Helpers.fullWidth, { minHeight:650, maxWidth:1237, width:1237, alignSelf:'center'}]}>\r\n              <Chart options={this.state.options} series={this.state.series} width={1240} height={700} />\r\n            </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n//<CurveElement Display={true} DataPoints={DataSet} Height={600} Width={1250}/>\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n    getValveFeed: (limit, sysId, start, stop, offset, lastId) => dispatch(FirebaseActions.actionStarting(ConsysRefs.VALVEFEED, DataRefs.CONSYS, {limit:limit, sysId:sysId, start:start, stop:stop, offset:offset, lastId:lastId})),\r\n    getAutoPig: (limit, sysId, start, stop, offset, lastId) => dispatch(FirebaseActions.actionStarting(ConsysRefs.SCALE, DataRefs.CONSYS, {limit:limit, sysId:sysId, start:start, stop:stop, offset:offset, lastId:lastId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AutoPig);\r\n//export default AutoPig;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass Operations extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.setCurrentData({})\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, {marginBottom:60}] }>\r\n          </View>\r\n\r\n          <View style={[Helpers.buttonContainer, Helpers.halvWidth, Helpers.fillColMain]}>\r\n            <OperationsPanel section={true}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setCurrentData: actionType => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action: actionType})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Operations);\r\n//export default Operations;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Datetime_Picker } from '../../../Components'\r\nimport Style from '../CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Weighing extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      weight: \"\",\r\n      quantity: quantity,\r\n      date: new Date().getTime()\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = Sections? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.penId && Pens[CurrentData.penId] && CurrentData.penId != Pen){\r\n      Pen = CurrentData.penId\r\n    }\r\n    var quantity = 1\r\n    if (localDataStore && localDataStore.pens) {\r\n      var _Pen = localDataStore.pens[Pen]\r\n      if (_Pen && _Pen.datas && _Pen.datas.count) quantity = _Pen.datas.count\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen, quantity}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n\r\n          const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n\r\n          this.setState({\r\n            Sections: Sections,\r\n            Section: Section,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n\r\n            quantity: quantity,\r\n            weight: \"\",\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin] }>\r\n              <Button Text=\"Weighing\" buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            \r\n            <View style={[Helpers.borderContainer, Helpers.fullWidth, {marginBottom:20}] }>\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Section}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  if (this.state.Sections[itemValue]){\r\n                    const Pens = sortObject(this.state.Sections[itemValue].pens)\r\n                    var quantity = 1\r\n                    if (localDataStore && localDataStore.pens) {\r\n                      var Pen = localDataStore.pens[Object.keys(Pens)[0]]\r\n                      if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                    }\r\n                    this.setState({\r\n                      Section: itemValue,\r\n                      Pens: Pens,\r\n                      Pen: Object.keys(Pens)[0],\r\n                      quantity: quantity,\r\n                    })\r\n                  }\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Sections).map((Section, i) => {\r\n                    return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Pen}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  var quantity = 1\r\n                  if (localDataStore && localDataStore.pens) {\r\n                    var Pen = localDataStore.pens[itemValue]\r\n                    if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                  }\r\n                  this.setState({\r\n                    quantity: quantity,\r\n                    Pen: itemValue\r\n                  })\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Pens).map((Pen, i) => {\r\n                    return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <View style={[Helpers.fullWidth, {borderWidth:0 ,height: 65, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\"}]}>\r\n                <View style={[Helpers.fullWidth, {alignItems:\"flex-start\"}]}>\r\n                  <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Weight date:</Text>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {alignItems:'flex-start'}]}>\r\n                  <Datetime_Picker Selected={this.state.date}\r\n                      onValueChange={(date)=>{\r\n                        this.setState({\r\n                          date: date.getTime()\r\n                        })\r\n                    }}/>\r\n                </View>\r\n              </View>\r\n              \r\n              <Input\r\n                label=\"Animal quantity\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      quantity: text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.quantity}\r\n              />\r\n              <Input\r\n                label=\"Total Weight\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  this.setState({\r\n                    weight: text\r\n                  })\r\n                }}\r\n                value={this.state.weight}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\"\r\n                onPress={() => {\r\n                  if (!this.state.Section){\r\n                    this.props.setViewError(\"A section is needed\")\r\n                  } else if (!this.state.Pen){\r\n                    this.props.setViewError(\"A pen is needed\")\r\n                  } else if (isNaN(this.state.quantity) || this.state.quantity === \"\" || this.state.quantity <= 0){\r\n                    this.props.setViewError(\"Quantity have to be a number bigger than 0\")\r\n                  } else if (isNaN(this.state.weight) || this.state.weight === \"\") {\r\n                    this.props.setViewError(\"Weight have to be a number\")\r\n                  }\r\n                  else {\r\n                    this.props.setViewLoading(true)\r\n                    this.props.setViewError(null)\r\n                    this.props.newWeight(this.state.Pen, parseFloat(this.state.weight), this.state.date, parseFloat(this.state.quantity))\r\n                    this.setState({\r\n                      weight: \"\",\r\n                      date: new Date().getTime()\r\n                    })\r\n                  }\r\n                } }/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Weighing);\r\n//export default Weighing;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass DataEditor extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen} = this.setData(props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    \r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = (Sections&&Sections[Section])? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.dataId && Pens[CurrentData.dataId] && CurrentData.dataId != Pen){\r\n      Pen = CurrentData.dataId\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase)  {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n            \r\n            const {Sections, Section, Pens, Pen} = this.setData(this.props)\r\n\r\n            this.setState({\r\n              Sections: Sections,\r\n              Section: Section,\r\n              Pens: Pens,\r\n              Pen: Pen,\r\n              NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n            })\r\n          }\r\n        }\r\n        if (this.props.firebase.currentData) {\r\n          if (this.props.firebase.currentData != prevProps.firebase.currentData){\r\n            this.forceUpdate()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    var DataView = (<View></View>);\r\n\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = PenEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {DataView}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst PenEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <PenEditor_Titles CurrentAction={CurrentData.action}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {CurrentData.action === Actions.CREATE ?(\r\n          <Input\r\n            label=\"Pen name\"\r\n            style={{ ...Style.input}}\r\n            onChangeText={text => {\r\n              if (text){\r\n                if (DataStringCheck(text)){\r\n                  Control.setState({Pen: text})\r\n                }\r\n              }else {\r\n                Control.setState({Pen: text})\r\n              }\r\n            }}\r\n            value={Control.state.Pen}\r\n          />\r\n        ):(<></>)}\r\n        {CurrentData.action === Actions.DELETE ?(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        ):(<></>)}\r\n      </View>\r\n\r\n      {CurrentData.action === Actions.CREATE || CurrentData.action === Actions.DELETE ?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else if (!exists && CurrentData.action === Actions.DELETE){\r\n                  Control.props.setViewError(\"Cannot remove non-existing pen\")\r\n                }\r\n                else {\r\n                  Control.props.setViewError(null)\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.penAction(CurrentData.action, Control.state.Section, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n    </View>\r\n  )\r\n}\r\n\r\nconst PenEditor_Titles = (props) => {\r\n  switch(props.CurrentAction) {\r\n    case Actions.CREATE:\r\n      return(\r\n        <TitleElement Text={\"Add Pen\"}/>\r\n      )\r\n    case Actions.DELETE:\r\n      return(\r\n        <TitleElement Text={\"Remove Pen\"}/>\r\n      )\r\n    default:\r\n      return(<></>)\r\n  }\r\n}\r\n\r\nconst PigEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    //Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <TitleElement Text={\"Add Pig: \" + CurrentData.pigtag}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {Control.state.NewSection?(\r\n        <Input\r\n          label=\"Pen name\"\r\n          style={{ ...Style.input}}\r\n          onChangeText={text => {\r\n            if (text){\r\n              if (DataStringCheck(text)){\r\n                Control.setState({Pen: text})\r\n              }\r\n            }else {\r\n              Control.setState({Pen: text})\r\n            }\r\n          }}\r\n          value={Control.state.Pen}\r\n        />\r\n        ):(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        )}\r\n        {CurrentData.action === Actions.CREATE?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE && Control.state.NewSection) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else {\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.setViewError(null)\r\n                  Control.props.pigAction(CurrentData.action, CurrentData.pigtag, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst Section_Picker = ({Control, CurrentData, localDataStore}) => {\r\n  if (Control.state.NewSection && CurrentData.action === Actions.CREATE){\r\n    return(\r\n      <Input\r\n        label=\"Section Name\"\r\n        style={{ ...Style.input}}\r\n        onChangeText={text => {\r\n          if (text){\r\n            if (DataStringCheck(text)){\r\n              Control.setState({Section: text})\r\n            }\r\n          }else {\r\n            Control.setState({Section: text})\r\n          }\r\n        }}\r\n        value={Control.state.Section}\r\n      />\r\n    )\r\n  } else {\r\n    return(\r\n      <Picker\r\n        mode=\"dropdown\"\r\n        selectedValue={Control.state.Section}\r\n        style={{ height: 50, width: 150 }}\r\n        onValueChange={(itemValue, itemIndex) => {\r\n          var Section = itemValue\r\n          var NewSection = Control.state.NewSection\r\n          var Pens = Control.state.Pens\r\n          var Pen = Control.state.Pen\r\n\r\n          if (itemValue === \"New Section\"){\r\n            NewSection = true;\r\n            Section = \"Section_\" + Object.keys(Control.state.Sections).length\r\n          } else {\r\n            Pens = sortObject(Control.state.Sections[itemValue].pens)\r\n            \r\n            if (CurrentData.action === Actions.DELETE){\r\n              Pen = Object.keys(Pens)[Object.keys(Pens).length-1]\r\n            }\r\n            else {\r\n              if (CurrentData.type == DataRefs.PIGS){\r\n                Pen = Object.keys(Pens)[0]\r\n              }else {\r\n                Pen = \"Pen_\" + (Object.keys(Pens).length +1)\r\n              }\r\n            }\r\n          }\r\n          \r\n          Control.setState({\r\n            Section: Section,\r\n            NewSection: NewSection,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n          })\r\n        }}>\r\n        {Object.keys(Control.state.Sections).map((Section, i) => {\r\n            return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n        })}\r\n      </Picker>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    penAction: (action, senctionId, penId) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PENS, {SectionId:senctionId, PenId:penId})),\r\n    pigAction: (action, tagId, penId,) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PIGS, {TagId:tagId, PenId:penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataEditor);\r\n//export default DataEditor;\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pens extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n\r\n      CommentsList: CommentsList,\r\n      Comments: Comments,\r\n\r\n      action: \"\"\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pens = sortObject(localDataStore.pens)\r\n    if (Pens[CurrentData.penId]){\r\n      CurrentData.data = Pens[CurrentData.penId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    var CommentsList = [];\r\n    var Comments = [];\r\n    if (localDataStore && localDataStore.comments) {\r\n      if (localDataStore.comments[CurrentData.penId]) {\r\n        CommentsList = localDataStore.comments[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n          var name = Object.keys(CommentsList)[i]\r\n          if (!name) continue;\r\n          var object = CommentsList[name];\r\n          if (!object || !object.time) continue;\r\n          Comments.push({[name]:object})\r\n        }\r\n        Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Comments = Comments.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings, CommentsList, Comments}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n\r\n      var MemTime = null\r\n      if (localDataStore.weighings && localDataStore.weighings[this.state.currentData.penId]) MemTime = localDataStore.weighings.update_time\r\n      this.props.getWeights(this.state.currentData.penId, MemTime, localDataStore.sections)\r\n\r\n      this.props.getComments(this.state.currentData.penId)\r\n      this.props.getBatch(localDataStore.batchs.update_time)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings))) ||\r\n            (localDataStore.comments && JSON.stringify(this.state.Comments)!==JSON.stringify(sortObject(localDataStoree.comments)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n\r\n            CommentsList: CommentsList, \r\n            Comments: Comments,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      \r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        if (Predict && Predict.Now) displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n      displayWeight = Math.round(displayWeight * 1000) / 1000\r\n\r\n      var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Control weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Weighings}\r\n                renderItem={({item, index}) => {\r\n                  if (item === \"__jsogObjectId\") return (<></>);\r\n                  var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Weight.time)]}\r\n                                datas={[Weight.weight + \"   : \" + Weight.count + \" pigs\"]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Comments}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Comment = this.state.CommentsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                              datas={[(Comment.quantity?(Comment.quantity + \" * \"):(\"\")) + Comment.action + \":\\n\" + Comment.data]}\r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime,  MemSections: MemSections})),\r\n    getComments: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.COMMENTS, {PenId: penId})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pens);\r\n//export default DataDisplay_Pens;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../../Stores/Device/Actions'\r\n//import { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pigs extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n      this.props.getWeights(this.state.currentData.penId)\r\n      this.props.getBatch(null)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        var count = pigcount?pigcount:1\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Last weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Weighings}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Weight.time)]}\r\n                              datas={[Weight.weight]} \r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {BatchId: batchId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pigs);\r\n//export default DataDisplay_Pigs;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\nimport DataDisplay_Pens from './DataDisplay_Pens'\r\nimport DataDisplay_Pigs from './DataDisplay_Pigs'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData:{}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (this.props.firebase.currentData && this.props.firebase.currentData.type){\r\n        const CurrentData = this.props.firebase.currentData;\r\n        switch(CurrentData.type){\r\n          case DataRefs.PIGS:\r\n            //this.props.getWeights()\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (this.props.firebase.currentData && this.props.firebase.currentData.type &&\r\n            JSON.stringify(this.state.currentData)!==JSON.stringify(this.props.firebase.currentData)) {\r\n          \r\n          const CurrentData = this.props.firebase.currentData;\r\n\r\n          switch(CurrentData.type){\r\n            case DataRefs.PENS:\r\n              if (localDataStore.pens) {\r\n                var Pens = sortObject(localDataStore.pens)\r\n                if (Pens[CurrentData.penId]){\r\n                  if (JSON.stringify(CurrentData.data)!==JSON.stringify(Pens[CurrentData.penId])){\r\n                    CurrentData.data = Pens[CurrentData.penId]\r\n                  }\r\n                  \r\n                  this.props.setCurrentDataElement(CurrentData)\r\n                }\r\n              }\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            case DataRefs.PIGS:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            default:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const CurrentData = this.state.currentData\r\n\r\n    var DataView = (<View></View>);\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = (<DataDisplay_Pens currentData={this.state.currentData}/>)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigData_View(this, CurrentData, localDataStore) //(<DataDisplay_Pigs currentData={this.state.currentData}/>)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n              {DataView}\r\n          </View>\r\n          \r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst PigData_View = (Control, CurrentData, localDataStore) => {\r\n  /*const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n  const connectedState = useSelector((state) => state.device.connectionState)*/\r\n\r\n  var Pigs;\r\n  if (localDataStore && localDataStore.pigs) {\r\n    Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n  }\r\n  \r\n  if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n  if (!CurrentData.data) {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n        <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n      </View>\r\n    )\r\n  }\r\n  \r\n  /*\r\n    <Row size={1.3}>\r\n          <Col size={1.5} style={{backgroundColor:\"red\"}}>\r\n            <Row size={2.25} style={{backgroundColor:\"blue\"}}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </Row>\r\n            <Row size={1.50}>\r\n              <Col><Text>Messages</Text></Col>\r\n              <Col><Text>Errors</Text></Col>\r\n            </Row>\r\n          </Col>\r\n          <Col>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </Col>\r\n        </Row>\r\n  */\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      {App ? (\r\n        <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth]}>\r\n          <View style={[ Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[ Helpers.fill, Helpers.column]}>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      ):(<></>)}\r\n      <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n        <Button Text={CurrentData.TagId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n          onPress={() => {} }/>\r\n      </View>\r\n      <View style={[Helpers.fullWidth]}>\r\n        <ContentProp ingrid={true} texts={[\"Section\", \"Pen\"]} datas={[CurrentData.data.section, CurrentData.data.pen]} />\r\n        <View style={{height:20}}/>\r\n        <View style={Helpers.midWidth, Helpers.colCenter}>\r\n          <Input\r\n            label={\"Comment:\"}\r\n            multiline={true}\r\n            containerStyle={[{borderWidth:1}]}\r\n            style={[ApplicationStyles.input]}\r\n            onChangeText={text => {\r\n              \r\n            }}\r\n            value={\r\n              \"NONE\"\r\n            }\r\n          />\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, GetCurve_FromBatch, CurvePredict, GetBatchEnd, AccumulateTime, format_Time, GetStats_FromBatch, GetStats_FromPen } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\nimport CurveElement, { WeightsToGraphData } from './CurveElement'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var {isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments} = this.setData(props)\r\n    this.state = {\r\n      Prediction: false,\r\n\r\n      isClosed: isClosed,\r\n      isVirtual: isVirtual,\r\n\r\n      StartDate: StartDate,\r\n      EndDate: EndDate,\r\n      Animals: Animals,\r\n      TargetWeight: TargetWeight,\r\n      AverageWeight: AverageWeight, \r\n      AverageGrowth:AverageGrowth,\r\n      Comments_List: Comments_List,\r\n      Comments: Comments,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var Batch = localDataStore.batchs[this.props.firebase.currentData.batchId];\r\n    var StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual\r\n    var Data = GetStats_FromBatch(Batch, localDataStore)\r\n    if (Data) {\r\n      StartDate = Data.StartDate\r\n      EndDate = Data.EndDate\r\n      TargetWeight = Data.TargetWeight\r\n      PenCount = Data.PenCount\r\n      Animals = Data.Animals\r\n      AverageWeight = Data.AverageWeight\r\n      AverageGrowth = Data.AverageGrowth\r\n      isClosed = Data.isClosed \r\n      isVirtual = Data.isVirtual\r\n    }\r\n\r\n    var Comments_List = null\r\n    var Comments = [];\r\n    if (Batch && Batch.state && Batch.state === \"Closed\" && Batch.closed && Batch.closed.comments) {\r\n      Comments_List = []\r\n      Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(element => {\r\n        var CommentsList = [];\r\n        if (Batch.closed.comments[element]) {\r\n          CommentsList = Batch.closed.comments[element];\r\n          for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n            var name = Object.keys(CommentsList)[i]\r\n            if (!name) continue;\r\n            var object = CommentsList[name];\r\n            if (!object || !object.time) continue;\r\n            object.pen = element\r\n            Comments.push({[name]:object})\r\n          }\r\n        }\r\n        Comments_List = Comments_List.concat(CommentsList);\r\n      });\r\n    }\r\n    Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n    return { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n\r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      if (batchData.pens) {\r\n        Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n          this.props.getPen(Pen, PenMemTime)\r\n        })\r\n      }\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n      }\r\n      this.props.getCurve(TempGraph)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.localDataStore) {\r\n        var { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments } = this.setData(this.props)\r\n        this.setState({\r\n          Prediction: false,\r\n          isClosed: isClosed,\r\n          isVirtual: isVirtual,\r\n\r\n          StartDate: StartDate,\r\n          EndDate: EndDate,\r\n          Animals: Animals,\r\n          TargetWeight: TargetWeight,\r\n          AverageWeight: AverageWeight, \r\n          AverageGrowth:AverageGrowth,\r\n          Comments_List: Comments_List,\r\n          Comments: Comments,\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    var StartDate = this.state.StartDate\r\n\r\n    var Dif_Time = new Date().getTime() - StartDate\r\n    var Days = Dif_Time / (1000 * 3600 * 24);\r\n    Days = Days.toFixed(0) //TODO: closed date...\r\n\r\n    StartDate = new Date(StartDate).getDate() + \"/\" + (new Date(StartDate).getMonth() +1) + \"/\" + new Date(StartDate).getFullYear()\r\n\r\n    var EndDate = this.state.EndDate\r\n    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n\r\n    var Virtual = String(this.state.isVirtual)\r\n    Virtual = Virtual.charAt(0).toUpperCase() + Virtual.slice(1)\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <TitleElement Text={this.props.firebase.currentData.batchId?this.props.firebase.currentData.batchId:\"-NON-\"}/>\r\n          <View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Start', data: StartDate},\r\n                  {title: 'End Forecast', data: EndDate},\r\n                  {title: 'Target Weight', data: this.state.TargetWeight},\r\n                  //{title: 'Virtual cal', data: Virtual}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Animals', data: this.state.Animals},\r\n                  {title: 'Day', data: Days},\r\n                  {title: 'Avarage weight', data: this.state.AverageWeight},\r\n                  {title: 'Average growth', data: this.state.AverageGrowth}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <Button Text=\"Show Predict\"\r\n                onPress={() => {\r\n                  this.setState({\r\n                    Prediction: !this.state.Prediction\r\n                  })\r\n                } }/>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, {minHeight:750}]}>\r\n            <CurveElement Predict={this.state.Prediction} weighings={localDataStore.weighings}/>\r\n          </View>\r\n          {this.state.Comments_List?(\r\n            <View style={[Helpers.fill, Helpers.midWidth, {height:415}]}>\r\n              {/* diff for app / web here ^ */}\r\n              <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n              <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Comments.filter(e => (e !== '__jsogObjectId'))}\r\n                renderItem={({item, index}) => {\r\n                  var Comment = this.state.Comments_List[0][Object.keys(item)[0]]\r\n                  if (!Comment) return null\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                                datas={[Comment.pen + \": \" + Comment.action + \":\\n\" + Comment.data]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport UserFrontScreen from '../Containers/Cloud/UserPanel/FrontScreen'\r\nimport UserDashBoardScreen from '../Containers/Cloud/UserPanel/Dashboard'\r\nimport UserPigsScreen from '../Containers/Cloud/UserPanel/Pigs'\r\nimport UserPensScreen from '../Containers/Cloud/UserPanel/Pens'\r\nimport UserBatchsScreen from '../Containers/Cloud/UserPanel/Batchs'\r\nimport UserCurvesScreen from '../Containers/Cloud/UserPanel/GrowthCurves'\r\nimport AutoPigScreen from '../Containers/Cloud/UserPanel/AutoPig'\r\n\r\nimport UserOperationsScreen from '../Containers/Cloud/UserPanel/Operations'\r\nimport Weighing from '../Containers/Cloud/UserPanel/Weighing'\r\n\r\nimport UserDataEditor from '../Containers/Cloud/UserPanel/DataEditor'\r\nimport UserDataDisplay from '../Containers/Cloud/UserPanel/DataDisplay'\r\nimport UserDataPlotter from '../Containers/Cloud/UserPanel/DataPlotter'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    UserFront: {\r\n      screen: UserFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Front Pannel',\r\n        headerLeft: (props) => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => {\r\n              if (props.label === \"System Board\") {\r\n                NavigationService.nacigationPop()\r\n              }\r\n              else NavigationService.navigate('MainStack')\r\n            }}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'user_front',\r\n    },\r\n\r\n    UserDashBoard: {\r\n      screen: UserDashBoardScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Dash Board',\r\n      }),\r\n      path: 'user_dashboard',\r\n    },\r\n\r\n    UserPigs: {\r\n      screen: UserPigsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pigs',\r\n      }),\r\n      path: 'user_pigs',\r\n    },\r\n\r\n    UserPens: {\r\n      screen: UserPensScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pens',\r\n      }),\r\n      path: 'user_pens',\r\n    },\r\n\r\n    UserBatchs: {\r\n      screen: UserBatchsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Batchs',\r\n      }),\r\n      path: 'user_batchs',\r\n    },\r\n\r\n    UserCurves: {\r\n      screen: UserCurvesScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Curves',\r\n      }),\r\n      path: 'user_curves',\r\n    },\r\n\r\n    AutoPig: {\r\n      screen: AutoPigScreen,\r\n      navigationOptions: () => ({\r\n        title: 'AutoPig',\r\n      }),\r\n      path: 'user_autopigs',\r\n    },\r\n\r\n    /**************** Operations */\r\n    UserOperations: {\r\n      screen: UserOperationsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    WeighingOperations: {\r\n      screen: Weighing,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    /**************** Data Displays */\r\n    DataEditor: {\r\n      screen: UserDataEditor,\r\n      navigationOptions: () => ({\r\n        title: 'Data Editor',\r\n      }),\r\n      path: 'user_dataedtior',\r\n    },\r\n\r\n    DataDisplay: {\r\n      screen: UserDataDisplay,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_datadisplay',\r\n    },\r\n\r\n    DataPlotter: {\r\n      screen: UserDataPlotter,\r\n      navigationOptions: () => ({\r\n        title: 'Batch Data',\r\n      }),\r\n      path: 'user_dataplotter',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './AdminPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData(){\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.props.clearDataMem()\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    \r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"User Board\", \"Systems\"]}\r\n            Images={[Images.DashBoard, Images.System,]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"User Board\":\r\n                  NavigationService.navigate(\"UserBoard\")\r\n                  break;\r\n                case \"Systems\":\r\n                  NavigationService.navigate(\"SystemBoard\")\r\n                  break;\r\n              }\r\n              ele.text\r\n            }}\r\n          />\r\n          \r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass UserListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {UserList} = this.setData(props)\r\n    this.state = {\r\n      UserList: UserList,\r\n      User: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getUsers()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var UserList = null\r\n    if (localDataStore && localDataStore.users) {\r\n      UserList = sortObject(localDataStore.users)\r\n    }\r\n    \r\n    return {UserList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.users && JSON.stringify(this.state.UserList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.users))) {\r\n            const {UserList} = this.setData(this.props)\r\n            this.setState({\r\n              UserList: UserList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.UserList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.UserList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var User = this.state.UserList[item];\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={User.name} itemStyle={[{minWidth: 190, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={\"\"} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={User.state} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"User-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  User: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.User\r\n              }\r\n            />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUsers: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERS, {UserId:\"\"})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserListBoard);","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass SystemListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {FarmList} = this.setData(props)\r\n    this.state = {\r\n      FarmList: FarmList,\r\n      Farm: {name: \"\"}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getFarms()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var FarmList = null\r\n    if (localDataStore && localDataStore.farms) {\r\n      FarmList = sortObject(localDataStore.farms)\r\n    }\r\n    return {FarmList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.farms && JSON.stringify(this.state.FarmList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.farms))) {\r\n            const {FarmList} = this.setData(this.props)\r\n            this.setState({\r\n              FarmList: FarmList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.FarmList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.FarmList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var Farm = this.state.FarmList[item];\r\n                      Farm.id = item\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={Farm.name} itemStyle={[{minWidth: 100, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35, justifyContent:\"center\"}]} Title={Farm.manager} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35}]} Title={Farm.email} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <View style={[Helpers.rowCenter, Helpers.fullWidth, {height:120}]}>\r\n              <Input\r\n                label={\"Farm-tag:\"}\r\n                containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                style={[ApplicationStyles.input, ]}\r\n                editable={false}\r\n                onChangeText={text => {\r\n                  var Farm = this.state.Farm;\r\n                  Farm.name = text;\r\n                  this.setState({\r\n                    Farm: Farm\r\n                  })\r\n                }}\r\n                value={\r\n                  this.state.Farm.name\r\n                }\r\n              />\r\n              <Button Text=\"Consys\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  //this.props.logOut()\r\n                }}/>\r\n              <Button Text=\"Farm Panel\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  if (this.state.Farm.id !== \"\") {\r\n                    this.props.clearDataMem()\r\n                    this.props.setUserFarm(this.state.Farm.id)\r\n                    NavigationService.navigate(\"UserPanel\")\r\n                  }\r\n                }}/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    getFarms: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {FarmId: \"\"})),\r\n    setUserFarm: (FarmId) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {farms:{[FarmId]: true}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SystemListBoard);","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport AdminFrontScreen from '../Containers/Cloud/AdminPanel/FrontScreen'\r\n\r\nimport AdminUserBoard from '../Containers/Cloud/AdminPanel/UserBoard'\r\nimport AdminSystemBoard from '../Containers/Cloud/AdminPanel/SystemBoard'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    AdminFront: {\r\n      screen: AdminFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n\r\n    UserBoard: {\r\n      screen: AdminUserBoard,\r\n      navigationOptions: () => ({\r\n        title: 'User Board',\r\n      }),\r\n      path: 'admin_user_board',\r\n    },\r\n    SystemBoard: {\r\n      screen: AdminSystemBoard,\r\n      navigationOptions: () => ({\r\n        title: 'System Board',\r\n      }),\r\n      path: 'admin_system_board',\r\n    },\r\n\r\n    UserPanel: {\r\n      screen: UserPanelNavigation,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('SystemBoard')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'AdminFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport SplashScreen from '../Containers/SplashScreen/SplashScreen'\r\nimport DeepLinkingScreen from '../Containers/DeepLinking/DeepLinkingScreen'\r\n\r\nimport FrontNavigation from '../Navigators/FrontNavigator'\r\nimport AuthNavigation from '../Navigators/AuthNavigator'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\nimport AdminPanelNavigator from '../Navigators/AdminPanelNavigator'\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    SplashScreen: {\r\n      screen: SplashScreen,\r\n      navigationOptions: () => ({\r\n        headerShown: false,\r\n      }),\r\n    },\r\n\r\n    MainStack: {\r\n      screen: FrontNavigation, // Called By StartupSaga.js\r\n      path: 'Front',\r\n    },\r\n    \r\n    AuthStack: AuthNavigation, // All user pages\r\n\r\n    UserPanel: UserPanelNavigation, // 'Free' Users Pages... \r\n\r\n    AdminPanel: AdminPanelNavigator, // Admin Pages\r\n\r\n    DeepLinkingScreen: {\r\n      screen: DeepLinkingScreen,\r\n      path: 'deeplink',\r\n    },\r\n  },\r\n  {\r\n    // By default the application will show the splash screen\r\n    initialRouteName: 'SplashScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'none',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default createAppContainer(StackNavigator)\r\n","import React, { useEffect } from 'react'\r\nimport { View } from 'react-native'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\nimport AppNavigator from '../../Navigators/AppNavigator'\r\n\r\nimport StartupActions from '../../Stores/Startup/Actions'\r\nimport { Helpers } from '../../Theme'\r\n\r\nconst RootScreen = () => {\r\n  // Deep linking prefix\r\n  const prefix = 'agrisysapp://';\r\n  \r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n    dispatch(StartupActions.startup())\r\n  }, [])\r\n\r\n  return (\r\n    <View style={Helpers.fill}>\r\n      <AppNavigator\r\n        // Initialize the NavigationService (see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html)\r\n        ref={(navigatorRef) => {\r\n          NavigationService.setTopLevelNavigator(navigatorRef)\r\n        }}\r\n        uriPrefix={prefix}\r\n      />\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default RootScreen\r\n","import { combineReducers } from 'redux'\r\nimport configureStore from './CreateStore'\r\nimport rootSaga from '../Sagas'\r\n\r\nimport { reducer as ExampleReducer } from './Example/Reducers'\r\nimport { reducer as DeviceReducer } from './Device/Reducers'\r\nimport { reducer as FirebaseReducer } from './Firebase/Reducers'\r\n\r\nexport default () => {\r\n  const rootReducer = combineReducers({\r\n    /**\r\n     * Register your reducers here.\r\n     * @see https://redux.js.org/api-reference/combinereducers\r\n     */\r\n    example: ExampleReducer,\r\n    device: DeviceReducer,\r\n    firebase: FirebaseReducer,\r\n  })\r\n\r\n  return configureStore(rootReducer, rootSaga)\r\n}\r\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/lib/integration/react'\n\nimport createStore from './Src/Stores'\nimport RootScreen from './Src/Containers/Root/RootScreen'\n\nconst { store, persistor } = createStore()\n\nconst App = () => (\n  <Provider store={store}>\n    {/**\n     * PersistGate delays the rendering of the app's UI until the persisted state has been retrieved\n     * and saved to redux.\n     * The `loading` prop can be `null` or any react instance to show during loading (e.g. a splash screen),\n     * for example `loading={<SplashScreen />}`.\n     * @see https://github.com/rt2zz/redux-persist/blob/master/docs/PersistGate.md\n     */}\n    <PersistGate loading={null} persistor={persistor}>\n      <RootScreen />\n    </PersistGate>\n  </Provider>\n);\n\nexport default App\n","module.exports = __webpack_public_path__ + \"static/media/Home.1fff8434.png\";","module.exports = __webpack_public_path__ + \"static/media/Dashboard.26766c7a.png\";","module.exports = __webpack_public_path__ + \"static/media/System.7e4af00c.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Curves.da739887.png\";","module.exports = __webpack_public_path__ + \"static/media/Growth-curve.7f9a7fea.png\";","module.exports = __webpack_public_path__ + \"static/media/User.d73be9fd.png\";","module.exports = __webpack_public_path__ + \"static/media/Sow.beff0aff.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABRCAYAAACuepoLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAq9JREFUeNrsnT1Lw1AUhk9FRFEhDhV0qgouLlrcjYOLi3XpasEfYjo62X/Quorg5iS0P0D8GBzVOAkWP6CVigg1197E0Naa3ER7b/K+cLig3tP4eJJz8g5XIig0JRS8Zr3Pn1+JUgE0JYgjK1JRqEz2y9DE1IJwgrdalRr1BxoZm6Th8aTvfVwvVqxacaE8zLXtQ+EEN+cHdH12QHPpLM0uZX3tbdSrdHmyS7VH0wY6w1caQNvwp5GxJC2v57+q2pJmRc7+HmAKaHBolGbTTkVvAGYIFdoBucfPp7p1rH8efwr280iJiu3ytUUr9iSY5+yZrqIqTAayzB+sIgOqHtJgq7vGD1IRpsaHUY3PTptWmCJjC5+/Ao8/7hlONZgZ/ow0OQylqkIGubv5Cl/3ATI4zFQUX+T7BRMCTMCM5mumqhf+fH8lvLdRqzqraJ7aU++pscznuyBvPk3XjEh/lKcpWZSVr8x+mMNufby/2p6m+rc58xRFZZvD0/O6b3PY/Zg5Pd5BA0I3B0yMRlsU3Ms0ALOlXAh5dwCzpZIVdwEh5uP4x+gGk1lwlYAQjDjCRAMCTMAETAgwARMwoZ5zphJiNpqonri73lrF8thu/U+C0x5Dpz0v2fWYKlcmGhC6OQSYMo1GMjnthkSsfr2WRFsD0lFfnlh5rswSyeO0y5BHyKiO4mgURh7POdCA0M0BEzAhwARMwIQAEzABEzAhwARMwIQ6FRen3fgPmHDaxVh5rswSwWnvlsOX4LQHzIEGhG4OmIAJASZgAiYEmIAJmPGEafJVBxZHi21sPCvH30Fv8W7uqMj3F/1uZCe6PtP3vxvQYg7TcO33dLe6LTh2ACk7Gpe5RxkeFcELKYd0m/UrT4q+zxMtBODgHOLcjHnc8oLyrMQvUDWKr3xX46cAAwCxt3YCfnN46AAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/Area_Colour.f4a4e098.png\";","module.exports = __webpack_public_path__ + \"static/media/AutoPig.ec16c410.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Components.224ca1b3.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexagon-globe.fce26805.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexa-icon.5129d536.png\";","module.exports = __webpack_public_path__ + \"static/media/Logo.9b051259.png\";","module.exports = __webpack_public_path__ + \"static/media/TOM.c88886f3.png\";"],"sourceRoot":""}