{"version":3,"sources":["Src/Stores/CreateStore.js","Src/Stores/Startup/Actions.js","Src/Stores/Example/Actions.js","Src/Stores/Device/BLE/Actions.js","Src/Stores/Device/BlueTooth/Actions.js","Src/Stores/Device/Actions.js","Src/Services/NavigationService.js","Src/Stores/Firebase/Actions.js","Src/Sagas/StartupSaga.js","Src/Config/index.js","Src/Services/UserService.js","Src/Sagas/Example/ExampleSaga.js","Src/Services/DeviceService.js","Src/Stores/Device/Selectors.js","Src/Sagas/Device/BLE/BLESaga.js","Src/Sagas/Device/BlueTooth/BlueToothSaga.js","Src/Sagas/Device/DeviceSaga.js","Src/Stores/Firebase/Selectors.js","Src/Services/FirebaseService.js","Src/Services/ConsysService.js","Src/Sagas/Firebase/FirebaseSaga.js","Src/Sagas/index.js","Src/Stores/Example/InitialState.js","Src/Stores/Example/Reducers.js","Src/Stores/Device/BLE/InitialState.js","Src/Stores/Device/BlueTooth/InitialState.js","Src/Stores/Device/InitialState.js","Src/Stores/Device/BLE/Reducers.js","Src/Stores/Device/BlueTooth/Reducers.js","Src/Stores/Device/Reducers.js","Src/Stores/Firebase/Reducers.js","Src/Stores/Firebase/InitialState.js","Src/Theme/Colors.js","Src/Theme/Fonts.js","Src/Theme/Metrics.js","Src/Theme/Images.js","Src/Theme/Helpers.js","Src/Theme/ApplicationStyles.js","Src/Containers/SplashScreen/SplashScreen.js","Src/Containers/SplashScreen/SplashScreenStyle.js","Src/Containers/DeepLinking/DeepLinkingScreen.js","Src/Components/Button.js","Src/Components/Button_Panel.js","Src/Components/TitleElement.js","Src/Components/CustomListItem.js","Src/Components/ContentProp.js","Src/Components/Loading.js","Src/Components/OperationsPanel.js","Src/Components/Progressbar.js","Src/Components/DateTime_Picker.js","Src/Components/Comment_Module.js","Src/Containers/Agrisys/FrontScreenStyle.js","Src/Containers/Agrisys/FrontScreen.js","Src/Stores/Example/Selectors.js","Src/Containers/Example/ExampleScreenStyle.js","Src/Containers/Example/ExampleScreen.js","Src/Containers/Device/DeviceScreenStyle.js","Src/Containers/Device/DeviceScreen.js","Src/Navigators/FrontNavigator.js","Src/Containers/Cloud/AuthScreens/UserLoadingScreen.js","Src/Containers/Cloud/AuthScreens/AuthStyle.js","Src/Containers/Cloud/AuthScreens/VerifyScreen.js","Src/Containers/Cloud/AuthScreens/UserLoginScreen.js","Src/Containers/Cloud/UserPanel/UserPanelStyle.js","Src/Containers/Cloud/UserPanel/UserInformation.js","Src/Containers/Cloud/UserPanel/Subscription.js","Src/Containers/Cloud/UserPanel/FarmInformation.js","Src/Containers/Cloud/AuthScreens/CreateUserDataScreen.js","Src/Navigators/AuthNavigator.js","Src/Containers/Cloud/UserPanel/FrontScreen.js","Src/Containers/Cloud/UserPanel/Dashboard.js","Src/Containers/Cloud/CloudScreenStyle.js","Src/Containers/Cloud/UserPanel/Pigs.js","Src/Containers/Cloud/UserPanel/Pens.js","Src/Containers/Cloud/UserPanel/Batchs.js","Src/Containers/Cloud/UserPanel/CurveElement.js","Src/Containers/Cloud/UserPanel/GrowthCurves.js","Src/Containers/Cloud/UserPanel/Operations.js","Src/Containers/Cloud/UserPanel/Weighing.js","Src/Containers/Cloud/UserPanel/DataEditor.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pens.js","Src/Containers/Cloud/UserPanel/DataDisplay_Pigs.js","Src/Containers/Cloud/UserPanel/DataDisplay.js","Src/Containers/Cloud/UserPanel/DataPlotter.js","Src/Navigators/UserPanelNavigator.js","Src/Containers/Cloud/AdminPanel/AdminPanelStyle.js","Src/Containers/Cloud/AdminPanel/FrontScreen.js","Src/Containers/Cloud/AdminPanel/UserBoard.js","Src/Containers/Cloud/AdminPanel/SystemBoard.js","Src/Navigators/AdminPanelNavigator.js","Src/Navigators/AppNavigator.js","Src/Containers/Root/RootScreen.js","Src/Stores/index.js","App.tsx","Src/Assets/Images/Home.png","Src/Assets/Images/Dashboard.png","Src/Assets/Images/System.png","Src/Assets/Images/Feed-Curves.png","Src/Assets/Images/Growth-curve.png","Src/Assets/Images/User.png","Src/Assets/Images/Sow.png","Src/Assets/Images/Section.png","Src/Assets/Images/Area_Colour.png","Src/Assets/Images/AutoPig.png","Src/Assets/Images/Feed-Components.png","Src/Assets/Images/Hexagon-globe.png","Src/Assets/Images/Hexa-icon.png","Src/Assets/Images/Logo.png","Src/Assets/Images/TOM.png"],"names":["JSOGTransform","createTransform","inboundState","key","JSOG","encode","outboundState","decode","persistConfig","storage","transforms","blacklist","createActions","startup","Types","Creators","StartupTypes","fetchUser","fetchUserLoading","fetchUserSuccess","fetchUserFailure","ExampleTypes","bleStartup","bleStateUpdated","startBleScan","stopBleScan","readBleDeviceData","BleTypes","bluetoothStartup","startBluetoothScan","stopBluetoothScan","bluetoothScanAble","readBlueDeviceData","BluetoothTypes","deviceStartup","setDeviceError","scannerStateUpdated","addDevice","removeDevice","clearDevices","connectedDeviceUpdated","connectionStateUpdated","connectionMethodeUpdated","setDeviceData","updateDeviceData","connectDevice","disconnectDevice","readDeviceData","fetchDevice","DeviceTypes","BleCreators","BlueToothCreators","navigator","firebaseStartup","firebaseIsLoading","setFirebaseError","setViewError","viewIsLoading","setCurrentData","actionStarting","fetchStarting","dataFetchSuccess","fetchSuccess","fetchFailure","FirebaseTypes","navigate","routeName","params","dispatch","NavigationActions","replace","StackActions","navigateAndReset","reset","index","actions","setTopLevelNavigator","navigatorRef","nacigationPop","back","console","log","Platform","OS","put","DeviceActions","FirebaseActions","NavigationService","Config","API_URL","HTTPS_START","CONSYS_CLIENT_ID","CONSYS_CLIENT_SECRET","CONSYS_AUTH","CONSYS_API","GetCheckToken_URL","Site_URL","GetConsumtion_URL","GetConsumtionData_URL","Consumptiontype","SystemId","res","GetConsumtionData_Var","Offset","Limit","Starttime","Stoptime","Lastid","in200s","curryN","min","max","value","isNumber","is","Number","gte","isWithin","userApiClient","axios","create","baseURL","headers","Accept","timeout","userService","Math","random","Promise","resolve","reject","number","floor","get","toString","then","response","status","data","ExampleActions","call","user","deviceService","Version","a","async","PermissionsAndroid","check","PERMISSIONS","ACCESS_COARSE_LOCATION","request","RESULTS","GRANTED","ScannerState","ConnectionState","ConnectionMethode","handleBleState","connectBle","handleConnection","handleScanning","scanBle","setBleScannerStart","sagaArgs","permitError","fork","BLEManager","manager","eventChannel","emit","subscription","onStateChange","state","remove","buffers","expanding","stateChannel","take","newState","BleActions","cancelled","close","device","select","connectionMethode","connectedDevice","_manager","isConnected","onDisconnected","error","type","disconnectedChannel","actionChannel","deviceActionChannel","connect","discoverAllServicesAndCharacteristics","_device","race","deviceAction","disconnected","cancelConnection","KnownUUIDS","services","_services","serviceUUIDs","filter","service","includes","uuid","monitor","characteristics","characteristic","push","forEach","i","monitorCharacteristicForService","readingChannel","TempData_Reading","Buffer","from","length","PacketId","BatteryLevel","base64","charCodeAt","Battery","RawData","header","slice","compare","parseInt","NewData","concat","TagId","tagid","FatLayers","FatL1","FatL2","FatL3","layers","layer1","layer2","layer3","scanTask","bleState","scannerState","connectionState","channel","action","State","PoweredOn","cancel","startDeviceScan","allowDuplicates","scannedDevice","localName","stopDeviceScan","scanningChannel","scanBluetooth","setBlueScannerStart","BlueManager","PairDevice","id","receiveData","Message","TAGId","Discover","NativeEventEmitter","addListener","Device","address","name","alias","bluetoothChannel","StopDiscovery","BluetoothSearchAble","methode","UserStates","DataStates","DataRefs","FIREBASEUSER","USERSDATA","USERS","FARMS","SECTIONS","PENS","PIGS","BATCHS","WEIGHING","GRAPH","COMMENTS","FARMDATAS","SHARES","CONSYS","Actions","SIGN","FETCH","CREATE","UPDATE","MOVE","DELETE","CLEAR","ADD","Operations","ErrorTypes","format_num","num","format_Time","time","s","Date","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","auth","messaging","database","reA","reN","sortAlphaNum","b","aA","bA","aN","bN","sortObject","o","sorted","hasOwnProperty","sort","DataStringCheck","Check_num","first","numbers","specialChars","indexOf","GetWeight_FromPen","PenId","WeighingsStore","AfterTime","BeforeTime","Weighing","_weighing","weighing","GetBatch_FromPen","localDataStore","batchs","_batch","batch","pens","GetStats_FromPen","PenData","StartDate","EndDate","PenWeighings","Animals","PenWeight","PenGrowth","AveragePenGrowth","datas","count","weighings","GrowthCount","lastDate","LastWeight","undefined","LastWeightDay","FirstWeight","Object","keys","weight","Weight","now","getTime","isVirtual","Batch","TempGraph","GetCurve_FromBatch","graphs","BatchEndDate","Predict","CurvePredict","Now","_date","lastWeighing","Addition","setDate","days","tempEnd","date","Growth","GetStats_FromBatch","PenCount","CollectedWeight","CollectedGrowth","isClosed","TargetWeight","GetBatchEnd","PenEnds","reverse","e","Batch_Pen","Pen","closed","PenStats","AverageWeight","parseFloat","toFixed","AverageGrowth","GraphsStore","CurrentData","gcurve","curveId","Id","TempCurve","currentTime","AccumulateTime","periode","Time","PeriodeLength","NewTime","setMonth","get_DataSpot","MinMax_Time","MinMax_Data","FindTime","Data","DataTime","ExValue","VirData","ExTime","slope","minX","maxX","minY","GetSlope_Between","Weighing2","weight2","StartIndex","PredictCurve","CurrentTime","Temp_CurrentIndex","unshift","PredictStart","TempEx","DataSpot","FirstSpot","CurrentIndex","WeightNow","require","default","_firebase","apps","Constants","manifest","web","config","firebase","initializeApp","isSupported","createFirebaseUserWithemailandpassword","Email","Pass","createUserWithEmailAndPassword","User","currentUser","Name","displayName","email","UserId","uid","_data","updateProfile","sendEmailVerification","catch","code","viewError","message","signinWithemailandpassword","logoutUser","signInWithEmailAndPassword","sendResetPassword","sendPasswordResetEmail","signOut","path","refreshUser","reload","ref","CurrentUser","createFarm","Farms","farmid","updateFarmData","FarmId","sections","Sections","Pens","updateUserData","UserData","farms","fetchFarm","updateFarm","fetchSections","fetchPens","createNewPen","deletePen","updatePen","fetchPigs","updatePigdata","fetchBatchs","createBatchs","updateBatchs","fetchWeights","createWeight","fetchComments","createComment","fetchGraphData","updateGraphData","SetUpdateTime","DataRef","update","update_time","ServerValue","TIMESTAMP","CheckDataTime","once","_Time","UpdateTime","val","List","userData","_farmData","farm","set","SectionId","DoFetch","_sectionidData","_pensData","penData","pen","ref2","section","_Pen","Datas","_pigsData","pigData","pig","updatePigPen","Action","counts","isNaN","pigs","BatchId","_batchdata","curve","batchdata","devianceMin","devianceMax","BatchPens","JSON","stringify","RemovedPens","x","enddate","NewPens","SamePens","pendata","startdate","CurveId","comments","p","_","_resolve","setTimeout","weights","limitStart","limitTo","MemSections","orderByChild","limitToLast","snapshot","c","_weighingTime","Weighings_Time","itemsProcessed","newWeights","Quantity","weightRef","comment","commentRef","quantity","GraphId","graph","Graphs","GraphVal","newGraph","Agraph","AgraphVal","Graph","_Graph","firebaseService","requestPermission","authStatus","AuthorizationStatus","AUTHORIZED","PROVISIONAL","isPermit_UserPermission","title","okText","_cancelable","Alert","alert","text","onPress","cancelable","onDismiss","Create_Axios","Acc_Token","getAccessToken","SiteUrl","Ref_Token","Refresh_Token","GetToken_URL","access_token","checkRenew_AccessToken","consysService","limit","starttime","offset","lastid","Token","token","handleAuthState","handleActions","onMessageHandler","onBackgroundMessageHandler","disableYellowBox","onAuthStateChanged","authChannel","newAuth","firebaseUser","values","FirebaseUser","FarmsData","FarmData","site","refToken","Params","sysId","start","lastId","ScaleData","result","messageListener","onMessage","remoteMessage","onMessageChannel","notification","body","onNotificationOpenedApp","setBackgroundMessageHandler","root","all","takeLatest","STARTUP","StartupSaga","FETCH_USER","ExampleSaga","DEVICE_STARTUP","DeviceSaga","CONNECT_DEVICE","DISCONNECT_DEVICE","READ_DEVICE_DATA","FETCH_DEVICE","BLE_STARTUP","START_BLE_SCAN","STOP_BLE_SCAN","READ_BLE_DEVICE_DATA","BLUETOOTH_STARTUP","START_BLUETOOTH_SCAN","STOP_BLUETOOTH_SCAN","BLUETOOTH_SCAN_ABLE","READ_BLUE_DEVICE_DATA","FIREBASE_STARTUP","FirebaseSaga","reducer","createReducer","userIsLoading","userErrorMessage","FETCH_USER_LOADING","FETCH_USER_SUCCESS","FETCH_USER_FAILURE","errorMessage","INITIAL_STATE","PoweredOff","deviceIsLoading","deviceErrorMessage","DeviceList","deviceData","BLE_INITIAL_STATE","BLUETOOTH_INITIAL_STATE","HANDLERS","BLE_STATE_UPDATED","SET_DEVICE_ERROR","SCANNER_STATE_UPDATED","ADD_DEVICE","some","NewList","REMOVE_DEVICE","splice","CLEAR_DEVICES","CONNECTED_DEVICE_UPDATED","CONNECTION_STATE_UPDATED","CONNECTION_METHODE_UPDATED","SET_DEVICE_DATA","UPDATE_DEVICE_DATA","newData","BLEReducers","BluetoothReducers","FIREBASE_IS_LOADING","loadingstate","SET_FIREBASE_ERROR","firebaseErrorMessage","SET_VIEW_ERROR","VIEW_IS_LOADING","SET_CURRENT_DATA","currentData","ACTION_STARTING","FETCH_STARTING","DATA_FETCH_SUCCESS","NewDataStore","NewFirebaseUser","_user","element","_auth","Values","users","FETCH_SUCCESS","newlocalDataStore","_newState","mergeDeep","target","source","isObject","obj","targetValue","sourceValue","Array","isArray","append","FETCH_FAILURE","h1","fontSize","h2","h3","normal","tiny","small","medium","tinyBottomMargin","marginBottom","smallBottomMargin","bottomMargin","mediumBottomMargin","tinyVerticalMargin","marginVertical","smallVerticalMargin","verticalMargin","mediumVerticalMargin","tinyHorizontalMargin","marginHorizontal","smallHorizontalMargin","horizontalMargin","mediumHorizontalMargin","tinyHorizontalPadding","paddingHorizontal","smallHorizontalPadding","horizontalPadding","mediumHorizontalPadding","tinyVerticalPadding","paddingVertical","smallVerticalPadding","verticalPadding","mediumVerticalPadding","Home","DashBoard","System","Curves","GCurves","Sow","Section","AutoPig","Feed","Haxa_globe","Hexa_icon","Logo","logo","column","flexDirection","colMain","justifyContent","colCenter","alignItems","colCross","columnReverse","row","rowMain","rowCenter","rowCross","rowReverse","center","crossCenter","crossEnd","crossStart","crossStretch","fill","flex","fillCenter","fillCol","fillColCenter","fillColCross","fillColMain","fillColReverse","fillRow","fillRowCenter","fillRowCross","fillRowMain","fillRowReverse","fullSize","height","width","halvWidth","midWidth","fullWidth","mainCenter","mainEnd","mainSpaceAround","mainSpaceBetween","mainStart","mainContainer","Metrics","contentContainer","marginTop","borderContainer","borderWidth","borderColor","borderRadius","maxWidth","zIndex","textContainer","Fonts","buttonContainer","loadingContainer","position","left","right","top","bottom","backgroundColor","logoContainer","backgroundReset","Colors","rotate90","transform","rotate","rotate90Inverse","mirror","scaleX","scrollSpaceAround","flexGrow","scrollSpaceBetween","selfStretch","alignSelf","textCenter","textAlign","textJustify","textLeft","textRight","button","color","buttonText","input","navigationHeader","StyleSheet","container","SplashScreen","props","getInitialNotification","this","checkData","getData","prevProps","prevState","View","style","Helpers","Style","Image","Images","resizeMode","Component","DeepLinkingScreen","Text","styles","boxContainer","ApplicationStyles","icon","Button","TextView","textStyle","ImageView","_Image","iconStyle","TouchableOpacity","boxStyle","buttonStyle","Button_Panel","Texts","Buttons","image","itemStyle","TitleElement","listitem","CustomListItem","containerStyle","Content","Title","Subtitle","contentBox","minHeight","ContentProp","texts","textsStyle","datasStyle","onLongPress","view","dataRow","OperationsPanel","pigTag","PigsList","newPig","getPenAndSection","setCurrentPig","editPens","onDone","charAt","toUpperCase","newWeight","penId","newComment","newPigCount","setState","ScrollView","paddingRight","setCurrentDataElement","pigtag","dataId","countChange","ProgressBar","animation","useRef","Animated","Value","progress","Color","useEffect","timing","current","toValue","duration","interpolate","inputRange","outputRange","extrapolate","paddingBottom","alignContent","progressBar","absoluteFill","paddingTop","padding","monthNames","DateTime_Picker","getStates","year","month","day","Selected","Year","Month","Day","forceUpdate","changed","Today","YearItems","String","Picker","Item","label","MonthItems","DayItems","selectedValue","minWidth","marginRight","onValueChange","_year","_month","_day","textAreaContainer","textArea","Comment_Module","useState","InputText","setInputText","QuantityText","setQuantityText","WeightText","setWeightText","App","marginLeft","TextInput","multiline","onChangeText","underlineColorAndroid","placeholder","placeholderTextColor","numberOfLines","FrontScreen","ShowMainError","FocusSubscription","Props","navigation","payload","setViewLoading","ErrorMessage","ele","liveInEurope","entries","example","city","instructions","fontStyle","ios","android","ExampleScreen","useDispatch","useSelector","ActivityIndicator","size","deviceContainer","deviceDataContainer","text2","DeviceScreen","DeviceData","Devices","Unknown","ConnectedDevice_View","map","Dev","StackNavigator","createStackNavigator","screen","Front","navigationOptions","headerMode","headerShown","headerTitleStyle","Example","initialRouteName","defaultNavigationOptions","headerTitleAlign","headerRight","PanelsSorter","userType","UserLoadingScreen","ISLOADPAGE","firebaseData","page","emailVerified","prev","getUser","IsLoading","clearDataMem","UserLoginScreen","CreateUser","secureTextEntry","createUser","signIN","resetPass","VerifyScreen","setUser","Verified","UserInformation","setData","FirstN","LastN","Contact","ContactP","Address","Country","lastN","contact","phoneNumber","F_FirstN","React","createRef","F_LastN","F_Contact","F_ContactP","F_Address","test","_UserData","country","updateUser","OnDone","window","Dimensions","Subscription","onChange","dimensions","CurrentSub","Billing","addEventListener","removeEventListener","wide","fontWeight","CheckBox","FarmInformation","FarmName","Cvr","Manager","cvr","getFarm","_FarmData","_sections","_pens","i2","sectionPens","CreateNewUserData","ViewState","Display","precreateUserData","Subsc","LoadingUserScreen","LoginUser","LoginUserScreen","headerLeft","paddingLeft","CreateUserData","CreateUserDataScreen","getAutoPig","logOut","Dashboard","Mail","BatchList","SectionsList","MaxCap","CurCap","farmName","farmManager","farmMail","Farm","BatchID","End","getSections","getPens","getBatch","getWeights","getCurve","FarmProgress","FlatList","renderItem","item","keyExtractor","loading","inputContainer","Pigs","PigTag","getPigs","connectedState","SafeAreaView","tagId","pigId","Device_Display","circle","Scanner_Display","known","Weighings","Mid","property","itemDimension","spacing","renderSectionHeader","displayWeight","round","Batchs","onMultiChange","items","xorBy","selectedPens","freePens","BatchName","ShowPicker","StartD","Curve","DevianceMin","DevianceMax","avaiblePens","add","scrollEnabled","batchName","_pen","mode","itemValue","itemIndex","endsWith","labelStyle","optionsLabelStyle","options","selectedValues","onMultiSelect","onTapClose","isMulti","newBatch","updateBatch","_Date","setBatch","batchId","getRandomNumber","low","high","getRandomColor","red_range","green_range","blue_range","a_range","red","green","blue","alpha","r","g","rgbaValue","CurveElement","Legends","DataSets","Labels","ActiveIndex","ActiveLength","ActiveDataSets","ActiveStartDate","ActiveEndDate","ViewPoint","D","DataX","dataX","opacity","TempData","TempEndDate","NextEnd","_EndDate","Prediction","DoPredict","BatchPen","DataSet","DataSetX","WeightsToGraphData","TemplatePeriode","CurrentDate","getNewDate","setGraphPeriode","BatchIsOpen","Height","Width","DataPoints","point","horizontal","showsHorizontalScrollIndicator","maxHeight","labels","xMinMax","legend","datasets","onDataPointClick","withShadow","withVerticalLines","fromZero","segments","verticalLabelRotation","xLabelsOffset","chartConfig","backgroundGradientFrom","backgroundGradientTo","decimalPlaces","labelColor","propsForDots","strokeWidth","stroke","control","CurveEditor","TimeText","dataset","Point","setPoint","step","evt","split","getPen","curveid","setCurve","GrowthCurve","CurveList","CurveName","Periode","CurveData","AppStyle","WebStyle","numColumns","newCurve","updateCurve","actionType","DataEditor","NewSection","DataView","PenEditor_View_Creator","PigEditor_View_Creator","Control","CurrentAction","exists","penAction","PenEditor_Titles","pigAction","Section_Picker","senctionId","DataDisplay_Pens","WeighingsList","CommentsList","Comments","object","MemTime","getComments","localDataStoree","pigcount","penWeight","batch_name","age","StartTime","onPageSwipe","sender","onDataPress","Comment","dir","DataDisplay_Pigs","DataDisplay","PigData_View","ingrid","Comments_List","batchData","PenMemTime","Days","Virtual","UserFront","UserFrontScreen","UserDashBoard","UserDashBoardScreen","UserPigs","UserPigsScreen","UserPens","UserPensScreen","UserBatchs","UserBatchsScreen","UserCurves","UserCurvesScreen","UserOperations","UserOperationsScreen","WeighingOperations","UserDataEditor","UserDataDisplay","DataPlotter","UserDataPlotter","UserListBoard","UserList","getUsers","SystemListBoard","FarmList","getFarms","editable","setUserFarm","AdminFront","AdminFrontScreen","UserBoard","AdminUserBoard","SystemBoard","AdminSystemBoard","UserPanel","UserPanelNavigation","MainStack","FrontNavigation","AuthStack","AuthNavigation","AdminPanel","AdminPanelNavigator","createAppContainer","RootScreen","StartupActions","AppNavigator","uriPrefix","rootReducer","rootSaga","middleware","enhancers","sagaMiddleware","createSagaMiddleware","applyMiddleware","persistedReducer","persistReducer","store","createStore","compose","persistor","persistStore","blemanager","BleManager","setLogLevel","LogLevel","Verbose","NativeModules","BlueToothControl","run","configureStore","combineReducers","ExampleReducer","DeviceReducer","FirebaseReducer","module","exports"],"mappings":"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","file":"static/js/app.d7b42b98.chunk.js","sourcesContent":["import { Platform } from 'react-native'\r\n\r\nimport { applyMiddleware, compose, createStore } from 'redux'\r\nimport createSagaMiddleware from 'redux-saga'\r\nimport { persistReducer, persistStore, createTransform } from 'redux-persist'\r\n\r\nimport { NativeModules } from 'react-native'\r\nimport { BleManager, BleError, LogLevel } from 'react-native-ble-plx'\r\n\r\n//** fix: error serializing state TypeError: Converting circular structure to JSON  */\r\n// https://www.npmjs.com/package/jsog\r\n// https://www.npmjs.com/package/flatted\r\nimport JSOG from 'jsog';\r\nexport const JSOGTransform = createTransform(\r\n  (inboundState, key) => JSOG.encode(inboundState),\r\n  (outboundState, key) => JSOG.decode(outboundState),\r\n)\r\n\r\n/**\r\n * This import defaults to localStorage for web and AsyncStorage for react-native.\r\n *\r\n * Keep in mind this storage *is not secure*. Do not use it to store sensitive information\r\n * (like API tokens, private and sensitive data, etc.).\r\n *\r\n * If you need to store sensitive information, use redux-persist-sensitive-storage.\r\n * @see https://github.com/CodingZeal/redux-persist-sensitive-storage\r\n */\r\nimport storage from 'redux-persist/lib/storage'\r\n\r\nconst persistConfig = {\r\n  key: 'root',\r\n  storage: storage,\r\n  transforms: [JSOGTransform],\r\n  /**\r\n   * Blacklist state that we do not need/want to persist\r\n   */\r\n  blacklist: [\r\n    // 'auth',\r\n  ],\r\n}\r\n\r\nexport default (rootReducer, rootSaga) => {\r\n  const middleware = []\r\n  const enhancers = []\r\n\r\n  // Connect the sagas to the redux store\r\n  const sagaMiddleware = createSagaMiddleware()\r\n  middleware.push(sagaMiddleware)\r\n\r\n  enhancers.push(applyMiddleware(...middleware))\r\n\r\n  // Redux persist\r\n  const persistedReducer = persistReducer(persistConfig, rootReducer)\r\n\r\n  const store = createStore(persistedReducer, compose(...enhancers))\r\n  const persistor = persistStore(store)\r\n\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    // First step is to create BleManager which should be used as an entry point\r\n    // to all BLE related functionalities\r\n    const blemanager = new BleManager();\r\n    blemanager.setLogLevel(LogLevel.Verbose);\r\n\r\n    const bluemanager = NativeModules.BlueToothControl;\r\n\r\n    // SagaArgs Construcktor\r\n    const sagaArgs = {BLEManager: blemanager, BlueManager: bluemanager}\r\n\r\n    // Kick off the root saga\r\n    sagaMiddleware.run(rootSaga, sagaArgs)\r\n  }else {\r\n    sagaMiddleware.run(rootSaga)\r\n  }\r\n  \r\n  return { store, persistor }\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\nconst { Types, Creators } = createActions({\r\n  // This action is triggered when the application starts\r\n  startup: null,\r\n})\r\n\r\nexport const StartupTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  // Fetch user informations\r\n  fetchUser: null,\r\n  // The operation has started and is loading\r\n  fetchUserLoading: null,\r\n  // User informations were successfully fetched\r\n  fetchUserSuccess: ['user'],\r\n  // An error occurred\r\n  fetchUserFailure: ['errorMessage'],\r\n})\r\n\r\nexport const ExampleTypes = Types\r\nexport default Creators\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bleStartup: null,\r\n  bleStateUpdated: ['bleState'],\r\n\r\n  startBleScan: null,\r\n  stopBleScan: null,\r\n\r\n  readBleDeviceData: null,\r\n})\r\n\r\nexport const BleTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  bluetoothStartup: null,\r\n\r\n  startBluetoothScan: null,\r\n  stopBluetoothScan: null,\r\n  \r\n  bluetoothScanAble: null,\r\n\r\n  readBlueDeviceData: null,\r\n})\r\n\r\nexport const BluetoothTypes = Types\r\nexport default Creators","import { createActions } from 'reduxsauce'\r\n\r\nimport BleCreators, {BleTypes} from './BLE/Actions'\r\nimport BlueToothCreators, {BluetoothTypes} from './BlueTooth/Actions'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Device Saga\r\n  deviceStartup: null,\r\n  setDeviceError: ['errorMessage'], // Device-saga error occurred\r\n\r\n  scannerStateUpdated: ['scannerState'],\r\n\r\n  addDevice: ['device'],\r\n  removeDevice: ['device'],\r\n  clearDevices: null,\r\n\r\n  connectedDeviceUpdated: ['connectedDevice'], \r\n\r\n  connectionStateUpdated: ['connectionState'],\r\n  connectionMethodeUpdated: ['connectionMethode'],\r\n\r\n  setDeviceData: ['data'],\r\n  updateDeviceData: ['data'],\r\n\r\n  connectDevice: ['device'],\r\n  disconnectDevice: ['methode'],\r\n  readDeviceData: null,\r\n\r\n  fetchDevice: null, // Fetch device informations\r\n})\r\n\r\nexport const DeviceTypes = {...Types, ...BleTypes, ...BluetoothTypes}\r\nexport default {...Creators, ...BleCreators, ...BlueToothCreators}","import React from 'react'\r\nimport { BackHandler } from 'react-native'\r\nimport { NavigationActions, StackActions } from 'react-navigation'\r\n\r\n/**\r\n * The navigation is implemented as a service so that it can be used outside of components, for example in sagas.\r\n *\r\n * @see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html\r\n */\r\n\r\nlet navigator\r\nvar LastPage\r\n/**\r\n * This function is called when the RootScreen is created to set the navigator instance to use.\r\n */\r\nfunction setTopLevelNavigator(navigatorRef) {\r\n  navigator = navigatorRef\r\n\r\n  /*BackHandler.addEventListener('hardwareBackPress', () => {\r\n    console.log(navigator._navigation)\r\n    if (navigator && navigator._navigation && navigator._navigation.state) {\r\n      var Stackindex = navigator._navigation.state.index\r\n      var Stack = navigator._navigation.state.routes[Stackindex]\r\n      if (Stack.routes){\r\n        var index = Stack.index;\r\n        var routeName = Stack.routes[index].routeName;\r\n        if (routeName === 'UserFront' || routeName === 'LoginUser'){\r\n          navigator.dispatch(\r\n            NavigationActions.back()\r\n          )\r\n          //navigate('FrontScreen');\r\n          //return true;\r\n        }\r\n      }\r\n    }\r\n  });*/\r\n}\r\n\r\nfunction replace(routeName, params){\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.replace({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigate(routeName, params) {\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      NavigationActions.navigate({\r\n        routeName,\r\n        params,\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\n/**\r\n * Call this function when you want to navigate to a specific route AND reset the navigation history.\r\n *\r\n * That means the user cannot go back. This is useful for example to redirect from a splashscreen to\r\n * the main screen: the user should not be able to go back to the splashscreen.\r\n *\r\n * @param routeName The name of the route to navigate to. Routes are defined in RootScreen using createStackNavigator()\r\n * @param params Route parameters.\r\n */\r\nfunction navigateAndReset(routeName, params) {\r\n  //if (LastPage === routeName) return null\r\n  //else {\r\n    LastPage = routeName;\r\n    navigator.dispatch(\r\n      StackActions.reset({\r\n        index: 0,\r\n        key: null,\r\n        actions: [\r\n          NavigationActions.navigate({\r\n            routeName,\r\n            params,\r\n          }),\r\n        ],\r\n      })\r\n    )\r\n  //}\r\n}\r\n\r\nfunction nacigationPop() {\r\n  LastPage = \"\";\r\n  navigator.dispatch(NavigationActions.back())\r\n}\r\n\r\nexport default {\r\n  navigate,\r\n  replace,\r\n  navigateAndReset,\r\n  setTopLevelNavigator,\r\n  nacigationPop,\r\n}\r\n","import { createActions } from 'reduxsauce'\r\n\r\n/**\r\n * We use reduxsauce's `createActions()` helper to easily create redux actions.\r\n *\r\n * Keys are action names and values are the list of parameters for the given action.\r\n *\r\n * Action names are turned to SNAKE_CASE into the `Types` variable. This can be used\r\n * to listen to actions:\r\n *\r\n * - to trigger reducers to update the state, for example in App/Stores/Example/Reducers.js\r\n * - to trigger sagas, for example in App/Sagas/index.js\r\n *\r\n * Actions can be dispatched:\r\n *\r\n * - in React components using `dispatch(...)`, for example in App/App.js\r\n * - in sagas using `yield put(...)`, for example in App/Sagas/ExampleSaga.js\r\n *\r\n * @see https://github.com/infinitered/reduxsauce#createactions\r\n */\r\nconst { Types, Creators } = createActions({\r\n  //Firebase Saga events\r\n  firebaseStartup: null,\r\n  //Firebase Saga and service\r\n  firebaseIsLoading: ['loadingstate'],\r\n  setFirebaseError: ['errorMessage'], // Firebase-saga error occurred\r\n\r\n  setViewError: ['errorMessage'], // view error\r\n  viewIsLoading: ['loadingstate'],\r\n  \r\n  setCurrentData: ['data'],\r\n\r\n  //Firebase Data fetches\r\n  actionStarting: ['action', 'ref', 'params'], // Data action (create, singin, share)\r\n  fetchStarting: ['action', 'ref', 'params'], // Fetch data informations\r\n  dataFetchSuccess: ['params'],\r\n  fetchSuccess: ['data'], // Informations were successfully fetched\r\n  fetchFailure: ['errorMessage'], // An error occurred\r\n})\r\n\r\nexport const FirebaseTypes = {...Types }\r\nexport default {...Creators }","import { Platform } from 'react-native';\r\n\r\nimport { put, call } from 'redux-saga/effects'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport ExampleActions from '../Stores/Example/Actions'\r\nimport DeviceActions from '../Stores/Device/Actions'\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\n\r\n/**\r\n * The startup saga is the place to define behavior to execute when the application starts.\r\n */\r\nexport function* startup() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  console.log(\"Starting sagas\")\r\n  \r\n  // Add more operations you need to do at startup here\r\n  //yield put(ExampleActions.fetchUser())\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    yield put(DeviceActions.deviceStartup())\r\n  }\r\n  yield put(FirebaseActions.firebaseStartup())\r\n\r\n  // When those operations are finished we redirect to the main screen\r\n  NavigationService.navigateAndReset('MainStack')\r\n}\r\n","const HTTPS_START = 'https://';\r\nexport const Config = {\r\n  API_URL: HTTPS_START+ 'jsonplaceholder.typicode.com/users/',\r\n\r\n  CONSYS_CLIENT_ID: 'consysapp',\r\n  CONSYS_CLIENT_SECRET: 'Kjsd832n8DIO32kmsdds3',\r\n  CONSYS_AUTH: '.agrisys.cloud/oauthserver/getaccesstoken/?redirect_uri=urn:ietf:wg:oauth:2.0:oob',\r\n  CONSYS_API: '.agrisys.cloud/consys-api-v1/',\r\n}\r\n\r\nexport function GetToken_URL(Site_URL, Refresh_Token) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_AUTH\r\n  res = res + '&client_id='+Config.CONSYS_CLIENT_ID+'&client_secret='+Config.CONSYS_CLIENT_SECRET+'&refresh_token=' + Refresh_Token\r\n  return res;\r\n}\r\n\r\nexport function GetCheckToken_URL(Site_URL) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_API + 'checkaccesstoken'\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtion_URL(Site_URL) {\r\n  var res = HTTPS_START + Site_URL + Config.CONSYS_API + 'getconsumptiondata?'\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtionData_URL(Site_URL, Consumptiontype, SystemId, Offset=null, Limit=null, Starttime=null, Stoptime=null, Lastid=null){\r\n  var res = GetConsumtion_URL(Site_URL)\r\n  res = res + GetConsumtionData_Var(Consumptiontype, SystemId, Offset=null, Limit=null, Starttime=null, Stoptime=null, Lastid=null)\r\n  return res;\r\n}\r\n\r\nexport function GetConsumtionData_Var(Consumptiontype, SystemId, Offset=null, Limit=null, Starttime=null, Stoptime=null, Lastid=null){\r\n  var res = 'consumptiontype=' + Consumptiontype + '&systemid=' + SystemId;\r\n  if (Offset) res = res + '&offset=' + Offset;\r\n  if (Limit) res = res + '&limit=' + Limit;\r\n  if (Starttime) res = res + '&starttime=' + Starttime;\r\n  if (Stoptime) res = res + '&stoptime=' + Stoptime;\r\n  if (Lastid) res = res + '&lastid=' + Lastid;\r\n  return res;\r\n}","import axios from 'axios'\r\nimport { Config } from '../Config'\r\nimport { is, curryN, gte } from 'ramda'\r\n\r\nconst isWithin = curryN(3, (min, max, value) => {\r\n  const isNumber = is(Number)\r\n  return isNumber(min) && isNumber(max) && isNumber(value) && gte(value, min) && gte(max, value)\r\n})\r\nconst in200s = isWithin(200, 299)\r\n\r\n/**\r\n * This is an example of a service that connects to a 3rd party API.\r\n *\r\n * Feel free to remove this example from your application.\r\n */\r\nconst userApiClient = axios.create({\r\n  /**\r\n   * Import the config from the App/Config/index.js file\r\n   */\r\n  baseURL: Config.API_URL,\r\n  headers: {\r\n    Accept: 'application/json',\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 3000,\r\n})\r\n\r\nfunction fetchUser() {\r\n  // Simulate an error 50% of the time just for testing purposes\r\n  console.log(\"user fetch test\");\r\n  if (Math.random() > 0.5) {\r\n    return new Promise((resolve, reject) => {\r\n      console.log(\"error\");\r\n      resolve(null)\r\n    })\r\n  }\r\n\r\n  const number = Math.floor(Math.random() / 0.1) + 1\r\n\r\n  return userApiClient.get(number.toString()).then((response) => {\r\n    if (in200s(response.status)) {\r\n      return response.data\r\n    }\r\n\r\n    return null\r\n  })\r\n}\r\n\r\nexport const userService = {\r\n  fetchUser,\r\n}\r\n","import { put, call } from 'redux-saga/effects'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { userService } from '../../Services/UserService'\r\n\r\n/**\r\n * A saga can contain multiple functions.\r\n *\r\n * This example saga contains only one to fetch fake user informations.\r\n * Feel free to remove it.\r\n */\r\nexport function* fetchUser() {\r\n  // Dispatch a redux action using `put()`\r\n  // @see https://redux-saga.js.org/docs/basics/DispatchingActions.html\r\n  yield put(ExampleActions.fetchUserLoading())\r\n\r\n  // Fetch user informations from an API\r\n  const user = yield call(userService.fetchUser)\r\n  if (user) {\r\n    yield put(ExampleActions.fetchUserSuccess(user))\r\n  } else {\r\n    yield put(\r\n      ExampleActions.fetchUserFailure('There was an error while fetching user informations.')\r\n    )\r\n  }\r\n}\r\n","import { Platform, PermissionsAndroid } from 'react-native'\r\nimport { Config } from '../Config'\r\n\r\nasync function isPermit_Android() {\r\n  if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n    const Have_Coarse_Location = await PermissionsAndroid.check(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n   if (!Have_Coarse_Location) {\r\n      const Got_Access = await PermissionsAndroid.request(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION);\r\n      if (Got_Access !== PermissionsAndroid.RESULTS.GRANTED) {\r\n        console.log(\"No Ble Permission granted : Android\");\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction isBlePermitted() {\r\n  return new Promise((resolve, reject) => {\r\n    if (Platform.OS === 'android' && Platform.Version >= 23) {\r\n      if (!isPermit_Android()){\r\n        resolve('This application needs premissions to be using BLE');\r\n      }\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nexport const deviceService = {\r\n  isBlePermitted,\r\n  //isPermit_Android,\r\n}\r\n","export const ScannerState = {\r\n  IDLE: 'IDLE',\r\n  AVAILABLE: 'AVAILABLE',\r\n  SCANNING: 'SCANNING',\r\n};\r\n\r\nexport const ConnectionState = {\r\n  DISCONNECTED: 'DISCONNECTED',\r\n  CONNECTING: 'CONNECTING',\r\n  DISCOVERING: 'DISCOVERING',\r\n  CONNECTED: 'CONNECTED',\r\n  DISCONNECTING: 'DISCONNECTING',\r\n};\r\n\r\nexport const ConnectionMethode = {\r\n  NONE: 'NONE',\r\n  BLE: 'BLE',\r\n  SERIAL: 'SERIAL',\r\n  BLUETOOTH: 'BLUETOOTH',\r\n  WIFI: 'WIFI',\r\n};","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\nimport base64 from 'react-native-base64'\r\nimport { Buffer } from 'buffer'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BleActions from '../../../Stores/Device/BLE/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device, State, Service, Characteristic, Descriptor } from 'react-native-ble-plx'\r\n\r\nexport function* bleStartup(sagaArgs) {\r\n  //Check and setup BLE....\r\n  const permitError = yield call(deviceService.isBlePermitted)\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BLEManager)\r\n    yield fork(handleBleState, sagaArgs.BLEManager)\r\n    yield fork(handleConnection, sagaArgs.BLEManager)\r\n  }\r\n  \r\n  console.log('BLE Startup : Done');\r\n}\r\n\r\n// This generator tracks our BLE state. Based on that we can enable scanning, get rid of devices etc.\r\n// eventChannel allows us to wrap callback based API which can be then conveniently used in sagas.\r\nfunction* handleBleState(manager: BleManager) {\r\n  console.log(\"Handle BLE State...\")\r\n\r\n  const stateChannel = yield eventChannel((emit) => {\r\n    const subscription = manager.onStateChange((state) => {\r\n      emit(state)\r\n    }, true)\r\n    return () => {\r\n      subscription.remove()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newState = yield take(stateChannel)\r\n      console.log(\"New BLE state: \" + newState)\r\n      yield put(BleActions.bleStateUpdated(newState))\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      stateChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* connectBle(device: Device) {\r\n  //dummy function\r\n}\r\n\r\nfunction* handleConnection(manager: BleManager) {\r\n  console.log(\"Handle BLE Connection...\")\r\n  \r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_DEVICE');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLE) continue;\r\n\r\n    var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n    //if (connectedDevice != null) return;  // TODO: Allready connected ? if problem\r\n\r\n    if (device === null || device._manager === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    if (device.isConnected()) {\r\n      console.log(\"is connected ??\");\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        yield call([device, device.connect]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        var _device = device;\r\n\r\n        yield fork(readBleDeviceData, manager)\r\n\r\n        for (; ;) {\r\n          const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });\r\n\r\n          if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield call([_device, _device.cancelConnection]);\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              //TODO: search for lost \"connected\" device..\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        /*yield put(\r\n            DeviceActions.setDeviceError(error)\r\n        )*/\r\n      } finally {\r\n        disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions...');\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBleDeviceData(manager: BleManager) {\r\n  // TODO: read service .... se Tests SensorTag-master project ... or try following\r\n  // or https://stackoverflow.com/questions/50137867/send-data-using-react-native-ble-plx-package\r\n  // or https://github.com/Polidea/react-native-ble-plx/issues/392\r\n  // or https://stackoverflow.com/questions/63012926/how-to-read-ble-peripheral-characteristics-in-react-native-using-react-native-bl\r\n  \r\n  // Better jet: https://www.polidea.com/blog/ReactNative_and_Bluetooth_to_An_Other_level/\r\n\r\n  \r\n  // Explanation of plx ble.. notify changes for characteristics and reading / writing\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Notifying\r\n  //https://github.com/Polidea/react-native-ble-plx/wiki/Characteristic-Reading\r\n  \r\n  const KnownUUIDS = [\r\n    '0000fff0-0000-1000-8000-00805f9b34fb', //* BF-8 EarTag reader Service's\r\n    '0000fff1-0000-1000-8000-00805f9b34fb',\r\n\r\n    '0000180f-0000-1000-8000-00805f9b34fb', //* Battery service (General BLE)\r\n    '00002a19-0000-1000-8000-00805f9b34fb',\r\n  ];\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const _services: Array<Service> = yield call([device, device.services]);\r\n  const serviceUUIDs = device.serviceUUIDs;\r\n\r\n  const services: Array<Service> = _services.filter(service => serviceUUIDs.includes(service.uuid))\r\n\r\n  var monitor = [];\r\n\r\n  for (const service of services) {\r\n    console.log('Device had service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      console.log('  characteristic: ' + characteristic.uuid);\r\n\r\n      if (KnownUUIDS.includes(service.uuid) && KnownUUIDS.includes(characteristic.uuid)) {\r\n        monitor.push([service.uuid, characteristic.uuid])\r\n      }\r\n    }\r\n  }\r\n\r\n  //const services: Array<Service> = yield call([device, device.services]);\r\n  //TODO: merch with KnownUUIDS and withouth monitor.. (append services)\r\n  /*for (const service of services) {\r\n    console.log('Found service: ' + service.uuid);\r\n\r\n    const characteristics: Array<Characteristic> = yield call([service, service.characteristics]);\r\n    for (const characteristic of characteristics) {\r\n      const descriptors: Array<Descriptor> = yield call([characteristic, characteristic.descriptors]);\r\n\r\n      for (const descriptor of descriptors) {\r\n        //Can contain value...\r\n        console.log('* Found descriptor: ' + descriptor.uuid);\r\n        const d: Descriptor = yield call([descriptor, descriptor.read]);\r\n        console.log('  ** Descriptor value: ' + (d.value || 'null'));\r\n\r\n        //yield call([descriptor, descriptor.write], 'AAA=');\r\n      }\r\n      if (characteristic.isReadable) {\r\n        //Can contain value...\r\n        var c = yield call([characteristic, characteristic.read]);\r\n        console.log('? characteristic: ' + characteristic.uuid);\r\n        if (characteristic.isNotifiable) {\r\n          console.log('  Is Notifiable');\r\n        }\r\n        //var basevalue = base64.decode(c.value);\r\n        //basevalue = basevalue.charCodeAt(0);\r\n        console.log('  ** Got base64 value: ' + c.value);\r\n        //if (characteristic.isWritableWithResponse) {\r\n      }\r\n    }\r\n  }*/\r\n\r\n  const readingChannel = yield eventChannel((emit) => {\r\n    monitor.forEach((service, i) => {\r\n      device.monitorCharacteristicForService(\r\n        service[0], service[1],\r\n        (error, characteristic) => {\r\n          if (error) {\r\n            emit([error, characteristic]);\r\n            return;\r\n          }\r\n          // ************************\r\n          if (characteristic != null) {\r\n            emit([error, characteristic]);\r\n          }\r\n          // *************************\r\n        },\r\n      );\r\n    });\r\n    \r\n    return () => {\r\n      // ****\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    // Used to receive multiple data packets\r\n    var TempData_Reading = Buffer.from([]);\r\n    var length = 0;\r\n    var PacketId = 0;\r\n\r\n    for (; ;) {\r\n      if (readingChannel != null) {\r\n        const [error, characteristic] = yield take(readingChannel);\r\n        if (error != null) {\r\n          yield put(DeviceActions.setDeviceError(error))\r\n        }\r\n        if (characteristic != null) {\r\n          //console.log(characteristic.uuid);\r\n          // Handler for Battery state Change\r\n          if (characteristic.uuid == \"00002a19-0000-1000-8000-00805f9b34fb\") {\r\n            var BatteryLevel = base64.decode(characteristic.value);\r\n            BatteryLevel = BatteryLevel.charCodeAt(0);\r\n            yield put(DeviceActions.updateDeviceData({Battery: BatteryLevel}))\r\n          } \r\n          // Handler for BF-8 EarTag reader Data\r\n          else if (characteristic.uuid == \"0000fff1-0000-1000-8000-00805f9b34fb\") {\r\n            //console.log(\"Raw \", characteristic.value);                        //Display data raw\r\n            var RawData = Buffer.from(characteristic.value, 'base64');    \r\n            //console.log(\"Base64 Decoded Buffer: \", RawData)               //Display data base64 decoded\r\n            //console.log(\"ascii: \", RawData.toString('ascii'));            //Display string\r\n\r\n            if (PacketId === 0) {                                         // If no data is processing (New Data read)\r\n              var header = RawData.slice(0,4)\r\n              if (Buffer.compare(header, Buffer.from([170,170,170,170])) == 0) {  // Data Read header [AA AA AA AA / -1431655766]\r\n                length = (parseInt(RawData.slice(4,8).toString(\"hex\"), 16) - 8)   // Next int is the data length (-8 for PacketId 8 bit)\r\n                PacketId = parseInt(RawData.slice(8,12).toString(\"hex\"), 16)      // Packet type id [Recv RFID Packet / Recv Fat Layers ID] = [251658240 / 2315255808]\r\n                RawData = RawData.slice(12,RawData.length)                        // Last of packet is filled with data\r\n\r\n                //console.log(\"Id = \", PacketId);\r\n                //console.log(\"data length = \", length);\r\n              }\r\n            }\r\n\r\n            var NewData = Buffer.concat([TempData_Reading, RawData])     // else append data string\r\n            //console.log(\"NewData: \", NewData);\r\n            //console.log(\"NewData base64: \", NewData.toString('base64'));\r\n            //console.log(\"ascii: \", NewData.toString('ascii'));\r\n            \r\n            //console.log(\"new length \", (NewData.length * 8));\r\n            if (NewData.length < 4 || Buffer.compare(NewData.slice(NewData.length -4, NewData.length), Buffer.from([85,85,85,85])) != 0) { // Data Read End [55 55 55 55]\r\n              TempData_Reading = NewData;\r\n            }\r\n            else {\r\n              while (NewData.length * 8 > length || Buffer.compare(NewData.slice(NewData.length-1, NewData.length), Buffer.from([85])) == 0){\r\n                NewData = NewData.slice(0, NewData.length -1)\r\n              }\r\n              if (PacketId == 251658240) { // Recv RFID Packet\r\n                var TagId = NewData.toString('ascii')\r\n                TagId = TagId.slice(0,3) + \"-\" + TagId.slice(3,TagId.length)\r\n                console.log(\"Read Tag: \", TagId);\r\n                yield put(DeviceActions.updateDeviceData({tagid: TagId, FatLayers: 0, FatL1: 0, FatL2: 0, FatL3: 0}))\r\n              } \r\n              else if (PacketId == 2315255808) { //Recv Fat Layers ID\r\n                console.log(\"Fat done\");\r\n                var layers = parseInt(NewData.slice(0,1).toString(\"hex\"), 16);    // First byte is Layer count\r\n                var layer1 = parseInt(NewData.slice(3,4).toString(\"hex\"), 16);    // 4th. byte is layer one fat layer (data is value in mm)\r\n                var layer2 = parseInt(NewData.slice(5,6).toString(\"hex\"), 16);    // 6th. byte is layer two fat layer (data is value in mm)\r\n                var layer3 = parseInt(NewData.slice(7,8).toString(\"hex\"), 16);    // 8th. byte is layer third fat layer (data is value in mm)\r\n\r\n                console.log(\"layers: \" + layers + \" layer1: \" + layer1);\r\n                console.log(\"layer2: \" + layer2 + \" layer3: \" + layer3);\r\n                console.log(\"NewData: \", NewData);\r\n\r\n                yield put(DeviceActions.updateDeviceData({FatLayers: layers, FatL1: layer1, FatL2: layer2, FatL3: layer3}))\r\n                /*var FatData = NewData.toString('ascii')\r\n                console.log(\"Read Data: \", FatData);*/\r\n\r\n                /*\r\n                getRealLayerDepthMM_1() {\r\n                return (((float) this.mRawLayerData1) * 1.0f) / 256.0f;\r\n                */\r\n              }\r\n\r\n              PacketId = 0;\r\n              length = 0;\r\n              TempData_Reading = Buffer.from([]);\r\n            }\r\n\r\n            /*const TestValue = Buffer.from(characteristic.value, 'base64').readUInt16LE(0);\r\n            console.log(\"Test Value: \" + TestValue);*/\r\n            \r\n            /*if (value.startsWith(\"****\")) {\r\n              var TagType = value.slice(value.length - 8, value.length - 5);\r\n              var TagId = value.slice(value.length - 5, value.length);\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGType: TagType}))\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            } else if (value.endsWith(\"UUUU\")){\r\n              var TagId = yield select((state) => state.device.deviceData)\r\n              TagId = TagId.TAGId + value;\r\n\r\n              while (TagId.startsWith('0')){\r\n                TagId = TagId.slice(1, TagId.length);\r\n              }\r\n              while (TagId.endsWith('U')){\r\n                TagId = TagId.slice(0, TagId.length -1)\r\n              }\r\n\r\n              yield put(DeviceActions.updateDeviceData({TAGId: TagId}))\r\n            }\r\n            else {\r\n              console.log(value);\r\n              yield put(DeviceActions.updateDeviceData({Unknown: value}))\r\n            }*/\r\n          } else {\r\n            console.log(\"unknown char: \", characteristic.uuid);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  } catch (error) {\r\n    //yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      if (readingChannel != null) readingChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * BLE state is in PoweredOn state\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLE\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager: BleManager) {\r\n  console.log(\"Handle BLE Scanning...\")\r\n\r\n  var scanTask = null\r\n  var bleState: $Keys<typeof State> = yield select((state) => state.device.bleState);\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'BLE_STATE_UPDATED',\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | BLE_STATE_UPDATED\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'BLE_STATE_UPDATED':\r\n        bleState = action.bleState\r\n        break;\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      bleState === State.PoweredOn && \r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLE &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n    \r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBle, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBle(manager: BleManager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n  \r\n  console.log(\"Scanning started\");\r\n\r\n  const scanningChannel = yield eventChannel((emit) => {\r\n    manager.startDeviceScan(\r\n      null,\r\n      { allowDuplicates: true },\r\n      (error, scannedDevice) => {\r\n        if (error) {\r\n          emit([error, scannedDevice]);\r\n          return;\r\n        }\r\n        // ************************\r\n        if (scannedDevice != null) {\r\n          if (scannedDevice.localName != null) {\r\n            //TODO: auto list only supported devices...\r\n            //TODO: auto connect \"missing / disconnected\" divece..\r\n\r\n            /*if (scannedDevice.id === TagId && TagId != null) { // Catch Specefic SensorTag\r\n              emit([error, scannedDevice]);\r\n            } else { //Else if not ....*/\r\n              emit([error, scannedDevice]);\r\n            //}\r\n          } \r\n          /*else if (scannedDevice.name != null && scannedDevice.name != \"\"){\r\n            console.log(\"Device found Name: \" + scannedDevice.name);\r\n          }\r\n          // Test\r\n          if (scannedDevice.isConnectable != null && scannedDevice.id != null){\r\n            console.log(\"Connect ??: \" + scannedDevice.id);\r\n          }*/\r\n        }\r\n        // *************************\r\n      },\r\n    );\r\n    return () => {\r\n      manager.stopDeviceScan();\r\n    };\r\n  }, buffers.expanding(1));\r\n\r\n  try {\r\n    for (; ;) {\r\n      const [error, scannedDevice]: [?BleError,?Device] = yield take(scanningChannel);\r\n      if (error != null) {\r\n        console.log(\"Ble Scan Error: \", error);\r\n        yield put(DeviceActions.setDeviceError(error))\r\n      }\r\n      if (scannedDevice != null) {\r\n        //console.log(\"Interest Device Found: \" + scannedDevice.localName);\r\n        yield put(DeviceActions.addDevice(scannedDevice));\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.log(\"Ble Scan Error: \", error);\r\n    yield put(DeviceActions.setDeviceError(error))\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      scanningChannel.close();\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBleScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBleScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBleScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\n\r\nexport function* stopBleScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLE) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}","import { PermissionsAndroid, NativeModules, NativeEventEmitter } from 'react-native'\r\nimport {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { deviceService } from '../../../Services/DeviceService'\r\n\r\nimport BluetoothActions from '../../../Stores/Device/BlueTooth/Actions'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../../Stores/Device/Selectors'\r\n\r\nimport { Device } from 'react-native-ble-plx'\r\n\r\nexport function* bluetoothStartup(sagaArgs) {\r\n  //Check and setup Bluetooth....\r\n  const permitError = yield call(deviceService.isBlePermitted) //BLE permits is same for bluetooth\r\n  if (permitError) {\r\n    yield put( DeviceActions.setDeviceError(permitError))\r\n  } else {\r\n    // All below generators are described below...\r\n    yield fork(handleScanning, sagaArgs.BlueManager)\r\n    yield fork(handleConnection, sagaArgs.BlueManager)\r\n  }\r\n  \r\n  console.log('BlueTooth Startup : Done');\r\n}\r\n\r\n// This generator decides if we want to start or stop scanning depending on specific\r\n// events:\r\n// * SCANNER is currently AVAILABLE or allready SCANNING\r\n// * ConnectionMethode is on BLUETOOTH\r\n// * We are not allready Connected to a device..\r\nfunction* handleScanning(manager) {\r\n  console.log(\"Handle Bluetooh Scanning...\")\r\n\r\n  var scanTask = null\r\n  var scannerState: $Keys<typeof ScannerState> = yield select((state) => state.device.scannerState)\r\n  var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n  var connectionState: $Keys<typeof ConnectionState> = yield select((state) => state.device.connectionState)\r\n\r\n  const channel = yield actionChannel([\r\n    'SCANNER_STATE_UPDATED',\r\n    'CONNECTION_METHODE_UPDATED',\r\n    'CONNECTION_STATE_UPDATED',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action:\r\n      | SCANNER_STATE_UPDATED\r\n      | CONNECTION_METHODE_UPDATED \r\n      | CONNECTION_STATE_UPDATED = yield take(channel)\r\n\r\n    switch (action.type) {\r\n      case 'SCANNER_STATE_UPDATED':\r\n        scannerState = action.scannerState\r\n        break;\r\n      case 'CONNECTION_METHODE_UPDATED':\r\n        connectionMethode = action.connectionMethode\r\n        break;\r\n      case 'CONNECTION_STATE_UPDATED':\r\n        connectionState = action.connectionState\r\n        break;\r\n    }\r\n\r\n    const enableScanning =\r\n      (scannerState === ScannerState.AVAILABLE ||\r\n        scannerState === ScannerState.SCANNING) &&\r\n      connectionMethode === ConnectionMethode.BLUETOOTH &&\r\n      (connectionState === ConnectionState.DISCONNECTING ||\r\n        connectionState === ConnectionState.DISCONNECTED)\r\n\r\n    if (enableScanning) {\r\n      if (scannerState != ScannerState.SCANNING) { //Dount need to start scanner if allready Scanning\r\n        if (scanTask != null) {\r\n          yield cancel(scanTask)\r\n        }\r\n        scanTask = yield fork(scanBluetooth, manager);\r\n      }\r\n    } else {\r\n      if (scanTask != null) {\r\n        yield cancel(scanTask)\r\n        scanTask = null\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//** Todo: Be done... (code is not touched... can contain lots of error) */\r\nfunction* handleConnection(manager) {\r\n  console.log(\"Handle Bluetooth Connection...\")\r\n\r\n  var testTask = null;\r\n  for (; ;) {\r\n    // Take action\r\n    var { device }: ConnectAction = yield take('CONNECT_BLUETOOTH');\r\n\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode != ConnectionMethode.BLUETOOTH) continue;\r\n\r\n    if (device === null) {\r\n      yield put(DeviceActions.setDeviceError(\"Could not find device..\"));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      return;\r\n    }\r\n    console.log(\"Connect device\");\r\n\r\n    try {\r\n      // TODO: handle disconnect\r\n\r\n      /*const disconnectedChannel = yield eventChannel((emit) => {\r\n          const subscription = device.onDisconnected((error) => {\r\n            emit({ type: 'DISCONNECT_DEVICE', error: error });\r\n          });\r\n        return () => {\r\n          subscription.remove();\r\n        };\r\n      }, buffers.expanding(1));\r\n    \r\n      const deviceActionChannel = yield actionChannel([\r\n        'DISCONNECT_DEVICE',\r\n      ]);*/\r\n\r\n      try {\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTING));\r\n        const res = yield call(manager.PairDevice, device.id);\r\n        console.log(\"\",res);\r\n        //yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCOVERING));\r\n        //yield call([device, device.discoverAllServicesAndCharacteristics]);\r\n\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.CONNECTED));\r\n        yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLE));\r\n\r\n        yield put(DeviceActions.connectedDeviceUpdated(device));\r\n\r\n        //for (; ;) {\r\n          /*const { deviceAction, disconnected } = yield race({\r\n            deviceAction: take(deviceActionChannel),\r\n            disconnected: take(disconnectedChannel),\r\n          });*/\r\n\r\n          /*if (deviceAction) {\r\n            if (deviceAction.type === 'DISCONNECT_DEVICE') {\r\n              console.log('Disconnected by user...');\r\n              yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n              yield call([device, device.cancelConnection]);\r\n              break;\r\n            }\r\n          } else if (disconnected) {\r\n            console.log('Disconnected by device...');\r\n            if (disconnected.error != null) {\r\n              console.log(\"Error \", disconnected.error);\r\n            }\r\n            break;\r\n          }*/\r\n\r\n        //}\r\n      } catch (error) {\r\n        console.log(\"?: \", error);\r\n        //yield put(DeviceActions.setDeviceError(error))\r\n      } finally {\r\n        //disconnectedChannel.close();\r\n        yield put(DeviceActions.connectedDeviceUpdated(null))\r\n        yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n      }\r\n    } catch (error) {\r\n      console.log('Error on device actions... ', error);\r\n      yield put(DeviceActions.removeDevice(device));\r\n      yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTING));\r\n    }\r\n  }\r\n}\r\n\r\nexport function* readBlueDeviceData(sagaArgs) {\r\n  console.log(\"Blue Read\");\r\n  const manager = sagaArgs.BlueManager;\r\n\r\n  var device: Device = yield select((state) => state.device.connectedDevice)\r\n  if (device === null) return;\r\n\r\n  const Message = yield call(manager.receiveData, device.id);\r\n  console.log(Message);\r\n  if (Message != \"\") {\r\n    yield put(DeviceActions.updateDeviceData({TAGId: Message}))\r\n  }\r\n}\r\n\r\n// As long as this generator is working we have enabled scanning functionality.\r\n// **\r\n// When we detect Tag-device, Device with localName or Name, We send device to device list\r\n// Testing with isConnectable\r\nfunction* scanBluetooth(manager) {\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.SCANNING))\r\n  yield put(DeviceActions.clearDevices())\r\n\r\n  console.log(\"Scanning started\");\r\n\r\n  yield call(manager.Discover);\r\n  const bluetoothChannel = yield eventChannel((emit) => {\r\n    const blueTootControlEmitter = new NativeEventEmitter(manager);\r\n    const subscription = blueTootControlEmitter.addListener('blueToothDeviceFound', (device) => {\r\n      if (device != null){\r\n        var scannedDevice = new Device();\r\n        scannedDevice.id = device.address\r\n        scannedDevice.localName = (device.name != null ? device.name : \"NONE\");\r\n        scannedDevice.name = device.alias\r\n        \r\n        if (scannedDevice.localName != null) {\r\n          if (scannedDevice.localName === 'SensorTag') { // Catch Specefic SensorTag\r\n            //console.log(\"Device with Tag found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          } else { //Else if not ....\r\n            //console.log(\"Device found localName: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n            emit(scannedDevice);\r\n          }\r\n        } \r\n        else if (device.alias != null && device.alias != \"\"){\r\n          scannedDevice.name = device.alias\r\n          emit(scannedDevice);\r\n          //console.log(\"Device found Name: \" + scannedDevice.name);\r\n        }\r\n      }\r\n    })\r\n    return () => {\r\n      subscription.remove();\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const scannedDevice: Device = yield take(bluetoothChannel);\r\n      if (scannedDevice != null) {\r\n        console.log(\"Interest Device Found: \" + scannedDevice.localName + \" : \" + scannedDevice.id);\r\n        yield put(DeviceActions.addDevice(scannedDevice))\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      yield call(manager.StopDiscovery);\r\n      yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n      console.log('Scanning stopped...');\r\n      bluetoothChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* startBluetoothScan(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n  \r\n  if (connectionMethode !== ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.connectionMethodeUpdated(ConnectionMethode.BLUETOOTH)) // rem, handleScanning should contain ConnectionMethode check and shutof scanning on change\r\n  } \r\n  yield call(setBlueScannerStart);\r\n}\r\n// Aparently functions cannot call itself... so..\r\nfunction* setBlueScannerStart(){\r\n  var connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  const scannerState = yield select((state) => state.device.scannerState);\r\n\r\n  if (scannerState === ScannerState.IDLE && connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.AVAILABLE));\r\n  }\r\n}\r\nexport function* stopBluetoothScan(){\r\n  const connectionMethode = yield select((state) => state.device.connectionMethode);\r\n  if (connectionMethode === ConnectionMethode.BLUETOOTH) {\r\n    yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE));\r\n  }\r\n}\r\n\r\nexport function* bluetoothScanAble(sagaArgs){\r\n  yield call(sagaArgs.BlueManager.BluetoothSearchAble);\r\n}","import {buffers, eventChannel} from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { deviceService } from '../../Services/DeviceService'\r\n\r\nimport { ScannerState, ConnectionState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { BleManager, BleError, Device} from 'react-native-ble-plx'\r\n//Include BLE Saga\r\nimport * as BLE from './BLE/BLESaga'\r\nexport {BLE}\r\n//Include BlueTooth Saga\r\nimport * as BlueTooth from './BlueTooth/BlueToothSaga'\r\nexport {BlueTooth}\r\n\r\nexport function* deviceStartup() {\r\n  //Check and setup BLE.... / Bluetooth\r\n  yield put(DeviceActions.setDeviceError(\"\"))\r\n  yield put(DeviceActions.clearDevices());\r\n  yield put(DeviceActions.connectedDeviceUpdated(null)); // TODO: load connected device if possible\r\n  yield put(DeviceActions.connectionStateUpdated(ConnectionState.DISCONNECTED));\r\n\r\n  yield put(DeviceActions.bleStartup());\r\n  yield put(DeviceActions.bluetoothStartup());\r\n  \r\n  console.log('Device Startup : Done');\r\n}\r\n\r\nexport function* connectDevice(device: Device){\r\n  yield put(DeviceActions.scannerStateUpdated(ScannerState.IDLE))\r\n  //console.log(\"Device: \", device); // dummy call to connect...\r\n}\r\n\r\nexport function* disconnectDevice(methode){\r\n  //console.log(\"Device: \", device); // dummy call to disconnect...\r\n}\r\n\r\nexport function* readDeviceData(){\r\n  var connectedDevice = yield select((state) => state.device.connectedDevice)\r\n  if (connectedDevice != null) {\r\n    var connectionMethode: $Keys<typeof ConnectionMethode> = yield select((state) => state.device.connectionMethode)\r\n    if (connectionMethode == ConnectionMethode.BLE) {\r\n      yield put(DeviceActions.readBleDeviceData())\r\n    } else if (connectionMethode == ConnectionMethode.BLUETOOTH) {\r\n      yield put(DeviceActions.readBlueDeviceData())\r\n    }\r\n  }\r\n}\r\n\r\nexport function* fetchDevice(sagaArgs) {\r\n  console.log(\"??\");\r\n  //yield put(DeviceActions.fetchDeviceLoading())\r\n  //yield call(scan_BLE, sagaArgs);\r\n}","//#region Defines\r\nexport const UserStates = {\r\n  STARTER: 'starter',\r\n  FREE: 'free',\r\n  WORKER: 'worker',\r\n  OWNER: 'owner',\r\n  ADMIN: 'admin',\r\n}\r\n\r\nexport const DataStates = {\r\n  CLOSED: 'Closed'\r\n}\r\n\r\nexport const DataRefs = {\r\n  FIREBASEUSER: 'firebaseuser',\r\n  USERSDATA: 'usersdata',\r\n  USERS: 'users',\r\n  FARMS: 'farms',\r\n  SECTIONS: 'farms_data/$farmid/sections',\r\n  PENS: 'farms_data/$farmid/pens',\r\n  PIGS: 'farms_data/$farmid/pigs',\r\n  BATCHS: 'farms_data/$farmid/batchs',\r\n\r\n  WEIGHING: 'farms_data/$farmid/pens/$penid/weighings/',\r\n  GRAPH: 'farms_data/$farmid/Graph/$graphid/',\r\n\r\n  COMMENTS: 'farms_data/$farmid/datas/comments/',\r\n  FARMDATAS: 'farms_data/$farmid/datas/',\r\n  SHARES: 'shareData',\r\n  CONSYS: 'consys',\r\n}\r\n\r\nexport const Actions = {\r\n  SIGN: 'sign',\r\n\r\n  FETCH: 'fetch',\r\n  CREATE: 'create',\r\n  UPDATE: 'update',\r\n  MOVE: 'move',\r\n  DELETE: 'delete',\r\n  CLEAR: 'clear',\r\n  ADD: 'add',\r\n}\r\n\r\nexport const Operations = {\r\n  ADD: 'Add pig',\r\n  MOVE: 'Move pig',\r\n  LOST: 'Lost pig',\r\n  SOLD: 'Sold pig',\r\n  NOTE: 'Pen Note',\r\n}\r\n\r\nexport const ErrorTypes = {\r\n  SYSTEM: 'System',\r\n  EMAIL: 'Email',\r\n  PASSWORD: 'Password',\r\n  FORMAT: 'Format',\r\n}\r\n//#endregion\r\n\r\n//#region Formaters\r\nfunction format_num(num) {\r\n  if (num < 10){\r\n    num = \"0\"+num\r\n  }\r\n  return num;\r\n}\r\nexport function format_Time(time) {\r\n  var s = new Date(parseInt(time));\r\n  var datetime = format_num(s.getDate()) + \"/\" + format_num(s.getMonth() +1) + \"/\" + s.getFullYear() + \" \" \r\n                  + format_num(s.getHours()) + \":\" + format_num(s.getMinutes()) + \":\" + format_num(s.getSeconds());\r\n  return datetime\r\n}\r\n\r\nvar reA = /[^a-zA-Z]/g;\r\nvar reN = /[^0-9]/g;\r\nfunction sortAlphaNum(a, b) {\r\n  var aA = a.replace(reA, \"\");\r\n  var bA = b.replace(reA, \"\");\r\n  if (aA === bA) {\r\n    var aN = parseInt(a.replace(reN, \"\"), 10);\r\n    var bN = parseInt(b.replace(reN, \"\"), 10);\r\n    return aN === bN ? 0 : aN > bN ? 1 : -1;\r\n  } else {\r\n    return aA > bA ? 1 : -1;\r\n  }\r\n}\r\n\r\nexport function sortObject(o) {\r\n  var sorted = {},\r\n  key, a = [];\r\n\r\n  for (key in o) {\r\n    if (o.hasOwnProperty(key) && key !== \"__jsogObjectId\" && key !== \"update_time\") {\r\n      a.push(key);\r\n    }\r\n  }\r\n  a.sort(sortAlphaNum);\r\n\r\n  for (key = 0; key < a.length; key++) {\r\n    sorted[a[key]] = o[a[key]];\r\n  }\r\n  return sorted;\r\n}\r\n\r\nexport function DataStringCheck(data, Check_num = true) {\r\n  if (!data || data === \"\"){\r\n    return false\r\n  }\r\n  if (!typeof(data) === 'string'){\r\n    return false\r\n  }else {\r\n    if (Check_num) {\r\n      var first = data[0]\r\n      var numbers = '0123456789';\r\n      for(var i = 0; i < numbers.length;i++){\r\n        if(first === numbers[i]){\r\n          return false\r\n        }\r\n      }\r\n    }\r\n\r\n    var specialChars = '/[`!@#$%^&*()+\\-=\\[\\]{};\\':\"\\\\|,.<>\\/?~]/';\r\n    for(var i = 0; i < specialChars.length;i++){\r\n      if(data.indexOf(specialChars[i]) > -1){\r\n        return false\r\n      }\r\n    }\r\n  }\r\n  return true\r\n}\r\n//#endregion\r\n\r\n//#region Data gets\r\nexport function GetWeight_FromPen(PenId, WeighingsStore = null, AfterTime = null, BeforeTime = null) {\r\n  //PenId: Parrent Get ellement (ID),\r\n  //WeighingsStore: LocalDataStore.weighings,\r\n  //AfterTime: Only data after specefied Time,\r\n  //BeforeTime: Only data before specefied Time\r\n  var Weighing = null;\r\n\r\n  if (PenId, WeighingsStore){\r\n    for (const _weighing in WeighingsStore[PenId]) {\r\n      var weighing = WeighingsStore[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) {\r\n        if ((!AfterTime || weighing.time >= AfterTime) &&\r\n          (!BeforeTime || weighing.time <= BeforeTime)) {\r\n          Weighing = weighing\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return Weighing;\r\n}\r\n\r\nexport function GetBatch_FromPen(localDataStore, PenId) {\r\n  if (localDataStore.batchs) {\r\n    //Get batch form pen\r\n    for (const _batch in localDataStore.batchs) {\r\n      var batch = localDataStore.batchs[_batch]\r\n      if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n        return localDataStore.batchs[_batch]\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetStats_FromPen(PenId, PenData, localDataStore, StartDate, EndDate, PenWeighings = null){\r\n  var Animals = 0;\r\n  var PenWeight = 0\r\n  var PenGrowth = 0\r\n  var AveragePenGrowth = 0;\r\n\r\n  if (PenData.datas && PenData.datas.count || PenData.count) {\r\n    if (PenData.count) Animals += PenData.count\r\n    else Animals += PenData.datas.count\r\n  }\r\n  \r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var GrowthCount = 0\r\n\r\n    var lastDate = 0\r\n    var LastWeight = undefined;\r\n    var LastWeightDay = undefined;\r\n    var FirstWeight = undefined;\r\n\r\n    if (!PenWeighings) PenWeighings = localDataStore.weighings[PenId]\r\n    if (PenWeighings) {\r\n      Object.keys(PenWeighings).forEach((weight) => {\r\n        var Weight = PenWeighings[weight]\r\n        if (Weight.time >= StartDate && Weight.time <= EndDate && Weight.time > lastDate) {\r\n          PenWeight = Weight.weight\r\n          if (Weight.count) PenWeight = Weight.weight / Weight.count;\r\n\r\n          if (LastWeight !== undefined) {\r\n            PenGrowth = PenWeight - LastWeight\r\n            GrowthCount++;\r\n          }\r\n\r\n          lastDate = Weight.time\r\n          LastWeight = PenWeight\r\n          LastWeightDay = Weight.time\r\n          if (!FirstWeight) FirstWeight = Weight.time;\r\n        }\r\n      })\r\n    }\r\n\r\n    var now = new Date().getTime()\r\n    var isVirtual = false;\r\n    if (StartDate && EndDate) {\r\n      var Batch = GetBatch_FromPen(localDataStore,PenId)\r\n      var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      var BatchEndDate = EndDate;\r\n      var Predict = CurvePredict(localDataStore, PenId, Batch, TempGraph)\r\n      if (Predict != null && Predict.Now && now > new Date(lastDate).getDate()) {\r\n        PenWeight = Predict.Now\r\n        if (LastWeight !== undefined) {\r\n          PenGrowth += PenWeight - LastWeight\r\n          GrowthCount++;\r\n        }\r\n        var _date = new Date(Predict.lastWeighing.time + Predict.Addition)\r\n        _date.setDate(_date.getDate() + Predict.days)\r\n        LastWeightDay = _date.getTime()\r\n        isVirtual = true\r\n      }\r\n      if (Predict && Predict.lastWeighing && Predict.days) {\r\n        var tempEnd = new Date(EndDate).getTime()\r\n        var date = new Date(Predict.lastWeighing.time)\r\n        date.setDate(date.getDate() + Predict.days)\r\n        tempEnd = date.getTime()\r\n        if (Predict.Addition) {\r\n          tempEnd += Predict.Addition\r\n        }\r\n        if (EndDate === BatchEndDate || EndDate < tempEnd) {\r\n          EndDate = tempEnd;\r\n        }\r\n      }\r\n    }\r\n    if (GrowthCount > 0) {\r\n      var Growth = (PenGrowth / GrowthCount)\r\n      var days = (LastWeightDay - FirstWeight) / 86400000\r\n      Growth = Growth / days\r\n      AveragePenGrowth += Growth //AverageGrowth for specefic pen\r\n    }\r\n  }\r\n  return { Animals, PenWeight, AveragePenGrowth, EndDate, isVirtual }\r\n}\r\n\r\nexport function GetStats_FromBatch(Batch, localDataStore, Closed=true) {\r\n  var isVirtual = false;\r\n  var PenCount = 0;\r\n  var Animals = 0\r\n  var CollectedWeight = 0;\r\n  var CollectedGrowth = 0;\r\n  \r\n  var isClosed = (Batch.state && Batch.state === \"Closed\")?true:false\r\n\r\n  var TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n  if (!TempGraph) return null;\r\n  var TargetWeight = TempGraph.data[TempGraph.data.length -1]\r\n  var EndDate = GetBatchEnd(Batch, TempGraph)\r\n  var StartDate = Batch.time;\r\n\r\n  var PenEnds = 0\r\n  if (Batch && Batch.pens && localDataStore.pens) {\r\n    Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(Batch_Pen => {\r\n      if (localDataStore && localDataStore.pens && localDataStore.pens[Batch_Pen] && localDataStore.weighings && localDataStore.weighings[Batch_Pen] || isClosed) {\r\n        var Pen = isClosed?Batch.pens[Batch_Pen]:localDataStore.pens[Batch_Pen]\r\n        PenCount++\r\n        \r\n        var PenWeighings = isClosed?Batch.closed.weighings[Batch_Pen]:localDataStore.weighings[Batch_Pen]\r\n        if (PenWeighings) {\r\n          var PenStats = GetStats_FromPen(Batch_Pen, Pen, localDataStore, StartDate, EndDate, PenWeighings)\r\n          Animals += PenStats.Animals;\r\n          var PenWeight = PenStats.PenWeight\r\n          if (PenWeight === 0) {\r\n            PenCount--\r\n          } else {\r\n            CollectedWeight += PenWeight\r\n            CollectedGrowth += PenStats.AveragePenGrowth\r\n            if (PenEnds < PenStats.EndDate) PenEnds = PenStats.EndDate\r\n            if (!isVirtual) isVirtual = PenStats.isVirtual\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  if (PenEnds > 0) EndDate = PenEnds\r\n  var AverageWeight = CollectedWeight / PenCount\r\n  AverageWeight = parseFloat(AverageWeight).toFixed(2)\r\n  var AverageGrowth = CollectedGrowth / PenCount\r\n  AverageGrowth = parseFloat(AverageGrowth).toFixed(2)\r\n\r\n  return {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual}\r\n}\r\n\r\nexport function GetCurve_FromBatch(Batch, GraphsStore = null, CurrentData = null) {\r\n  //Batch: Parrent Get ellement,\r\n  //GraphsStore: LocalDataStore.graphs,\r\n  //CurrentData: Data state get,\r\n  if (Batch) {\r\n    if (Batch.gcurve && Batch.state && Batch.state === DataStates.CLOSED) {\r\n      return Batch.gcurve;\r\n    }\r\n    if (GraphsStore) {\r\n      if (CurrentData && (typeof CurrentData === 'string' || CurrentData.curveId)) {\r\n        var Id = (typeof CurrentData === 'string')? CurrentData: CurrentData.curveId\r\n        return GraphsStore[Id];\r\n      }\r\n      if (Batch.gcurve){\r\n        return GraphsStore[Batch.gcurve];\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function GetBatchEnd(Batch, TempCurve){\r\n  if (Batch && Batch.time && TempCurve){\r\n    var currentTime = new Date(Batch.time) //Does not allow weight's after Batch end\r\n    for (var i = 0; i < TempCurve.data.length; i++) {\r\n      if (i < TempCurve.data.length -1) {\r\n        currentTime = new Date(AccumulateTime(currentTime, TempCurve.periode))\r\n      }\r\n    }\r\n    return currentTime.getTime();\r\n  }\r\n  return null\r\n}\r\n//#endregion\r\n\r\n//#region Curve Functions\r\nexport function AccumulateTime(Time, PeriodeLength) {\r\n  var NewTime = new Date(Time.getTime())\r\n  switch(PeriodeLength) {\r\n    case \"Days\":\r\n    //86.400.000 ms\r\n    NewTime.setDate(NewTime.getDate() + 1)\r\n    break;\r\n    case \"Month\":\r\n    NewTime.setMonth(NewTime.getMonth() + 1)\r\n    break;\r\n    case \"Weeks\":\r\n    default:\r\n    NewTime.setDate(NewTime.getDate() + 7)\r\n    break;\r\n  }\r\n  return NewTime;\r\n}\r\n\r\n//Get Today-point expected data and virtual simulation For PenId with Batch / or given\r\nexport function get_DataSpot_FromData(localDataStore, PenId, Batch, Closed = false) {\r\n  if (localDataStore.weighings && localDataStore.weighings[PenId]) {\r\n    var Weighing = null;\r\n\r\n    //get newest weighing\r\n    for (const _weighing in localDataStore.weighings[PenId]) {\r\n      var weighing = localDataStore.weighings[PenId][_weighing]\r\n      if (weighing && (!Weighing || Weighing.time < weighing.time)) { \r\n        Weighing = weighing\r\n      }\r\n    }\r\n\r\n    if (Weighing) {\r\n      var weight = Weighing.weight\r\n      weight = weight / Weighing.count\r\n      if (weight && !isNaN(weight)) {\r\n        if (!Batch) {\r\n          //Get batch form pen\r\n          for (const _batch in localDataStore.batchs) {\r\n            var batch = localDataStore.batchs[_batch]\r\n            if (batch.hasOwnProperty(\"pens\") && batch.pens[PenId] != null) {\r\n              Batch = localDataStore.batchs[_batch]\r\n              //break; //diffrenc from web ??? (needed in mobile..)\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Batch && Batch.time && Batch.datas \r\n          && localDataStore.graphs && localDataStore.graphs[Batch.gcurve]) {\r\n          var Curve = localDataStore.graphs[Batch.gcurve]\r\n          var WeighingTime = Weighing.time\r\n\r\n          if (Closed || (WeighingTime > Batch.time && (!Batch.state || Batch.state !== \"Closed\"))) {\r\n            var StartTime = Batch.time\r\n            var EndTime = Batch.time\r\n            var index = 0;\r\n            var currentTime = new Date(StartTime)\r\n            for (index = 0; index < Curve.data.length-1; index++) {\r\n              currentTime = new Date(AccumulateTime(currentTime, Curve.periode))\r\n              EndTime = currentTime.getTime()\r\n              if (EndTime >= WeighingTime) {\r\n                break;\r\n              } else {\r\n                StartTime = EndTime\r\n              }\r\n            }\r\n            //var EndDate = EndDate = currentTime.getTime();\r\n            \r\n            var Keys = Object.keys(Curve.data);\r\n            var DataSpot = get_DataSpot([StartTime, EndTime], [Curve.data[Keys[index]], Curve.data[index +1]], new Date().getTime(), weight, WeighingTime)\r\n            DataSpot.Batch = Batch\r\n            return DataSpot\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\n//Get point expected data and virtual simulation from data.\r\n//ExValue = Expected value if slope continues, for spots given (or inbetween).\r\n//VirData = Virtual calculation for Data progress to DataTime, if slope continues.\r\nexport function get_DataSpot(MinMax_Time, MinMax_Data, FindTime, Data, DataTime) {\r\n  var ExValue = null\r\n  var VirData = null\r\n  var ExTime = null\r\n  if (FindTime) {\r\n    var slope = GetSlope_Between(MinMax_Time, MinMax_Data)\r\n    var FindX = FindTime- MinMax_Time[0]\r\n    // ExValue = (FindX * Slope) + MinY             // Setting FindTime, due b then = Min data.. (b is y = 0)\r\n    ExValue = (FindX * slope) + MinMax_Data[0]          // ( X * a ) + b = Expeted data for spot on CalcTime\r\n    \r\n    if (Data && DataTime) {\r\n      var Findx2 = DataTime- MinMax_Time[0]\r\n      var ExData = (Findx2 * slope) + MinMax_Data[0]    //Expeted data for given Time 2\r\n      \r\n      var DataDiff = ExData - Data;\r\n      VirData = ExValue + DataDiff;\r\n\r\n      ExTime = (Data - MinMax_Data[0]) / slope          // (y-b)/a = Expeted time for data\r\n      ExTime = MinMax_Time[0] + ExTime\r\n      ExTime = Math.floor(ExTime)\r\n    }\r\n  }\r\n  return {ExValue, VirData, ExTime}\r\n}\r\n\r\n//Get Slope Between two points\r\nfunction GetSlope_Between(MinMax_Time, MinMax_Data){\r\n  var minX = MinMax_Time[0]\r\n  var maxX = MinMax_Time[1]\r\n  var minY = MinMax_Data[0]\r\n  var maxY = MinMax_Data[1]\r\n\r\n  //Slope = DeltaY / DeltaX\r\n  var slope = (maxY - minY) / (maxX - minX)\r\n  if (minY > minX) slope = -slope;\r\n  return slope\r\n}\r\n\r\nexport function CurvePredict(localDataStore, PenId, Batch, TempCurve) {\r\n  if (localDataStore) {\r\n    /* Get data */\r\n    if (!PenId && Batch && Batch.pens){\r\n      PenId = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId'))[0]\r\n    }\r\n    if (!Batch) {\r\n      Batch = GetBatch_FromPen(localDataStore, PenId)\r\n    }\r\n    if (Batch && Batch.time) {\r\n      if (!TempCurve) {\r\n          TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n      }\r\n      if (TempCurve && TempCurve.data) {\r\n        var BatchEndDate = GetBatchEnd(Batch, TempCurve)\r\n        var Weighing = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, BatchEndDate);\r\n        if (Weighing && Weighing.weight) {\r\n          var weight = Weighing.weight\r\n          if (Weighing.count) weight = weight / Weighing.count\r\n          var Weighing2 = GetWeight_FromPen(PenId, localDataStore.weighings, Batch.time, Weighing.time -1);\r\n          var weight2 = Weighing2?Weighing2.weight:0\r\n          if (Weighing2 && Weighing2.count) weight2 = weight2 / Weighing2.count\r\n\r\n          var StartIndex = \"none\";\r\n          var PredictCurve = { periode: TempCurve.periode, data: [] }\r\n          var now = new Date(Date.now())\r\n          now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n          var CurrentTime = new Date(Batch.time)\r\n          var Temp_CurrentIndex = 0;\r\n\r\n          /* find template fit */\r\n          for (var index = 0; index < TempCurve.data.length; index++) {\r\n            if (CurrentTime.getTime() <= now) {\r\n              CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n              Temp_CurrentIndex++;\r\n            }\r\n\r\n            if (weight <= TempCurve.data[index]) {\r\n              if (StartIndex === \"none\") {\r\n                StartIndex = index\r\n              }\r\n              PredictCurve.data.push(TempCurve.data[index])\r\n            }\r\n          }\r\n          if (weight < weight2) {\r\n            StartIndex = StartIndex -1\r\n            PredictCurve.data.unshift(TempCurve.data[StartIndex])\r\n          }\r\n\r\n          var PredictStart = new Date(Batch.time)\r\n          for (let index = 0; index < StartIndex; index++) {\r\n            PredictStart = new Date(AccumulateTime(PredictStart, TempCurve.periode))\r\n          }\r\n\r\n          PredictCurve.Now = weight\r\n          PredictCurve.TempEx = TempCurve.data[Temp_CurrentIndex]\r\n          if (StartIndex !== \"none\") {\r\n            var DataSpot = null\r\n            if (Weighing2) {\r\n              DataSpot = get_DataSpot([Weighing2.time, Weighing.time], [weight2, weight], Weighing.time, TempCurve.data[StartIndex], PredictStart.getTime())\r\n            }\r\n            if (DataSpot && DataSpot.ExTime) {\r\n              PredictCurve.FirstSpot = DataSpot.ExTime \r\n              PredictCurve.Addition = DataSpot.ExTime - Weighing.time\r\n            } else {\r\n              PredictCurve.FirstSpot = new Date(Weighing.time + 86400000)\r\n              PredictCurve.Addition = 86400000\r\n            }\r\n\r\n            if (BatchEndDate) {\r\n              var now = new Date(Date.now())\r\n              if (BatchEndDate <= now) {\r\n                now = new Date(BatchEndDate)\r\n              }\r\n\r\n              now = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime()\r\n              CurrentTime = new Date(Weighing.time)\r\n              var CurrentIndex = 0;\r\n              for (var index = 0; index < PredictCurve.data.length; index++) {\r\n                if (CurrentTime.getTime() < now) {\r\n                  CurrentTime = new Date(AccumulateTime(CurrentTime, TempCurve.periode))\r\n                  CurrentIndex ++;\r\n                }\r\n              }\r\n              CurrentIndex--\r\n              \r\n              var WeightNow = PredictCurve.data[CurrentIndex];\r\n              if (WeightNow) PredictCurve.Now = WeightNow\r\n              else PredictCurve.Now = weight\r\n            }\r\n          }\r\n\r\n          var days = 0;\r\n          if (TempCurve.periode === \"Days\") days = PredictCurve.data.length\r\n          else if (TempCurve.periode === \"Weeks\") days = (PredictCurve.data.length) * 7\r\n          PredictCurve.days = days\r\n          PredictCurve.lastWeighing = Weighing\r\n\r\n          PredictCurve.Batch = Batch;\r\n          return PredictCurve;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n//#endregion","import { Platform, Alert } from 'react-native'\r\n\r\nimport { UserStates } from '../Stores/Firebase/Selectors'\r\nimport { Actions, DataRefs, format_Time } from '../Stores/Firebase/Selectors';\r\n\r\nlet auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  console.log(\"firebase load\")\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase\r\n\r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n\r\n  auth = _firebase.auth;\r\n  if (_firebase.messaging.isSupported()){\r\n    messaging = _firebase.messaging;\r\n  }\r\n  database = _firebase.database;\r\n  console.log(\"Started\")\r\n  //#endregion\r\n}\r\n\r\n//#region Firebase specefic services\r\nasync function isPermit_UserPermission() {\r\n  console.log(\"permit test\")\r\n  if (messaging) {\r\n    const authStatus = await messaging().requestPermission();\r\n    const enabled =\r\n      authStatus === messaging.AuthorizationStatus.AUTHORIZED ||\r\n      authStatus === messaging.AuthorizationStatus.PROVISIONAL;\r\n\r\n    if (!enabled) {\r\n      console.log('Authorization status:', authStatus);\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction requestUserPermission() {\r\n  return new Promise((resolve, reject) => {\r\n    if ((Platform.OS === \"ios\" || Platform.OS == \"android\") && !isPermit_UserPermission()) {\r\n      resolve('This application needs premissions to be using notifications')\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nasync function is_getToken() {\r\n  var fcmToken = \"\"\r\n  if (messaging) {\r\n    try{\r\n      fcmToken = await messaging().getToken();\r\n      console.log('Device_token: ', fcmToken)\r\n    }catch(error){\r\n      console.log(error)\r\n    }\r\n  }\r\n  return fcmToken;\r\n}\r\n\r\nfunction requestFirebaseToken() {\r\n  return new Promise((resolve, reject) => {\r\n    var token;\r\n    if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    } else if (messaging && messaging.isSupported()) {\r\n      try {\r\n        token = is_getToken();\r\n      } catch{}\r\n    }\r\n    if (!token) {\r\n      resolve('Could not find Firebase messaging Token')\r\n    }\r\n    resolve(token)\r\n  })\r\n}\r\n\r\nfunction wrappedAlert(title, message, okText, _cancelable) {\r\n  return new Promise(resolve => {\r\n    Alert.alert(\r\n      title,\r\n      message,\r\n      [{text: okText, onPress: function() { resolve(); }}],\r\n      {cancelable: _cancelable, onDismiss: function() {resolve(); }},\r\n    );\r\n  });\r\n}\r\n//#endregion\r\n\r\n//#region Firebase Auth services\r\nfunction createFirebaseUserWithemailandpassword({Email, Pass}) {\r\n  return new Promise((resolve, reject) => {\r\n    auth().createUserWithEmailAndPassword(Email,Pass).then(() => {\r\n      var User = auth().currentUser;\r\n      var Name = User.displayName ? User.displayName : User.email\r\n      actionStarting(DataRefs.USERSDATA, Actions.UPDATE, {UserId: User.uid, Data: {\r\n        name: Name,\r\n        state: UserStates.STARTER,\r\n      }}).then((_data) => {\r\n        User.updateProfile({\r\n          displayName: Name\r\n        }).then((data) => {\r\n          User.sendEmailVerification().then(function() {\r\n            // Email sent.\r\n            resolve(null)\r\n          }).catch(function(error) {\r\n            console.log(\"error in send EmailVerification\", error)\r\n            resolve({error:error.code, viewError:'Verification could not be send'})\r\n          });\r\n        }).catch(function(error) {\r\n          console.log(\"update profile\")\r\n          resolve({error:error.code, viewError:'Update error, please refresh'})\r\n        });\r\n      })\r\n      \r\n    }).catch(error => {\r\n      console.log(\"UserCreate Error: \", error);\r\n      if (error.code === 'auth/email-already-in-use') {\r\n        resolve({error:error.code, viewError:'The email address is already in use.'})\r\n        //Should not exploid the users... (this could be used as a find user-mails) ???\r\n      }\r\n      else if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else if (error.code === 'auth/weak-password') {\r\n        resolve({error:error.code, viewError: error.message})\r\n      } else {\r\n        resolve({error:error.code, viewError: 'Something went wrong'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction signinWithemailandpassword({Email, Pass}){\r\n  if (auth().currentUser){\r\n    if (auth().currentUser.email != Email){\r\n      const res = logoutUser()\r\n    }\r\n    else {\r\n      return new Promise((resolve, reject) => {\r\n        resolve(true)\r\n      })\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    auth().signInWithEmailAndPassword(Email,Pass).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User Signin Error: \", error);\r\n\r\n      if (error.code === 'auth/invalid-email') {\r\n        resolve({error:error.code, viewError:'The email addres is invalid.'})\r\n      }\r\n      else {\r\n        resolve({error:'Could not singin', viewError:'Could not singin'})\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction sendResetPassword({Email}){\r\n  return new Promise((resolve, reject) => {\r\n    auth().sendPasswordResetEmail(Email).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(\"User resetPass error:\", error);\r\n      if (error.code === 'auth/user-not-found'){\r\n        //Should not exploid the users... (this could be used as a find user-mails)\r\n      }\r\n      resolve(null)\r\n    })\r\n  })\r\n}\r\n\r\nfunction logoutUser(){\r\n  return new Promise((resolve, reject) => {\r\n    auth().signOut().then(() => {\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    }).catch(error => {\r\n      console.log(\"User logout error:\", error);\r\n      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n    })\r\n  })\r\n}\r\n\r\nfunction refreshUser(){\r\n  return new Promise((resolve, reject) => {\r\n    var user = auth().currentUser\r\n    if (user){\r\n      auth().currentUser.reload().then((data) => {\r\n        user = auth().currentUser\r\n        console.log(data, user)\r\n        //resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:null })\r\n      })\r\n    }\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Master Control\r\nfunction actionStarting(ref, action, params = null){\r\n  const CurrentUser = auth().currentUser;\r\n  switch(ref){\r\n    case DataRefs.USERSDATA:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"UserData\")) {\r\n            return new Promise((resolve, reject) => {\r\n              var Data = params[0]\r\n              createFarm({Data:{name: params.Farms.name}}).then((farmid) => {\r\n                updateFarmData({FarmId:farmid, Data:{sections:params.Sections, pens: params.Pens}}).then(() => {\r\n                  updateUserData({Data:{state: params.UserData.state, farms: {[farmid]: true}}}).then(() => {\r\n                    fetchUser(CurrentUser.uid).then((data) => {\r\n                      var Data = data.data\r\n                      resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:Data })\r\n                    });\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          }\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateUserData(params)\r\n        case Actions.SIGN:\r\n          if (!params){\r\n            return logoutUser()\r\n          }else {\r\n            if (params.hasOwnProperty(\"refresh\")){ // TODO: verify\r\n              return refreshUser()\r\n            } else return signinWithemailandpassword(params)\r\n          }\r\n          break;\r\n        case Actions.CLEAR:\r\n          if (!CurrentUser) {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n          } else {\r\n            return {type:Actions.CLEAR, path:DataRefs.USERSDATA, data:{}}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n\r\n    case DataRefs.USERS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchUser(params, true)\r\n        case Actions.CREATE:\r\n          if (params.hasOwnProperty(\"Email\") && params.hasOwnProperty(\"Pass\")) return createFirebaseUserWithemailandpassword(params)\r\n          else if (params.hasOwnProperty(\"Email\")) return sendResetPassword(params)\r\n          break;\r\n        case Actions.UPDATE:\r\n          return {type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:params}\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.USERS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchFarm(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          return updateFarm(params)\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.FARMS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.FARMDATAS:\r\n      switch(action) {\r\n        case Actions.UPDATE:\r\n          return updateFarmData(params)\r\n      }\r\n      break;\r\n\r\n    case DataRefs.SECTIONS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchSections(params);\r\n        case Actions.CREATE:\r\n          break;\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.SECTIONS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PENS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPens(params);\r\n        case Actions.CREATE:\r\n          return createNewPen(params);\r\n        case Actions.DELETE:\r\n          return deletePen(params)\r\n        case Actions.UPDATE:\r\n          return updatePen(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PENS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.PIGS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchPigs(params);\r\n        case Actions.CREATE:\r\n          return updatePigdata(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.PIGS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.BATCHS:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchBatchs(params)\r\n        case Actions.CREATE:\r\n          return createBatchs(params)\r\n        case Actions.UPDATE:\r\n          return updateBatchs(params)\r\n        case Actions.DELETE:\r\n          //return deleteBatch(params)\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.BATCHS, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.WEIGHING:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchWeights(params);\r\n        case Actions.CREATE:\r\n          return createWeight(params);\r\n        case Actions.UPDATE:\r\n          break;\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.WEIGHING, data:{}}\r\n      }\r\n      break;\r\n\r\n    case DataRefs.COMMENTS:\r\n      switch(action) {\r\n        case Actions.FETCH:\r\n          return fetchComments(params);\r\n        case Actions.CREATE:\r\n          return createComment(params);\r\n      }\r\n      break;\r\n\r\n    case DataRefs.GRAPH:\r\n      switch(action){\r\n        case Actions.FETCH:\r\n          return fetchGraphData(params);\r\n        case Actions.CREATE:\r\n          return updateGraphData(params);\r\n        case Actions.UPDATE:\r\n          return updateGraphData(params);\r\n        case Actions.CLEAR:\r\n          return {type:Actions.CLEAR, path:DataRefs.GRAPH, data:{}}\r\n      }\r\n      break;\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    resolve({error: \"Unknown Action\"})\r\n  })\r\n}\r\n//#endregion\r\n\r\nfunction SetUpdateTime(DataRef) {\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Setting Update Time\")\r\n    database().ref(DataRef).update({\r\n      update_time: database.ServerValue.TIMESTAMP,\r\n    }).then(() => {\r\n      resolve(true)\r\n    }).catch(error => {\r\n      console.log(error)\r\n      /*if (error.code === 'database/permission-denied') {\r\n        console.log(\"Batch update was permission denied. \");\r\n      }else if (error.code) {\r\n        console.log(\"Batch update Error: \", error);\r\n      }*/\r\n      resolve(true)\r\n    });\r\n  })\r\n}\r\nfunction CheckDataTime(DataRef, DataTime) {\r\n  return new Promise((resolve, reject) => {\r\n    if (!DataTime) resolve(true)\r\n    database().ref(DataRef + \"/update_time\").once('value').then((_Time) => {\r\n      var UpdateTime = _Time.val()\r\n      if (!UpdateTime) {\r\n        SetUpdateTime(DataRef).then((res) => {\r\n          resolve(true)\r\n        })\r\n      } else {\r\n        if (DataTime) {\r\n          if (DataTime === \"SET\"){\r\n            SetUpdateTime(DataRef).then((res) => {\r\n              resolve(res)\r\n            })\r\n          } else if (DataTime < UpdateTime){\r\n            resolve(true)\r\n          }\r\n          else resolve(false)\r\n        }else resolve(true)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n//#region User data Controls\r\nfunction fetchUser({UserId}, List = false) {\r\n  var user = \"\";\r\n  if (UserId) user = UserId\r\n  else if (!List && auth().currentUser) user = auth().currentUser.uid;\r\n\r\n  if (user || List) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).once('value').then((userData) => {\r\n        var data = userData.val()\r\n        if (!List) {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data:{data}})\r\n        } else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.USERS, data:{data}})\r\n        }\r\n      }).catch(error => {\r\n        console.log(error)\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    })\r\n  }\r\n  else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateUserData({UserId, Data}) {\r\n  const user = UserId? UserId: auth().currentUser.uid;\r\n  if (user) {\r\n    const ref = \"users/\" + user;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then((data) => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"User update was permission denied. \");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n        resolve({error:\"An error occurred\"})\r\n      })\r\n    }) \r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"User uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm info data Controls\r\nfunction fetchFarm({FarmId}) {\r\n  var ref = \"farms/\" + FarmId\r\n  return database().ref(ref).once('value').then((_farmData) => {\r\n    //TODO:Multiple farms\r\n    var data = _farmData.val()\r\n    if (FarmId) {\r\n      data = {[FarmId]:data}\r\n    }\r\n    return {type:Actions.UPDATE, path:DataRefs.FARMS, data: data}\r\n  })\r\n  /*} else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })*/\r\n}\r\n\r\nfunction updateFarm({FarmId, Data}) {\r\n  return new Promise((resolve, reject) => {\r\n    if (FarmId){\r\n      database().ref('farms/'+ FarmId).update({\r\n        ...Data\r\n      }).then(()=> {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    } else {\r\n      const farm = database().ref('farms/').push()\r\n      const farmid = farm.key\r\n      farm.set({\r\n        Data\r\n      }).then(() => {\r\n        resolve(farmid)\r\n      }).catch(error => {\r\n        console.log(\"Create Farm Error: \", error);\r\n        resolve(false)\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nfunction createFarm({Data}){\r\n  const user = auth().currentUser;\r\n  const ref = \"users/\" + user.uid;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const farm = database().ref('farms/').push()\r\n    const farmid = farm.key\r\n    \r\n    farm.set({\r\n      email: user.email,\r\n      manager: user.displayName ? user.displayName : user.email,\r\n      name: Data.name\r\n    }).then(() => {\r\n      resolve(farmid)\r\n    }).catch(error => {\r\n      console.log(\"Create Farm Error: \", error);\r\n      resolve(false)\r\n    })\r\n  })\r\n}\r\n\r\nfunction updateFarmData({FarmId, Data}) {\r\n  if (FarmId) {\r\n    const ref = \"farms_data/\" + FarmId;\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref).update(\r\n        Data\r\n      ).then(() => {\r\n        resolve(null)\r\n      }).catch(error => {\r\n        if (error.code === 'database/permission-denied') {\r\n          console.log(\"Farm data update was permission denied.\");\r\n        }else if (error.code) {\r\n          console.log(\"User update Error: \", error);\r\n        }\r\n\r\n        resolve(false)\r\n      })\r\n    })\r\n  } else return new Promise((resolve, reject) => {\r\n    console.log(\"Farm uid in fecth unknown\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Farm data Controls\r\n\r\n//#region Sections\r\nfunction fetchSections({FarmId, SectionId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/sections\";\r\n    if (SectionId){\r\n      ref += \"/\" + SectionId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/sections\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          console.log(\"Sections fetch called\")\r\n          return database().ref(ref).once('value').then((_sectionidData) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.SECTIONS, data:_sectionidData.val()})\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Sections Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Pens\r\nfunction fetchPens({FarmId, PenId, DataTime}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pens\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/pens\", DataTime).then((DoFetch) => {\r\n        if (DoFetch){\r\n          console.log(\"Pens fetch Called\")\r\n\r\n          database().ref(ref).once('value').then((_pensData) => {\r\n            if (PenId) {\r\n              var penData = _pensData.val()\r\n              if (!penData) penData = {}\r\n              if (!penData.datas) penData.datas = {}\r\n              //if (!penData.datas.gcurve) penData.datas.gcurve = \"default\";\r\n      \r\n              var pen = {[PenId]: penData};\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen})\r\n            } else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_pensData.val()})\r\n            }\r\n          })\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  } \r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pens Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createNewPen({FarmId, PenId, SectionId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n        database().ref(ref2).set({\r\n          section: SectionId,\r\n        }).then(() => {\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n            [PenId]: true,\r\n          }).then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              });\r\n            });\r\n          });\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction deletePen({FarmId, PenId, SectionId}){\r\n  if (FarmId && PenId){\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref + \"pens/\" + PenId).remove().then(() => {\r\n        if (SectionId){\r\n          database().ref(ref + \"sections/\" + SectionId + \"/pens/\" + PenId).remove().then(() => {\r\n            database().ref(ref + \"sections/\").update({\r\n              update_time: database.ServerValue.TIMESTAMP,\r\n            }).then(() => {\r\n              fetchPens({FarmId: FarmId, PenId: PenId, DataTime: \"SET\"}).then((_Pen) => {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:_Pen.data})\r\n              })\r\n            });\r\n          })\r\n        }else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePen({FarmId, PenId, Pen}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId){\r\n        fetchPens({FarmId: FarmId, PenId: PenId}).then((_Pen) => {\r\n          var ref2 = ref + \"pens/\" + PenId + \"/\"\r\n          var data = Pen.datas\r\n          var Datas = {..._Pen.data[PenId].datas, ...data}\r\n          database().ref(ref2).update({\r\n            ...Pen,\r\n            datas: Datas\r\n          }).then(() => {\r\n            if (Pen.section) {\r\n              database().ref(ref + \"sections/\" + SectionId + \"/pens\").update({\r\n                [PenId]: true,\r\n              }).then(() => {\r\n                database().ref(ref + \"sections/\").update({\r\n                  update_time: database.ServerValue.TIMESTAMP,\r\n                }).then(() => {\r\n                  resolve(null)\r\n                });\r\n              });\r\n            }\r\n          });\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Pigs\r\nfunction fetchPigs({FarmId, TagId}){\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/pigs\";\r\n    if (TagId){\r\n      ref += \"/\" + TagId\r\n    }\r\n\r\n    return database().ref(ref).once('value').then((_pigsData) => {\r\n      if (TagId) {\r\n        var pigData = _pigsData.val()\r\n        if (!pigData) return null;\r\n        if (!pigData.datas) pigData.datas = {}\r\n        if (!pigData.datas.gcurve) pigData.datas.gcurve = \"default\";\r\n\r\n        var pig = {[TagId]: pigData};\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:pig}\r\n      } else {\r\n        return {type:Actions.UPDATE, path:DataRefs.PIGS, data:_pigsData.val()}\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Pigs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updatePigPen({FarmId, TagId, PenId, Action}) {\r\n  if (PenId) {\r\n    var ref2 = \"farms_data/\" + FarmId + \"/\" + \"pens/\" + PenId + \"/datas\"\r\n    return new Promise((resolve, reject) => {\r\n      database().ref(ref2 + \"/count\").once('value').then((counts) => {\r\n        var val = counts.val()\r\n        if (!val) val = 0\r\n        if (Action && !isNaN(Action)) {\r\n          val = parseInt(val) + parseInt(Action)\r\n        } else {\r\n          val = parseInt(val) +1\r\n        }\r\n        database().ref(ref2).update({\r\n          count: val,\r\n        }).then(() => {\r\n          fetchPens({FarmId: FarmId, PenId: PenId}).then((pen) => {\r\n            resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:pen.data})\r\n          })\r\n        });\r\n      }).catch(error => {\r\n        console.log(\"Update pig pen Error: \", error);\r\n        resolve(null)\r\n      })\r\n    })\r\n  }else {\r\n    return new Promise((resolve, reject) => {\r\n      resolve(null)\r\n    })\r\n  }\r\n}\r\n\r\nfunction updatePigdata({FarmId, TagId, PenId, Action}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/\";\r\n    if (TagId) {\r\n      return new Promise((resolve, reject) => {\r\n        var ref2 = ref + \"pigs/\" + TagId + \"/\"\r\n        fetchPigs({FarmId: FarmId, TagId: TagId}).then((pig) => {\r\n          if (pig && pig.data) {\r\n            pig = pig.data[TagId]?pig.data[TagId]:null\r\n          }\r\n          if (!pig || !pig.hasOwnProperty('pen')){\r\n            database().ref(ref2).update({\r\n              pen: 0,\r\n            }).then(() => {\r\n              fetchPigs({FarmId: FarmId}).then((pigs) => {\r\n                console.log(\"?\", pigs)\r\n                resolve(null)\r\n                //resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs})\r\n              })\r\n            })\r\n          }\r\n          else if (PenId && PenId != pig.pen) {\r\n            updatePigPen({FarmId: FarmId, TagId: TagId, PenId: pig.pen, Action:-1}).then((data)=>{\r\n              updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:+1}).then((data)=>{\r\n                database().ref(ref2).update({\r\n                  pen: PenId\r\n                }).then(() => {\r\n                  fetchPigs({FarmId: FarmId}).then((pigs)=> {\r\n                    resolve({type:Actions.UPDATE, path:DataRefs.PIGS, data:pigs.data})\r\n                  })\r\n                })\r\n              })\r\n            })\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        })\r\n      })\r\n    } else {\r\n      return new Promise((resolve, reject) => {\r\n        updatePigPen({FarmId: FarmId, TagId: TagId, PenId: PenId, Action:Action}).then((data) => {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.PENS, data:data.data})\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Batchs\r\nfunction fetchBatchs({FarmId, BatchId, Data, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    if (BatchId){\r\n      ref += \"/\" + BatchId\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/batchs\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (!Data) {\r\n            database().ref(ref).once('value').then((_batchdata) => {\r\n              if (BatchId) {\r\n                var batchdata = _batchdata.val()\r\n                if (!batchdata) return null;\r\n                if (!batchdata.datas) batchdata.datas = {}\r\n                if (!batchdata.pens) batchdata.pens = []\r\n                if (!batchdata.datas.gcurve) batchdata.datas.gcurve = \"default\";\r\n\r\n                var batch = {[BatchId]: batchdata};\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:batch})\r\n              } else {\r\n                resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:_batchdata.val()})\r\n              }\r\n            })\r\n          }\r\n          else if (BatchId) {\r\n            switch(Data){\r\n              case DataRefs.BATCHS:\r\n                ref += \"/\" + \"datas\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var data = {[BatchId]: {datas: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:data})\r\n                })\r\n              case DataRefs.PENS:\r\n                ref += \"/\" + \"pens\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var pens = {[BatchId]: {pens: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:pens})\r\n                })\r\n              case DataRefs.GRAPH:\r\n                ref += \"/\" + \"gcurve\"\r\n                return database().ref(ref).once('value').then((_batchdata) => {\r\n                  var curve = {[BatchId]: {gcurve: _batchdata.val()}}\r\n                  resolve({type:Actions.UPDATE, path:DataRefs.BATCHS, data:curve})\r\n                })\r\n            }\r\n          }\r\n\r\n        } else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Batchs Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createBatchs({FarmId, BatchId, Batch}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (Batch && Batch.name) {\r\n        BatchId = Batch.name;\r\n        ref += \"/\" + Batch.name + \"/\"\r\n        delete Batch.name;\r\n        database().ref(ref).set({\r\n          ...Batch,\r\n        }).then(() => {\r\n          Object.keys(Batch.pens).forEach(pen => {\r\n            updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n          })\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        }).catch(error => {\r\n          if (error.code === 'database/permission-denied') {\r\n            console.log(\"Batch update was permission denied. \");\r\n          }else if (error.code) {\r\n            console.log(\"Batch update Error: \", error);\r\n          }\r\n          resolve({error:\"An error occurred\"})\r\n        })\r\n      } else if (BatchId) { //added else ??? still cleanup ??\r\n        console.log(\"???\") //TODO: why id.. mabye cleanup\r\n        ref += \"/\" + BatchId + \"/\"\r\n        database().ref(ref).set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          pens:[],\r\n          datas:{\r\n            devianceMin:1,\r\n            devianceMax:2,\r\n          }\r\n        }).then(() => {\r\n          resolve(fetchBatchs({FarmId: FarmId, DataTime: \"SET\"}))\r\n        });\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction updateBatchs({FarmId, BatchId, Batch, Data}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/batchs\";\r\n    return new Promise((resolve, reject) => {\r\n      if (BatchId && Batch) {\r\n        ref += \"/\" + BatchId\r\n        fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.PENS}).then((_batch) => {\r\n          var Pens = _batch.data[BatchId].pens\r\n          if (Batch.name) delete Batch.name\r\n\r\n          var BatchPens = {}\r\n          if (Batch.pens && JSON.stringify(Batch.pens)!==JSON.stringify(Pens)) {\r\n            if (!Pens) Pens = []\r\n            var RemovedPens = Object.keys(Pens).filter(x => !Object.keys(Batch.pens).includes(x) && !Pens[x].enddate);\r\n            var NewPens = Object.keys(Batch.pens).filter(x => !Object.keys(Pens).includes(x) || Pens[x].enddate);\r\n            var SamePens = Object.keys(Pens).filter(x => !Object.keys(RemovedPens).includes(x) && !Object.keys(NewPens).includes(x));\r\n\r\n            if (RemovedPens && RemovedPens.length > 0) {\r\n              RemovedPens.forEach(pen => {\r\n                if (Pens[pen]) {\r\n                  var Pen = Pens[pen]\r\n                  Pen.enddate = Date.now()\r\n                  BatchPens[pen] = Pen\r\n                  fetchPens({FarmId: FarmId, PenId:pen}).then((pendata) => {\r\n                    var count = 0\r\n                    if (pendata.data[pen] && pendata.data[pen].datas && pendata.data[pen].datas.count)count=pendata.data[pen].datas.count\r\n                    BatchPens[pen].count = count\r\n                  })\r\n                  updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:\"\"}}})\r\n                }\r\n              })\r\n            }\r\n            if (NewPens && NewPens.length > 0) {\r\n              NewPens.forEach(pen => {\r\n                var Pen = Pens[pen]?Pens[pen]:{startdate:Date.now()}\r\n                if (Pen.enddate) delete Pen.enddate\r\n                BatchPens[pen] = Pen\r\n                updatePen({FarmId:FarmId, PenId:pen, Pen:{datas:{batch:BatchId}}})\r\n              })\r\n            }\r\n\r\n            if (SamePens && SamePens.length > 0) {\r\n              SamePens.forEach(pen => {\r\n                BatchPens[pen] = Pens[pen]\r\n              })\r\n            }\r\n          }\r\n          Batch.pens = BatchPens\r\n\r\n          if (Batch.state && Batch.state === \"Closed\") {\r\n            fetchBatchs({FarmId: FarmId, BatchId: BatchId, Data:DataRefs.GRAPH}).then((curve) => {\r\n              var CurveId = curve.data[BatchId].gcurve\r\n              fetchGraphData({FarmId: FarmId}).then((curve) => {\r\n                Batch.gcurve = curve.data[CurveId]\r\n                Batch.closed = {comments: [], weighings: []}\r\n                \r\n                for (let i = 0, p = Promise.resolve(); i <= Object.keys(Pens).length; i++) {\r\n                  p = p.then(_ => new Promise(_resolve => {\r\n                    setTimeout(function () {\r\n                      if (i !== Object.keys(Pens).length) {\r\n                        var PenId = Object.keys(Pens)[i]\r\n                        Batch.pens[PenId] = Pens[PenId]\r\n                        fetchPens({FarmId: FarmId, PenId:PenId}).then((pendata) => {\r\n                          var count = 0\r\n                          if (pendata.data[PenId] && pendata.data[PenId].datas && pendata.data[PenId].datas.count)count=pendata.data[PenId].datas.count\r\n                          Batch.pens[PenId].count = count\r\n                        })\r\n                        if (!Batch.pens[PenId].enddate) {\r\n                          Batch.pens[PenId].enddate = Date.now()\r\n                        }\r\n                        updatePen({FarmId:FarmId, PenId:PenId, Pen:{datas:{batch:\"\", count:0}}})\r\n\r\n                        fetchComments({FarmId: FarmId, PenId: PenId}).then((comments) => {\r\n                          Batch.closed.comments[PenId] = comments.data[PenId]\r\n                          database().ref(\"farms_data/\" + FarmId + \"/datas/comments/\" + PenId).remove()\r\n                          \r\n                          fetchWeights({FarmId: FarmId, PenId: PenId}).then((weights) => {\r\n                            Batch.closed.weighings[PenId] = weights.data[PenId]\r\n                            database().ref(\"farms_data/\" + FarmId + \"/weighings/\" + PenId).remove()\r\n                            _resolve();\r\n                          })\r\n                        })\r\n                      }\r\n                      else {\r\n                        database().ref(ref).update({\r\n                          ...Batch\r\n                        }).then(()=>{\r\n                          database().ref(ref + \"/closed\").set(\r\n                            Batch.closed\r\n                          ).then(() => {\r\n                            fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                              resolve(data)\r\n                            })\r\n                          }).catch(error => {\r\n                            if (error.code === 'database/permission-denied') {\r\n                              console.log(\"Batch update was permission denied. \");\r\n                            }else if (error.code) {\r\n                              console.log(\"Batch update Error: \", error);\r\n                            }\r\n                            console.log(error)\r\n                            resolve({error:\"An error occurred\"})\r\n                          })\r\n                        })\r\n                      }\r\n                    })\r\n                  }));\r\n                }\r\n              })\r\n            })\r\n          } else {\r\n            database().ref(ref).update({\r\n              ...Batch,\r\n            }).then(() => {\r\n              fetchBatchs({FarmId: FarmId, BatchId: BatchId, DataTime: \"SET\"}).then((data)=>{\r\n                resolve(data)\r\n              })\r\n            }).catch(error => {\r\n              if (error.code === 'database/permission-denied') {\r\n                console.log(\"Batch update was permission denied. \");\r\n              }else if (error.code) {\r\n                console.log(\"Batch update Error: \", error);\r\n              }\r\n              console.log(error)\r\n              resolve({error:\"An error occurred\"})\r\n            })\r\n          }\r\n        })\r\n      }else {\r\n        console.log(\"Update Batchs Error\");\r\n        resolve(null)\r\n      }\r\n    })\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Weights\r\nfunction fetchWeights({FarmId, PenId, SectionId, limitStart = 0, limitTo = 9999, DataTime, MemSections}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/weighings\", DataTime).then((DoFetch) => {\r\n        if (DoFetch) {\r\n          if (PenId) {\r\n            console.log(\"Weight fetch called, getting Pen\")\r\n            ref += \"/\" + PenId\r\n            database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n              var weighing = {[snapshot.key]:{}}\r\n              snapshot.forEach(c => {\r\n                weighing[snapshot.key][c.key] = c.val()\r\n              })\r\n              resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:weighing})\r\n            })\r\n          } else {\r\n            console.log(\"Weight fetch called, getting Sections\")\r\n            database().ref(ref + \"/update_time\").once('value').then((_weighingTime) => {\r\n              //TODO: Section fetch cast :: in mem check ??\r\n              var Weighings_Time = _weighingTime.val()\r\n              fetchSections({FarmId, SectionId, DataTime: MemSections?MemSections.update_time:null}).then((sections) => {\r\n                var itemsProcessed = 0;\r\n                var length = 0;\r\n                var newWeights = {}\r\n                var Sections = sections?sections.data:MemSections\r\n                Object.keys(Sections).forEach(section => {\r\n                  if (Sections[section] && Sections[section].pens) {\r\n                    length += Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').length\r\n                    Object.keys(Sections[section].pens).filter(e => e !== '__jsogObjectId').forEach(pen => {\r\n                      fetchWeights({FarmId:FarmId, PenId:pen, limitStart:0, limitTo:limitTo}).then((weights) => {\r\n                        itemsProcessed++\r\n                        newWeights = {...newWeights, ...weights.data}\r\n                        if (itemsProcessed === length) {\r\n                          newWeights.update_time = Weighings_Time\r\n                          resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                        }\r\n                      }).catch(error => {\r\n                        console.log(error)\r\n                        resolve({type:Actions.UPDATE, path:DataRefs.WEIGHING, data:newWeights})\r\n                      })\r\n                    })\r\n                  }\r\n                })\r\n              }).catch(error => {\r\n                console.log(error)\r\n              })\r\n            })\r\n          }\r\n\r\n        }\r\n        else {\r\n          resolve(null)\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createWeight({FarmId, PenId, Weight, Quantity, Date}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/weighings\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const weightRef = database().ref(ref).push()\r\n        const weightId = weightRef.key\r\n        weightRef.set({\r\n          time: Date,\r\n          weight: Weight,\r\n          count: Quantity,\r\n        }).then(() => {\r\n          fetchWeights({FarmId:FarmId, PenId:PenId, DataTime: \"SET\"}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Weight Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n\r\n//#region Comments\r\nfunction fetchComments({FarmId, PenId, limitStart = 0, limitTo = 5}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    return new Promise((resolve, reject) => {\r\n      if (PenId) {\r\n        ref += \"/\" + PenId\r\n        database().ref(ref).orderByChild('time').limitToLast(limitTo).once('value', snapshot => {\r\n          var comment = {[snapshot.key]:{}}\r\n          snapshot.forEach(c => {\r\n            comment[snapshot.key][c.key] = c.val()\r\n          }) \r\n          resolve({type:Actions.UPDATE, path:DataRefs.COMMENTS, data:comment})\r\n        })\r\n      } else {\r\n        //TODO: ...Comment other than PenId\r\n      }\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Weights Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction createComment({FarmId, PenId, Action, Data, Quantity, Weight}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/datas/comments\";\r\n    if (PenId){\r\n      ref += \"/\" + PenId + \"/\"\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const commentRef = database().ref(ref).push()\r\n        const commentId = commentRef.key\r\n\r\n        commentRef.set({\r\n          time: database.ServerValue.TIMESTAMP,\r\n          user: auth().currentUser.email,\r\n          action: Action,\r\n          quantity: Quantity,\r\n          weight: Weight,\r\n          data: Data,\r\n        }).then(() => {\r\n          fetchComments({FarmId:FarmId, PenId:PenId}).then((weights)=>{\r\n            resolve(weights)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Comment Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    } else {\r\n      //TODO: ...Comment other than PenId\r\n    }\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n//#endregion\r\n\r\n//#region Graphs\r\nfunction fetchGraphData({FarmId, GraphId, DataTime}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    ref = ref + \"/\" + GraphId;\r\n    return new Promise((resolve, reject) => {\r\n      CheckDataTime(\"farms_data/\" + FarmId + \"/graph\", DataTime).then((DoFetch) => {\r\n        console.log(\"Doing Graphs fetch\", DoFetch, \"Always..\")\r\n        //if (DoFetch){\r\n\r\n          database().ref(ref).once('value').then((graph) => {\r\n            var Graphs = null\r\n            var GraphVal = graph.val()\r\n            if (GraphVal) {\r\n              if (GraphId) {\r\n                var newGraph = {[graph.key]: GraphVal}\r\n                Graphs = {...Graphs, ...newGraph}\r\n              }else {\r\n                Graphs = {...Graphs, ...GraphVal}\r\n              }\r\n            }\r\n            if (!GraphId) {\r\n              database().ref(\"farms_data/Agrisys/graph\").once('value').then((Agraph) => {\r\n                var AgraphVal = Agraph.val();\r\n                if (AgraphVal) {\r\n                  Graphs = {...AgraphVal, ...Graphs}\r\n                }\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              }).catch(error => {\r\n                console.log(\"Get Agrisys graph Error: \", error);\r\n                resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n              })\r\n            }else {\r\n              resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:Graphs})\r\n            }\r\n          }).catch(error => {\r\n            console.log(\"Get farm graph Error: \", error);\r\n            resolve(null)\r\n          })\r\n\r\n        /*}\r\n        else {\r\n          resolve({type:Actions.UPDATE, path:DataRefs.GRAPH, data:{}})\r\n        }*/\r\n      })\r\n    })\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    console.log(\"Fecth Graph Error\");\r\n    resolve(null)\r\n  })\r\n}\r\n\r\nfunction updateGraphData({FarmId, Graph}) {\r\n  if (FarmId) {\r\n    var ref = \"farms_data/\" + FarmId + \"/graph\";\r\n    if (Graph.name) {\r\n      ref += \"/\" + Graph.name + \"/\"\r\n      return new Promise((resolve, reject) => {\r\n        database().ref(ref).update({\r\n          data: Graph.data,\r\n          periode: Graph.periode\r\n        }).then(() => {\r\n          fetchGraphData({FarmId: FarmId, GraphId: Graph.name}).then((_Graph)=>{\r\n            resolve(_Graph)\r\n          })\r\n        }).catch(error => {\r\n          console.log(\"Create Graph Error: \", error);\r\n          resolve(null)\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n//#endregion\r\n//#endregion\r\n\r\nexport const firebaseService = {\r\n  //Firebase\r\n  requestUserPermission,\r\n  requestFirebaseToken,\r\n  wrappedAlert,\r\n\r\n  //Firebase Auth (could be moved to fetch / action)\r\n  createFirebaseUserWithemailandpassword,\r\n  signinWithemailandpassword,\r\n  sendResetPassword,\r\n  logoutUser,\r\n  refreshUser,\r\n\r\n  //Commnads\r\n  actionStarting,\r\n}\r\n","import axios from 'axios'\r\nimport { Config, GetToken_URL, GetCheckToken_URL, GetConsumtionData_URL } from '../Config'\r\nimport { is, curryN, gte } from 'ramda'\r\n\r\nconst isWithin = curryN(3, (min, max, value) => {\r\n  const isNumber = is(Number)\r\n  return isNumber(min) && isNumber(max) && isNumber(value) && gte(value, min) && gte(max, value)\r\n})\r\nconst in200s = isWithin(200, 299)\r\n\r\nfunction Create_Axios(baseURL, Acc_Token = null) {\r\n  var Consys_ApiClient;\r\n  if (Acc_Token){\r\n    Consys_ApiClient = axios.create({\r\n      /**\r\n       * Import the config from the App/Config/index.js file\r\n       */\r\n      baseURL: baseURL,\r\n      headers: {\r\n        Accept: 'application/json',\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${Acc_Token}`\r\n      },\r\n      timeout: 3000,\r\n    })\r\n  }else {\r\n    Consys_ApiClient = axios.create({\r\n      /**\r\n       * Import the config from the App/Config/index.js file\r\n       */\r\n      baseURL: baseURL,\r\n      headers: {\r\n        Accept: 'application/json',\r\n        'Content-Type': 'application/json',\r\n      },\r\n      timeout: 3000,\r\n    })\r\n  }\r\n  return Consys_ApiClient\r\n}\r\n\r\nfunction getAccessToken(SiteUrl, Ref_Token){\r\n  return new Promise((resolve, reject) => {\r\n    Create_Axios(GetToken_URL(SiteUrl, Ref_Token)).get().then((response) => {\r\n      if (response && response.data && response.data.access_token) {\r\n        resolve(response.data.access_token)\r\n      }else {\r\n        resolve(null)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nfunction checkRenew_AccessToken(SiteUrl, Ref_Token, Acc_Token=null) {\r\n  return new Promise((resolve, reject) => {\r\n    if (Acc_Token) {\r\n      Create_Axios(GetCheckToken_URL(SiteUrl),Acc_Token).get().then((response) => {\r\n        if (response.status === 200){\r\n          resolve(Acc_Token)\r\n        } else {\r\n          resolve(getAccessToken(SiteUrl, Ref_Token))\r\n        }\r\n      })\r\n    }else {\r\n      resolve(getAccessToken(SiteUrl, Ref_Token))\r\n    }\r\n  })\r\n}\r\n\r\nfunction fetch_AutoPig(SiteUrl, Ref_Token, limit, SystemId=1, starttime=null, offset=null, lastid=null, Acc_Token=null) {\r\n  return new Promise((resolve, reject) => {\r\n    checkRenew_AccessToken(SiteUrl, Ref_Token, Acc_Token).then((Token)=>{\r\n      if (Token) {\r\n        var baseURL = GetConsumtionData_URL(SiteUrl,700, SystemId, offset, limit, starttime, null, lastid)\r\n        Create_Axios(baseURL, Token).get().then((response)=>{\r\n          if (response && response.data) {\r\n            resolve({...response.data, token:Token})\r\n          } else {\r\n            resolve(null)\r\n          }\r\n        }).catch(error => {\r\n          console.log(\"fetch AutoPig Error: \", error);\r\n          resolve(null)\r\n        })\r\n      }else {\r\n        resolve(null)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nexport const consysService = {\r\n  fetch_AutoPig,\r\n}\r\n","import { Platform, Alert } from 'react-native'\r\nimport { buffers, eventChannel } from 'redux-saga'\r\nimport { put, call, fork, take, cancelled, cancel, actionChannel, race, select } from 'redux-saga/effects'\r\n\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\nimport { firebaseService } from '../../Services/FirebaseService'\r\nimport { consysService } from '../../Services/ConsysService'\r\n\r\nvar auth, messaging, database, firebase;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  messaging = require( '@react-native-firebase/messaging').default;\r\n  database = require('@react-native-firebase/database').default;\r\n  //#endregion\r\n} else {\r\n  console.log(\"firebase load\", Platform.OS)\r\n  //#region Web Version imports\r\n  var _firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n  require('firebase/messaging').default;\r\n  require('firebase/database').default;\r\n\r\n  firebase = _firebase;\r\n  \r\n  if (!firebase.apps.length) {\r\n    console.log(\"Starting\")\r\n    var Constants = require('expo-constants').default;\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    _firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }\r\n  \r\n  auth = _firebase.auth;\r\n  if (_firebase.messaging.isSupported()) {\r\n    messaging = _firebase.messaging;\r\n  }\r\n  database = _firebase.database;\r\n  console.log(\"Started\")\r\n  //#endregion\r\n}\r\n\r\nimport { UserStates, DataRefs, Actions } from '../../Stores/Firebase/Selectors'\r\n\r\nexport function* firebaseStartup() {\r\n  console.log(\"Starting firebase saga\")\r\n  //Check and setup Firebase and permissions\r\n  yield put(FirebaseActions.setFirebaseError(null))\r\n\r\n  /*console.log(\"test\")\r\n  if (Platform.OS !== 'ios' && Platform.OS !== 'android') {\r\n    console.log(\"Starting\")\r\n    console.log(Constants.manifest.web.config.firebase)\r\n    firebase.initializeApp(Constants.manifest.web.config.firebase);\r\n  }*/\r\n\r\n  const permitError = yield call(firebaseService.requestUserPermission)\r\n  if (permitError) {\r\n    yield put(FirebaseActions.fetchFailure(permitError))\r\n  }else {\r\n    console.log(\"Starting handlers\")\r\n    //yield put(FirebaseActions.firebaseIsLoading(true))\r\n    yield fork(handleAuthState)\r\n    yield fork(handleActions)\r\n    console.log(\"auth & actions\")\r\n\r\n    if (messaging && messaging.isSupported()) {\r\n      if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n        yield fork(onMessageHandler)\r\n        yield fork(onBackgroundMessageHandler)\r\n      }\r\n      else {\r\n        yield fork(onMessageHandler)\r\n        yield fork(onBackgroundMessageHandler)\r\n      }\r\n    }\r\n\r\n    //var FirebaseToken = yield call(firebaseService.requestFirebaseToken);\r\n    //console.log('Firebase Token: ', FirebaseToken);\r\n    \r\n    //yield fork(testmessage,FirebaseToken)\r\n  }\r\n\r\n  console.log('Firebase Startup : Done');\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    console.log('Firebase will disable yellow box debug')\r\n    console.disableYellowBox = true;\r\n  }\r\n}\r\n\r\n//Somehow works ??? but should only work at server hosting XMPP, try firebase functions insted if nessasary\r\n//TODO: check this more... SendNotification to device\r\n//it seams to work ... but slow ???\r\n/*function* testmessage(token) {\r\n  if (messaging) {\r\n    ///////\r\n    messaging().sendMessage({\r\n        to: '11111111111111@fcm.googleapis.com',\r\n        messageId: 'test1',\r\n        messageType: 'test2',\r\n        notification: {\r\n            title: 'Foo',\r\n            body: 'Bar',\r\n        }\r\n      });\r\n    ///////\r\n      //to: 'worker@agrisys.dk',\r\n    var message = {\r\n      to: token,\r\n      messageId: 'test1',\r\n      messageType: 'test2',\r\n      notification: {\r\n          title: 'Foo',\r\n          body: 'Bar',\r\n      }\r\n    }\r\n    messaging().sendMessage(message).then(msg => {\r\n      console.log(msg)\r\n    })\r\n  }\r\n}*/\r\n\r\nexport function* handleAuthState() {\r\n  const authChannel = yield eventChannel((emit) => {\r\n    const subscription = auth().onAuthStateChanged((user) => {\r\n      if (user == null){\r\n        emit(\"NONE\")\r\n      }else {\r\n        emit(user)\r\n      }\r\n    })\r\n    return () => {\r\n      subscription()\r\n    };\r\n  }, buffers.expanding(1))\r\n\r\n  try {\r\n    for (;;) {\r\n      const newAuth = yield take(authChannel)\r\n      var firebaseUser = newAuth === \"NONE\"?null:newAuth;\r\n      if (firebaseUser) {\r\n        const userData = yield call(firebaseService.actionStarting, DataRefs.USERSDATA, Actions.FETCH, {UserId: firebaseUser.uid})\r\n        if (userData.data) {\r\n          firebaseUser.farms = userData.data.data.farms\r\n          firebaseUser.state = userData.data.data.state\r\n          yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: firebaseUser}))\r\n          //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: userData.data}))    //TODO: mabye moved to firebaseUser..\r\n        }\r\n      } else {\r\n        yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FIREBASEUSER, data: {}}))\r\n        //yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.USERSDATA, data: {}}))    //TODO: mabye moved to firebaseUser..\r\n      }\r\n    }\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      authChannel.close()\r\n    }\r\n  }\r\n}\r\n\r\nexport function* handleActions() {\r\n  const channel = yield actionChannel([\r\n    'ACTION_STARTING',\r\n  ])\r\n\r\n  for (;;) {\r\n    const action: ACTION_STARTING = yield take(channel)\r\n\r\n    //console.log(action.ref, action.action, action.params)\r\n\r\n    if (Object.values(Actions).includes(action.action)) {\r\n      if (action.ref === DataRefs.CONSYS) {\r\n        const FirebaseUser = yield select((state) => state.firebase.firebaseUser);\r\n        if (FirebaseUser && FirebaseUser.farms) {\r\n          const FarmsData = yield select((state) => state.firebase.localDataStore.farms);\r\n          if (FarmsData && FarmsData[Object.keys(FirebaseUser.farms)[0]]) {\r\n            const FarmData = FarmsData[Object.keys(FirebaseUser.farms)[0]]\r\n            if (FarmData.site && FarmData.refToken) {\r\n              var Token = FarmData.token?FarmData.token:null\r\n              var Params = action.params\r\n\r\n              const ScaleData = yield call(consysService.fetch_AutoPig, FarmData.site,FarmData.refToken, Params.limit, Params.sysId, Params.start, Params.offset, Params.lastId, Token)\r\n              if (ScaleData.result === \"OK\"){\r\n                console.log(ScaleData)\r\n                if (ScaleData.token) {\r\n                  FarmData.token = ScaleData.token\r\n                  yield put(FirebaseActions.dataFetchSuccess({type:Actions.UPDATE, path:DataRefs.FARMS, data: {FarmData}}))\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      else if (Object.values(DataRefs).includes(action.ref)) {\r\n        const FirebaseUser = yield select((state) => state.firebase.firebaseUser);\r\n        if (action.action != Actions.SIGN && FirebaseUser && FirebaseUser.farms) {\r\n          if (!action.params) action.params = {}\r\n          if (!action.params.FarmId) action.params.FarmId = [Object.keys(FirebaseUser.farms)[0]]\r\n        }\r\n\r\n        const NewData = yield call(firebaseService.actionStarting, action.ref, action.action, action.params)\r\n        if (NewData && (NewData.error || NewData.viewError)) {\r\n          yield put(FirebaseActions.fetchFailure(NewData.error))\r\n          yield put(FirebaseActions.setViewError(NewData.viewError))\r\n        } else {\r\n          //console.log(\"resCall: \", NewData)\r\n          if (NewData && NewData.hasOwnProperty(\"type\") && NewData.hasOwnProperty(\"path\") && NewData.hasOwnProperty(\"data\")) {\r\n            yield put(FirebaseActions.dataFetchSuccess(NewData))\r\n          }\r\n          else {\r\n            //console.log(\"Old Path: \", action.ref, action.action, params, NewData)\r\n            yield put(FirebaseActions.fetchSuccess({localDataStore:NewData}))\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Foreground State\r\nexport function* onMessageHandler() {\r\n  if (messaging) {\r\n    const onMessageChannel = yield eventChannel((emit) => {\r\n      const messageListener = messaging().onMessage((remoteMessage) => {\r\n        //console.log(\"message ? \", remoteMessage);\r\n        emit(remoteMessage);\r\n      });\r\n      return () => {\r\n        messageListener();\r\n      };\r\n    }, buffers.expanding(1));\r\n\r\n    try {\r\n      for (;;) {\r\n        const remoteMessage = yield take(onMessageChannel)\r\n        console.log(\"New Firebase message: \", remoteMessage)\r\n        if (remoteMessage.notification && remoteMessage.notification.title && remoteMessage.notification.body){\r\n          yield call(firebaseService.wrappedAlert, remoteMessage.notification.title, remoteMessage.notification.body, \"Ok\", false)\r\n        }else {\r\n          console.log(\"New Firebase data message: \", remoteMessage)\r\n        }\r\n      }\r\n    } finally {\r\n      if (yield cancelled()) {\r\n        onMessageChannel.close()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Notification Handler for then App is in Background & Quit state\r\nexport function* onBackgroundMessageHandler() {\r\n  if ((Platform.OS === 'ios' || Platform.OS === 'android') && messaging) {\r\n    // Assume a message-notification contains a \"type\" property in the data payload of the screen to open\r\n    messaging().onNotificationOpenedApp(remoteMessage => {\r\n      console.log(\r\n        'Notification caused app to open from background state:',\r\n        remoteMessage.notification,\r\n      );\r\n      //NavigationService.navigate(remoteMessage.data.type); // this is not view..\r\n    });\r\n\r\n    const onMessageChannel = yield eventChannel((emit) => {\r\n      messaging().setBackgroundMessageHandler((remoteMessage) => {\r\n        emit(remoteMessage);\r\n      });\r\n      return () => {\r\n        //\r\n      };\r\n    }, buffers.expanding(1));\r\n\r\n    try {\r\n      for (;;) {\r\n        const remoteMessage = yield take(onMessageChannel)\r\n        console.log(\"New background Firebase message: \", remoteMessage)\r\n      }\r\n    } finally {\r\n      if (yield cancelled()) {\r\n        onMessageChannel.close()\r\n      }\r\n    }\r\n  }\r\n}","import { takeLatest, all, take } from 'redux-saga/effects'\r\n\r\nimport { StartupTypes } from '../Stores/Startup/Actions'\r\nimport { ExampleTypes } from '../Stores/Example/Actions'\r\nimport { DeviceTypes } from '../Stores/Device/Actions'\r\nimport { FirebaseTypes } from '../Stores/Firebase/Actions'\r\n\r\nimport * as StartupSaga from './StartupSaga'\r\nimport * as ExampleSaga from './Example/ExampleSaga'\r\nimport * as DeviceSaga from './Device/DeviceSaga'\r\nimport * as FirebaseSaga from './Firebase/FirebaseSaga'\r\n\r\nexport default function* root(sagaArgs) {\r\n  yield all([\r\n    /**\r\n     * @see https://redux-saga.js.org/docs/basics/UsingSagaHelpers.html\r\n     */\r\n    // Run the startup saga when the application starts\r\n    takeLatest(StartupTypes.STARTUP, StartupSaga.startup), //Initer\r\n    \r\n\r\n    //Example\r\n    takeLatest(ExampleTypes.FETCH_USER, ExampleSaga.fetchUser), // Call `fetchUser()` when a `FETCH_USER` action is triggered\r\n    \r\n    //Device Main Saga\r\n    takeLatest(DeviceTypes.DEVICE_STARTUP, DeviceSaga.deviceStartup), //Initer\r\n\r\n    takeLatest(DeviceTypes.CONNECT_DEVICE, DeviceSaga.connectDevice),\r\n    takeLatest(DeviceTypes.DISCONNECT_DEVICE, DeviceSaga.disconnectDevice),\r\n    takeLatest(DeviceTypes.READ_DEVICE_DATA, DeviceSaga.readDeviceData),\r\n\r\n    takeLatest(DeviceTypes.FETCH_DEVICE, DeviceSaga.fetchDevice, sagaArgs),\r\n\r\n    //BLE Saga\r\n    takeLatest(DeviceTypes.BLE_STARTUP, DeviceSaga.BLE.bleStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLE_SCAN, DeviceSaga.BLE.startBleScan),\r\n    takeLatest(DeviceTypes.STOP_BLE_SCAN, DeviceSaga.BLE.stopBleScan),\r\n    takeLatest(DeviceTypes.READ_BLE_DEVICE_DATA, DeviceSaga.BLE.readBleDeviceData, sagaArgs),\r\n    \r\n    //Android BlueThooth Saga\r\n    takeLatest(DeviceTypes.BLUETOOTH_STARTUP, DeviceSaga.BlueTooth.bluetoothStartup, sagaArgs), //Initer\r\n    takeLatest(DeviceTypes.START_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.startBluetoothScan),\r\n    takeLatest(DeviceTypes.STOP_BLUETOOTH_SCAN, DeviceSaga.BlueTooth.stopBluetoothScan),\r\n    takeLatest(DeviceTypes.BLUETOOTH_SCAN_ABLE, DeviceSaga.BlueTooth.bluetoothScanAble, sagaArgs),\r\n    takeLatest(DeviceTypes.READ_BLUE_DEVICE_DATA, DeviceSaga.BlueTooth.readBlueDeviceData, sagaArgs),\r\n    \r\n\r\n    //Firebase Saga\r\n    takeLatest(FirebaseTypes.FIREBASE_STARTUP, FirebaseSaga.firebaseStartup), //Initer\r\n  ])\r\n}\r\n","/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n}\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\nimport { createReducer } from 'reduxsauce'\r\nimport { ExampleTypes } from './Actions'\r\n\r\nexport const fetchUserLoading = (state) => ({\r\n  ...state,\r\n  userIsLoading: true,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserSuccess = (state, { user }) => ({\r\n  ...state,\r\n  user: user,\r\n  userIsLoading: false,\r\n  userErrorMessage: null,\r\n})\r\n\r\nexport const fetchUserFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  user: {},\r\n  userIsLoading: false,\r\n  userErrorMessage: errorMessage,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const reducer = createReducer(INITIAL_STATE, {\r\n  [ExampleTypes.FETCH_USER_LOADING]: fetchUserLoading,\r\n  [ExampleTypes.FETCH_USER_SUCCESS]: fetchUserSuccess,\r\n  [ExampleTypes.FETCH_USER_FAILURE]: fetchUserFailure,\r\n})\r\n","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n  bleState: State.PoweredOff, // status of the BLE manger\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from '../Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Managers States\r\n}","import { ConnectionState, ConnectionMethode, ScannerState } from './Selectors'\r\nimport { State } from 'react-native-ble-plx';\r\n\r\n//BLE Saga's\r\nimport { INITIAL_STATE as BLE_INITIAL_STATE } from './BLE/InitialState'\r\n//BlueTooth Saga's\r\nimport { INITIAL_STATE as BLUETOOTH_INITIAL_STATE} from './BlueTooth/InitialState'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  //Device Main Info\r\n  deviceIsLoading: false,\r\n  deviceErrorMessage: null,\r\n\r\n  //Device list Info... (only one ???)\r\n  scannerState: ScannerState.IDLE, // status of BLE scanner\r\n  DeviceList: [], //An Array of Discovered Devices\r\n\r\n  //Connection info...\r\n  connectedDevice: {}, // the current connected device element\r\n  connectionState: ConnectionState.DISCONNECTED, // the status of the current device connection\r\n  connectionMethode: ConnectionMethode.NONE,  //the current connected Methode\r\n\r\n  deviceData: {}, // Something\r\n\r\n  //BLE specefic\r\n  ...BLE_INITIAL_STATE,\r\n  //BlueTooth specefic\r\n  ...BLUETOOTH_INITIAL_STATE,\r\n}","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BleTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const bleStateUpdated = (state, {bleState}) => {\r\n  return({\r\n    ...state,\r\n    bleState: bleState,\r\n  })\r\n}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n  [BleTypes.BLE_STATE_UPDATED]: bleStateUpdated,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from '../Selectors'\r\nimport { BluetoothTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Managers...\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)\r\n","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\n\r\nimport { ConnectionState, ConnectionMethode } from './Selectors'\r\nimport { DeviceTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\n//BLE Saga's\r\nimport * as BLEReducers from './BLE/Reducers'\r\n//BlueTooth Saga's\r\nimport * as BluetoothReducers from './BlueTooth/Reducers'\r\n\r\nexport const setDeviceError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  deviceErrorMessage: errorMessage,\r\n})\r\n\r\nexport const scannerStateUpdated = (state, {scannerState}) => {\r\n  return({\r\n    ...state,\r\n    scannerState: scannerState,\r\n  })\r\n}\r\n\r\nexport const addDevice = (state, {device}) => {\r\n  if (state.DeviceList.some(Device => Device.id === device.id )) { //&& device.isConnectable)){\r\n    return({...state});\r\n  } else {\r\n    //device._manager = null; // Type.script Stringify ... not allowing function callback (fix see CreateStore.js)\r\n    var NewList = [...state.DeviceList];\r\n    NewList.push(device);\r\n\r\n    return({\r\n      ...state,\r\n      DeviceList: NewList,\r\n    });\r\n  }\r\n}\r\n\r\nexport const removeDevice = (state, {device}) => {\r\n  var NewList = [...state.DeviceList];\r\n  for( var i = 0; i < NewList.length; i++){ \r\n    if ( NewList[i] === device) {\r\n      NewList.splice(i, 1); \r\n    }\r\n  }\r\n\r\n  return ({\r\n    ...state,\r\n    DeviceList: NewList,\r\n  });\r\n}\r\n\r\nexport const clearDevices = (state) => ({\r\n  ...state,\r\n  DeviceList: [],\r\n  deviceData: {}\r\n})\r\n\r\nexport const connectedDeviceUpdated = (state, {connectedDevice}) => {\r\n  if (!connectedDevice) {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice,\r\n      //deviceData: {}\r\n    })\r\n  } else {\r\n    return ({\r\n      ...state,\r\n      connectedDevice: connectedDevice\r\n    })\r\n  }\r\n}\r\n\r\n// Connections *******************************************\r\nexport const connectionStateUpdated = (state, {connectionState}) => ({\r\n  ...state,\r\n  connectionState: connectionState\r\n})\r\nexport const connectionMethodeUpdated = (state, {connectionMethode}) => ({\r\n  ...state,\r\n  connectionMethode: connectionMethode\r\n})\r\n\r\nexport const setDeviceData = (state, {data}) => ({\r\n  ...state,\r\n  deviceData: data\r\n})\r\nexport const updateDeviceData = (state, {data}) => {\r\n  const newData = {...state.deviceData, ...data}\r\n  return({\r\n  ...state,\r\n  deviceData: newData\r\n})}\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [DeviceTypes.SET_DEVICE_ERROR]: setDeviceError,\r\n  \r\n  //Managers...\r\n  [DeviceTypes.SCANNER_STATE_UPDATED]: scannerStateUpdated,\r\n\r\n  [DeviceTypes.ADD_DEVICE]: addDevice,\r\n  [DeviceTypes.REMOVE_DEVICE]: removeDevice,\r\n  [DeviceTypes.CLEAR_DEVICES]: clearDevices,\r\n\r\n  [DeviceTypes.CONNECTED_DEVICE_UPDATED]: connectedDeviceUpdated,\r\n  \r\n  //Connection...\r\n  [DeviceTypes.CONNECTION_STATE_UPDATED]: connectionStateUpdated,\r\n  [DeviceTypes.CONNECTION_METHODE_UPDATED]: connectionMethodeUpdated,\r\n\r\n  //Data...\r\n  [DeviceTypes.SET_DEVICE_DATA]: setDeviceData,\r\n  [DeviceTypes.UPDATE_DEVICE_DATA]: updateDeviceData,\r\n\r\n  //BLE Saga\r\n  ...BLEReducers.HANDLERS,\r\n\r\n  //Android BlueTooth Saga\r\n  ...BluetoothReducers.HANDLERS,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","/**\r\n * Reducers specify how the application's state changes in response to actions sent to the store.\r\n *\r\n * @see https://redux.js.org/basics/reducers\r\n */\r\n\r\nimport { createReducer } from 'reduxsauce'\r\nimport { append } from 'funcadelic';\r\n\r\nimport { Actions, DataRefs } from './Selectors'\r\nimport { FirebaseTypes } from './Actions'\r\n\r\nimport { INITIAL_STATE } from './InitialState'\r\n\r\nexport const firebaseIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  firebaseIsLoading: loadingstate,\r\n})\r\n\r\nexport const setFirebaseError = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseErrorMessage: errorMessage,\r\n})\r\n\r\nexport const setViewError = (state, { errorMessage }) => {\r\n  return({\r\n    ...state,\r\n    viewError: errorMessage,\r\n  })\r\n}\r\n\r\nexport const viewIsLoading = (state, { loadingstate }) => ({\r\n  ...state,\r\n  viewIsLoading: loadingstate,\r\n})\r\n\r\nexport const setCurrentData = (state, {data}) => {\r\n  return({\r\n    ...state,\r\n    currentData: data\r\n  })\r\n}\r\n\r\nfunction IDGenerate(){\r\n  return Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\nexport const actionStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nexport const fetchStarting = (state) => ({\r\n  ...state,\r\n  //firebaseIsLoading: true,\r\n  firebaseErrorMessage: null,\r\n})\r\n\r\nfunction mergeDeep(target, source) {\r\n  const isObject = (obj) => obj && typeof obj === 'object';\r\n\r\n  if (!isObject(target) || !isObject(source)) {\r\n    return source;\r\n  }\r\n\r\n  Object.keys(source).forEach(key => {\r\n    const targetValue = target[key];\r\n    const sourceValue = source[key];\r\n\r\n    if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\r\n      //target[key] = targetValue.concat(sourceValue);  //Mercing value of arrays would creates doubles.. like curve data..\r\n    } else if (isObject(targetValue) && isObject(sourceValue)) {\r\n      target[key] = mergeDeep(Object.assign({}, targetValue), sourceValue);\r\n    } else {\r\n      target[key] = sourceValue;\r\n    }\r\n  });\r\n\r\n  return target;\r\n}\r\n\r\nexport const dataFetchSuccess = (state, { params }) => {\r\n  const {type, path, data} = params\r\n  var NewDataStore = state.localDataStore;\r\n  var NewFirebaseUser = {...state.firebaseUser};\r\n  switch(type) {\r\n    case Actions.UPDATE:\r\n    case Actions.ADD:\r\n      var newData = {...data}\r\n      if (path === DataRefs.FIREBASEUSER) {\r\n        if (data && data.data) newData = {...data.data}\r\n        if (data && data._user) {\r\n          Object.keys(data._user).forEach(element => {\r\n            newData[element] = data._user[element]\r\n          })\r\n          delete newData._user\r\n          delete newData._auth\r\n        }\r\n        if (newData && Object.keys(newData).length > 0) {\r\n          var Values = [\"displayName\", \"name\", \"lastN\", \"email\", \"emailVerified\", \"address\", \"country\", \"farms\", \"isAnonymous\", \"phoneNumber\", \"photoURL\", \"refreshToken\", \"state\", \"uid\"]\r\n          Object.keys(newData).forEach(element => {\r\n            for (var index = 0; index < Values.length; index++) {\r\n              if (Values[index] === element) {\r\n                NewFirebaseUser[element] = newData[element]\r\n                break;\r\n              }\r\n            }\r\n          });\r\n        }else {\r\n          NewFirebaseUser = newData;\r\n        }\r\n      }\r\n      if (!data) break;\r\n      switch(path){\r\n        case DataRefs.FIREBASEUSER:\r\n          //Done above\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          Object.keys(newData).forEach(element => {\r\n            if (!NewDataStore.userData) NewDataStore.userData = {};\r\n            NewDataStore.userData[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.users) NewDataStore.users = {};\r\n          if (data.data) newData = data.data\r\n          if (newData.users) newData = newData.users\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.users[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.FARMS:\r\n          if (!NewDataStore.farms) NewDataStore.farms = {};\r\n          if (data.farms) newData = data.farms\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.farms[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.BATCHS:\r\n          if (!NewDataStore.batchs) NewDataStore.batchs = {};\r\n          if (data.batchs) newData = data.batchs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.batchs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.SECTIONS:\r\n          if (!NewDataStore.sections) NewDataStore.sections = {};\r\n          if (data.sections) newData = data.sections\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.sections[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PENS:\r\n          if (!NewDataStore.pens) NewDataStore.pens = {};\r\n          if (data.pens) newData = data.pens\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pens[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.PIGS:\r\n          if (!NewDataStore.pigs) NewDataStore.pigs = {};\r\n          if (data.pigs) newData = data.pigs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.pigs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.COMMENTS:\r\n          if (!NewDataStore.comments) NewDataStore.comments = {};\r\n          if (data.comments) newData = data.comments\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.comments[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.GRAPH:\r\n          if (!NewDataStore.graphs) NewDataStore.graphs = {};\r\n          if (data.graphs) newData = data.graphs\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.graphs[element] = newData[element]\r\n          });\r\n          break;\r\n        case DataRefs.WEIGHING:\r\n          if (!NewDataStore.weighings) NewDataStore.weighings = {};\r\n          if (data.weighings) newData = data.weighings\r\n          Object.keys(newData).forEach(element => {\r\n            NewDataStore.weighings[element] = newData[element]\r\n          });\r\n          break;\r\n      }\r\n      //console.log(path, data)\r\n      break;\r\n    case Actions.CLEAR:\r\n      switch(path){\r\n        case DataRefs.USERS:\r\n          if (!NewDataStore.userData) NewDataStore.userData = {};\r\n          NewDataStore.userData.action = \"CLEAR\";\r\n          break;\r\n        case DataRefs.USERSDATA:\r\n          console.log(\"CLEAR\")\r\n          if (NewDataStore.batchs) NewDataStore.batchs = {}\r\n          if (NewDataStore.sections) NewDataStore.sections = {}\r\n          if (NewDataStore.pens) NewDataStore.pens = {}\r\n          if (NewDataStore.pigs) NewDataStore.pigs = {}\r\n          if (NewDataStore.graphs) NewDataStore.graphs = {}\r\n          if (NewDataStore.weighings) NewDataStore.weighings = {}\r\n          if (NewDataStore.userData && NewDataStore.userData.action) {\r\n            NewDataStore.userData.action = {}\r\n            //NewDataStore.userData = {}\r\n          }\r\n          break;\r\n      }\r\n      break;\r\n    default:\r\n      console.log(\"DataFetch Not created / default\")\r\n      break;\r\n  }\r\n  return({\r\n    ...state,\r\n    firebaseUser: NewFirebaseUser,\r\n    localDataStore: NewDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchSuccess = (state, { data }) => {\r\n  var newlocalDataStore = {...state.localDataStore}\r\n  var newState = {...state}\r\n\r\n  if (data) {\r\n    let {localDataStore, ..._newState} = data;\r\n\r\n    if (localDataStore) {\r\n      if (Object.keys(localDataStore).length !== 0) {\r\n        newlocalDataStore = mergeDeep(localDataStore, newlocalDataStore)\r\n      }\r\n      else {\r\n        newlocalDataStore = {...localDataStore}\r\n      }\r\n    }\r\n    newState = append(state,_newState)\r\n  }\r\n  return({\r\n    ...newState,\r\n    localDataStore: newlocalDataStore,\r\n    firebaseIsLoading: false,\r\n    firebaseErrorMessage: null,\r\n    viewIsLoading: false,\r\n  })\r\n}\r\n\r\nexport const fetchFailure = (state, { errorMessage }) => ({\r\n  ...state,\r\n  firebaseIsLoading: false,\r\n  firebaseErrorMessage: errorMessage,\r\n  viewIsLoading: false,\r\n})\r\n\r\n/**\r\n * @see https://github.com/infinitered/reduxsauce#createreducer\r\n */\r\nexport const HANDLERS = {\r\n  //Response...\r\n  [FirebaseTypes.FIREBASE_IS_LOADING]: firebaseIsLoading,\r\n  [FirebaseTypes.SET_FIREBASE_ERROR]: setFirebaseError,\r\n\r\n  [FirebaseTypes.SET_VIEW_ERROR]: setViewError,\r\n  [FirebaseTypes.VIEW_IS_LOADING]: viewIsLoading,\r\n\r\n  [FirebaseTypes.SET_CURRENT_DATA]: setCurrentData,\r\n\r\n  [FirebaseTypes.ACTION_STARTING]: actionStarting,\r\n  [FirebaseTypes.FETCH_STARTING]: fetchStarting,\r\n  [FirebaseTypes.DATA_FETCH_SUCCESS]: dataFetchSuccess,\r\n  [FirebaseTypes.FETCH_SUCCESS]: fetchSuccess,\r\n  [FirebaseTypes.FETCH_FAILURE]: fetchFailure,\r\n}\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, HANDLERS)","import { UserStates } from './Selectors'\r\n\r\n/**\r\n * The initial values for the redux state.\r\n */\r\nexport const INITIAL_STATE = {\r\n  firebaseIsLoading: false,     //SystemLoading\r\n  firebaseErrorMessage: null,   //SystemError\r\n\r\n  firebaseUser: null,           //UserData\r\n\r\n  localDataStore: {},           //Full DataStore\r\n  currentData: null,            //State DataStore\r\n\r\n  viewIsLoading: false,         //View / state - waiting for action\r\n  viewError: null,              //View / state - error display\r\n}","/**\r\n * This file contains the application's colors.\r\n *\r\n * Define color here instead of duplicating them throughout the components.\r\n * That allows to change them more easily later on.\r\n */\r\n\r\nexport default {\r\n  transparent: 'rgba(0,0,0,0)',\r\n  white: '#ffffff',\r\n  gray: '#a6a6a6',\r\n\r\n  text: '#4a4a49',\r\n  secountText: '#ffffff',\r\n\r\n  primary: '#a3b9cf',\r\n\r\n  success: '#03a489',\r\n  error: '#dc3545',\r\n  overest: '#4cafea',\r\n  pigpink: '#FFAA95',\r\n\r\n  input: '#86939e',\r\n\r\n  AgriGreen: '#03a489',\r\n  AgriDarkblue: '#4463ab',\r\n  AgriLightblue: '#a3b9cf',\r\n  AgriDark: '#4a4a49',\r\n}\r\n","import { StyleSheet } from 'react-native'\r\n\r\nconst size = {\r\n  h1: 38,\r\n  h2: 34,\r\n  h3: 30,\r\n  input: 18,\r\n  regular: 17,\r\n  medium: 14,\r\n  small: 12,\r\n}\r\n\r\nexport default {\r\n  h1: {\r\n    fontSize: size.h1,\r\n  },\r\n  h2: {\r\n    fontSize: size.h2,\r\n  },\r\n  h3: {\r\n    fontSize: size.h3,\r\n  },\r\n  normal: {\r\n    fontSize: size.regular,\r\n  },\r\n}","/**\r\n * This file contains metric values that are global to the application.\r\n */\r\n\r\n// Examples of metrics you can define:\r\nexport const tiny = 5\r\nexport const small = tiny * 2 // 10\r\nexport const normal = tiny * 3 // 15\r\nexport const medium = normal * 2 // 30\r\n\r\nexport default {\r\n  tiny,\r\n  small,\r\n  normal,\r\n  medium,\r\n  \r\n  tinyBottomMargin: {\r\n    marginBottom: tiny,\r\n  },\r\n  smallBottomMargin: {\r\n    marginBottom: small,\r\n  },\r\n  bottomMargin: {\r\n    marginBottom: normal,\r\n  },\r\n  mediumBottomMargin: {\r\n    marginBottom: medium,\r\n  },\r\n\r\n  tinyVerticalMargin: {\r\n    marginVertical: tiny,\r\n  },\r\n  smallVerticalMargin: {\r\n    marginVertical: small,\r\n  },\r\n  verticalMargin: {\r\n    marginVertical: normal,\r\n  },\r\n  mediumVerticalMargin: {\r\n    marginVertical: medium,\r\n  },\r\n\r\n  tinyHorizontalMargin: {\r\n    marginHorizontal: tiny,\r\n  },\r\n  smallHorizontalMargin: {\r\n    marginHorizontal: small,\r\n  },\r\n  horizontalMargin: {\r\n    marginHorizontal: normal,\r\n  },\r\n  mediumHorizontalMargin: {\r\n    marginHorizontal: medium,\r\n  },\r\n\r\n  tinyHorizontalPadding: {\r\n    paddingHorizontal: tiny,\r\n  },\r\n  smallHorizontalPadding: {\r\n    paddingHorizontal: small,\r\n  },\r\n  horizontalPadding: {\r\n    paddingHorizontal: normal,\r\n  },\r\n  mediumHorizontalPadding: {\r\n    paddingHorizontal: medium,\r\n  },\r\n\r\n  tinyVerticalPadding: {\r\n    paddingVertical: tiny,\r\n  },\r\n  smallVerticalPadding: {\r\n    paddingVertical: small,\r\n  },\r\n  verticalPadding: {\r\n    paddingVertical: normal,\r\n  },\r\n  mediumVerticalPadding: {\r\n    paddingVertical: medium,\r\n  },\r\n}\r\n","/**\r\n * Images should be stored in the `App/Images` directory and referenced using variables defined here.\r\n */\r\n\r\nexport default {\r\n  Home: require('../Assets/Images/Home.png'),\r\n\r\n  DashBoard: require('../Assets/Images/Dashboard.png'),\r\n  System: require('../Assets/Images/System.png'),\r\n  Curves: require('../Assets/Images/Feed-Curves.png'),\r\n  GCurves: require('../Assets/Images/Growth-curve.png'),\r\n\r\n  User: require('../Assets/Images/User.png'),\r\n  Sow: require('../Assets/Images/Sow.png'),\r\n  Section: require('../Assets/Images/Section.png'),\r\n  Pens: require('../Assets/Images/Area_Colour.png'),\r\n  AutoPig: require('../Assets/Images/AutoPig.png'),\r\n  Feed: require('../Assets/Images/Feed-Components.png'),\r\n\r\n  Haxa_globe: require('../Assets/Images/Hexagon-globe.png'),\r\n  Hexa_icon: require('../Assets/Images/Hexa-icon.png'),\r\n  Logo: require('../Assets/Images/Logo.png'),\r\n\r\n  logo: require('../Assets/Images/TOM.png'),\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  //********************** col sets */\r\n  column: {\r\n    flexDirection: 'column',\r\n  },\r\n  colMain: {\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  colCenter: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  colCross: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  columnReverse: {\r\n    flexDirection: 'column-reverse',\r\n  },\r\n\r\n  //********************** Row sets */\r\n  row: {\r\n    flexDirection: 'row',\r\n  },\r\n  rowMain: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCenter: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  rowCross: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  rowReverse: {\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Cross sets */\r\n  center: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  crossCenter: {\r\n    alignItems: 'center',\r\n  },\r\n  crossEnd: {\r\n    alignItems: 'flex-end',\r\n  },\r\n  crossStart: {\r\n    alignItems: 'flex-start',\r\n  },\r\n  crossStretch: {\r\n    alignItems: 'stretch',\r\n  },\r\n\r\n  //********************** Fill sets */\r\n  fill: {\r\n    flex: 1,\r\n  },\r\n  fillCenter: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillCol: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n  },\r\n  fillColCenter: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColCross: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  fillColMain: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n  },\r\n  fillColReverse: {\r\n    flex: 1,\r\n    flexDirection: 'column-reverse',\r\n  },\r\n  fillRow: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n  },\r\n  fillRowCenter: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowCross: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  fillRowMain: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n  },\r\n  fillRowReverse: {\r\n    flex: 1,\r\n    flexDirection: 'row-reverse',\r\n  },\r\n\r\n  //********************** Size sets */\r\n  fullSize: {\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  halvWidth: {\r\n    width: '50%',\r\n  },\r\n  midWidth: {\r\n    width: '75%',\r\n  },\r\n  fullWidth: {\r\n    width: '100%',\r\n  },\r\n\r\n  //********************** Main sets */\r\n  mainCenter: {\r\n    justifyContent: 'center',\r\n  },\r\n  mainEnd: {\r\n    justifyContent: 'flex-end',\r\n  },\r\n  mainSpaceAround: {\r\n    justifyContent: 'space-around',\r\n  },\r\n  mainSpaceBetween: {\r\n    justifyContent: 'space-between',\r\n  },\r\n  mainStart: {\r\n    justifyContent: 'flex-start',\r\n  },\r\n\r\n  //********************** Container sets */\r\n  mainContainer:{\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n  },\r\n  contentContainer:{\r\n    flex:1,\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    ...Metrics.mediumHorizontalMargin,\r\n    marginTop: Metrics.small,\r\n    ...Metrics.bottomMargin,\r\n  },\r\n  borderContainer: {\r\n    borderWidth: 1,\r\n    borderColor: '#000',\r\n    borderRadius: 15,\r\n    ...Metrics.tinyHorizontalPadding,\r\n    ...Metrics.tinyVerticalPadding,\r\n    maxWidth:450,\r\n    zIndex: 1,\r\n  },\r\n  textContainer:{\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n    alignItems: 'center',\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.small,\r\n    maxWidth:450,\r\n  },\r\n  loadingContainer: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n  logoContainer: {\r\n    width: '100%',\r\n    height: 220,\r\n  },\r\n\r\n  //**********************  */\r\n  backgroundReset: {\r\n    backgroundColor: Colors.transparent,\r\n  },\r\n\r\n  rotate90: {\r\n    transform: [{ rotate: '90deg' }],\r\n  },\r\n  rotate90Inverse: {\r\n    transform: [{ rotate: '-90deg' }],\r\n  },\r\n  mirror: {\r\n    transform: [{ scaleX: -1 }],\r\n  },\r\n\r\n  scrollSpaceAround: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-around',\r\n  },\r\n  scrollSpaceBetween: {\r\n    flexGrow: 1,\r\n    justifyContent: 'space-between',\r\n  },\r\n\r\n  selfStretch: {\r\n    alignSelf: 'stretch',\r\n  },\r\n\r\n  textCenter: {\r\n    textAlign: 'center',\r\n  },\r\n  textJustify: {\r\n    textAlign: 'justify',\r\n  },\r\n  textLeft: {\r\n    textAlign: 'left',\r\n  },\r\n  textRight: {\r\n    textAlign: 'right',\r\n  },\r\n};\r\n","/**\r\n * This file defines the base application styles.\r\n *\r\n * Use it to define generic component styles (e.g. the default text styles, default button styles...).\r\n */\r\nimport { StyleSheet } from 'react-native'\r\nimport { Colors, Fonts, Metrics, } from '../Theme'\r\n\r\nexport default {\r\n  button: {\r\n    backgroundColor: Colors.primary,\r\n    color: Colors.secountText,\r\n  },\r\n  buttonText: {\r\n    color: Colors.secountText,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n\r\n  navigationHeader:{\r\n    textAlign: 'center',\r\n    alignSelf:'center',\r\n    flexGrow:1,\r\n  }\r\n};\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, Image, Platform } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nlet messaging;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  messaging = require('@react-native-firebase/messaging').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/messaging').default;\r\n\r\n  messaging = firebase.messaging();\r\n  //#endregion\r\n}\r\n\r\nimport Style from './SplashScreenStyle'\r\nimport { Helpers, Images } from '../../Theme'\r\n\r\nclass SplashScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    /*this.state = {\r\n    }*/\r\n  }\r\n\r\n  getData(){\r\n    if (Platform.OS === \"android\" || Platform.OS === \"ios\"){\r\n      messaging().onNotificationOpenedApp(remoteMessage => {\r\n        console.log(\r\n          'Notification caused app to open from background state:',\r\n          remoteMessage.notification,\r\n        );\r\n        NavigationService.navigate(remoteMessage.data.type);\r\n      });\r\n\r\n      // Check whether an initial notification is available\r\n      messaging().getInitialNotification().then(remoteMessage => {\r\n        if (remoteMessage) {\r\n          console.log(\r\n            'Notification caused app to open from quit state:',\r\n            remoteMessage.notification,\r\n          );\r\n          NavigationService.navigate(remoteMessage.data.type); // e.g. \"Settings\"\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount(){\r\n    //this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Style.container]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    //setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SplashScreen);\r\n//export default SplashScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n})\r\n","import React from 'react'\r\nimport { Text, View } from 'react-native'\r\nimport { Helpers, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component with a deep link.\r\n */\r\nconst DeepLinkingScreen = () => (\r\n  <View style={[Helpers.fillCenter, Helpers.rowMain, Metrics.mediumHorizontalMargin]}>\r\n    <Text>\r\n      This is deep linking example screen which can be accessed using agrissysapp://deeplink scheme!\r\n    </Text>\r\n  </View>\r\n)\r\n\r\nexport default DeepLinkingScreen\r\n","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst Button = props => {\r\n  var TextView = [<Text style={[styles.text, props.textStyle]} key={0}>{props.Text}</Text>]\r\n\r\n  var ImageView = []\r\n  if (props.icon) {\r\n    var _Image = <Image style={Helpers.fullSize} source={props.icon} resizeMode={'contain'} />\r\n    ImageView = (\r\n      <View style={[styles.icon, props.iconStyle]}>\r\n        {_Image}\r\n      </View>\r\n    )\r\n  }\r\n  return (\r\n    <TouchableOpacity style={[styles.boxContainer, props.boxStyle]} onPress={props.onPress}>\r\n      {props.icon?(\r\n        <View style={[styles.button, props.buttonStyle, Helpers.rowCenter]}>\r\n          <View style={[Helpers.colCenter, Helpers.fill]}>\r\n            {TextView}\r\n          </View>\r\n            {ImageView}\r\n        </View>\r\n      ):(\r\n        <View style={[styles.button, props.buttonStyle]}>\r\n          {TextView}\r\n        </View>\r\n      )}\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  boxContainer:{\r\n    ...Helpers.center,\r\n    ...Metrics.tinyVerticalMargin,\r\n  },\r\n  button: {\r\n    borderRadius: 15,\r\n    ...Helpers.center,\r\n    ...Helpers.fullWidth,\r\n    ...Metrics.horizontalPadding,\r\n    ...ApplicationStyles.button,\r\n  },\r\n  text: {\r\n    ...ApplicationStyles.buttonText,\r\n    ...Metrics.verticalPadding,\r\n    ...Helpers.center,\r\n    textAlign:\"center\",\r\n  },\r\n  icon: {\r\n    ...Helpers.colCenter,\r\n    ...Metrics.smallVerticalMargin,\r\n    width: '25%', \r\n    height: 50,\r\n  },\r\n});\r\n\r\nexport default Button;","import React from 'react';\r\nimport { View, Text, Image} from 'react-native';\r\nimport Button from './Button'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst Button_Panel = props => {\r\n  const Texts = props.Texts;\r\n  const Images = props.Images;\r\n\r\n  const onPress = props.onPress;\r\n\r\n  var Buttons = []\r\n\r\n  Texts.forEach((element, index) => {\r\n    var image = null\r\n    if (Images && Images[index]){\r\n      image = Images[index]\r\n    }\r\n    Buttons.push(\r\n      <Button key={index} Text={element} icon={image}\r\n        iconStyle={props.iconStyle} itemStyle={props.itemStyle}\r\n        onPress={() => {\r\n          if (onPress) {\r\n            onPress({index: index, text: element})\r\n          }\r\n        }}/>\r\n    )\r\n  });\r\n\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:30}, props.style] }>\r\n      {Buttons}\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default Button_Panel;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, Image} from 'react-native';\r\n\r\nimport Button from './Button';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst TitleElement = props => {\r\n  return(\r\n    <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin,] }>\r\n      <Button Text={props.Text} icon={props.icon} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n        onPress={() => {\r\n          if (props.onPress){\r\n            props.onPress()\r\n          }\r\n        } }/>\r\n    </View>\r\n  )\r\n};\r\n\r\nexport default TitleElement;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text} from 'react-native';\r\nimport { ListItem } from 'react-native-elements'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst CustomListItem = props => {\r\n  const key = props.key? props.key : 0\r\n  return (\r\n    <ListItem key={key} containerStyle={[styles.listitem, {flexDirection:\"column\", borderRadius:0}, props.itemStyle]} button onPress={props.onPress}>\r\n      <ListItem.Content>\r\n        <ListItem.Title>{props.Title}</ListItem.Title>\r\n        {props.hasOwnProperty(\"Subtitle\") ? <ListItem.Subtitle>{props.Subtitle}</ListItem.Subtitle>\r\n        :(<></>)}\r\n      </ListItem.Content>\r\n    </ListItem>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  listitem: {\r\n    flex: 1,\r\n    ...Helpers.borderContainer,\r\n    ...Helpers.center,\r\n    backgroundColor: '#fff',\r\n    paddingVertical: 5,\r\n    paddingHorizontal: 5,\r\n  },\r\n});\r\n\r\nexport default CustomListItem;","import React from 'react';\r\nimport { StyleSheet, View, TouchableOpacity, Text, FlatList} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst ContentProp = props => {\r\n  var texts = [];\r\n  if (props.texts){\r\n    props.texts.forEach((element,i) => {\r\n      texts.push(\r\n        (<View style={[styles.contentBox, props.textsStyle]} key={\"text_\" + i}>\r\n          <Text>{element}</Text>\r\n        </View>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var datas = [];\r\n  if (props.datas) {\r\n    props.datas.forEach((element,i) => {\r\n      datas.push(\r\n        (<TouchableOpacity style={[styles.contentBox, props.datasStyle]} onLongPress={() => {\r\n          if (props.onPress){\r\n            props.onPress({data: element, index: i})\r\n          }\r\n        }} key={\"data_\" + i}>\r\n          <Text>{element}</Text>\r\n        </TouchableOpacity>)\r\n      )\r\n    });\r\n  }\r\n\r\n  var length = texts.length > datas.length? texts.length : datas.length\r\n  \r\n  var view = [];\r\n  for(var i = 0; i < length; i++) {\r\n    var dataRow = [];\r\n    if (i < texts.length) {\r\n      dataRow.push(texts[i])\r\n    } else {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"leftSpace_\" + i}/>))\r\n    }\r\n\r\n    if (datas.length > 0) {\r\n      dataRow.push((<View style={[Helpers.fill, Helpers.colCenter, {maxWidth:20}]} key={\"seperator_\" + view.length}/>))\r\n\r\n      if (i < datas.length) {\r\n        dataRow.push(datas[i])\r\n      } else {\r\n        dataRow.push((<View style={[Helpers.fill, Helpers.colCenter]} key={\"rightSpace_\" + i}/>))\r\n      }\r\n    }\r\n\r\n    view.push(\r\n      (<View style={[props.datas?Helpers.rowCenter:Helpers.halvWidth, Metrics.tinyVerticalMargin]} key={\"row_\" + view.length}>\r\n        {dataRow}\r\n      </View>)\r\n    )\r\n  }\r\n  \r\n  return (view);\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  contentBox: {\r\n    ...Helpers.fill,\r\n    ...Helpers.colCenter,\r\n    ...Helpers.borderContainer,\r\n    borderRadius: 0,\r\n    minHeight:30,\r\n  }\r\n});\r\n\r\n\r\nexport default ContentProp;","import React, { useEffect } from 'react'\r\nimport { StyleSheet, Text, View, Image, ActivityIndicator } from 'react-native'\r\n\r\nimport { Helpers, Images, Colors } from '../Theme'\r\n\r\nconst Loading = props => {\r\n  if (props.loading){\r\n    var styles = props.back ? styles.container: {}\r\n    return (\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer, styles]}>\r\n        <View style={[Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      </View>\r\n    )\r\n  } else return null;\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    backgroundColor: Colors.primary,\r\n  },\r\n});\r\n\r\nexport default Loading\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Comment_Module } from '../Components'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nclass OperationsPanel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      View:1,\r\n    }\r\n  }\r\n\r\n  getPenAndSection() {\r\n    var Section, Pen = undefined\r\n    if (this.props.pig && this.props.pigTag && this.props.PigsList) {\r\n      if (this.props.PigsList[this.props.pigTag] && this.props.PigsList[this.props.pigTag].pen && this.props.PigsList[this.props.pigTag].pen != 0) {\r\n        Pen = this.props.PigsList[this.props.pigTag].pen\r\n\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (localDataStore && localDataStore.pens && localDataStore.pens[Pen]) {\r\n          var PenData = localDataStore.pens[Pen];\r\n          Section = PenData.section;\r\n        }\r\n      }\r\n    }\r\n    return {Section, Pen}\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    if (this.props.pig) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Add Pig\"\r\n            onPress={() => {\r\n              if (this.props.pigTag !== \"\" ) {\r\n                if (Object.keys(this.props.PigsList).filter(e => e === this.props.pigTag).length > 0){\r\n                  this.props.setFirebaseError(\"Can not add Tag already exist\")\r\n                } else {\r\n                  this.props.setFirebaseError(\"\")\r\n                  this.props.newPig(this.props.pigTag)\r\n                }\r\n              }\r\n              else this.props.setFirebaseError(\"A Tag is needed\")\r\n            } }/>\r\n          <Button Text=\"Move Pig\"\r\n            onPress={() => {\r\n              var {Section, Pen} = this.getPenAndSection()\r\n              this.props.setCurrentPig(this.props.pigTag, Section, Pen)\r\n              NavigationService.navigate(\"DataEditor\")\r\n            } }/>\r\n        </View>\r\n      )\r\n    } else if (this.props.section) {\r\n      return(\r\n        <View style={[Helpers.buttonContainer]}>\r\n          <Button Text=\"Weight\"\r\n              onPress={() => {\r\n                NavigationService.navigate(\"WeighingOperations\")\r\n              }}/>\r\n          <View style={[{marginTop:40}]}>\r\n            <Button Text=\"Add Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.CREATE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n            <Button Text=\"Remove Pen\"\r\n              onPress={() => {\r\n                this.props.editPens(Actions.DELETE)\r\n                NavigationService.navigate(\"DataEditor\")\r\n              } }/>\r\n          </View>\r\n        </View>\r\n      )\r\n    } else {\r\n      var Action = 1;\r\n      switch(this.state.View) {\r\n        case Operations.MOVE:\r\n        case Operations.LOST:\r\n        case Operations.SOLD:\r\n          Action = -1\r\n        case Operations.ADD:\r\n          return(\r\n            <Comment_Module Title={\"Operations comment:\"} Quantity={true} Weight={true} onDone={(res) => {\r\n              if (res.res) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                var quantity = res.quantity\r\n                if (isNaN(quantity)) quantity = 1\r\n                Action = Action * quantity\r\n                if (res.weight && res.weight !== \"\") {\r\n                  var weight = res.weight\r\n                  if (this.state.View === Operations.ADD) {\r\n                    this.props.newWeight(CurrentData.penId, weight, Date.now(),1)\r\n                  }\r\n                }\r\n\r\n                this.props.newComment(CurrentData.penId, action, res.data, quantity, weight)\r\n                this.props.newPigCount(CurrentData.penId, Action)\r\n              }\r\n\r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          //this.props.newPigCount(CurrentData.penId, Action * \"count_input\", comment)\r\n        case Operations.NOTE:\r\n          return(\r\n            <Comment_Module Title={\"Pen Note:\"} onDone={(res) => {\r\n              if (res.res && res.data) {\r\n                var action = this.state.View\r\n                action = action.charAt(0).toUpperCase() + action.slice(1)\r\n                \r\n                this.props.newComment(CurrentData.penId, action, res.data)\r\n              }\r\n              \r\n              this.setState({\r\n                View: 1\r\n              })\r\n            }}/>\r\n          )\r\n          break;\r\n        default:\r\n          return(\r\n            <ScrollView style={{paddingRight: 5}}>\r\n              <View style={[Helpers.buttonContainer]}>\r\n                <Button Text=\"Weight\"\r\n                    onPress={() => {\r\n                      NavigationService.navigate(\"WeighingOperations\")\r\n                    }}/>\r\n                <Button Text=\"Note\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.NOTE,\r\n                      })\r\n                    }\r\n                  }/>\r\n                <View style={[{marginTop:10}]}>\r\n                  <Button Text=\"Add Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.ADD,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Move Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.MOVE,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Lost Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.LOST,\r\n                      })\r\n                    } }/>\r\n                  <Button Text=\"Sold Pig\"\r\n                    onPress={() => {\r\n                      this.setState({\r\n                        View: Operations.SOLD,\r\n                      })\r\n                    } }/>\r\n                </View>\r\n              </View>\r\n            </ScrollView>\r\n          )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n\r\n    editPens: (action) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action:action})),\r\n\r\n    setCurrentPig: (pigTag, Section, Pen) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PIGS, action:Actions.CREATE, pigtag:pigTag, data:{section:Section}, dataId:Pen})),\r\n    newPig: (pigTag) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {TagId: pigTag})),\r\n    newPigCount: (penId, countChange) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {PenId: penId, Action:countChange})),\r\n\r\n    newComment: (penId, action, data, quantity=null, weight=null) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.COMMENTS, {PenId: penId, Action: action, Data: data, Quantity:quantity, Weight:weight})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OperationsPanel);\r\n//export default OperationsPanel","import React, {useRef, useState, useEffect} from 'react';\r\nimport { Text, View, StyleSheet, Animated } from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics } from '../Theme'\r\n\r\nconst ProgressBar = props => {\r\n  let animation = useRef(new Animated.Value(0));\r\n  const progress = props.progress\r\n  const Color = props.color?props.color:\"#8BED4F\"\r\n  \r\n  useEffect(() => {\r\n    Animated.timing(animation.current, {\r\n      toValue: progress,\r\n      duration: 100\r\n    }).start();\r\n  },[progress])\r\n\r\n  const width = animation.current.interpolate({\r\n    inputRange: [0, 100],\r\n    outputRange: [\"0%\", \"100%\"],\r\n    extrapolate: \"clamp\"\r\n  })\r\n  return (\r\n    <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, minHeight:45, paddingBottom:10}]}>\r\n      <View style={[Helpers.fill, Helpers.fullWidth, Helpers.colMain, {alignContent:'center'}]}>\r\n        {props.text?(\r\n        <Text style={{alignSelf:'flex-start', minHeight:20}}>\r\n          {props.text}\r\n        </Text>):(<></>)}\r\n        <View style={styles.progressBar}>\r\n          <Animated.View style={[StyleSheet.absoluteFill], {backgroundColor: Color, width }}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ProgressBar;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingTop: 5,\r\n    padding: 8,\r\n  },\r\n  progressBar: {\r\n    flexDirection: 'row',\r\n    height: 20,\r\n    width: '100%',\r\n    borderColor: '#000',\r\n    borderWidth: 2,\r\n    borderRadius: 5\r\n  }\r\n});\r\n","import React, { Component } from 'react'\r\nimport { StyleSheet, View, TouchableOpacity, Picker, Text, Image} from 'react-native';\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors, Images } from '../Theme'\r\n\r\nconst monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n];\r\n\r\nclass DateTime_Picker extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n      \r\n    const {year, month, day} = this.getStates(props)\r\n    this.state = {\r\n      year: year,\r\n      month: month,\r\n      day: day,\r\n    }\r\n  }\r\n\r\n  getStates(props) {\r\n    var Today = new Date();\r\n    var Selected = new Date();\r\n    if (props.Selected) {\r\n      Selected = new Date(props.Selected)\r\n    }\r\n\r\n    var year, month, day;\r\n    year = Selected.getFullYear()\r\n    month = Selected.getMonth()\r\n    day = Selected.getDate()\r\n\r\n    if (!props.Selected) {\r\n      if (props.Year){\r\n        year = this.props.Year\r\n      }\r\n      if (props.Month){\r\n        month = this.props.Month\r\n      }\r\n      if (props.Day){\r\n        day = this.props.Day\r\n      }\r\n    }\r\n    return {year, month, day}\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevProps.Selected){\r\n      if (prevProps.Selected != this.props.Selected){\r\n        const {year, month, day} = this.getStates(this.props)\r\n        this.setState({\r\n          year: year,\r\n          month: month,\r\n          day: day,\r\n        }, this.forceUpdate())\r\n      }\r\n    } else {\r\n      var changed = false;\r\n      if (prevProps.Year != this.props.Year) changed = true\r\n      if (prevProps.Month != this.props.Month) changed = true\r\n      if (prevProps.Day != this.props.Day) changed = true\r\n      if (changed) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    var Today = new Date();\r\n\r\n    var year = Today.getFullYear()\r\n    var YearItems = []\r\n    for (let index = year + 25; index > year - 25; index--) {\r\n      var val = String(index)\r\n      YearItems.push(<Picker.Item key={\"Year_\" + index} value={index} label={val} />)\r\n    }\r\n      \r\n    var MonthItems = []\r\n    var month = Today.getMonth()\r\n    for (let index = 0; index < monthNames.length; index++) {\r\n      var val = String(index)\r\n      MonthItems.push(<Picker.Item key={\"Month_\" + index} value={index} label={monthNames[index]} />)\r\n    }\r\n  \r\n    var DayItems = []\r\n    var days = new Date(year, month + 1, 0).getDate()\r\n    for (let index = 1; index <= days; index++) {\r\n      var val = String(index)\r\n      DayItems.push(<Picker.Item key={\"Day_\" + index} value={index} label={val} />)\r\n    }\r\n\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.row, {marginBottom:-10,}, this.props.style]}>\r\n        <Picker selectedValue={this.state.year} style={[{minWidth: 101, marginRight:5}]}\r\n          onValueChange={(_year) => {\r\n            year = _year\r\n            this.props.onValueChange(new Date(year, this.state.month, this.state.day))\r\n          }}>\r\n          {YearItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.month} style={[{minWidth: 110, marginRight:5}]}\r\n          onValueChange={(_month) => {\r\n            month = _month\r\n            this.props.onValueChange(new Date(this.state.year, month, this.state.day))\r\n          }}>\r\n          {MonthItems}\r\n        </Picker>\r\n\r\n        <Picker selectedValue={this.state.day} style={[{minWidth: 83}]}\r\n          onValueChange={(_day) => {\r\n            days = parseInt(_day)\r\n            this.props.onValueChange(new Date(this.state.year, this.state.month, days))\r\n          }}>\r\n          {DayItems}\r\n        </Picker>\r\n      </View>\r\n    )\r\n  }\r\n}\r\nexport default DateTime_Picker;","import React, { useState } from 'react';\r\nimport { Platform, View, Text, TextInput, Image, StyleSheet, RecyclerViewBackedScrollViewComponent} from 'react-native';\r\nimport Button from './Button'\r\nimport { Icon, Input } from 'react-native-elements'\r\nimport { Operations } from '../Stores/Firebase/Selectors'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Fonts, Colors } from '../Theme'\r\n\r\nconst Comment_Module = props => {\r\n  const Title = props.Title;\r\n  const Quantity = props.Quantity?props.Quantity:false\r\n  const Weight = props.Weight?props.Weight:false\r\n  \r\n  const onDone = props.onDone;\r\n  var Button1 = \"Done\";\r\n  var Button2 = \"Cancel\";\r\n  const [InputText, setInputText] = useState(\"\");\r\n  const [QuantityText, setQuantityText] = useState(\"1\");\r\n  const [WeightText, setWeightText] = useState(\"\");\r\n\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.buttonContainer, props.style] }>\r\n      <View style={styles.textAreaContainer} >\r\n        <View style={[App?{}:Helpers.row]}>\r\n          {Title?(<Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>{Title}</Text>):(<></>)}\r\n          {Quantity?(\r\n            <View style={[Helpers.row, App?{}:{marginLeft:50, marginBottom:4}]}>\r\n              <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Quantity:</Text>\r\n              <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n                multiline={false}\r\n                onChangeText={(text) => {\r\n                  if (text === \"\" || !isNaN(text)) setQuantityText(text)\r\n                }}\r\n                value={QuantityText}\r\n              />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {Weight?(\r\n          <View style={[Helpers.row, App?{}:{marginBottom:4}]}>\r\n            <Text style={[Fonts.normal, {height: 24, color:Colors.input}]}>Average Weight:</Text>\r\n            <TextInput style={[styles.textArea, {marginLeft: 10, height:22, width:80, paddingBottom:-10}]} \r\n              multiline={false}\r\n              onChangeText={(text) => {\r\n                if (text === \"\" || !isNaN(text)) setWeightText(text)\r\n              }}\r\n              value={WeightText}\r\n            />\r\n          </View>\r\n        ):(<></>)}\r\n        <TextInput\r\n          style={styles.textArea}\r\n          underlineColorAndroid=\"transparent\"\r\n          placeholder=\"Type something\"\r\n          placeholderTextColor=\"grey\"\r\n          numberOfLines={10}\r\n          multiline={true}\r\n          onChangeText={(text) => setInputText(text)}\r\n          value={InputText}\r\n        />\r\n      </View>\r\n      <Button key={\"_Done\"} Text={Button1}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: true, data: InputText, quantity: QuantityText, weight: WeightText})\r\n          }\r\n        }}/>\r\n      <Button key={\"_Cancel\"} Text={Button2}\r\n        onPress={() => {\r\n          if (onDone) {\r\n            onDone({res: false, data: InputText})\r\n          }\r\n        }}/>\r\n    </View>\r\n  )\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  textAreaContainer: {\r\n    borderColor: Colors.gray,\r\n    borderWidth: 1,\r\n    padding: 5\r\n  },\r\n  textArea: {\r\n    height: 150,\r\n    justifyContent: \"flex-start\",\r\n    borderColor: \"black\",\r\n    borderWidth: 0.5,\r\n    padding: 5,\r\n  }\r\n})\r\n\r\nexport default Comment_Module;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 190,\r\n    marginTop: Metrics.medium * 2, \r\n    marginBottom: Metrics.medium,\r\n  },\r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../Stores/Device/Actions'\r\nimport FirebaseActions from '../../Stores/Firebase/Actions'\r\n\r\nimport { Button_Panel } from '../../Components'\r\nimport Style from './FrontScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images } from '../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      ShowMainError: false,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseErrorMessage = this.props.firebase.firebaseErrorMessage\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Style.logoContainer]}>\r\n          <Image style={[Helpers.fullSize]} source={Images.Logo} resizeMode={'contain'} />\r\n        </View>\r\n\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize]}>\r\n          <View style={[Helpers.textContainer, Helpers.fullWidth]}>\r\n            {this.state.ShowMainError && firebaseErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <Text style={ApplicationStyles.text}>Welcome to Agrisys App</Text>\r\n            <Text style={ApplicationStyles.text}>Please choose your action</Text>\r\n          </View>\r\n\r\n          <Button_Panel \r\n            Texts={[\"Connect to Agrisys Cloud\", \"Connect to Device\"]}\r\n            Images={[Images.Haxa_globe, null]}\r\n            onPress={(ele) => {\r\n              switch(ele.index){\r\n                case 0:\r\n                  NavigationService.navigate('AuthStack')\r\n                  break;\r\n                case 1:\r\n                  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n                    NavigationService.navigate(\"DeviceScreen\")\r\n                  }\r\n                  break;\r\n              }\r\n              /*<Button Text=\"Example\"\r\n              onPress={() => NavigationService.navigate(\"ExampleScreen\")}/>*/\r\n            }}\r\n          />\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","/**\r\n * Selectors let us factorize logic that queries the state.\r\n *\r\n * Selectors can be used in sagas or components to avoid duplicating that logic.\r\n *\r\n * Writing selectors is optional as it is not always necessary, we provide a simple example below.\r\n */\r\n\r\nexport const liveInEurope = (state) => {\r\n  if (Object.entries(state.example.user).length <= 0) return null\r\n\r\n  // For this example, we imagine this cities are european cities\r\n  const europeanCities = [\r\n    'Gwenborough',\r\n    'Wisokyburgh',\r\n    'McKenziehaven',\r\n    'South Elvis',\r\n    'Roscoeview',\r\n  ]\r\n\r\n  return europeanCities.includes(state.example.user.address.city)\r\n}\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  instructions: {\r\n    ...Fonts.normal,\r\n    fontStyle: 'italic',\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 300,\r\n    marginBottom: 25,\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, Button, ActivityIndicator, Image } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport ExampleActions from '../../Stores/Example/Actions'\r\nimport { liveInEurope } from '../../Stores/Example/Selectors'\r\n\r\nimport Style from './ExampleScreenStyle'\r\nimport { ApplicationStyles, Helpers, Images, Metrics } from '../../Theme'\r\n\r\n/**\r\n * This is an example of a container component.\r\n *\r\n * This screen displays a little help message and informations about a fake user.\r\n * Feel free to remove it.\r\n */\r\nconst instructions = Platform.select({\r\n  ios: 'Press Cmd+R to reload,\\nCmd+D or shake for dev menu.',\r\n  android: 'Double tap R on your keyboard to reload,\\nShake or press menu button for dev menu.',\r\n})\r\n\r\nconst ExampleScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const user = useSelector((state) => state.example.user)\r\n  const userIsLoading = useSelector((state) => state.example.userIsLoading)\r\n  const userErrorMessage = useSelector((state) => state.example.userErrorMessage)\r\n\r\n  useEffect(() => {\r\n    dispatch(ExampleActions.fetchUser())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fillCenter,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      {userIsLoading ? (\r\n        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\r\n      ) : (\r\n        <View>\r\n          <View style={Style.logoContainer}>\r\n            <Image style={Helpers.fullSize} source={Images.logo} resizeMode={'contain'} />\r\n          </View>\r\n          <Text style={Style.text}>To get started, edit App.js</Text>\r\n          <Text style={Style.instructions}>{instructions}</Text>\r\n          {userErrorMessage ? (\r\n            <Text style={Style.error}>{userErrorMessage}</Text>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.result}>\r\n                {\"I'm a fake user, my name is \"}\r\n                {user.name}\r\n              </Text>\r\n              <Text style={Style.result}>\r\n                {liveInEurope ? 'I live in Europe !' : \"I don't live in Europe.\"}\r\n              </Text>\r\n            </View>\r\n          )}\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => dispatch(ExampleActions.fetchUser())}\r\n            title=\"Refresh\"\r\n          />\r\n          <Button\r\n            style={ApplicationStyles.button}\r\n            onPress={() => NavigationService.navigate(\"TestScreen\") }\r\n            title=\"Test\"\r\n          />\r\n        </View>\r\n      )}\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ExampleScreen\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  logoContainer: {\r\n    ...Helpers.fullWidth,\r\n    height: 220,\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.small,\r\n  },\r\n  buttonContainer: {\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  deviceContainer: {\r\n    flex: 1,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n  deviceDataContainer: {\r\n    borderWidth: 1,\r\n    borderColor: \"#000\",\r\n    marginTop: Metrics.normal,\r\n    paddingTop: Metrics.small,\r\n    paddingHorizontal: Metrics.normal,\r\n  },\r\n\r\n  error: {\r\n    ...Fonts.normal,\r\n    color: Colors.error,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  result: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.tiny,\r\n    textAlign: 'center',\r\n  },\r\n  text2: {\r\n    ...Fonts.normal,\r\n    marginRight: Metrics.small,\r\n    marginBottom: Metrics.tiny,\r\n  },\r\n})\r\n","import React, { useEffect } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, FlatList, SafeAreaView, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport NavigationService from '../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../Stores/Device/Actions'\r\nimport { ScannerState, ConnectionMethode } from '../../Stores/Device/Selectors'\r\n\r\nimport { Button, CustomListItem } from '../../Components'\r\nimport Style from './DeviceScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../Theme'\r\n\r\nimport { Service, } from 'react-native-ble-plx'\r\n\r\nconst BLEButton = (dispatch, Active = false) => {\r\n  if (!Active) {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n              onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n    )\r\n  } else {\r\n    return (\r\n      <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n              onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n    )\r\n  }\r\n} \r\n\r\nconst ConnectedDevice_View = (connectedDevice, DeviceData) => {\r\n  const dispatch = useDispatch()\r\n  return (\r\n    <View>\r\n      <CustomListItem Title={connectedDevice.localName} Subtitle={connectedDevice.id} itemStyle={{marginBottom: 10}} onPress={() => dispatch(DeviceActions.disconnectDevice())}/>\r\n      { DeviceData && Object.keys(DeviceData).length > 1 ? (\r\n        <View style={Style.deviceDataContainer}>\r\n          {/* if battery is presented */}\r\n          {DeviceData && DeviceData.Battery ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Device battery level</Text>\r\n              <Text>{DeviceData.Battery + \"%\"}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n\r\n          {/* App scanners data */}\r\n          {DeviceData.tagid ? (\r\n          <View style={Style.textContainer}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n          {DeviceData.Unknown ? (\r\n            <View style={Style.textContainer}>\r\n              <Text>unknon Id:</Text>\r\n              <Text>{DeviceData.Unknown}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n      ):(<></>)\r\n      }\r\n    </View>\r\n  )\r\n}\r\n\r\nconst DeviceScreen = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  const deviceErrorMessage = useSelector((state) => state.device.deviceErrorMessage)\r\n\r\n  const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n\r\n  const scannerState = useSelector((state) => state.device.scannerState)\r\n  const connectionMethode = useSelector((state) => state.device.connectionMethode)\r\n  const Devices = useSelector((state) => state.device.DeviceList)\r\n\r\n  useEffect(() => {\r\n    //dispatch(DeviceActions.fetchDevice())\r\n  }, [])\r\n\r\n  return (\r\n    <View\r\n      style={[\r\n        Helpers.fill,\r\n        Helpers.rowMain,\r\n        Metrics.mediumHorizontalMargin,\r\n        Metrics.mediumVerticalMargin,\r\n      ]}\r\n    >\r\n      <View>\r\n        <View style={Style.textContainer}>\r\n          {deviceErrorMessage ? (\r\n            <View>\r\n              <Text>There was a error while retrieving conected device</Text>\r\n              \r\n            </View>\r\n          ) : (\r\n            <View>\r\n              <Text style={Style.text}>Corrently connected:</Text>\r\n              <Text style={Style.text}>{connectedDevice && connectedDevice.name ? (connectedDevice.name):(\"None\") /*mabye use localname*/}</Text>\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.buttonContainer}>\r\n          {connectedDevice ? (\r\n            <View>\r\n              <Button buttonStyle={ApplicationStyles.button} Text=\"Disconnect Device\" \r\n                onPress={() => dispatch(DeviceActions.disconnectDevice(connectionMethode))}/>\r\n              {/*<Button buttonStyle={ApplicationStyles.button} Text=\"Activate device reading\"\r\n                onPress={() => {\r\n                  dispatch(DeviceActions.readDeviceData())\r\n                }}\r\n              />*/}\r\n            </View>\r\n            ): (\r\n            <View>\r\n              {connectionMethode == ConnectionMethode.BLE && scannerState != ScannerState.IDLE ? (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Stop BLE Search\" \r\n                  onPress={() => dispatch(DeviceActions.stopBleScan())}/>\r\n                  ) : (\r\n                <Button buttonStyle={ApplicationStyles.button} Text=\"Search BLE devices\"\r\n                  onPress={() => dispatch(DeviceActions.startBleScan())}/>\r\n                )\r\n              }\r\n              \r\n              {Platform.OS === 'ios' ? (<></>):(\r\n                <View>\r\n                  {connectionMethode == ConnectionMethode.BLUETOOTH && scannerState != ScannerState.IDLE ? (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Stop Bluetooth Search\" \r\n                      onPress={() => dispatch(DeviceActions.stopBluetoothScan())}/>\r\n                      ) : (\r\n                    <Button buttonStyle={ApplicationStyles.button} Text=\"Search Bluetooth devices\" \r\n                      onPress={() => dispatch(DeviceActions.startBluetoothScan())}/>\r\n                    )\r\n                  }\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"Make Discoverable (Blu 30sec)\" \r\n                      onPress={() => dispatch(DeviceActions.bluetoothScanAble())}/>\r\n\r\n                  <Button buttonStyle={ApplicationStyles.button} Text=\"OnDevice-serial\" \r\n                      onPress={() => {}}/>\r\n                </View>\r\n              )}\r\n            </View>\r\n          )}\r\n        </View>\r\n        <View style={Style.deviceContainer}>\r\n          <Text style={Style.text2}>Device List:</Text>\r\n            { connectedDevice ? \r\n              ConnectedDevice_View(connectedDevice, DeviceData)\r\n              : (\r\n                <ScrollView style={{paddingRight: 5}}>\r\n                  {Devices.map((Dev, i) => (\r\n                    <CustomListItem key={i} Title={Dev.localName} Subtitle={Dev.id} onPress={() => dispatch(DeviceActions.connectDevice(Dev))}/>\r\n                  ))}\r\n                </ScrollView> \r\n              )\r\n            }\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nexport default DeviceScreen;\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport Front from '../Containers/Agrisys/FrontScreen'\r\nimport Example from '../Containers/Example/ExampleScreen'\r\nimport Device from '../Containers/Device/DeviceScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // The main application screen is our \"ExampleScreen\". Feel free to replace it with your\r\n    // own screen and remove the example.\r\n    FrontScreen: {\r\n      screen: Front,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n        headerShown: false,\r\n      }),\r\n      path: 'main',\r\n    },\r\n    \r\n    DeviceScreen: {\r\n      screen: Device,\r\n      navigationOptions: () => ({\r\n        title: 'Device',\r\n        headerTitleStyle:{\r\n          ...ApplicationStyles.navigationHeader\r\n        },\r\n      }),\r\n    },\r\n\r\n    ExampleScreen: {\r\n      screen: Example,\r\n      navigationOptions: () => ({\r\n        headerMode: 'none',\r\n      }),\r\n      path: 'example',\r\n    }\r\n  },\r\n  {\r\n    initialRouteName: 'FrontScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, Image, View, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport {Actions, DataRefs, UserStates} from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Loading } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;\r\n  //#endregion\r\n}\r\n\r\nconst PanelsSorter = (userType) => {\r\n  switch(userType) {\r\n    case UserStates.ADMIN:\r\n      return \"AdminPanel\"\r\n    case UserStates.OWNER:\r\n      return \"ConsysPanel\"\r\n    case UserStates.FREE:\r\n      return \"UserPanel\"\r\n    case UserStates.STARTER:\r\n      return \"CreateUserData\"\r\n    default:\r\n      return \"LoginUser\"\r\n  }\r\n};\r\n\r\nclass UserLoadingScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n      FocusSubscription: null,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    const firebaseData = this.props.firebase;\r\n    if (!firebaseData) {\r\n      this.props.setFirebaseError(\"Internal rootdata Error\")\r\n      NavigationService.navigate('MainStack')\r\n      return;\r\n    }\r\n    \r\n    var page = \"LoginUser\";\r\n    const firebaseUser = firebaseData.firebaseUser\r\n    if (firebaseUser && Object.keys(firebaseUser).length > 1) {\r\n      if (firebaseUser.state === UserStates.STARTER && !firebaseUser.emailVerified) {\r\n        var User = auth().currentUser;\r\n        if(!User.emailVerified) {\r\n          page = \"VerifyScreen\";\r\n        }else {\r\n          page = PanelsSorter(firebaseUser.state)\r\n        }\r\n      } else {\r\n        page = PanelsSorter(firebaseUser.state)\r\n      }\r\n    }\r\n\r\n    NavigationService.navigate(page)\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      if (this.props.firebase.firebaseUser != prevProps.firebase.firebaseUser) { //Only checking user changes\r\n        var now = this.props.firebase.firebaseUser\r\n        var prev = prevProps.firebase.firebaseUser\r\n        if (!now || now.uid !== prev.uid || (now.state !== prev.state && prev.state !== UserStates.STARTER) || now.emailVerified != prev.emailVerified) {\r\n          console.log(\"UserLoading\")\r\n          this.checkData(this.props);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setFirebaseError(null)\r\n    this.props.getUser(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n\r\n    const FocusSubscription = this.props.navigation.addListener(\r\n      'willFocus',\r\n      payload => {\r\n        this.props.setViewLoading(false)\r\n        this.props.setViewError(null)\r\n      }\r\n    );\r\n    this.setState({\r\n      FocusSubscription: FocusSubscription\r\n    })\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.FocusSubscription) {\r\n      this.state.FocusSubscription.remove()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ISLOADPAGE = this.state.ISLOADPAGE;\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        {!ISLOADPAGE ?(\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            <Text style={ApplicationStyles.text}>This page contains an error.</Text>\r\n            <Text style={ApplicationStyles.text}>If you are going back, please press back again.</Text>\r\n          </View>\r\n        ):(\r\n          <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n            <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n          </View>\r\n        )}\r\n        {(IsLoading || ISLOADPAGE) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})), //TODO: mabye not get user \r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoadingScreen);\r\n//export default UserLoadingScreen;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  \r\n})\r\n","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Platform } from 'react-native'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nlet auth;\r\nif (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n  //#region App version imports\r\n  auth = require('@react-native-firebase/auth').default;\r\n  //#endregion\r\n} else {\r\n  //#region Web Version imports\r\n  var firebase = require('firebase/app').default;\r\n  require('firebase/auth').default;\r\n\r\n  auth = firebase.auth;\r\n  //#endregion\r\n}\r\n\r\nclass VerifyScreen extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    \r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n    if (props.firebase && props.firebase.firebaseUser) {\r\n      var User = auth().currentUser;\r\n\r\n      if (User && !props.firebase.firebaseUser.emailVerified && !props.firebase.viewIsLoading){\r\n        User.reload().then((data)=>{\r\n          if(User.emailVerified) {\r\n            this.props.setViewLoading(true)\r\n            this.props.setUser(User.emailVerified)\r\n            console.log(\"Verified\")\r\n            NavigationService.navigate(\"AuthStack\")\r\n          }\r\n        })\r\n      }\r\n      \r\n      if (props.firebase.firebaseUser.emailVerified) NavigationService.navigate(\"AuthStack\")\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          <View>\r\n            <Text>Please verify your account by accepting the email, sent to your current account</Text>\r\n            <Text>This page will not refresh itself...</Text>\r\n            <Button Text=\"Resend verification\"\r\n              onPress={() => {\r\n                console.log(\"send\", firebaseUser, this.state.User)\r\n                if (firebaseUser && this.state.User) {\r\n                  this.state.User.sendEmailVerification()\r\n                }\r\n              }}/>\r\n            <Button Text=\"Refresh\"\r\n              onPress={() => {\r\n                this.checkData(this.props, this.state)\r\n              }}/>\r\n          </View>\r\n          \r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n\r\n    setUser: (Verified) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {emailVerified:Verified, })),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VerifyScreen);\r\n//export default VerifyScreen;","import React, { Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass UserLoginScreen extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      Email: \"\",\r\n      Pass: \"\",\r\n      CreateUser: false,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    \r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n\r\n          {!this.state.CreateUser?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={[Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Username\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Email: text})\r\n                  }}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {\r\n                    this.setState({Pass:text})\r\n                  }}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n                <Button Text=\"Login\" icon={Images.User}\r\n                  onPress={() => {\r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setViewError(\"Email is needed\")\r\n                    else if (this.state.Email === \"CLEAR\") this.props.clearDataMem()\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setViewError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.signIN(this.state.Email, this.state.Pass)\r\n                    }\r\n                  }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Send reset password\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    if (this.state.Email) {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.resetPass(this.state.Email)\r\n                    } else {\r\n                      this.props.setViewError(\"Please provide an Email\")\r\n                    }\r\n                  }}/>\r\n                <Button Text=\"Create New User\"\r\n                  onPress={() => {\r\n                    this.props.setViewError(null)\r\n                    this.setState({\r\n                      Email: \"\",\r\n                      Pass: \"\",\r\n                      CreateUser: true,\r\n                    })\r\n                  }}/>\r\n              </View>\r\n            </View>\r\n          ):(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n              <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n                <Input\r\n                  label=\"Email\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Email:text})}}\r\n                  value={this.state.Email}\r\n                />\r\n                <Input\r\n                  label=\"Password\"\r\n                  style={ApplicationStyles.input}\r\n                  onChangeText={text => {this.setState({Pass:text})}}\r\n                  value={this.state.Pass}\r\n                  secureTextEntry={true}\r\n                />\r\n              </View>\r\n              <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n                <Button Text=\"Create User\" \r\n                  onPress={() => { \r\n                    if (!this.state.Email || this.state.Email === \"\") this.props.setFirebaseError(\"Email is needed\")\r\n                    else if (!this.state.Pass || this.state.Pass === \"\") this.props.setFirebaseError(\"Password is needed\")\r\n                    else {\r\n                      this.props.setViewLoading(true)\r\n                      this.props.createUser(this.state.Email,this.state.Pass)\r\n                    }\r\n                  }}\r\n                />\r\n              </View>\r\n            </View>\r\n          )}\r\n\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    signIN: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA, {Email: Email, Pass: Pass})),\r\n    resetPass: (Email) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email})),\r\n    createUser: (Email, Pass) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERS, {Email: Email, Pass: Pass})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserLoginScreen);\r\n//export default UserLoginScreen;","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass UserInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FirstN, LastN, Contact, ContactP, Address} = this.setData(props)\r\n    this.state = {\r\n      FirstN: FirstN,\r\n      LastN: LastN,\r\n      Contact: Contact,\r\n      ContactP: ContactP,\r\n      Address: Address,\r\n      Country: \"\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FirstN = \"\"\r\n    var LastN = \"\"\r\n    var Contact = \"\"\r\n    var ContactP = \"\"\r\n    var Address = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.name && DataStringCheck(firebaseUser.name)){\r\n          FirstN = firebaseUser.name\r\n        }\r\n        if (firebaseUser.lastN){\r\n          LastN = firebaseUser.lastN\r\n        }\r\n        if (firebaseUser.contact){\r\n          Contact = firebaseUser.contact\r\n        }\r\n        if (firebaseUser.phoneNumber) {\r\n          ContactP = firebaseUser.phoneNumber\r\n        }\r\n        if (firebaseUser.address){\r\n          Address = firebaseUser.address\r\n        }\r\n      }\r\n    }\r\n    return {FirstN, LastN, Contact, ContactP, Address}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FirstN, LastN, Contact, ContactP, Address} = this.setData(this.props)\r\n          this.setState({\r\n            FirstN: FirstN,\r\n            LastN: LastN,\r\n            Contact: Contact,\r\n            ContactP: ContactP,\r\n            Address: Address,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    //TODO: Test more with input error display ??\r\n    const F_FirstN = React.createRef();\r\n    const F_LastN = React.createRef();\r\n    const F_Contact = React.createRef();\r\n    const F_ContactP = React.createRef();\r\n    const F_Address = React.createRef();\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"User Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input ref={F_FirstN}\r\n                label=\"First Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FirstN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FirstN:text})\r\n                  }\r\n                }}\r\n                value={this.state.FirstN}\r\n\r\n              />\r\n              <Input ref={F_LastN}\r\n                label=\"Last Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({LastN:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({LastN:text})\r\n                  }\r\n                }}\r\n                value={this.state.LastN}\r\n              />\r\n              <Input ref={F_Contact}\r\n                label=\"Contact Email\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Contact:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Contact:text})\r\n                  }\r\n                }}\r\n                value={this.state.Contact}\r\n              />\r\n              <Input ref={F_ContactP}\r\n                label=\"Contact Phone\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text, false)){\r\n                      this.setState({ContactP:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({ContactP:text})\r\n                  }\r\n                }}\r\n                value={this.state.ContactP}\r\n              />\r\n              <Input ref={F_Address}\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save User information\" \r\n                onPress={() => {\r\n                  var _UserData = {}\r\n\r\n                  if (!this.state.FirstN || this.state.FirstN === \"\"){\r\n                    this.props.setViewError(\"First name is needed\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps:\"First name is needed\" })\r\n                    F_FirstN.current.shake();*/\r\n                  } else if (!DataStringCheck(this.state.FirstN)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                    /*F_FirstN.current.setNativeProps({ errorProps: \"First name contains invalid characters\" })\r\n                    F_FirstN.current.shake();*/\r\n                  }\r\n                  \r\n                  else if (!this.state.LastN || this.state.LastN === \"\"){\r\n                    this.props.setViewError(\"Last name is needed\")\r\n                  } else if (!DataStringCheck(this.state.LastN)) {\r\n                    this.props.setViewError(\"Last name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _UserData = {name: this.state.FirstN, lastN: this.state.LastN}\r\n                    if (this.state.Contact !== \"\") _UserData.email = this.state.Contact\r\n                    if (this.state.ContactP !== \"\") _UserData.phoneNumber = this.state.ContactP\r\n                    if (this.state.Address !== \"\") _UserData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _UserData.country = this.state.Country\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateUser(_UserData)\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserInformation);\r\n//export default UserInformation;","import React, { Component } from 'react'\r\nimport { Platform, Dimensions, Text, CheckBox, View, ScrollView, ActivityIndicator, TouchableOpacity } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Subscription extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {CurrentSub} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      CurrentSub: CurrentSub,\r\n\r\n      Billing: 0,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var CurrentSub = \"\"\r\n\r\n    const firebaseData = this.props.firebase;\r\n    if (firebaseData){\r\n      const firebaseUser = firebaseData.firebaseUser\r\n      if (firebaseUser) {\r\n        if (firebaseUser.state && firebaseUser.state != UserStates.STARTER){\r\n          CurrentSub = firebaseUser.state\r\n        }\r\n      }\r\n    }\r\n    return { CurrentSub }\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        if ((this.props.firebase.firebaseUser.state != this.state.CurrentSub && this.state.CurrentSub === \"\")\r\n          ) {\r\n          const {CurrentSub} = this.setData(this.props)\r\n          this.setState({\r\n            CurrentSub: CurrentSub,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n    \r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            \r\n            <TitleElement Text=\"Subscription plan\"/>\r\n            <View style={[!App?Helpers.fillRowCenter:{}, {marginBottom:20}]}>\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.WORKER?{backgroundColor: Colors.AgriGreen}:{}]} \r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.WORKER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Staff</Text>\r\n                  {this.state.CurrentSub===UserStates.WORKER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.WORKER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to assign as staff of an existing farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.FREE?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.FREE\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Owner</Text>\r\n                  {this.state.CurrentSub===UserStates.FREE?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.FREE?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>Free</Text>\r\n                  <Text>Access to create and manage own farm</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===UserStates.OWNER?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: UserStates.OWNER\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Farm Manager</Text>\r\n                  {this.state.CurrentSub===UserStates.OWNER?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===UserStates.OWNER?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                  <Text style={{fontWeight:\"bold\"}}>9999.99</Text>\r\n                  <Text>Access to manage own farm, and assing staff</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity style={[Helpers.borderContainer, {width:200, height:300}, this.state.CurrentSub===\"Contact\"?{backgroundColor: Colors.AgriGreen}:{}]}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    CurrentSub: \"Contact\"\r\n                  }, this.forceUpdate())\r\n              }}>\r\n                <View style={[Helpers.row, Helpers.fullWidth, {alignContent:'center', alignItems:'center', justifyContent:'center', height:35}]}>\r\n                  <Text style={{fontWeight:\"bold\", fontSize:20}}>Get contacted</Text>\r\n                  {this.state.CurrentSub===\"Contact\"?(\r\n                    <CheckBox \r\n                      value={this.state.CurrentSub===\"Contact\"?true:false}\r\n                    />\r\n                  ):(<></>)}\r\n                </View>\r\n                <View style={[Helpers.fill, Helpers.borderContainer]}>\r\n                  \r\n                </View>\r\n                <View style={[Helpers.borderContainer, {height:75}]}>\r\n                <Text style={{fontWeight:\"bold\", height:20}}></Text>\r\n                  <Text>We will contact you, and tell more about our offers</Text>\r\n                </View>\r\n              </TouchableOpacity>\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\" \r\n                onPress={() => {\r\n                  if (!this.state.CurrentSub || this.state.CurrentSub === \"\"){\r\n                    this.props.setViewError(\"Please choose a subscription type.\")\r\n                  }\r\n\r\n                  else if (this.props.OnDone) {\r\n                    this.props.OnDone(this.state.CurrentSub)\r\n                  } else {\r\n                    //TODO: something.. validate buy and update user state\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n\r\n    //updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data}))\r\n    //createUserData: (Userdata, Farm, Sections, Pens) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: Userdata, Farms:{name:Farm}, Sections:Sections, Pens:Pens})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Subscription);\r\n//export default Subscription;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, ErrorTypes, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass FarmInformation extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const {FarmName, Address, Country, Cvr, Manager} = this.setData(props)\r\n    this.state = {\r\n      FarmName: FarmName,\r\n      Address: Address,\r\n      Country: Country,\r\n      Cvr: Cvr,\r\n      Manager: Manager,\r\n\r\n      Sections: \"0\",\r\n      Pens: \"0\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    var FarmName = \"\"\r\n    var Address = \"\"\r\n    var Country = \"\"\r\n    var Cvr = \"\"\r\n    var Manager = \"\"\r\n\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    if (firebaseUser) {\r\n      if (firebaseUser.lastN !== \"\") {\r\n        FarmName = firebaseUser.lastN\r\n      }\r\n      if (firebaseUser.address !== \"\") {\r\n        Address = firebaseUser.address\r\n      }\r\n      if (firebaseUser.country) {\r\n        Country = firebaseUser.country\r\n      }\r\n      if (firebaseUser.email != \"\") {\r\n        Manager = firebaseUser.email\r\n      }\r\n    }\r\n\r\n    if (localDataStore && firebaseUser && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var FarmData = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n      if (FarmData.name) FarmName = FarmData.name\r\n      if (FarmData.address) Address = FarmData.address\r\n      if (FarmData.country) Country = FarmData.country\r\n      if (FarmData.cvr) Cvr = FarmData.cvr\r\n      if (FarmData.manager) Manager = FarmData.manager\r\n    }\r\n\r\n    return {FarmName, Address, Country, Cvr, Manager}\r\n  }\r\n\r\n  getData() {\r\n    \r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n\r\n    this.props.getUser(null)\r\n    this.props.getFarm()\r\n\r\n    this.checkData(this.props)\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.firebaseUser) {\r\n        /*if ((this.props.firebase.firebaseUser.name != this.state.FirstN && this.state.FirstN === \"\") ||\r\n            (this.props.firebase.firebaseUser.lastN != this.state.lastN && this.state.lastN === \"\") ||\r\n            (this.props.firebase.firebaseUser.contact != this.state.Contact && this.state.Contact === \"\") ||\r\n            (this.props.firebase.firebaseUser.address != this.state.Address && this.state.Address === \"\")\r\n          ) {\r\n          const {FarmName, Address, Cvr, Manager} = this.setData(this.props)\r\n          this.state = {\r\n            FarmName: FarmName,\r\n            Address: Address,\r\n            Cvr: Cvr,\r\n            Manager: Manager,\r\n          }\r\n        }*/\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n            {ErrorMessage && (!ErrorMessage.type || ErrorMessage.type === ErrorTypes.SYSTEM) ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage.message?ErrorMessage.message:ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            <TitleElement Text=\"Farm Informations\"/>\r\n            <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n              <Input\r\n                label=\"Farm Name\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    if (DataStringCheck(text)){\r\n                      this.setState({FarmName:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({FarmName:text})\r\n                  }\r\n                }}\r\n                value={this.state.FarmName}\r\n              />\r\n              <Input\r\n                label=\"Address\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Address:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Address:text})\r\n                  }\r\n                }}\r\n                value={this.state.Address}\r\n              />\r\n              <Input\r\n                label=\"Country\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text){\r\n                    //if (DataStringCheck(text)){\r\n                      this.setState({Country:text})\r\n                    //}\r\n                  }else {\r\n                    this.setState({Country:text})\r\n                  }\r\n                }}\r\n                value={this.state.Country}\r\n              />\r\n              <Input\r\n                label=\"Cvr\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Cvr:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Cvr}\r\n              />\r\n              <Input\r\n                label=\"Manager contact\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (text) {\r\n                    var test = text\r\n                    test = test.replace('@','a')\r\n                    test = test.replace('.','d')\r\n                    if (DataStringCheck(test)) {\r\n                      this.setState({Manager:text})\r\n                    }\r\n                  }else {\r\n                    this.setState({Manager:text})\r\n                  }\r\n                }}\r\n                value={this.state.Manager}\r\n              />\r\n              <Input\r\n                label=\"Number of Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Sections:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Sections}\r\n              />\r\n              <Input\r\n                label=\"Number of Pens in each Sections\"\r\n                style={ApplicationStyles.input}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      Pens:text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.Pens}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Save User information\" \r\n                onPress={() => {\r\n                  var _FarmData = {}\r\n                  var _sections = {};\r\n                  var _pens = {};\r\n\r\n                  if (!this.state.FarmName || this.state.FarmName === \"\"){\r\n                    this.props.setViewError(\"Farm name is needed\")\r\n                  } else if (!DataStringCheck(this.state.FarmName)) {\r\n                    this.props.setViewError(\"First name contains invalid characters\")\r\n                  }\r\n                  \r\n                  else {\r\n                    _FarmData = {name: this.state.FarmName}\r\n\r\n                    if (this.state.Address !== \"\") _FarmData.address = this.state.Address\r\n                    if (this.state.Country !== \"\") _FarmData.country = this.state.Country\r\n                    if (this.state.Cvr !== \"\") _FarmData.cvr = this.state.Cvr\r\n                    if (this.state.Manager !== \"\") _FarmData.manager = this.state.Manager\r\n\r\n                    this.props.setViewLoading(true)\r\n                    this.props.updateFarm(_FarmData)\r\n\r\n                    if (this.state.Sections && this.state.Pens) {\r\n                      var Pen = 1;\r\n                      var i, i2;\r\n                      for (i = 1; i <= this.state.Sections; i++) {\r\n                        var sectionPens = {};\r\n                        for (i2 = 1; i2 <= this.state.Pens; i2++) {\r\n                          _pens['Pen_' + Pen] = {section: 'Section_' + i}\r\n                          sectionPens['Pen_' + Pen] = true\r\n                          Pen++;\r\n                        }\r\n                        \r\n                        _sections['Section_' + i] = {pens: sectionPens}\r\n                      }\r\n                      console.log(\"Set\", _sections, _pens)\r\n                      this.props.updateFarmData(_sections, _pens)\r\n                    }\r\n\r\n                    if (this.props.OnDone) {\r\n                      this.props.OnDone(true)\r\n                    }\r\n                  }\r\n                }}/>\r\n              </View>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    //setViewError: (error, type) => dispatch(FirebaseActions.setViewError(error, type)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUser: (UserId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERSDATA, {UserId: UserId})),\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n\r\n    updateFarm: (FarmData) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMS, {Data: FarmData})),\r\n    updateFarmData: (sections, pens) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.FARMDATAS, {Data:{sections:sections, pens:pens}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FarmInformation);\r\n//export default FarmInformation;","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ScrollView, ActivityIndicator } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, UserStates, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from './AuthStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport UserInformation from '../UserPanel/UserInformation'\r\nimport Subscription from '../UserPanel/Subscription'\r\nimport FarmInformation from '../UserPanel/FarmInformation'\r\n\r\nclass CreateNewUserData extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      ViewState: 1,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    //this.props.setViewError(null)\r\n\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      /*if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }*/\r\n      if (this.props.firebase.firebaseUser !== prevProps.firebase.firebaseUser) {\r\n        if (prevProps.firebase.firebaseUser.state !== UserStates.STARTER && this.state.ViewState !== 3) {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    var Display = [];\r\n    if (this.state.ViewState === 1) {\r\n      Display = [(<UserInformation key={\"View1\"} OnDone={res => {\r\n        if (res) {\r\n          this.setState({\r\n            ViewState:2\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 2) {\r\n      Display = [(<Subscription key={\"View2\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          var FarmName = \"Not set\"\r\n          if (this.props.firebase.firebaseUser.lastN) FarmName = this.props.firebase.firebaseUser.lastN;\r\n          this.props.precreateUserData(res, FarmName)\r\n\r\n          this.setState({\r\n            ViewState:3\r\n          }, this.forceUpdate())\r\n        }else {\r\n          NavigationService.nacigationPop()\r\n        }\r\n      }}/>)]\r\n    } else if (this.state.ViewState === 3) {\r\n      Display = [(<FarmInformation key={\"View3\"} OnDone={res => {\r\n        if (res && res != \"\") {\r\n          NavigationService.navigateAndReset('AuthStack')\r\n        }\r\n      }}/>)]\r\n    } else {\r\n      NavigationService.navigateAndReset('AuthStack')\r\n    }\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        {Display}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n\r\n    updateUser: (Data) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERSDATA, {Data: Data})),\r\n    precreateUserData: (Subsc, FarmName) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.USERSDATA, {UserData: {state:Subsc}, Farms:{name:FarmName}, Sections:{}, Pens:{}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateNewUserData);\r\n//export default CreateNewUserData;","import React from 'react'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport LoadingUserScreen from '../Containers/Cloud/AuthScreens/UserLoadingScreen'\r\nimport LoginUserScreen from '../Containers/Cloud/AuthScreens/UserLoginScreen'\r\nimport VerifyScreen from '../Containers/Cloud/AuthScreens/VerifyScreen'\r\nimport CreateUserDataScreen from '../Containers/Cloud/AuthScreens/CreateUserDataScreen'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    UserLoadingScreen: {\r\n      screen: LoadingUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User loading',\r\n      }),\r\n    },\r\n    LoginUser: {\r\n      screen: LoginUserScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Login',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n    },\r\n    VerifyScreen: {\r\n      screen: VerifyScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Verification',\r\n      }),\r\n    },\r\n    CreateUserData: {\r\n      screen: CreateUserDataScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Create Data',\r\n      }),\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserLoadingScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerLeft: () => (\r\n        <View style={{padding:6, paddingLeft: 15}}>\r\n          <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n        </View>\r\n      ),\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.viewError != prevProps.firebase.viewError) {\r\n        this.forceUpdate()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const firebase = this.props.firebase;\r\n\r\n    const IsLoading = firebase.firebaseIsLoading\r\n    const firebaseErrorMessage = firebase.firebaseErrorMessage\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const firebaseUser = firebase.firebaseUser\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{firebaseErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"Dashboard\", \"Pens\", \"Batchs\", \"Growth curves\", \"Operations\", \"AutoPigs\", \"Feeding\", \"Pigs\"]}\r\n            Images={[Images.DashBoard, Images.Pens, Images.Section, Images.GCurves, Images.System, Images.AutoPig, Images.Feed, Images.Sow ]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"Dashboard\":\r\n                  NavigationService.navigate(\"UserDashBoard\")\r\n                  break;\r\n                case \"Pens\":\r\n                  NavigationService.navigate(\"UserPens\")\r\n                  break;\r\n                case \"Batchs\":\r\n                  NavigationService.navigate(\"UserBatchs\")\r\n                  break;\r\n                case \"Growth curves\":\r\n                  NavigationService.navigate(\"UserCurves\")\r\n                  break;\r\n                case \"Operations\":\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                  break;\r\n                case \"AutoPigs\":\r\n                  this.props.getAutoPig()\r\n                  break;\r\n                case \"Feeding\":\r\n                  break;\r\n                case \"Pigs\":\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                  break;\r\n              }\r\n            }}\r\n          />\r\n          \r\n          {firebaseUser && firebaseUser.state === \"admin\"?(<></>):(\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n\r\n    getAutoPig: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.CONSYS, {sysId:2}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { DataRefs, Actions, GetBatchEnd, CurvePredict, GetCurve_FromBatch, GetStats_FromBatch  } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, ContentProp, ProgressBar } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Name, Manager, Mail, SectionsList, BatchList, MaxCap, CurCap} = this.setData(props)\r\n    this.state = {\r\n      farmName: Name,\r\n      farmManager: Manager,\r\n      farmMail: Mail, \r\n\r\n      BatchList: BatchList,\r\n\r\n      MaxCap:MaxCap, \r\n      CurCap:CurCap,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n\r\n    var Name = \"Not set\"\r\n    var Manager = \"Not set\"\r\n    var Mail = \"Not set\"\r\n\r\n    if (localDataStore && localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n      var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n      Name = Farm.name?Farm.name: Name\r\n      Manager = Farm.name?Farm.manager: Manager\r\n      Mail = Farm.name?Farm.email: Mail\r\n    }\r\n\r\n    var BatchList = {}//localDataStore.batchs\r\n    var MaxCap = 0;\r\n    var CurCap = 0;\r\n\r\n    if (localDataStore.batchs) {\r\n      Object.keys(localDataStore.batchs).filter(e => e !== '__jsogObjectId' && e !== 'update_time').map((BatchID) => {\r\n        var Batch = localDataStore.batchs[BatchID]\r\n        var Data = GetStats_FromBatch(Batch, localDataStore)\r\n        if (Data) {\r\n          var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = Data\r\n          \r\n          if (Batch.pens) {\r\n            MaxCap += Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).length * 1;\r\n          }\r\n          CurCap += Animals;\r\n\r\n          Batch.count = Animals\r\n          Batch.weight = AverageWeight\r\n          Batch.target = TargetWeight\r\n          Batch.End = EndDate\r\n\r\n          BatchList[BatchID] = Batch\r\n        }\r\n      })\r\n    }\r\n\r\n    if (MaxCap === 0) MaxCap++;\r\n    return { Name, Manager, Mail, BatchList, MaxCap, CurCap }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getFarm()\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getBatch()\r\n    this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore && prevProps.firebase.localDataStore) {\r\n        const firebaseUser = this.props.firebase.firebaseUser\r\n        const localDataStore = this.props.firebase.localDataStore;\r\n\r\n        if (localDataStore.farms && firebaseUser.farms && localDataStore.farms[Object.keys(firebaseUser.farms)[0]]) {\r\n          var Farm = localDataStore.farms[Object.keys(firebaseUser.farms)[0]]\r\n\r\n          if ((this.state.farmName !== Farm.name || this.state.farmManager !== Farm.manager || this.state.farmMail !== Farm.email) ||\r\n              localDataStore.batchs && JSON.stringify(this.state.BatchList) !== JSON.stringify(localDataStore.batchs) ||\r\n              localDataStore.graphs && localDataStore.graphs !== prevProps.firebase.localDataStore.graphs) {\r\n            const {Name, Manager, Mail, BatchList, MaxCap, CurCap} = this.setData(this.props)\r\n            this.setState({\r\n              farmName: Name,\r\n              farmManager: Manager,\r\n              farmMail: Mail,\r\n        \r\n              BatchList: BatchList,\r\n\r\n              MaxCap:MaxCap, \r\n              CurCap:CurCap,\r\n            }, () => {\r\n              this.forceUpdate()\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var FarmProgress = 0\r\n    if (this.state.BatchList) {\r\n      var BatchList = Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))\r\n      BatchList.forEach(element => {\r\n        var Batch = this.state.BatchList[element]\r\n        FarmProgress += (Batch.weight/Batch.target)*100;\r\n      });\r\n      FarmProgress = (FarmProgress/(100*BatchList.length))*100\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n            <TitleElement Text=\"Farm description\"/>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.fullWidth, {height:110,}]}>\r\n              <ContentProp texts={[\"Farm name\", \"Manager\", \"E-mail\"]} datas={[this.state.farmName, this.state.farmManager, this.state.farmMail ]} />\r\n            </View>\r\n            <View style={{height:20}}/>\r\n            <ProgressBar text={\"Farm capacity: \" + this.state.CurCap + \" of \" + this.state.MaxCap} progress={(this.state.CurCap/this.state.MaxCap) * 100 }/>\r\n            <ProgressBar text={\"Farm performance:\"} progress={FarmProgress}/>\r\n\r\n            {this.state.BatchList?(\r\n              <View style={[Helpers.borderContainer, Helpers.fullWidth, {borderWidth:0, marginTop:10}]}>\r\n                <Text>Batches:</Text>\r\n                <FlatList\r\n                  data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time' && \r\n                                                                (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\"))}\r\n                  renderItem={({item, i}) => {\r\n                    var Batch = this.state.BatchList[item]\r\n                    var TempCurve = GetCurve_FromBatch(Batch, localDataStore.graphs)\r\n                    var End = GetBatchEnd(Batch, TempCurve)\r\n                    var EndDate = Batch.End;\r\n                    var Color = Colors.AgriGreen\r\n                    if (EndDate > End) Color = Colors.error\r\n                    var count = Batch.count\r\n                    if (!count) count = 0\r\n                    var progress = (Batch.weight/Batch.target)*100;\r\n\r\n                    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n                    var StartDate = new Date(Batch.time).getDate() + \"/\" + (new Date(Batch.time).getMonth() +1) + \"/\" + new Date(Batch.time).getFullYear()\r\n                    return(\r\n                      <ProgressBar text={item + \" Startdate: \" + StartDate + \" EndForcast: \" + EndDate + \", \" + count + \" pigs\"} progress={progress} color={Color}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <Button Text=\"Clear local datastore\"\r\n              onPress={() => {\r\n                this.props.clearDataMem()\r\n                this.getData()\r\n              }}/>\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n\r\n    getFarm: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {})),\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\r\n//export default Dashboard;\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n  loading: {\r\n    position: 'absolute',\r\n    left: 0,\r\n    right: 0,\r\n    top: 0,\r\n    bottom: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: '#F5FCFF88',\r\n  },\r\n\r\n  textContainer: {\r\n    ...Fonts.normal,\r\n    marginBottom: Metrics.normal,\r\n  },\r\n  inputContainer: {\r\n    marginBottom: Metrics.small,\r\n  },\r\n\r\n  input: {\r\n    ...Fonts.normal,\r\n    height: 24, \r\n  },\r\n  \r\n})\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pigs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {PigsList} = this.setData(props)\r\n    this.state = {\r\n      PigsList: PigsList,\r\n      PigTag: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    this.props.getPigs()\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var PigsList = null\r\n    if (localDataStore && localDataStore.pigs) {\r\n      PigsList = sortObject(localDataStore.pigs)\r\n    }\r\n    \r\n    return {PigsList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.pigs && JSON.stringify(this.state.PigsList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.pigs))) {\r\n            const {PigsList} = this.setData(this.props)\r\n            this.setState({\r\n              PigsList: PigsList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    const connectedDevice = null\r\n    const connectedState = null\r\n    const DeviceData = null\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            <Device_Display connectedState={connectedState}/>\r\n            <Scanner_Display DeviceData={DeviceData}/>\r\n            {this.state.PigsList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.PigsList)}\r\n                    renderItem={({item})=>{\r\n                      var Pen = \"-\"\r\n                      var Section = \"-\"\r\n                      if (this.state.PigsList[item].pen && this.state.PigsList[item].pen != 0) {\r\n                        Pen = this.state.PigsList[item].pen\r\n                        if (localDataStore.pens && localDataStore.pens[Pen]){\r\n                          var PenData = localDataStore.pens[Pen];\r\n                          Section = PenData.section;\r\n                        }\r\n                      }\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={item} itemStyle={[{height:35,}]} onPress={() => {\r\n                              this.props.setData(item, Section, Pen)\r\n                              NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={Pen} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={Section} onPress={() => {\r\n                              this.setState({\r\n                                PigTag: item\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={item => \"PigTag_\" + item}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"Pig-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  PigTag: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.PigTag\r\n              }\r\n            />\r\n            <OperationsPanel pig={true} pigTag={this.state.PigTag} PigsList={this.state.PigsList} />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getPigs: (tagId = null) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PIGS, {TagId: tagId})),\r\n    setData: (pigId, Section, Pen) => dispatch(FirebaseActions.setCurrentData({pigId:pigId, type:DataRefs.PIGS, section:Section, dataId:Pen})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pigs);\r\n//export default Pigs;\r\n\r\n//TODO extract to own component also used in DataDisplay\r\nconst Device_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    return(\r\n      <View style={[Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.rowCenter, ]}>\r\n        <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowMain]}>\r\n          <View style={[Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, {maxWidth:150}]}>\r\n            {props && props.connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst Scanner_Display = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    const dispatch = useDispatch()\r\n    const DeviceData = (props && props.DeviceData)?props.DeviceData:null\r\n    return(\r\n      <View style={{flexDirection: 'row',justifyContent: 'space-between', borderWidth:1, borderColor:'#000', borderRadius: 25, paddingHorizontal:15, paddingVertical:10, marginBottom:10}}>\r\n        <View style={Style.textContainer, {paddingTop: 10}}>\r\n          {\r\n            // App scanners data\r\n          }\r\n          {DeviceData&&DeviceData.tagid? (\r\n          <View style={{marginBottom:5}}>\r\n            <Text>TAG Id:</Text>\r\n            <Text>{DeviceData.tagid}</Text>\r\n          </View>\r\n          ):(<></>)}\r\n          {DeviceData&& DeviceData.FatLayers && DeviceData.FatLayers > 0 ? (\r\n            <View style={{marginBottom:5}}>\r\n              <Text>Layers received: {DeviceData.FatLayers}</Text>\r\n              <Text>Layer 1: {DeviceData.FatL1}</Text>\r\n              <Text>Layer 2: {DeviceData.FatL2}</Text>\r\n              <Text>Layer 3: {DeviceData.FatL3}</Text>\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {DeviceData&& DeviceData.tagid ? (\r\n          <View style={{flexDirection: 'row',justifyContent: 'space-between'}}>\r\n            {known ?(\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Open data\" onPress={() => {\r\n              dispatch(FirebaseActions.setCurrentData({pigId:known, type:DataRefs.PIGS}))\r\n              NavigationService.navigate(\"DataDisplay\")\r\n            }}/>\r\n            ):(<></>)}\r\n            <Button buttonStyle={ApplicationStyles.button, {minWidth: 0}} Text=\"Save Tag\" onPress={() => {\r\n              //dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.PIGS, {FarmId: Object.keys(localDataStore.userData.farms)[0]}))\r\n            }}/>\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }else {\r\n    return(<></>)\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView, FlatList, TouchableOpacity, Image } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nimport { SectionGrid } from 'react-native-super-grid';\r\n\r\nclass Pens extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Weighings, Mid} = this.setData(props)\r\n    this.state = {\r\n      Mid: Mid,\r\n      Sections: Sections,\r\n      Weighings: Weighings\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var Sections = {}\r\n    if (localDataStore && localDataStore.sections) {\r\n      Sections = sortObject(Props.firebase.localDataStore.sections)\r\n    }\r\n\r\n    var Mid = 0;\r\n    var Weighings = {}\r\n    if (localDataStore && localDataStore.weighings) {\r\n      Weighings = localDataStore.weighings\r\n      for (const property in localDataStore.weighings) {\r\n        if (localDataStore.weighings[property] && Object.keys(localDataStore.weighings[property]).length > 0){\r\n          var weight = localDataStore.weighings[property][Object.keys(localDataStore.weighings[property])[0]].weight\r\n          if (weight){\r\n            if (Mid > 0){\r\n              Mid = ((Mid + weight)/2)\r\n            } else {\r\n              Mid = (Mid + weight)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return {Sections, Weighings, Mid}\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n    if (!localDataStore.weighings) localDataStore.weighings = {}\r\n    if (!localDataStore.batchs) localDataStore.batchs = {}\r\n    if (!localDataStore.graphs) localDataStore.graphs = {}\r\n\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n    this.props.getPens(localDataStore.pens.update_time)\r\n    this.props.getWeights(localDataStore.weighings.update_time, localDataStore.sections)\r\n\r\n    this.props.getBatch(localDataStore.batchs.update_time)\r\n    this.props.getCurve(localDataStore.graphs.update_time)\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) ||\r\n            (this.props.firebase.localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.weighings)))\r\n        ) {\r\n          const {Sections, Mid} = this.setData(this.props)\r\n          this.setState({\r\n            Mid: Mid,\r\n            Sections: Sections\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.fullSize, Helpers.fill]}>\r\n          {this.state.Sections? (\r\n            <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n              <SectionGrid\r\n                itemDimension={70}\r\n                spacing={10}\r\n                sections={\r\n                  Object.keys(this.state.Sections).filter(e => e !== 'update_time').map((Section) => {\r\n                    var Pens = sortObject(this.state.Sections[Section].pens)\r\n                    return(\r\n                      {\r\n                        title: Section,\r\n                        data: Object.keys(Pens)\r\n                      }\r\n                    )\r\n                  })\r\n                }\r\n\r\n                renderSectionHeader={({ section }) => (\r\n                  <View style={[Helpers.buttonContainer, Helpers.midWidth, {marginBottom:0}]}>\r\n                    <Button Text={section.title} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                      onPress={() => {} }/>\r\n                  </View>\r\n                )}\r\n\r\n                renderItem={({ item }) => {\r\n                  var color = Colors.gray\r\n                  var displayWeight = null\r\n\r\n                  var Predict = CurvePredict(localDataStore, item)\r\n                  if (Predict != null) color = Colors.pigpink\r\n                  if (Predict && Predict.Now) {\r\n                    var Batch = Predict.Batch  //Mabye optain batch self ??\r\n\r\n                    var devianceMin = 2\r\n                    var devianceMax = 5\r\n                    if (Batch.datas.devianceMin) {\r\n                      devianceMin = Batch.datas.devianceMin\r\n                    }\r\n                    if (Batch.datas.devianceMax) {\r\n                      devianceMax = Batch.datas.devianceMax\r\n                    }\r\n                    var ExValue = Predict.TempEx\r\n                    var Weight = Predict.Now;\r\n                    var devianceValMin = (ExValue/100)* devianceMin\r\n                    var devianceValMax = (ExValue/100)* devianceMax\r\n                    if (ExValue && Weight < ExValue && Weight < ExValue - devianceValMin) {\r\n                      color = Colors.error\r\n                    } else if (ExValue && Weight > ExValue && Weight > ExValue + devianceValMax) {\r\n                      color = Colors.overest\r\n                    } else {\r\n                      color = Colors.success\r\n                    }\r\n                    displayWeight = Math.round(Weight * 100) / 100\r\n                  }\r\n\r\n                  return(\r\n                    <TouchableOpacity style={[Helpers.borderContainer, {width:70, height:70, alignItems:\"center\", justifyContent:\"center\", backgroundColor:color}]}\r\n                      onPress={() => {\r\n                        this.props.setCurrentData(item)\r\n                        NavigationService.navigate(\"DataDisplay\")\r\n                      }}>\r\n                      <Text>{item}</Text>\r\n                      {displayWeight?(<Text>{displayWeight + \" kg\"}</Text>):(<></>)}\r\n                    </TouchableOpacity>\r\n                  )\r\n                }}\r\n              />\r\n            </ScrollView>\r\n          ):(\r\n            <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n              <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n            </View>\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n    getCurve: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\", DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pens);\r\n//export default Pens;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, GetStats_FromBatch, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, CustomListItem, Datetime_Picker } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport Icon from 'react-native-vector-icons/MaterialIcons'\r\nimport SectionedMultiSelect from 'react-native-sectioned-multi-select'\r\n\r\n//import moment from 'moment';\r\n//import SimplerDatePicker from '@cawfree/react-native-simpler-date-picker';\r\n//import DatePicker from 'react-native-simple-date-picker';\r\n\r\n//import DateTimePicker from '@react-native-community/datetimepicker';\r\n\r\n//Genneral test for submodule merge (please delete this line)\r\n\r\nimport SelectBox from 'react-native-multi-selectbox'\r\nimport { xorBy } from 'lodash'\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nclass Batchs extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {BatchList, freePens} = this.setData(props)\r\n    this.state = {\r\n      dimensions: {window, screen},\r\n      BatchList: BatchList,\r\n\r\n      Display: 0,\r\n\r\n      BatchName: \"\",\r\n      ShowPicker: false,\r\n      StartD: new Date().getTime(),\r\n      Curve: \"\",\r\n      DevianceMin: \"\",\r\n      DevianceMax: \"\",\r\n\r\n      freePens: freePens,\r\n      avaiblePens: freePens,\r\n      selectedPens: [],\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var BatchList = localDataStore.batchs\r\n    \r\n    var freePens = []\r\n    if (BatchList && localDataStore.sections) {\r\n      Object.keys(localDataStore.sections).forEach(section => {\r\n        if (localDataStore.sections[section].pens) {\r\n          var pens = []\r\n          Object.keys(localDataStore.sections[section].pens).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').forEach(pen => {\r\n            var add = true\r\n            Object.keys(BatchList).forEach(batch => {\r\n              if (!BatchList[batch].state || BatchList[batch].state !== \"Closed\") {\r\n                if (BatchList[batch].pens && BatchList[batch].pens[pen] && !BatchList[batch].pens[pen].enddate) {\r\n                  add = false;\r\n                }\r\n              }\r\n            });\r\n            if (add) {\r\n              var item = {\r\n                item: pen,\r\n                id: section + \"_\" + pen\r\n              }\r\n              freePens.push(item)\r\n            }\r\n          })\r\n        }\r\n      });\r\n    }\r\n    return { BatchList, freePens }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    if (!localDataStore.pens) localDataStore.pens = {}\r\n\r\n    this.props.getBatch(localDataStore.batchs?localDataStore.batchs.update_time:null)\r\n    this.props.getSections(localDataStore.sections?localDataStore.sections.update_time:null)\r\n    this.props.getPens(localDataStore.pens?localDataStore.pens.update_time:null)\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if ((this.props.firebase.localDataStore.batchs && JSON.stringify(this.state.BatchList)!==JSON.stringify(this.props.firebase.localDataStore.batchs)) ||\r\n            (this.props.firebase.localDataStore.pens && JSON.stringify(this.state.pens)!==JSON.stringify(this.props.firebase.localDataStore.pens))) {\r\n          const {BatchList, freePens} = this.setData(this.props)\r\n          this.setState({\r\n            freePens: freePens,\r\n            BatchList: BatchList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    Dimensions.addEventListener(\"change\", this.onChange);\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  onMultiChange = (item) => {\r\n    var items = xorBy(this.state.selectedPens, [item], 'id')\r\n    this.setState({\r\n      selectedPens: items\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    var wide = this.state.dimensions.window.width>900?true:false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    return(\r\n      <ScrollView style={[Metrics.verticalMargin, {paddingRight: 5}]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n            {this.state.Display === 0?(\r\n              //#region Normal Front View to display all batches.\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.BatchList ? (\r\n                  <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                    <FlatList scrollEnabled={true} style={[Helpers.fill]}\r\n                      data={Object.keys(this.state.BatchList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                      renderItem={({item, i})=>{\r\n                        var name = item;\r\n                        if (this.state.BatchList[item] && this.state.BatchList[item].state && this.state.BatchList[item].state === \"Closed\") {\r\n                          name += \"  Closed\"\r\n                        }\r\n                        return(\r\n                          <Button Text={name} onPress={() => {\r\n                            var curveId = \"default\"\r\n                            if (this.state.BatchList[item] && this.state.BatchList[item].gcurve) {\r\n                              curveId = this.state.BatchList[item].gcurve\r\n                              if (typeof curveId !== 'string') curveId = null\r\n                            }\r\n                            this.props.setCurrentData(item, curveId)\r\n                            \r\n                            NavigationService.navigate('DataPlotter')\r\n                          }}/>\r\n                        )\r\n                      }}\r\n                      keyExtractor={(item, index) => index.toString()}\r\n                    />\r\n                  </View>\r\n                ):(<></>)}\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n                  <Button Text={\"New Batch\"} onPress={() => {\r\n                    var graph = 0\r\n                    if (localDataStore && localDataStore.graphs) {\r\n                      graph = Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time')[0]\r\n                    }\r\n                    this.setState({\r\n                      Display: 1,\r\n\r\n                      DevianceMin: String(2),\r\n                      DevianceMax: String(2),\r\n                      Curve: graph,\r\n\r\n                      freePens: this.state.freePens,\r\n                      avaiblePens: this.state.freePens,\r\n                      selectedPens: [],\r\n                    })\r\n                  }}/>\r\n                  {this.state.BatchList?(\r\n                  <Button Text={\"Edit or Close Batch\"} onPress={() => {\r\n                    var batchName = Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      )[0]\r\n                    var batch = this.state.BatchList[batchName]\r\n                    if (batch) {\r\n                      var Pens = []\r\n                      var pens = sortObject(batch.pens)\r\n                      Object.keys(pens).forEach(element => {\r\n                        if (!batch.pens[element].enddate) {\r\n                          if (localDataStore.pens && localDataStore.pens[element]){\r\n                            var _pen = localDataStore.pens[element]\r\n                            var item = {}\r\n                            item.item = element;\r\n                            item.id = _pen.section + \"_\" + element;\r\n                            Pens.push(item)\r\n                          }\r\n                        }\r\n                      });\r\n\r\n                      this.setState({\r\n                        Display: 2,\r\n                        BatchName: batchName,\r\n                        StartD: batch.time,\r\n                        Curve: batch.gcurve,\r\n                        DevianceMin: String(batch.datas.devianceMin),\r\n                        DevianceMax: String(batch.datas.devianceMax),\r\n                        avaiblePens: this.state.freePens.concat(Pens),\r\n                        selectedPens: Pens\r\n                      })\r\n                    }\r\n                  }}/>):(<></>)}\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            ):(\r\n              //#region Edit or create\r\n              <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n                {this.state.Display === 1?( // Create\r\n                  <Input label={\"BatchName\"}\r\n                    containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, ]}\r\n                    onChangeText={text => {\r\n                      if (text){\r\n                        if (DataStringCheck(text)){\r\n                          this.setState({BatchName: text})\r\n                        }\r\n                      }else {\r\n                        this.setState({BatchName: text})\r\n                      }\r\n                    }}\r\n                    value={\r\n                      this.state.BatchName\r\n                    }\r\n                  />\r\n                ):( // Edit\r\n                  <View style={[Helpers.borderContainer, Helpers.fullWidth, {height:60, borderRadius:0, alignItems:\"center\"}]}>\r\n                    <Picker\r\n                      mode=\"dropdown\"\r\n                      selectedValue={this.state.BatchName}\r\n                      style={[Helpers.fullWidth, { height: 50, justifyContent:\"flex-end\"}]}\r\n                      onValueChange={(itemValue, itemIndex) => {\r\n                        if (this.state.BatchList && this.state.BatchList[itemValue]) {\r\n                          var batch = this.state.BatchList[itemValue]\r\n\r\n                          var Pens = []\r\n                          var pens = sortObject(batch.pens)\r\n                          Object.keys(pens).forEach(element => {\r\n                            if (!batch.pens[element].enddate) {\r\n                              if (localDataStore.pens && localDataStore.pens[element]){\r\n                                var _pen = localDataStore.pens[element]\r\n                                var item = {}\r\n                                item.item = element;\r\n                                item.id = _pen.section + \"_\" + element;\r\n                                Pens.push(item)\r\n                              }\r\n                            }\r\n                          });\r\n\r\n                          this.setState({\r\n                            BatchName: itemValue,\r\n                            StartD: batch.time,\r\n                            Curve: batch.gcurve,\r\n                            DevianceMin: String(batch.datas.devianceMin),\r\n                            DevianceMax: String(batch.datas.devianceMax),\r\n                            avaiblePens: this.state.freePens.concat(Pens),\r\n                            selectedPens: Pens,\r\n                          })\r\n                        }\r\n                      }}\r\n                    >\r\n                      {Object.keys(this.state.BatchList)\r\n                                      .filter(e => e !== '__jsogObjectId'  && e !== 'update_time' && \r\n                                              (!this.state.BatchList[e].state || this.state.BatchList[e].state !== \"Closed\")\r\n                                      ).map((graph, i) => {\r\n                        return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                      })}\r\n                    </Picker>\r\n                  </View>\r\n                )}\r\n                <View style={[Helpers.fullWidth, App?{}:Helpers.row, {zIndex:999}]}>\r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1 , marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Start date:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, App?{marginBottom:10}:{},{alignItems:'flex-start',}]}>\r\n                      <Datetime_Picker Selected={this.state.StartD}\r\n                        onValueChange={(date)=>{\r\n                          this.setState({\r\n                            StartD: date.getTime()\r\n                          })\r\n                      }}/>\r\n                    </View>\r\n                  </View>\r\n                  \r\n                  <View style={[App?{}:Helpers.halvWidth, {borderWidth:1, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\", zIndex:1}]}>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"flex-start\", marginBottom: -5}]}>\r\n                      <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Growth curve:</Text>\r\n                    </View>\r\n                    <View style={[Helpers.fullWidth, {alignItems:\"center\"}]}>\r\n                      <Picker\r\n                        mode=\"dropdown\"\r\n                        selectedValue={this.state.Curve}\r\n                        style={[Helpers.fullWidth, {height: 30}]}\r\n                        onValueChange={(itemValue, itemIndex) => {\r\n                          this.setState({\r\n                            Curve: itemValue\r\n                          })\r\n                        }}\r\n                      >\r\n                        {Object.keys(localDataStore.graphs).filter(e => e !== '__jsogObjectId'  && e !== 'update_time').map((graph, i) => {\r\n                          return (<Picker.Item label={graph} value={graph} key={i}/>)\r\n                        })}\r\n                      </Picker>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, Helpers.row]}>\r\n                  <Input label={\"Deviance Min alert procentage\"}\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (isNaN(text)) {\r\n                        if (!text.endsWith(\".\")) return;\r\n                      }\r\n                      this.setState({\r\n                        DevianceMin: text\r\n                      })\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMin\r\n                    }\r\n                  />\r\n                  <Input label={\"Deviance Max alert procentage\"}\r\n                    containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                    style={[ApplicationStyles.input, {marginBottom:-10}]}\r\n                    onChangeText={text => {\r\n                      if (isNaN(text)) {\r\n                        if (!text.endsWith(\".\")) return;\r\n                      }\r\n                      this.setState({\r\n                        DevianceMax: text\r\n                      })\r\n                    }}\r\n                    value={\r\n                      this.state.DevianceMax\r\n                    }\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {borderWidth:1, marginTop:10, paddingHorizontal:10, paddingTop:5}]}>\r\n                  <SelectBox\r\n                    label=\"Pens in Batch..\"\r\n                    labelStyle={{color:Colors.input, fontSize: 15, fontWeight: \"bold\"}}\r\n                    optionsLabelStyle={{minWidth:100, color:\"black\", fontSize: 12, fontWeight: \"bold\"}}\r\n\r\n                    options={this.state.avaiblePens}\r\n                    selectedValues={this.state.selectedPens}\r\n                    onMultiSelect={this.onMultiChange}\r\n                    onTapClose={this.onMultiChange}\r\n                    isMulti\r\n                  />\r\n                </View>\r\n                <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                  {this.state.Display === 2?(\r\n                    <Button Text={\"Close Batch\"} onPress={() => {\r\n                      var Batch = localDataStore.batchs[this.state.BatchName];\r\n                      if (Batch) {\r\n                        var {StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual} = GetStats_FromBatch(Batch, localDataStore)\r\n                        if (Animals){\r\n                          this.props.setViewError(\"The batch still contains active pens, please clear pens before closing the batch\")\r\n                        }else {\r\n                          var newBatch = {name:this.state.BatchName, state:\"Closed\"}\r\n                          this.props.updateBatch(newBatch)\r\n                          this.setState({\r\n                            Display: 0\r\n                          })\r\n                          this.props.getPens(localDataStore.pens.update_time)\r\n                        }\r\n                      }\r\n                    }}/>\r\n                  ):(\r\n                    <></>\r\n                  )}\r\n                  <Button Text={\"Save\"} onPress={() => {\r\n                    var update = true;\r\n\r\n                    if (this.state.BatchName !== \"\") {\r\n                      var Name = this.state.BatchName;\r\n                      if (!Object.keys(this.state.BatchList).includes(Name)){\r\n                        if (this.state.Display === 2) { // update on non existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch does not exists\")\r\n                        }\r\n                      } \r\n                      else {\r\n                        if (this.state.Display === 1) { // create on allready existing\r\n                          update = false \r\n                          this.props.setViewError(\"BatchName error, batch allready exists\")\r\n                        }\r\n                      }\r\n                    } else {\r\n                      update = false \r\n                      this.props.setViewError(\"BatchName error\")\r\n                    }\r\n\r\n                    if (this.state.StartD !== \"\") {\r\n                      /*var StartD = this.state.StartD.split(\".\")\r\n                      if (StartD.length !== 3 || StartD[0].length !== 4 || isNaN(StartD[0]) || \r\n                                                (StartD[1].length <= 0 && StartD[1].length >= 3) || isNaN(StartD[1]) ||\r\n                                                (StartD[2].length <= 0 && StartD[2].length >= 3)|| isNaN(StartD[2])) {\r\n                        update = false \r\n                        this.props.setViewError(\"Startdate error\")\r\n                      }*/\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"Startdate error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMin !== \"\") {\r\n                      var Dev = this.state.DevianceMin\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMin setting error\")\r\n                    }\r\n\r\n                    if (this.state.DevianceMax !== \"\") {\r\n                      var Dev = this.state.DevianceMax\r\n                      if (Dev.length > 3 || isNaN(Dev) || Dev > 100){\r\n                        update = false \r\n                      }\r\n                    }else {\r\n                      update = false \r\n                      this.props.setViewError(\"DevianceMax setting error\")\r\n                    }\r\n\r\n                    if (this.state.Curve === \"\"){\r\n                      update = false \r\n                      this.props.setViewError(\"Growth curve setting error, please reselect a curve\")\r\n                    }\r\n\r\n                    var Pens = {}\r\n                    if (this.state.selectedPens && this.state.selectedPens.length > 0) {\r\n                      this.state.selectedPens.forEach(element => {\r\n                        Pens[element.item] = true\r\n                      });\r\n                    }\r\n                    if (Object.keys(Pens).length !== this.state.selectedPens.length) {\r\n                      update = false\r\n                      this.props.setViewError(\"An error occurred during Pen assigning (please update the page)\")\r\n                    }\r\n\r\n                    if (update) {\r\n                      this.props.setViewLoading(true)\r\n                      var _Date = new Date(this.state.StartD)\r\n                      var StartD = new Date(_Date.getFullYear(), _Date.getMonth(), _Date.getDate()).getTime()\r\n                      var newBatch = {name:this.state.BatchName, gcurve:this.state.Curve, pens:Pens, time: StartD, datas:{devianceMin: this.state.DevianceMin, devianceMax: this.state.DevianceMax}}\r\n                      if (this.state.Display === 1) {\r\n                        this.props.setBatch(newBatch)\r\n                      }\r\n                      else if (this.state.Display === 2) {\r\n                        this.props.updateBatch(newBatch)\r\n                      }\r\n                      this.setState({\r\n                        Display: 0\r\n                      })\r\n                      this.props.getPens(localDataStore.pens.update_time)\r\n                      this.props.setViewError(null)\r\n                      this.props.setViewLoading(false)\r\n                    }\r\n                  }}/>\r\n                </View>\r\n              </View>\r\n              //#endregion\r\n            )}\r\n          </View>\r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {})),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, { DataTime: DataTime})),\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.BATCHS, {Batch: batch})),\r\n    updateBatch: (batch) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.BATCHS, {BatchId: batch.name, Batch: batch})),\r\n    \r\n    setCurrentData: (batchId, curveId) => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, batchId:batchId, curveId: curveId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Batchs);\r\n//export default Batchs;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, GetCurve_FromBatch, AccumulateTime, get_DataSpot, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\n\r\nfunction getRandomNumber(low, high) {\r\n  var r = Math.floor(Math.random() * (high - low + 1)) + low;\r\n  return r;\r\n}\r\n\r\nfunction getRandomColor() {\r\n  var red_range = [10, 250];\r\n  var green_range = [10, 250];\r\n  var blue_range = [10, 250];\r\n  var a_range = [0.2, 1];\r\n\r\n  var red = getRandomNumber(red_range[0], red_range[1]);\r\n  var green = getRandomNumber(green_range[0], green_range[1]);\r\n  var blue = getRandomNumber(blue_range[0], blue_range[1]);\r\n\r\n  var alpha = getRandomNumber(a_range[0] * 100, a_range[1] * 100) / 100;\r\n\r\n  return {\r\n    r: red,\r\n    g: green,\r\n    b: blue,\r\n    a: alpha,\r\n    rgbaValue: 'rgba(' + red + ',' + green + ',' + blue + ',' + alpha + ')'\r\n  }\r\n}\r\n\r\nconst window = Dimensions.get(\"window\");\r\nconst screen = Dimensions.get(\"screen\");\r\n\r\nfunction WeightsToGraphData(localDataStore, Batch, TempGraph = null, StartDate = undefined, _EndDate = undefined, Prediction = false) {\r\n  var DataSets = []\r\n  var EndDate = 0;\r\n\r\n  var DoPredict = (Batch && (!Batch.state || Batch.state !== \"Closed\"))?true:false\r\n  var Legends = []\r\n  if (Batch.pens) Legends = Object.keys(Batch.pens).filter(e => (e !== '__jsogObjectId')).reverse()\r\n  Legends.forEach(Pen => {\r\n    var BatchPen = Batch.pens[Pen]\r\n    var color = getRandomColor();\r\n\r\n    var DataSet = []\r\n    var DataSetX = []\r\n\r\n    if (localDataStore.weighings[Pen] || (Batch.state && Batch.state === \"Closed\")) {\r\n      var PenWeighings = localDataStore.weighings[Pen];\r\n      if (Batch.state && Batch.state === \"Closed\") {\r\n        PenWeighings = Batch.closed.weighings[Pen]\r\n      }\r\n\r\n      if (PenWeighings && Object.keys(PenWeighings).length >= 1) {\r\n        Object.keys(PenWeighings).sort(function(a, b) {\r\n          return PenWeighings[a].time - PenWeighings[b].time;\r\n        }).forEach(key => {\r\n          var data = PenWeighings[key]\r\n          if (data.weight) {\r\n            if ((!StartDate || data.time >= StartDate) && (!_EndDate || data.time <= _EndDate)) {\r\n              if ((!BatchPen.startdate || data.time >= BatchPen.startdate) && (!BatchPen.enddate || data.time <= BatchPen.enddate)) {\r\n                var weight = data.weight\r\n                if (data.count) {\r\n                  weight = weight / data.count\r\n                }\r\n                DataSet.push(weight)\r\n                var Time = new Date(data.time)\r\n                //Time = new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime() // allows midday placement\r\n                DataSetX.push(Time)\r\n                if (!_EndDate && data.time > EndDate) {\r\n                  EndDate = data.time\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n\r\n        if (DoPredict && Prediction) {\r\n          var Predict = CurvePredict(localDataStore, Pen)\r\n          if (Predict && Predict.lastWeighing) {\r\n            var Time = Predict.FirstSpot?new Date(Predict.FirstSpot):new Date(Predict.lastWeighing.time)\r\n            //var DatePredict = []\r\n            //var DataPredicttX = []\r\n            Predict.data.forEach((element,index) => {\r\n              DataSet.push(element)\r\n              Time = (index===0&&Predict.FirstSpot)?Time:AccumulateTime(Time, TempGraph.periode)\r\n              DataSetX.push(Time)\r\n              //DataSetX.push(new Date(Time.getFullYear(),Time.getMonth(),Time.getDate()).getTime())\r\n            });\r\n            //if (Predict.length > 0){\r\n            //  DataSets.push({Pen: Pen + \"_Predict\", data: DatePredict, dataX: DataPredictX, color:(opacity = 0) => color.rgbaValue})\r\n            //}\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    while(DataSet.length < TempGraph.data.length) {\r\n      DataSet.push(null)\r\n      DataSetX.push(null)\r\n    }\r\n    DataSets.push({Pen: Pen, data: DataSet, dataX: DataSetX, color:(opacity = 1) => color.rgbaValue})\r\n  });\r\n  return {DataSets, EndDate};\r\n}\r\n\r\nclass CurveElement extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (!this.props.Display) {\r\n      const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(props)\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n\r\n        TempGraph: TempGraph,\r\n        Legends: Legends,\r\n        DataSets: DataSets,\r\n        StartDate: StartDate,\r\n        EndDate: EndDate,\r\n\r\n        Labels: [],\r\n        ActiveIndex: 0,\r\n        ActiveLength: \"Batch\",\r\n        ActiveDataSets: DataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n\r\n        ViewPoint: null,\r\n      }\r\n    } else {\r\n      this.state = {\r\n        dimensions: {window, screen},\r\n      }\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var TempGraph = {periode:\"Weeks\", data: []} //Template Graph\r\n    var Legends = []     //Name lables\r\n    var DataSets = []    //Data Points\r\n\r\n    var D = new Date()\r\n    var StartDate = D.getTime()\r\n    var EndDate = new Date(D.setDate(D.getDate()+(7*8))) //Default timespand is 2 months or 8 weeks (will be changed acording to batch)\r\n\r\n    if (localDataStore && localDataStore.batchs && CurrentData && CurrentData.batchId) {\r\n      var Batch = localDataStore.batchs[CurrentData.batchId];\r\n      TempGraph = GetCurve_FromBatch(Batch, localDataStore.graphs, CurrentData.curveId)\r\n\r\n      if (TempGraph) {\r\n        if (CurrentData.curveId) TempGraph.name = CurrentData.curveId\r\n        else TempGraph.name = \"Template\"\r\n        //Find Startdate\r\n        StartDate = Batch.time\r\n        //Find Batch Pens (Legends)\r\n        if (Batch.pens) Legends = Legends.concat(Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')))\r\n\r\n        var DataX = []\r\n        //#region Find Template X values and EndDate\r\n        if (!TempGraph.periode){\r\n          TempGraph.periode = \"Weeks\"\r\n        }\r\n        var currentTime = new Date(StartDate)\r\n        for (var i = 0; i < TempGraph.data.length; i++) {\r\n          DataX.push(currentTime.getTime())\r\n          if (i < TempGraph.data.length -1) {\r\n            currentTime = new Date(AccumulateTime(currentTime, TempGraph.periode))\r\n          }\r\n        }\r\n        EndDate = currentTime.getTime();\r\n        DataX.push(EndDate)\r\n        //#endregion\r\n        \r\n        //Set TempGraph data\r\n        DataSets.push({\r\n          data: TempGraph.data,\r\n          dataX: DataX,\r\n          color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`, // optional\r\n        })\r\n\r\n        //Find DataSets from Legends\r\n        if (localDataStore.weighings) {\r\n          var TempData = DataSets\r\n          var TempEndDate = EndDate\r\n          var NextEnd = new Date(AccumulateTime(new Date(TempEndDate), TempGraph.periode)).getTime()\r\n          var {DataSets, EndDate} = WeightsToGraphData(localDataStore, Batch, TempGraph, StartDate, NextEnd, this.props.Predict)\r\n          DataSets = TempData.concat(DataSets)\r\n\r\n          if (TempEndDate > EndDate) {\r\n            EndDate = TempEndDate\r\n          }\r\n\r\n          Legends = Legends.filter(e => (e !== '__jsogObjectId' && (e === TempGraph.name || DataSets.some(i => i.Pen === e))));\r\n          Legends.unshift(TempGraph.name)\r\n        }\r\n      }\r\n    }\r\n    return {TempGraph, Legends, DataSets, StartDate, EndDate }\r\n  }\r\n\r\n  setGraphPeriode(ActiveLength = this.state.ActiveLength) {\r\n    var Labels = []\r\n\r\n    var StartDate = this.state.StartDate\r\n    var EndDate = this.state.EndDate\r\n    var ActiveIndex = this.state.ActiveIndex\r\n\r\n    var TemplatePeriode = \"Weeks\"\r\n    if (this.state.TempGraph && this.state.TempGraph.periode) TemplatePeriode = this.state.TempGraph.periode\r\n    var CurrentDate = new Date(StartDate)\r\n    var TempActiveDataSet = this.state.ActiveDataSets;\r\n\r\n    var Today = new Date().getTime()\r\n    switch(this.state.ActiveLength) {\r\n      case \"Days\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i-1;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n        \r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n\r\n        EndDate = CurrentDate.getTime();\r\n        CurrentDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n        break;\r\n      case \"Weeks\":\r\n        for (var i = 0; (i < ActiveIndex || ActiveIndex === -1); i++){\r\n          var getNewDate = new Date(AccumulateTime(CurrentDate, this.state.ActiveLength))\r\n          if (ActiveIndex === -1 && getNewDate > Today) {\r\n            ActiveIndex = i;\r\n            break;\r\n          }\r\n          CurrentDate = getNewDate;\r\n        }\r\n        StartDate = CurrentDate.getTime();\r\n\r\n        for (var i = 0; i <= 7; i++) {\r\n          Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n          EndDate = CurrentDate.getTime();\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, \"Days\"))\r\n        }\r\n        break;\r\n      case \"Batch\":\r\n      default:\r\n        while (CurrentDate.getTime() <= EndDate) {\r\n          switch (TemplatePeriode){\r\n            case \"Days\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Month\":\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n            case \"Weeks\":\r\n            default:\r\n              Labels.push(CurrentDate.getDate() + \"/\" + (CurrentDate.getMonth() + 1))\r\n              break;\r\n          }\r\n          CurrentDate = new Date(AccumulateTime(CurrentDate, TemplatePeriode))\r\n        }\r\n        break;\r\n    }\r\n\r\n    var ActiveDataSets = []\r\n    if (!ActiveLength || ActiveLength === \"Batch\") {\r\n      ActiveDataSets = this.state.DataSets;\r\n    }\r\n    else {\r\n      var End = AccumulateTime(new Date(EndDate), this.state.ActiveLength).getTime()\r\n      this.state.DataSets.forEach(element => {\r\n        var NewData = {...element, data:[], dataX: []}\r\n\r\n        var first = null\r\n        var last = null\r\n        if (new Date(element.dataX[0]).getTime() <= EndDate) {\r\n          for(var i = 0; i < element.data.length; i++) {\r\n            if (new Date(element.dataX[i]).getTime() >= StartDate) {\r\n              NewData.data.push(element.data[i])\r\n              NewData.dataX.push(element.dataX[i])\r\n\r\n              var time = AccumulateTime(new Date(element.dataX[i]), this.state.ActiveLength)\r\n              if (time.getTime() > End){\r\n                if (element.dataX.length -1 >= i) last = i\r\n                break;\r\n              }\r\n            } else if (element.dataX[i] !== null) {\r\n              first = i\r\n            }\r\n          }\r\n          if (first !== null && NewData.dataX[0] > StartDate && element.data.length >= first+1) {\r\n            var DataSpot = get_DataSpot([element.dataX[first], element.dataX[first+1]], [element.data[first], element.data[first +1]], StartDate, element.data[first], element.dataX[first])\r\n            console.log(DataSpot)\r\n            NewData.data.unshift(DataSpot.ExValue)\r\n            NewData.dataX.unshift(StartDate)\r\n          }\r\n          if (last != null) {\r\n            //NewData.data.push(ExValue)\r\n            //NewData.dataX.push(StartDate)\r\n          }\r\n        }\r\n\r\n        ActiveDataSets.push(NewData)\r\n      });\r\n    }\r\n\r\n    //var lastDataPoint = this.state.DataSets[0].dataX[this.state.DataSets[0].dataX.length-1]\r\n    if (this.state.ActiveIndex > 0 && ActiveDataSets[0].data.length === 0){\r\n      var i = this.state.ActiveIndex\r\n      i = i-1;\r\n      this.setState({\r\n        ActiveIndex: i\r\n      })\r\n    } else {\r\n      this.setState({\r\n        ActiveLength: ActiveLength,\r\n        \r\n        Labels: Labels,\r\n        ActiveDataSets: ActiveDataSets,\r\n        ActiveStartDate: StartDate,\r\n        ActiveEndDate: EndDate,\r\n        ActiveIndex: ActiveIndex,\r\n      }, () => {\r\n        this.forceUpdate()\r\n      })\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    /*if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      var WeightsMemTime = null\r\n      if (localDataStore.weighings) WeightsMemTime = localDataStore.weighings.update_time\r\n      Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n        this.props.getPen(Pen, PenMemTime)\r\n        this.props.getWeights(Pen, WeightsMemTime, localDataStore.sections)\r\n      })\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n        this.props.getCurve(TempGraph)\r\n      }\r\n    }*/\r\n  }\r\n\r\n  onChange = ({ window, screen }) => {\r\n    this.setState({\r\n      dimensions: {window, screen},\r\n    })\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (!this.props.Display && this.props !== prevProps) {\r\n      if (this.props.firebase.localDataStore) {\r\n        if (JSON.stringify(prevProps.firebase.localDataStore.weighings) !== JSON.stringify(this.props.firebase.localDataStore.weighings) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.pens) !== JSON.stringify(this.props.firebase.localDataStore.pens) ||\r\n            JSON.stringify(prevProps.firebase.localDataStore.graphs) !== JSON.stringify(this.props.firebase.localDataStore.graphs) || \r\n            prevProps.Predict !== this.props.Predict || \r\n            prevProps.weighings !== this.props.weighings) {\r\n          const {TempGraph, Legends, DataSets, StartDate, EndDate } = this.setData(this.props)\r\n          if (JSON.stringify(this.state.TempGraph)!==JSON.stringify(TempGraph) ||\r\n              JSON.stringify(this.state.Legends)!==JSON.stringify(Legends) ||\r\n              JSON.stringify(this.state.DataSets)!==JSON.stringify(DataSets) ||\r\n\r\n              JSON.stringify(this.state.StartDate)!==JSON.stringify(StartDate) ||\r\n              JSON.stringify(this.state.EndDate)!==JSON.stringify(EndDate)\r\n          ) {\r\n            this.setState({\r\n              TempGraph: TempGraph,\r\n              Legends: Legends,\r\n              DataSets: DataSets,\r\n        \r\n              StartDate: StartDate,\r\n              EndDate: EndDate,\r\n            }, () => {\r\n              this.setGraphPeriode(this.state.ActiveLength)\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (!this.props.Display && this.state !== prevState) {\r\n      if (this.state.ActiveLength != prevState.ActiveLength || this.state.ActiveIndex != prevState.ActiveIndex) {\r\n        this.setGraphPeriode(this.state.ActiveLength)\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData();\r\n    if (!this.props.height) Dimensions.addEventListener(\"change\", this.onChange);\r\n    if (!this.props.Display) this.setGraphPeriode(this.state.ActiveLength)\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    if (!this.props.height) Dimensions.removeEventListener(\"change\", this.onChange);\r\n  }\r\n\r\n  render() {\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    var BatchIsOpen = false;\r\n    if (localDataStore.batchs && this.props.firebase.currentData && this.props.firebase.currentData.batchId) {\r\n      BatchIsOpen= ((localDataStore.batchs && localDataStore.batchs[this.props.firebase.currentData.batchId]) && (!localDataStore.batchs[this.props.firebase.currentData.batchId].state || localDataStore.batchs[this.props.firebase.currentData.batchId].state !== \"Closed\"))?true:false\r\n    }\r\n    var wide = this.state.dimensions.window.width>1000?true:false\r\n    if (this.props.Display) wide = false\r\n    var App = (Platform.OS === 'ios' || Platform.OS === 'android')||!wide\r\n\r\n    var height = this.state.dimensions.window.height //Full Screen\r\n    if (this.props.Height) {\r\n      height = this.props.Height;\r\n      //height = height - 100 // ?? beautify'er\r\n    } else {\r\n      height = 500 \r\n      /*if (Platform.OS !== 'ios' && Platform.OS !== 'android') height = height - 64 //Navigation title\r\n      height = height - 49 //TitleElement\r\n      height = height - 145 //Data Props\r\n      height = height - 71 //View Selector\r\n      if (BatchIsOpen) height = height - 74 //Editor\r\n\r\n      height = height - 100 // ?? beautify'er*/\r\n    }\r\n    //height = height - parseInt(10 + 15) //Margins \r\n\r\n    var width = this.state.dimensions.window.width * 2; //Full Screen\r\n    if (this.props.Width) {\r\n      width = this.props.Width;\r\n    } else {\r\n      width = width - (Metrics.normal * 4) // Margins\r\n      width = width / (wide?2.05:1) //If not WideScreen - Split diagram in 2\r\n    }\r\n    \r\n    var DataSets = this.props.Display?[{color: (opacity = 0.1) => `rgba(0, 0, 0, ${opacity})`,data:[],dataX:[]}]:this.state.ActiveDataSets\r\n    var Legends = this.props.Display?[]:this.state.Legends.slice(0, DataSets.length)\r\n    var StartDate = this.props.Display?1:this.state.ActiveStartDate\r\n    var EndDate = this.props.Display?this.props.DataPoints.length:this.state.ActiveEndDate\r\n    var Labels = [];\r\n    if (this.props.Display) {\r\n      this.props.DataPoints.forEach((point,index)=>{\r\n        DataSets[0].data.push(point.value)\r\n        DataSets[0].dataX.push(index +1)\r\n        Labels.push(index +1)\r\n      })\r\n    }else Labels = this.state.Labels\r\n\r\n    return(\r\n      <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n        <View style={[Helpers.fullWidth, Helpers.fill]}>\r\n          <ScrollView horizontal={true} showsHorizontalScrollIndicator={wide||this.props.Display?false:true} style={[Helpers.fullSize, App&&!this.props.Display?{maxWidth:width/2, maxHeight:540}:{}]}>\r\n            {this.state.TempGraph||this.props.Display && (Labels && Labels.length > 0) && (DataSets && DataSets.length > 0)?(\r\n            <LineChart\r\n              //bezier\r\n              style={[{marginLeft: -15, minHeight: height, minWidth: width}]}\r\n              width={width}\r\n              height={height}\r\n\r\n              data={{\r\n                labels: Labels,\r\n                xMinMax: [StartDate, EndDate, Labels.length -1],\r\n                legend: Legends,\r\n                datasets: DataSets,\r\n              }}\r\n\r\n              onDataPointClick={(data) => {\r\n                this.setState({\r\n                  ViewPoint: data\r\n                })\r\n              }}\r\n\r\n              withShadow={false}\r\n              withVerticalLines={true}\r\n              fromZero={false}\r\n              segments={15} //Horizontal-Lines\r\n              \r\n              verticalLabelRotation={0} //Not Working in browser\r\n              xLabelsOffset={0}\r\n\r\n              chartConfig={{\r\n                backgroundColor: Colors.white,\r\n                backgroundGradientFrom: Colors.white,  //#FFFFFF\r\n                backgroundGradientTo: Colors.white,     \r\n                decimalPlaces: 1, // optional, defaults to 2dp\r\n                color: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`,  //Lines / Grid\r\n                labelColor: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`, //Lables\r\n                style: {\r\n                  borderRadius: 16,\r\n                  height: height,\r\n                },\r\n                propsForDots: {\r\n                  r: \"5\",\r\n                  strokeWidth: \"0.5\",\r\n                  stroke: Colors.white\r\n                }\r\n              }}\r\n            />):(<></>)}\r\n          </ScrollView>\r\n        </View>\r\n        {!this.props.Display?(\r\n          <View style={[Helpers.fullWidth, Helpers.mainCenter]}>\r\n            <View style={[Helpers.fill, Helpers.fullWidth, Helpers.rowCenter, ]}>\r\n              <View style={{paddingRight: 2.5}}>\r\n                <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  if (this.state.ActiveIndex != 0){\r\n                    var i = this.state.ActiveIndex;\r\n                    i = i-1;\r\n                    this.setState({\r\n                      ActiveIndex: i\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n              <Button Text=\"Day view\" buttonStyle={{width:wide?100:80}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Days\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Week view\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: -1,\r\n                    ActiveLength: \"Weeks\"\r\n                  })\r\n                } }/>\r\n              <Button Text=\"Full Batch\" buttonStyle={{width:wide?100:80, marginLeft:2.5}}\r\n                onPress={() => {\r\n                  this.setState({\r\n                    ActiveIndex: 0,\r\n                    ActiveLength: \"Batch\"\r\n                  })\r\n                } }/>\r\n              <View style={{paddingLeft: 2.5}}>\r\n                <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n                  var i = this.state.ActiveIndex;\r\n                  i = i+1;\r\n                  this.setState({\r\n                    ActiveIndex: i\r\n                  })\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            {BatchIsOpen&&!App?(\r\n              <View style={[Helpers.fullWidth, Helpers.rowCenter]}>\r\n                  <CurveEditor control={this} props={this.props} state={this.state} />\r\n              </View>\r\n            ):(<></>)}\r\n          </View>\r\n        ):(<></>)}\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst CurveEditor = (props) => {\r\n  if (Platform.OS === 'ios' || Platform.OS === 'android') {\r\n    if (props.state.ViewPoint){\r\n      var TimeText = props.state.Labels[props.state.ViewPoint.index]\r\n      if (props.state.ViewPoint.dataset.dataX) {\r\n        var Time = new Date(props.state.ViewPoint.dataset.dataX[props.state.ViewPoint.index])\r\n        TimeText = Time.getFullYear() + \".\" + (Time.getMonth() +1) + \".\" + Time.getDate()\r\n      }\r\n\r\n      var Data = props.state.ViewPoint.value\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100}] }>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{TimeText}</Text>\r\n          </View>\r\n          <View style={[Helpers.colCenter, Helpers.borderContainer, {borderRadius:0}]}>\r\n            <Text>{Data} Kg.</Text>\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n    else return(<></>)\r\n  } else {\r\n    const [Point, setPoint] = React.useState(0)\r\n    if (!props.state.TempGraph) {\r\n      return(<></>)\r\n    }\r\n    else {\r\n      return (\r\n        <View style={[Helpers.buttonContainer, Helpers.fullWidth, Helpers.rowCenter, {maxHeight:100,marginTop:10}] }>\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index -1\r\n              if (index < 0) {\r\n                index = props.state.TempGraph.data.length -1\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              type='number'\r\n              step=\"0.1\"\r\n\r\n              label={props.state.Labels[Point]}\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n\r\n              onChange= {(evt) => {\r\n                var text = evt.target.value\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  NewData[Point] = text\r\n                  \r\n                  props.control.setState({\r\n                    state: props.state,\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n                  props.control.setGraphPeriode(props.state.ActiveLength)\r\n                }\r\n              }}\r\n              /*onChangeText={text => {\r\n                if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                  var NewData = props.state.TempGraph.data;\r\n                  if (text === \"\" || text === null) text = 0\r\n                  if (text.endsWith('.')) text = text + \"0\"\r\n                  NewData[Point] = parseFloat(text)\r\n                  console.log(NewData[Point], text)\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, data: NewData}\r\n                  })\r\n\r\n                  props.control.forceUpdate()\r\n                }\r\n              }}*/\r\n              value={\r\n                props.state.TempGraph.data[Point]\r\n              }\r\n            />\r\n          <View style={{padding:6, paddingRight: 15}}>\r\n            <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => {\r\n              var index = Point;\r\n              index = index +1\r\n              if (index > props.state.TempGraph.data.length -1){\r\n                index = 0\r\n              }\r\n              setPoint(index)\r\n            }}/>\r\n          </View>\r\n          <Input\r\n              label=\"Curve Name\"\r\n              containerStyle={[{width:\"auto\", borderWidth:1}]}\r\n              style={[ApplicationStyles.input, Helpers.borderContainer, {borderRadius:0}]}\r\n              \r\n              onChangeText={text => {\r\n                /*var name = text;\r\n                name = name.replace(' ', '_')\r\n                if (isNaN(name[0])){\r\n                  var NewLegends = props.state.Legends;\r\n                  NewLegends[0] = name\r\n                  props.control.setState({\r\n                    TempGraph: {...props.state.TempGraph, name: name},\r\n                    Legends: NewLegends\r\n                  })\r\n                }*/\r\n              }}\r\n              value={\r\n                props.state.TempGraph.name\r\n              }\r\n            />\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n} \r\n\r\n/*\r\n<Button Text=\"Save\" buttonStyle={{width:100, marginLeft:20}}\r\n            onPress={() => {\r\n              props.props.setCurve(props.state.TempGraph)\r\n            } }/>\r\n*/\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime, MemSections: MemSections})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CurveElement);\r\nexport {\r\n  WeightsToGraphData,\r\n}","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Dimensions, SafeAreaView, FlatList, Picker } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\nimport CurveElement from './CurveElement'\r\n\r\nclass GrowthCurve extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {CurveList} = this.setData(props)\r\n    var D = new Date()\r\n    this.state = {\r\n      CurveList: CurveList,\r\n\r\n      Display: 0,\r\n\r\n      CurveName: \"\",\r\n      DataPoints: [],\r\n      Periode: \"Weeks\",\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurveList = localDataStore.graphs\r\n    return { CurveList }\r\n  }\r\n\r\n  getData(){\r\n    this.props.getCurve()\r\n  }\r\n\r\n  checkData(props){\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.graphs && JSON.stringify(this.state.CurveList)!==JSON.stringify(this.props.firebase.localDataStore.graphs)) {\r\n          const {CurveList} = this.setData(this.props)\r\n          this.setState({\r\n            CurveList: CurveList,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    var AverageGrowth = 0\r\n    for(var i = 0; i < this.state.DataPoints.length; i++){\r\n      var value = this.state.DataPoints[i].value\r\n      if (value === \"\" || value === null) value = 0\r\n      value = parseFloat(value)\r\n\r\n      if (i === 0) continue;\r\n      var Growth = value - this.state.DataPoints[i-1].value\r\n      AverageGrowth = (AverageGrowth + Growth) / 2\r\n    }\r\n    AverageGrowth = AverageGrowth.toFixed(3)\r\n\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {this.state.Display === 0?(\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n            {this.state.CurveList ? (\r\n              <View style={[Helpers.fill, Helpers.fullWidth, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <FlatList\r\n                  data={Object.keys(this.state.CurveList).filter(e => e !== '__jsogObjectId' && e !== 'update_time')}\r\n                  renderItem={({item})=>{\r\n                    return(\r\n                      <Button Text={item} onPress={() => {\r\n                        var CurveData = this.state.CurveList[item]\r\n\r\n                        var DataPoints = []\r\n                        CurveData.data.forEach(element => {\r\n                          DataPoints.push({value: element})\r\n                        });\r\n                        this.setState({\r\n                          Display: 2,\r\n                          CurveName: item,\r\n                          DataPoints: DataPoints,\r\n                          Periode: CurveData.periode\r\n                        })\r\n                      }}/>\r\n                    )\r\n                  }}\r\n                  keyExtractor={(item, index) => index.toString()}\r\n                />\r\n              </View>\r\n            ):(<></>)}\r\n            <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth]}>\r\n              <Button Text={\"New Curve\"} onPress={() => {\r\n                this.setState({\r\n                  Display: 1,\r\n                  DataPoints: [{value:\"0\"},{value:\"0\"}]\r\n                })\r\n              }}/>\r\n            </View>\r\n          </View>\r\n          ):(\r\n            //#region Edit or create\r\n            <View style={[Helpers.contentContainer, Helpers.fullSize, {marginHorizontal:0, paddingHorizontal:-20}]}>\r\n              {this.state.Display === 1?( // Create\r\n                <Input label={\"CurveName\"}\r\n                  containerStyle={[{borderWidth:1, marginTop:10}]}\r\n                  style={[ApplicationStyles.input, ]}\r\n                  onChangeText={text => {\r\n                    if (text){\r\n                      if (DataStringCheck(text)){\r\n                        this.setState({CurveName: text})\r\n                      }\r\n                    }else {\r\n                      this.setState({CurveName: text})\r\n                    }\r\n                  }}\r\n                  value={\r\n                    this.state.CurveName\r\n                  }\r\n                />\r\n              ):( //Edit\r\n                <TitleElement Text={this.state.CurveName}/>\r\n              )}\r\n              <View style={[Helpers.fill, Helpers.fullWidth]}>\r\n                <ContentProp texts={[\"Data Points\"]} datas={[\"Periode: \" + this.state.Periode]} />\r\n                <ContentProp texts={[\"Average Growth: \" + AverageGrowth]} datas={[]} />\r\n                <View style={[Helpers.borderContainer, Helpers.fillCenter, Helpers.fullWidth, {alignSelf:'center'}]}>\r\n                  <CurveElement Display={true} DataPoints={this.state.DataPoints} Height={200} Width={455}/>\r\n                </View>\r\n                <View>\r\n                  <FlatList\r\n                    data={this.state.DataPoints}\r\n                    style={[App?styles.AppStyle:styles.WebStyle]}\r\n                    renderItem={({item, index}) => {\r\n                      return(\r\n                        <Input \r\n                          type='number'\r\n                          step=\"0.1\"\r\n\r\n                          label={\"Day: \" + (index)}\r\n                          containerStyle={[Helpers.fullWidth,{borderWidth:1, marginTop:10}]}\r\n                          style={[ApplicationStyles.input]}\r\n                          \r\n                          onChangeText={text => {\r\n                            if (!isNaN(text) || text.endsWith('.') && text.split('.').length <= 2) {\r\n                              var DataPoints = [ ...this.state.DataPoints ];\r\n                              DataPoints[index].value = text;\r\n                              this.setState({DataPoints});\r\n                            }\r\n                          }}\r\n                          value={\r\n                            \"\" + item.value\r\n                          }\r\n                        />\r\n                      )}\r\n                    }\r\n                      //Setting the number of column\r\n                      numColumns={1}\r\n                  />\r\n                </View>\r\n                <View style={{height:20}} />\r\n                <Button Text={\"New Point\"} onPress={() => {\r\n                  var DataPoints = [ ...this.state.DataPoints ];\r\n                  var value = this.state.DataPoints&&this.state.DataPoints.length >= 1?this.state.DataPoints[this.state.DataPoints.length-1].value:\"0\"\r\n                  DataPoints.push({value:value})\r\n                  this.setState({\r\n                    DataPoints\r\n                  })\r\n                }}/>\r\n              </View>\r\n\r\n              <View style={[Helpers.buttonContainer, Helpers.borderContainer, Helpers.midWidth, {marginTop:10}]}>\r\n                <Button Text={\"Save\"} onPress={() => {\r\n                  var update = true;\r\n\r\n                  if (this.state.CurveName !== \"\"){\r\n                    var Name = this.state.CurveName;\r\n                    if (!Object.keys(this.state.CurveList).includes(Name)){\r\n                      if (this.state.Display === 2) { // update on non existing\r\n                        this.props.setViewError(\"Cannot update non-existing Curve. (Please refresh)\")\r\n                        update = false \r\n                      }\r\n                    } \r\n                    else {\r\n                      if (this.state.Display === 1) { // create on allready existing\r\n                        this.props.setViewError(\"Cannot create allready existing Curve.\")\r\n                        update = false \r\n                      }\r\n                    }\r\n                  }else {\r\n                    this.props.setViewError(\"Curve template need a name.\")\r\n                    update = false\r\n                  }\r\n\r\n                  if (update) {\r\n                    this.props.setViewError(null)\r\n                    this.props.setViewLoading(true)\r\n                    var newCurve = {name:this.state.CurveName, periode:this.state.Periode}\r\n                    var Data = []\r\n                    var index = 0;\r\n                    this.state.DataPoints.forEach(element => {\r\n                      Data[index] = parseFloat(element.value)\r\n                      index++;\r\n                    });\r\n                    newCurve.data = Data;\r\n                    this.props.updateCurve(newCurve)\r\n                    \r\n                    this.setState({\r\n                      Display: 0\r\n                    })\r\n                  }\r\n                }}/>\r\n              </View>\r\n            </View>\r\n            //#endregion\r\n          )}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  AppStyle: {\r\n    \r\n  },\r\n  WebStyle: {\r\n    height:400\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getCurve: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: \"\"})),\r\n    updateCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.GRAPH, {Graph: curve})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(GrowthCurve);\r\n//export default GrowthCurve;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, ScrollView } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nclass Operations extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.setCurrentData({})\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, {marginBottom:60}] }>\r\n          </View>\r\n\r\n          <View style={[Helpers.buttonContainer, Helpers.halvWidth, Helpers.fillColMain]}>\r\n            <OperationsPanel section={true}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    setCurrentData: actionType => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, action: actionType})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Operations);\r\n//export default Operations;\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Datetime_Picker } from '../../../Components'\r\nimport Style from '../CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass Weighing extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      weight: \"\",\r\n      quantity: quantity,\r\n      date: new Date().getTime()\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = Sections? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.penId && Pens[CurrentData.penId] && CurrentData.penId != Pen){\r\n      Pen = CurrentData.penId\r\n    }\r\n    var quantity = 1\r\n    if (localDataStore && localDataStore.pens) {\r\n      var _Pen = localDataStore.pens[Pen]\r\n      if (_Pen && _Pen.datas && _Pen.datas.count) quantity = _Pen.datas.count\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen, quantity}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n\r\n          const {Sections, Section, Pens, Pen, quantity} = this.setData(this.props)\r\n\r\n          this.setState({\r\n            Sections: Sections,\r\n            Section: Section,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n\r\n            quantity: quantity,\r\n            weight: \"\",\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin] }>\r\n              <Button Text=\"Weighing\" buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            \r\n            <View style={[Helpers.borderContainer, Helpers.fullWidth, {marginBottom:20}] }>\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Section}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  if (this.state.Sections[itemValue]){\r\n                    const Pens = sortObject(this.state.Sections[itemValue].pens)\r\n                    var quantity = 1\r\n                    if (localDataStore && localDataStore.pens) {\r\n                      var Pen = localDataStore.pens[Object.keys(Pens)[0]]\r\n                      if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                    }\r\n                    this.setState({\r\n                      Section: itemValue,\r\n                      Pens: Pens,\r\n                      Pen: Object.keys(Pens)[0],\r\n                      quantity: quantity,\r\n                    })\r\n                  }\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Sections).map((Section, i) => {\r\n                    return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <Picker\r\n                mode=\"dropdown\"\r\n                selectedValue={this.state.Pen}\r\n                style={{ height: 50, width: 150 }}\r\n                onValueChange={(itemValue, itemIndex) => {\r\n                  var quantity = 1\r\n                  if (localDataStore && localDataStore.pens) {\r\n                    var Pen = localDataStore.pens[itemValue]\r\n                    if (Pen && Pen.datas && Pen.datas.count) quantity = Pen.datas.count\r\n                  }\r\n                  this.setState({\r\n                    quantity: quantity,\r\n                    Pen: itemValue\r\n                  })\r\n                }}\r\n              >\r\n                {Object.keys(this.state.Pens).map((Pen, i) => {\r\n                    return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n                })}\r\n              </Picker>\r\n\r\n              <View style={[Helpers.fullWidth, {borderWidth:0 ,height: 65, marginTop:10, paddingHorizontal:5, paddingTop:0, borderRadius:0, alignItems:\"center\"}]}>\r\n                <View style={[Helpers.fullWidth, {alignItems:\"flex-start\"}]}>\r\n                  <Text style={[ApplicationStyles.text, {marginHorizontal:5, marginTop:2, color:Colors.input, fontSize: 15, fontWeight: \"bold\"}]}>Weight date:</Text>\r\n                </View>\r\n                <View style={[Helpers.fullWidth, {alignItems:'flex-start'}]}>\r\n                  <Datetime_Picker Selected={this.state.date}\r\n                      onValueChange={(date)=>{\r\n                        this.setState({\r\n                          date: date.getTime()\r\n                        })\r\n                    }}/>\r\n                </View>\r\n              </View>\r\n              \r\n              <Input\r\n                label=\"Animal quantity\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  if (!isNaN(text)){\r\n                    this.setState({\r\n                      quantity: text\r\n                    })\r\n                  }\r\n                }}\r\n                value={this.state.quantity}\r\n              />\r\n              <Input\r\n                label=\"Total Weight\"\r\n                style={{ ...Style.input}}\r\n                onChangeText={text => {\r\n                  this.setState({\r\n                    weight: text\r\n                  })\r\n                }}\r\n                value={this.state.weight}\r\n              />\r\n            </View>\r\n\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text=\"Submit\"\r\n                onPress={() => {\r\n                  if (!this.state.Section){\r\n                    this.props.setViewError(\"A section is needed\")\r\n                  } else if (!this.state.Pen){\r\n                    this.props.setViewError(\"A pen is needed\")\r\n                  } else if (isNaN(this.state.quantity) || this.state.quantity === \"\" || this.state.quantity <= 0){\r\n                    this.props.setViewError(\"Quantity have to be a number bigger than 0\")\r\n                  } else if (isNaN(this.state.weight) || this.state.weight === \"\") {\r\n                    this.props.setViewError(\"Weight have to be a number\")\r\n                  }\r\n                  else {\r\n                    this.props.setViewLoading(true)\r\n                    this.props.setViewError(null)\r\n                    this.props.newWeight(this.state.Pen, parseFloat(this.state.weight), this.state.date, parseFloat(this.state.quantity))\r\n                    this.setState({\r\n                      weight: \"\",\r\n                      date: new Date().getTime()\r\n                    })\r\n                  }\r\n                } }/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    newWeight: (penId, weight, date, quantity) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.WEIGHING, {PenId: penId, Weight:weight, Quantity:quantity, Date:date})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Weighing);\r\n//export default Weighing;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, Picker } from 'react-native'\r\nimport { Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, DataStringCheck } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, TitleElement } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\n\r\nclass DataEditor extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {Sections, Section, Pens, Pen} = this.setData(props)\r\n    this.state = {\r\n      Sections: Sections,\r\n      Section: Section,\r\n\r\n      Pens: Pens,\r\n      Pen: Pen,\r\n      NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    if (!localDataStore.sections) localDataStore.sections = {}\r\n    this.props.getSections(localDataStore.sections.update_time)\r\n  }\r\n\r\n  setData(Props) {\r\n    //Set Sections\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    var Sections = false;\r\n    \r\n    if (localDataStore && localDataStore.sections && localDataStore.sections !== Sections) {\r\n      Sections = sortObject(localDataStore.sections)\r\n    }\r\n\r\n    //Set Section\r\n    const CurrentData = Props.firebase.currentData;\r\n    var Section = Sections? Object.keys(Sections)[0] : \"\"\r\n    if (CurrentData && CurrentData.data && CurrentData.data.section && Sections[CurrentData.data.section]) {\r\n      if (CurrentData.data.section != Section) {\r\n        Section = CurrentData.data.section\r\n      }\r\n    }\r\n\r\n    //Pens & Pen\r\n    var Pens = (Sections&&Sections[Section])? sortObject(Sections[Section].pens): {}\r\n    var Pen = Sections? Object.keys(Pens)[0]: \"\"\r\n    if (CurrentData && CurrentData.dataId && Pens[CurrentData.dataId] && CurrentData.dataId != Pen){\r\n      Pen = CurrentData.dataId\r\n    }\r\n\r\n    if (!Sections) Sections = {}\r\n    return {Sections, Section, Pens, Pen}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase)  {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.sections))) {\r\n            \r\n            const {Sections, Section, Pens, Pen} = this.setData(this.props)\r\n\r\n            this.setState({\r\n              Sections: Sections,\r\n              Section: Section,\r\n              Pens: Pens,\r\n              Pen: Pen,\r\n              NewSection: (Sections&&Object.keys(Sections).length > 0)?false:true,\r\n            })\r\n          }\r\n        }\r\n        if (this.props.firebase.currentData) {\r\n          if (this.props.firebase.currentData != prevProps.firebase.currentData){\r\n            this.forceUpdate()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData\r\n\r\n    var DataView = (<View></View>);\r\n\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = PenEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigEditor_View_Creator(this, CurrentData, localDataStore)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          {DataView}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst PenEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <PenEditor_Titles CurrentAction={CurrentData.action}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {CurrentData.action === Actions.CREATE ?(\r\n          <Input\r\n            label=\"Pen name\"\r\n            style={{ ...Style.input}}\r\n            onChangeText={text => {\r\n              if (text){\r\n                if (DataStringCheck(text)){\r\n                  Control.setState({Pen: text})\r\n                }\r\n              }else {\r\n                Control.setState({Pen: text})\r\n              }\r\n            }}\r\n            value={Control.state.Pen}\r\n          />\r\n        ):(<></>)}\r\n        {CurrentData.action === Actions.DELETE ?(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        ):(<></>)}\r\n      </View>\r\n\r\n      {CurrentData.action === Actions.CREATE || CurrentData.action === Actions.DELETE ?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else if (!exists && CurrentData.action === Actions.DELETE){\r\n                  Control.props.setViewError(\"Cannot remove non-existing pen\")\r\n                }\r\n                else {\r\n                  Control.props.setViewError(null)\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.penAction(CurrentData.action, Control.state.Section, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserOperations\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n    </View>\r\n  )\r\n}\r\n\r\nconst PenEditor_Titles = (props) => {\r\n  switch(props.CurrentAction) {\r\n    case Actions.CREATE:\r\n      return(\r\n        <TitleElement Text={\"Add Pen\"}/>\r\n      )\r\n    case Actions.DELETE:\r\n      return(\r\n        <TitleElement Text={\"Remove Pen\"}/>\r\n      )\r\n    default:\r\n      return(<></>)\r\n  }\r\n}\r\n\r\nconst PigEditor_View_Creator = (Control, CurrentData, localDataStore) => {\r\n  var Sections = Control.state.Sections;\r\n  if (CurrentData.action === Actions.CREATE) {\r\n    //Sections[\"New Section\"] = {}\r\n  }\r\n\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      <TitleElement Text={\"Add Pig: \" + CurrentData.pigtag}/>\r\n      \r\n      <View style={ [Helpers.borderContainer, Helpers.midWidth, {marginBottom:20}] }>\r\n        <Section_Picker Control={Control} CurrentData={CurrentData} localDataStore={localDataStore}/>\r\n        {Control.state.NewSection?(\r\n        <Input\r\n          label=\"Pen name\"\r\n          style={{ ...Style.input}}\r\n          onChangeText={text => {\r\n            if (text){\r\n              if (DataStringCheck(text)){\r\n                Control.setState({Pen: text})\r\n              }\r\n            }else {\r\n              Control.setState({Pen: text})\r\n            }\r\n          }}\r\n          value={Control.state.Pen}\r\n        />\r\n        ):(\r\n          <Picker\r\n            mode=\"dropdown\"\r\n            selectedValue={Control.state.Pen}\r\n            style={{ height: 50, width: 150 }}\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              Control.setState({\r\n                Pen: itemValue\r\n              })\r\n            }}\r\n          >\r\n            {Object.keys(Control.state.Pens).map((Pen, i) => {\r\n                return (<Picker.Item label={Pen} value={Pen} key={i}/>)\r\n            })}\r\n          </Picker>\r\n        )}\r\n        {CurrentData.action === Actions.CREATE?(\r\n        <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n          <Button Text=\"Submit\"\r\n            onPress={() => {\r\n              if (!Control.state.Section || Control.state.Section === \"\"){\r\n                Control.props.setViewError(\"A section is needed\")\r\n              } else if (!Control.state.Pen || Control.state.Pen === \"\"){\r\n                Control.props.setViewError(\"A pen name is needed\")\r\n              } else if (!isNaN(Control.state.Section) || !isNaN(Control.state.Section[0])){\r\n                Control.props.setViewError(\"Section name cannot be or start with a number\")\r\n              } else if (!isNaN(Control.state.Pen) || !isNaN(Control.state.Pen[0])){\r\n                Control.props.setViewError(\"Pen name cannot be or start with a number\")\r\n              }\r\n              else {\r\n                var exists = false;\r\n\r\n                Object.keys(Control.state.Sections).map((section, i) => {\r\n                  if (Control.state.Sections[section].pens){\r\n                    var test = Object.keys(Control.state.Sections[section].pens).filter(e => e === Control.state.Pen).length\r\n                    if (test) exists = true\r\n                  }\r\n                })\r\n\r\n                if (exists && CurrentData.action === Actions.CREATE && Control.state.NewSection) {\r\n                  Control.props.setViewError(\"Given pen name already exists\")\r\n                } else {\r\n                  Control.props.setViewLoading(true)\r\n                  Control.props.setViewError(null)\r\n                  Control.props.pigAction(CurrentData.action, CurrentData.pigtag, Control.state.Pen)\r\n                  NavigationService.navigate(\"UserPigs\")\r\n                }\r\n              }\r\n            } }/>\r\n        </View>\r\n      ):(<></>)}\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst Section_Picker = ({Control, CurrentData, localDataStore}) => {\r\n  if (Control.state.NewSection && CurrentData.action === Actions.CREATE){\r\n    return(\r\n      <Input\r\n        label=\"Section Name\"\r\n        style={{ ...Style.input}}\r\n        onChangeText={text => {\r\n          if (text){\r\n            if (DataStringCheck(text)){\r\n              Control.setState({Section: text})\r\n            }\r\n          }else {\r\n            Control.setState({Section: text})\r\n          }\r\n        }}\r\n        value={Control.state.Section}\r\n      />\r\n    )\r\n  } else {\r\n    return(\r\n      <Picker\r\n        mode=\"dropdown\"\r\n        selectedValue={Control.state.Section}\r\n        style={{ height: 50, width: 150 }}\r\n        onValueChange={(itemValue, itemIndex) => {\r\n          var Section = itemValue\r\n          var NewSection = Control.state.NewSection\r\n          var Pens = Control.state.Pens\r\n          var Pen = Control.state.Pen\r\n\r\n          if (itemValue === \"New Section\"){\r\n            NewSection = true;\r\n            Section = \"Section_\" + Object.keys(Control.state.Sections).length\r\n          } else {\r\n            Pens = sortObject(Control.state.Sections[itemValue].pens)\r\n            \r\n            if (CurrentData.action === Actions.DELETE){\r\n              Pen = Object.keys(Pens)[Object.keys(Pens).length-1]\r\n            }\r\n            else {\r\n              if (CurrentData.type == DataRefs.PIGS){\r\n                Pen = Object.keys(Pens)[0]\r\n              }else {\r\n                Pen = \"Pen_\" + (Object.keys(Pens).length +1)\r\n              }\r\n            }\r\n          }\r\n          \r\n          Control.setState({\r\n            Section: Section,\r\n            NewSection: NewSection,\r\n            Pens: Pens,\r\n            Pen: Pen,\r\n          })\r\n        }}>\r\n        {Object.keys(Control.state.Sections).map((Section, i) => {\r\n            return (<Picker.Item label={Section} value={Section} key={i}/>)\r\n        })}\r\n      </Picker>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getSections: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.SECTIONS, {DataTime: DataTime})),\r\n    penAction: (action, senctionId, penId) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PENS, {SectionId:senctionId, PenId:penId})),\r\n    pigAction: (action, tagId, penId,) => dispatch(FirebaseActions.actionStarting(action, DataRefs.PIGS, {TagId:tagId, PenId:penId})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataEditor);\r\n//export default DataEditor;\r\n","import React, { Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time, CurvePredict } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pens extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n\r\n      CommentsList: CommentsList,\r\n      Comments: Comments,\r\n\r\n      action: \"\"\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pens = sortObject(localDataStore.pens)\r\n    if (Pens[CurrentData.penId]){\r\n      CurrentData.data = Pens[CurrentData.penId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    var CommentsList = [];\r\n    var Comments = [];\r\n    if (localDataStore && localDataStore.comments) {\r\n      if (localDataStore.comments[CurrentData.penId]) {\r\n        CommentsList = localDataStore.comments[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n          var name = Object.keys(CommentsList)[i]\r\n          if (!name) continue;\r\n          var object = CommentsList[name];\r\n          if (!object || !object.time) continue;\r\n          Comments.push({[name]:object})\r\n        }\r\n        Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Comments = Comments.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings, CommentsList, Comments}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n\r\n      var MemTime = null\r\n      if (localDataStore.weighings && localDataStore.weighings[this.state.currentData.penId]) MemTime = localDataStore.weighings.update_time\r\n      this.props.getWeights(this.state.currentData.penId, MemTime, localDataStore.sections)\r\n\r\n      this.props.getComments(this.state.currentData.penId)\r\n      this.props.getBatch(localDataStore.batchs.update_time)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings))) ||\r\n            (localDataStore.comments && JSON.stringify(this.state.Comments)!==JSON.stringify(sortObject(localDataStoree.comments)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings, CommentsList, Comments} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n\r\n            CommentsList: CommentsList, \r\n            Comments: Comments,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      \r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        if (Predict && Predict.Now) displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n\r\n      var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Control weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Weighings}\r\n                renderItem={({item, index}) => {\r\n                  if (item === \"__jsogObjectId\") return (<></>);\r\n                  var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Weight.time)]}\r\n                                datas={[Weight.weight + \"   : \" + Weight.count + \" pigs\"]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Comments}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Comment = this.state.CommentsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                              datas={[(Comment.quantity?(Comment.quantity + \" * \"):(\"\")) + Comment.action + \":\\n\" + Comment.data]}\r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId, DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId, DataTime: DataTime,  MemSections: MemSections})),\r\n    getComments: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.COMMENTS, {PenId: penId})),\r\n    getBatch: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {DataTime: DataTime})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pens);\r\n//export default DataDisplay_Pens;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\n//import DeviceActions from '../../../Stores/Device/Actions'\r\n//import { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay_Pigs extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData: props.currentData,\r\n    }\r\n\r\n    const {CurrentData, WeighingsList, Weighings} = this.setData(props)\r\n    this.state = {\r\n      currentData: CurrentData,\r\n\r\n      WeighingsList: WeighingsList,\r\n      Weighings: Weighings,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n\r\n    var CurrentData = this.state.currentData;\r\n    var Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n\r\n    var WeighingsList = [];\r\n    var Weighings = [];\r\n    var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n    if (localDataStore && localDataStore.weighings) {\r\n      if (localDataStore.weighings[CurrentData.penId]) {\r\n        WeighingsList = localDataStore.weighings[CurrentData.penId];\r\n        for(var i = 0; i < Object.keys(WeighingsList).length; i++) {\r\n          var name = Object.keys(WeighingsList)[i]\r\n          if (!name) continue;\r\n          var object = WeighingsList[name];\r\n          if (!object || !object.time) continue;\r\n          Weighings.push({[name]:object})\r\n        }\r\n        Weighings = Weighings.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n        if (App) {\r\n          Weighings = Weighings.slice(0,5)\r\n        }\r\n      }\r\n    }\r\n    if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n    return {CurrentData, WeighingsList, Weighings}\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore && this.state.currentData.penId) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (!localDataStore.pens) localDataStore.pens = {}\r\n      this.props.getPens(localDataStore.pens.update_time)\r\n      this.props.getWeights(this.state.currentData.penId)\r\n      this.props.getBatch(null)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if ((JSON.stringify(prevProps.currentData)!==JSON.stringify(this.state.currentData)) ||\r\n            (localDataStore.sections && JSON.stringify(this.state.Sections)!==JSON.stringify(sortObject(localDataStore.sections))) ||\r\n            (localDataStore.weighings && JSON.stringify(this.state.Weighings)!==JSON.stringify(sortObject(localDataStoree.weighings)))\r\n        ) {\r\n          const {CurrentData, WeighingsList, Weighings} = this.setData(this.props)\r\n          this.setState({\r\n            currentData: CurrentData,\r\n\r\n            WeighingsList: WeighingsList,\r\n            Weighings: Weighings,\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.state.currentData\r\n\r\n    if (!CurrentData.data) {\r\n      return(\r\n        <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n          <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n        </View>\r\n      )\r\n    } else {\r\n      var pigcount = CurrentData.data.datas.count?CurrentData.data.datas.count:0\r\n      var penWeight = []\r\n      if (this.state.Weighings.length > 0) {\r\n        var count = pigcount?pigcount:1\r\n        penWeight = this.state.Weighings[0][Object.keys(this.state.Weighings[0])].weight / this.state.Weighings[0][Object.keys(this.state.Weighings[0])].count\r\n      }\r\n\r\n      var batch_name = CurrentData.data.datas.batch?CurrentData.data.datas.batch:\"No Batch\"\r\n      var batch = {}\r\n\r\n      //TODO: Cleanup load mem throws..\r\n      var age = \"\";\r\n      var displayWeight = penWeight;\r\n      if (CurrentData.data.datas.batch && localDataStore.batchs && localDataStore.batchs[CurrentData.data.datas.batch]) {\r\n        batch = localDataStore.batchs[CurrentData.data.datas.batch];\r\n        var StartTime = batch.time;\r\n        age = Math.floor(((Date.now()-StartTime)/(1000*60*60*24)));\r\n        CurrentData.data.datas.gcurve = batch.gcurve;\r\n\r\n        var Predict = CurvePredict(localDataStore, CurrentData.penId)\r\n        displayWeight = Predict.Now\r\n      }\r\n\r\n      if (!batch.datas) batch.datas = {};\r\n      if (!batch.datas.devianceMin) batch.datas.devianceMin = 0;\r\n      if (!batch.datas.devianceMax) batch.datas.devianceMax = 0;\r\n\r\n      return(\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth, Metrics.bottomMargin, Helpers.rowCenter] }>\r\n            <View style={{padding:6, paddingRight: 15}}>\r\n              <Icon name=\"md-arrow-back\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, false)}/>\r\n            </View>\r\n            <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n              <Button Text={CurrentData.penId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n                onPress={() => {} }/>\r\n            </View>\r\n            <View style={{padding:6, paddingLeft: 15}}>\r\n              <Icon name=\"md-arrow-forward\" type='ionicon' size={25} color=\"black\" onPress={() => onPageSwipe(this, localDataStore, CurrentData, true)}/>\r\n            </View>\r\n          </View>\r\n          \r\n          <View style={[Helpers.fullWidth]}>\r\n            <ContentProp texts={[\"Pig count\", \"Batch\", \"Age Days\", \"Weight\", \"Growth Cruve\", \"Alarm Max\", \"Alarm Min\", \"Mixtur\", \"Correction\", \"Portion in kg\"]} onPress={(element) => onDataPress(1, element)} \r\n              datas={[pigcount, batch_name, age, /*penWeight*/ displayWeight, CurrentData.data.datas.gcurve?CurrentData.data.datas.gcurve:\"default\", batch.datas.devianceMin + \" %\", batch.datas.devianceMax + \" %\", \"-\", \"-\", \"-\"]} />\r\n          </View>\r\n\r\n          <View style={{height:20}} />\r\n          <View style={[Helpers.fill, App?Helpers.fullWidth:Helpers.midWidth, App?{}:{height:215}]}>\r\n            <ContentProp texts={[\"Last weighings\"]} datas={[]} />\r\n            <View style={{height:10}} />\r\n            <FlatList\r\n              data={this.state.Weighings}\r\n              renderItem={({item, index}) => {\r\n                if (item === \"__jsogObjectId\") return (<></>);\r\n                var Weight = this.state.WeighingsList[Object.keys(item)[0]]\r\n                return(\r\n                  <ContentProp texts={[format_Time(Weight.time)]}\r\n                              datas={[Weight.weight]} \r\n                  />\r\n                )}\r\n              }\r\n                //Setting the number of column\r\n                numColumns={1}\r\n                keyExtractor={(item, index) => String(index)}\r\n              />\r\n          </View>\r\n\r\n          <View style={{height:30}} />\r\n\r\n          <View style={[Helpers.borderContainer, Helpers.midWidth]}>\r\n            <OperationsPanel />\r\n          </View>\r\n        </View>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getPens: (DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {DataTime: DataTime})),\r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {BatchId: batchId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay_Pigs);\r\n//export default DataDisplay_Pigs;","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\nimport { Icon, Input } from 'react-native-elements'\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport DeviceActions from '../../../Stores/Device/Actions'\r\nimport { ConnectionState } from '../../../Stores/Device/Selectors'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject, format_Time } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel, ContentProp, OperationsPanel } from '../../../Components'\r\nimport DataDisplay_Pens from './DataDisplay_Pens'\r\nimport DataDisplay_Pigs from './DataDisplay_Pigs'\r\n\r\nimport { ApplicationStyles, Helpers, Metrics, Images, Colors } from '../../../Theme'\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      currentData:{}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.props.firebase && this.props.firebase.localDataStore) {\r\n      const localDataStore = this.props.firebase.localDataStore\r\n      if (this.props.firebase.currentData && this.props.firebase.currentData.type){\r\n        const CurrentData = this.props.firebase.currentData;\r\n        switch(CurrentData.type){\r\n          case DataRefs.PIGS:\r\n            //this.props.getWeights()\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase.localDataStore) {\r\n        const localDataStore = this.props.firebase.localDataStore\r\n        if (this.props.firebase.currentData && this.props.firebase.currentData.type &&\r\n            JSON.stringify(this.state.currentData)!==JSON.stringify(this.props.firebase.currentData)) {\r\n          \r\n          const CurrentData = this.props.firebase.currentData;\r\n\r\n          switch(CurrentData.type){\r\n            case DataRefs.PENS:\r\n              if (localDataStore.pens) {\r\n                var Pens = sortObject(localDataStore.pens)\r\n                if (Pens[CurrentData.penId]){\r\n                  if (JSON.stringify(CurrentData.data)!==JSON.stringify(Pens[CurrentData.penId])){\r\n                    CurrentData.data = Pens[CurrentData.penId]\r\n                  }\r\n                  \r\n                  this.props.setCurrentDataElement(CurrentData)\r\n                }\r\n              }\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            case DataRefs.PIGS:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n            default:\r\n              this.setState({\r\n                currentData:CurrentData\r\n              })\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const ErrorMessage = this.props.firebase.viewError\r\n    const CurrentData = this.state.currentData\r\n\r\n    var DataView = (<View></View>);\r\n    switch(CurrentData.type){\r\n      case DataRefs.PENS:\r\n        DataView = (<DataDisplay_Pens currentData={this.state.currentData}/>)\r\n        break;\r\n      case DataRefs.PIGS:\r\n        DataView = PigData_View(this, CurrentData, localDataStore) //(<DataDisplay_Pigs currentData={this.state.currentData}/>)\r\n        break;\r\n    }\r\n\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n        <View\r\n          style={[\r\n            Helpers.mainContainer,\r\n          ]}\r\n        >\r\n          <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n            {ErrorMessage ? (\r\n              <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n            ):(<></>)}\r\n              {DataView}\r\n          </View>\r\n          \r\n          {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n            <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n          }\r\n        </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nfunction onPageSwipe(Control, localDataStore, CurrentData, dir) {\r\n  const section = localDataStore.pens[CurrentData.penId].section\r\n  const Pens = sortObject(localDataStore.sections[section].pens)\r\n\r\n  if (CurrentData.type === DataRefs.PENS && CurrentData.data && Pens[CurrentData.penId]) {\r\n    var index = Object.keys(Pens).indexOf(CurrentData.penId)\r\n\r\n    switch (dir) {\r\n      case true: //forward\r\n        index = index +1\r\n        break;\r\n      case false: //backward\r\n        index = index -1\r\n        break;\r\n    }\r\n\r\n    if (index < 0) index = Object.keys(Pens).length - 1\r\n    else if (index >= Object.keys(Pens).length) index = 0\r\n\r\n    Control.props.setCurrentData(Object.keys(Pens)[index])\r\n    NavigationService.replace(\"DataDisplay\")\r\n  }\r\n}\r\n\r\nfunction onDataPress(sender, element){\r\n  switch(sender){\r\n    case 1:\r\n      switch(element.index){\r\n        case 0:\r\n          console.log(\"test\")\r\n          break;\r\n      }\r\n      break;\r\n  }\r\n}\r\n\r\nconst PigData_View = (Control, CurrentData, localDataStore) => {\r\n  /*const connectedDevice = useSelector((state) => state.device.connectedDevice)\r\n  const DeviceData = useSelector((state) => state.device.deviceData)\r\n  const connectedState = useSelector((state) => state.device.connectionState)*/\r\n\r\n  var Pigs;\r\n  if (localDataStore && localDataStore.pigs) {\r\n    Pigs = sortObject(localDataStore.pigs)\r\n    if (Pigs[CurrentData.TagId]){\r\n      CurrentData.data = Pigs[CurrentData.TagId]\r\n    }\r\n  }\r\n  \r\n  if (CurrentData.data && !CurrentData.data.datas) CurrentData.data.datas = {}\r\n\r\n  if (!CurrentData.data) {\r\n    return(\r\n      <View style={[Helpers.fillRowCenter, Helpers.center, Helpers.logoContainer]}>\r\n        <Image style={Helpers.fullSize} source={Images.Hexa_icon} resizeMode={'contain'} />\r\n      </View>\r\n    )\r\n  }\r\n  \r\n  /*\r\n    <Row size={1.3}>\r\n          <Col size={1.5} style={{backgroundColor:\"red\"}}>\r\n            <Row size={2.25} style={{backgroundColor:\"blue\"}}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </Row>\r\n            <Row size={1.50}>\r\n              <Col><Text>Messages</Text></Col>\r\n              <Col><Text>Errors</Text></Col>\r\n            </Row>\r\n          </Col>\r\n          <Col>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </Col>\r\n        </Row>\r\n  */\r\n  var App = Platform.OS === \"android\" || Platform.OS === \"ios\" ? true: false\r\n  return(\r\n    <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n      {App ? (\r\n        <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth]}>\r\n          <View style={[ Helpers.fill, Helpers.column, {backgroundColor:\"red\"}]}>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth, {backgroundColor: \"blue\"}]}>\r\n              <View style={{justifyContent:'center', alignItems: 'center'}}/>\r\n            </View>\r\n            <View style={[ Helpers.fill, Helpers.row, Helpers.fullWidth,]}>\r\n              <Text>Messages</Text>\r\n              <Text>Errors</Text>\r\n            </View>\r\n          </View>\r\n          <View style={[ Helpers.fill, Helpers.column]}>\r\n            {connectedState === ConnectionState.CONNECTED ? (\r\n              <View style={{...styles.circle, backgroundColor:\"green\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>Device is</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            ):(\r\n              <View style={{...styles.circle, backgroundColor:\"red\", justifyContent:'center', alignItems: 'center'}}>\r\n                <Text>No Device</Text>\r\n                <Text>connected</Text>\r\n              </View>\r\n            )}\r\n          </View>\r\n        </View>\r\n      ):(<></>)}\r\n      <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n        <Button Text={CurrentData.TagId} buttonStyle={{backgroundColor: Colors.AgriDarkblue}}\r\n          onPress={() => {} }/>\r\n      </View>\r\n      <View style={[Helpers.fullWidth]}>\r\n        <ContentProp ingrid={true} texts={[\"Section\", \"Pen\"]} datas={[CurrentData.data.section, CurrentData.data.pen]} />\r\n        <View style={{height:20}}/>\r\n        <View style={Helpers.midWidth, Helpers.colCenter}>\r\n          <Input\r\n            label={\"Comment:\"}\r\n            multiline={true}\r\n            containerStyle={[{borderWidth:1}]}\r\n            style={[ApplicationStyles.input]}\r\n            onChangeText={text => {\r\n              \r\n            }}\r\n            value={\r\n              \"NONE\"\r\n            }\r\n          />\r\n        </View>\r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getWeights: (penId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {PenId: penId})),\r\n\r\n    setCurrentData: penId => dispatch(FirebaseActions.setCurrentData({type:DataRefs.PENS, penId: penId})),\r\n    setCurrentDataElement: element => dispatch(FirebaseActions.setCurrentData(element)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React, { useEffect, Component } from 'react'\r\nimport { Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, FlatList } from 'react-native'\r\nimport { Input, Icon } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, GetCurve_FromBatch, CurvePredict, GetBatchEnd, AccumulateTime, format_Time, GetStats_FromBatch, GetStats_FromPen } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { LineChart } from 'react-native-chart-kit'\r\nimport { Button, TitleElement, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from './UserPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Colors } from '../../../Theme'\r\nimport CurveElement, { WeightsToGraphData } from './CurveElement'\r\n\r\nimport { FlatGrid } from 'react-native-super-grid';\r\n\r\nclass DataDisplay extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    var {isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments} = this.setData(props)\r\n    this.state = {\r\n      Prediction: false,\r\n\r\n      isClosed: isClosed,\r\n      isVirtual: isVirtual,\r\n\r\n      StartDate: StartDate,\r\n      EndDate: EndDate,\r\n      Animals: Animals,\r\n      TargetWeight: TargetWeight,\r\n      AverageWeight: AverageWeight, \r\n      AverageGrowth:AverageGrowth,\r\n      Comments_List: Comments_List,\r\n      Comments: Comments,\r\n    }\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore;\r\n    const CurrentData = Props.firebase.currentData;\r\n\r\n    var Batch = localDataStore.batchs[this.props.firebase.currentData.batchId];\r\n    var StartDate, EndDate, TargetWeight, PenCount, Animals, AverageWeight, AverageGrowth, isClosed, isVirtual\r\n    var Data = GetStats_FromBatch(Batch, localDataStore)\r\n    if (Data) {\r\n      StartDate = Data.StartDate\r\n      EndDate = Data.EndDate\r\n      TargetWeight = Data.TargetWeight\r\n      PenCount = Data.PenCount\r\n      Animals = Data.Animals\r\n      AverageWeight = Data.AverageWeight\r\n      AverageGrowth = Data.AverageGrowth\r\n      isClosed = Data.isClosed \r\n      isVirtual = Data.isVirtual\r\n    }\r\n\r\n    var Comments_List = null\r\n    var Comments = [];\r\n    if (Batch && Batch.state && Batch.state === \"Closed\" && Batch.closed && Batch.closed.comments) {\r\n      Comments_List = []\r\n      Object.keys(Batch.pens).reverse().filter(e => (e !== '__jsogObjectId')).forEach(element => {\r\n        var CommentsList = [];\r\n        if (Batch.closed.comments[element]) {\r\n          CommentsList = Batch.closed.comments[element];\r\n          for(var i = 0; i < Object.keys(CommentsList).length; i++) {\r\n            var name = Object.keys(CommentsList)[i]\r\n            if (!name) continue;\r\n            var object = CommentsList[name];\r\n            if (!object || !object.time) continue;\r\n            object.pen = element\r\n            Comments.push({[name]:object})\r\n          }\r\n        }\r\n        Comments_List = Comments_List.concat(CommentsList);\r\n      });\r\n    }\r\n    Comments = Comments.sort((a, b) => (a.time > b.time) ? 1 : -1)\r\n    return { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments }\r\n  }\r\n\r\n  getData() {\r\n    const localDataStore = this.props.firebase.localDataStore;\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    if (CurrentData && CurrentData.batchId && localDataStore.batchs[CurrentData.batchId]){\r\n      const batchData = localDataStore.batchs[CurrentData.batchId]\r\n      \r\n      this.props.getWeights(localDataStore.weighings?localDataStore.weighings.update_time:null, localDataStore.sections)\r\n\r\n      var PenMemTime = null\r\n      if (localDataStore.pens) PenMemTime = localDataStore.pens.update_time\r\n      if (batchData.pens) {\r\n        Object.keys(batchData.pens).filter(e => e !== '__jsogObjectId').forEach(Pen => {\r\n          this.props.getPen(Pen, PenMemTime)\r\n        })\r\n      }\r\n\r\n      var TempGraph = \"\"\r\n      if (CurrentData.curveId) {\r\n        TempGraph = CurrentData.curveId;\r\n      }\r\n      this.props.getCurve(TempGraph)\r\n    }\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps) {\r\n      this.checkData(this.props);\r\n      if (this.props.firebase.localDataStore) {\r\n        var { isClosed, isVirtual, StartDate, EndDate, Animals, TargetWeight, AverageWeight, AverageGrowth, Comments_List, Comments } = this.setData(this.props)\r\n        this.setState({\r\n          Prediction: false,\r\n          isClosed: isClosed,\r\n          isVirtual: isVirtual,\r\n\r\n          StartDate: StartDate,\r\n          EndDate: EndDate,\r\n          Animals: Animals,\r\n          TargetWeight: TargetWeight,\r\n          AverageWeight: AverageWeight, \r\n          AverageGrowth:AverageGrowth,\r\n          Comments_List: Comments_List,\r\n          Comments: Comments,\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props);\r\n    this.getData();\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const ErrorMessage = this.props.firebase.viewError\r\n\r\n    const localDataStore = this.props.firebase.localDataStore\r\n    const CurrentData = this.props.firebase.currentData;\r\n\r\n    var StartDate = this.state.StartDate\r\n\r\n    var Dif_Time = new Date().getTime() - StartDate\r\n    var Days = Dif_Time / (1000 * 3600 * 24);\r\n    Days = Days.toFixed(0) //TODO: closed date...\r\n\r\n    StartDate = new Date(StartDate).getDate() + \"/\" + (new Date(StartDate).getMonth() +1) + \"/\" + new Date(StartDate).getFullYear()\r\n\r\n    var EndDate = this.state.EndDate\r\n    EndDate = new Date(EndDate).getDate() + \"/\" + (new Date(EndDate).getMonth() +1) + \"/\" + new Date(EndDate).getFullYear()\r\n\r\n    var Virtual = String(this.state.isVirtual)\r\n    Virtual = Virtual.charAt(0).toUpperCase() + Virtual.slice(1)\r\n    return(\r\n      <ScrollView style={[Helpers.fullSize, Helpers.fill]}>\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fill]}>\r\n          {ErrorMessage ? (\r\n            <Text style={ApplicationStyles.error}>{ErrorMessage}</Text>\r\n          ):(<></>)}\r\n          <TitleElement Text={this.props.firebase.currentData.batchId?this.props.firebase.currentData.batchId:\"-NON-\"}/>\r\n          <View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Start', data: StartDate},\r\n                  {title: 'End Forecast', data: EndDate},\r\n                  {title: 'Target Weight', data: this.state.TargetWeight},\r\n                  //{title: 'Virtual cal', data: Virtual}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <View style={[Helpers.fullWidth, {justifyContent:'center'}]}>\r\n              <FlatGrid\r\n                itemDimension={120}\r\n                spacing={10}\r\n\r\n                data={[\r\n                  {title: 'Animals', data: this.state.Animals},\r\n                  {title: 'Day', data: Days},\r\n                  {title: 'Avarage weight', data: this.state.AverageWeight},\r\n                  {title: 'Average growth', data: this.state.AverageGrowth}\r\n                ]}\r\n                renderItem={({ item }) => (\r\n                  <View style={[Helpers.borderContainer, {textAlign:'center'}]}>\r\n                    <Text>{item.title}</Text>\r\n                    <Text>{item.data}</Text>\r\n                  </View>\r\n                )}\r\n                />\r\n            </View>\r\n            <Button Text=\"Show Predict\"\r\n                onPress={() => {\r\n                  this.setState({\r\n                    Prediction: !this.state.Prediction\r\n                  })\r\n                } }/>\r\n          </View>\r\n          <View style={[Helpers.fill, Helpers.fullWidth, {minHeight:750}]}>\r\n            <CurveElement Predict={this.state.Prediction} weighings={localDataStore.weighings}/>\r\n          </View>\r\n          {this.state.Comments_List?(\r\n            <View style={[Helpers.fill, Helpers.midWidth, {height:415}]}>\r\n              {/* diff for app / web here ^ */}\r\n              <ContentProp texts={[\"Action log\"]} datas={[]} />\r\n              <View style={{height:10}} />\r\n              <FlatList\r\n                data={this.state.Comments.filter(e => (e !== '__jsogObjectId'))}\r\n                renderItem={({item, index}) => {\r\n                  var Comment = this.state.Comments_List[0][Object.keys(item)[0]]\r\n                  if (!Comment) return null\r\n                  return(\r\n                    <ContentProp texts={[format_Time(Comment.time) + \":\\n\" + Comment.user]}\r\n                                datas={[Comment.pen + \": \" + Comment.action + \":\\n\" + Comment.data]}\r\n                    />\r\n                  )}\r\n                }\r\n                  //Setting the number of column\r\n                  numColumns={1}\r\n                  keyExtractor={(item, index) => String(index)}\r\n                />\r\n            </View>\r\n          ):(<></>)}\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n      </ScrollView>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n    \r\n    getPen: (penId, DataTime) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.PENS, {PenId: penId, DataTime:DataTime})),\r\n    getWeights: (DataTime, MemSections) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.WEIGHING, {DataTime: DataTime, MemSections: MemSections})),\r\n    \r\n    getBatch: (batchId) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.BATCHS, {})),\r\n    getCurve: (curveid) => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.GRAPH, {GraphId: curveid})),\r\n    setCurve: (curve) => dispatch(FirebaseActions.actionStarting(Actions.CREATE, DataRefs.GRAPH, {Graph: curve}))\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataDisplay);\r\n//export default DataDisplay;","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport UserFrontScreen from '../Containers/Cloud/UserPanel/FrontScreen'\r\nimport UserDashBoardScreen from '../Containers/Cloud/UserPanel/Dashboard'\r\nimport UserPigsScreen from '../Containers/Cloud/UserPanel/Pigs'\r\nimport UserPensScreen from '../Containers/Cloud/UserPanel/Pens'\r\nimport UserBatchsScreen from '../Containers/Cloud/UserPanel/Batchs'\r\nimport UserCurvesScreen from '../Containers/Cloud/UserPanel/GrowthCurves'\r\n\r\nimport UserOperationsScreen from '../Containers/Cloud/UserPanel/Operations'\r\nimport Weighing from '../Containers/Cloud/UserPanel/Weighing'\r\n\r\nimport UserDataEditor from '../Containers/Cloud/UserPanel/DataEditor'\r\nimport UserDataDisplay from '../Containers/Cloud/UserPanel/DataDisplay'\r\nimport UserDataPlotter from '../Containers/Cloud/UserPanel/DataPlotter'\r\n\r\nimport { Actions, DataRefs } from '../Stores/Firebase/Selectors'\r\nimport FirebaseActions from '../Stores/Firebase/Actions'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    UserFront: {\r\n      screen: UserFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n        headerLeft: (props) => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => {\r\n              if (props.label === \"System Board\") {\r\n                NavigationService.nacigationPop()\r\n              }\r\n              else NavigationService.navigate('MainStack')\r\n            }}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'user_front',\r\n    },\r\n\r\n    UserDashBoard: {\r\n      screen: UserDashBoardScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Dash Board',\r\n      }),\r\n      path: 'user_dashboard',\r\n    },\r\n\r\n    UserPigs: {\r\n      screen: UserPigsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pigs',\r\n      }),\r\n      path: 'user_pigs',\r\n    },\r\n\r\n    UserPens: {\r\n      screen: UserPensScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Pens',\r\n      }),\r\n      path: 'user_pens',\r\n    },\r\n\r\n    UserBatchs: {\r\n      screen: UserBatchsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Batchs',\r\n      }),\r\n      path: 'user_batchs',\r\n    },\r\n\r\n    UserCurves: {\r\n      screen: UserCurvesScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Curves',\r\n      }),\r\n      path: 'user_curves',\r\n    },\r\n\r\n    /**************** Operations */\r\n    UserOperations: {\r\n      screen: UserOperationsScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    WeighingOperations: {\r\n      screen: Weighing,\r\n      navigationOptions: () => ({\r\n        title: 'Operations',\r\n      }),\r\n      path: 'user_operations',\r\n    },\r\n\r\n    /**************** Data Displays */\r\n    DataEditor: {\r\n      screen: UserDataEditor,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_dataedtior',\r\n    },\r\n\r\n    DataDisplay: {\r\n      screen: UserDataDisplay,\r\n      navigationOptions: () => ({\r\n        title: 'User Data',\r\n      }),\r\n      path: 'user_datadisplay',\r\n    },\r\n\r\n    DataPlotter: {\r\n      screen: UserDataPlotter,\r\n      navigationOptions: () => ({\r\n        title: 'Batch Data',\r\n      }),\r\n      path: 'user_dataplotter',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'UserFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import { StyleSheet } from 'react-native'\r\nimport { Helpers, Metrics, Fonts, Colors } from '../../../Theme'\r\n\r\nexport default StyleSheet.create({\r\n\r\n})\r\n","import React, { useEffect, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator } from 'react-native'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, Button_Panel } from '../../../Components'\r\nimport Style from './AdminPanelStyle'\r\nimport { ApplicationStyles, Helpers, Metrics, Images } from '../../../Theme'\r\n\r\nclass FrontScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ISLOADPAGE: true,\r\n    }\r\n  }\r\n\r\n  getData(){\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.props.clearDataMem()\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n    const firebaseUser = this.props.firebase.firebaseUser\r\n    \r\n    return(\r\n      <View\r\n      style={[\r\n        Helpers.mainContainer,\r\n      ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullSize, Helpers.fillColMain]}>\r\n          {firebaseUser?(\r\n          <View style={ Helpers.textContainer }>\r\n            <Text style={ApplicationStyles.text}>Welcome: {firebaseUser.displayName ? firebaseUser.displayName : firebaseUser.email}</Text>\r\n          </View>):(<></>)}\r\n\r\n          <Button_Panel \r\n            Texts={[\"User Board\", \"Systems\"]}\r\n            Images={[Images.DashBoard, Images.System,]}\r\n            onPress={(ele) => {\r\n              switch(ele.text){\r\n                case \"User Board\":\r\n                  NavigationService.navigate(\"UserBoard\")\r\n                  break;\r\n                case \"Systems\":\r\n                  NavigationService.navigate(\"SystemBoard\")\r\n                  break;\r\n              }\r\n              ele.text\r\n            }}\r\n          />\r\n          \r\n          <View style={[Helpers.buttonContainer, Helpers.midWidth] }>\r\n            <Button Text=\"LogOut\"\r\n              onPress={() => {\r\n                this.props.logOut()\r\n              }}/>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    logOut: () => dispatch(FirebaseActions.actionStarting(Actions.SIGN, DataRefs.USERSDATA)),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FrontScreen);\r\n//export default FrontScreen;\r\n","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass UserListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {UserList} = this.setData(props)\r\n    this.state = {\r\n      UserList: UserList,\r\n      User: \"\"\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getUsers()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var UserList = null\r\n    if (localDataStore && localDataStore.users) {\r\n      UserList = sortObject(localDataStore.users)\r\n    }\r\n    \r\n    return {UserList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.users && JSON.stringify(this.state.UserList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.users))) {\r\n            const {UserList} = this.setData(this.props)\r\n            this.setState({\r\n              UserList: UserList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.UserList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.UserList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var User = this.state.UserList[item];\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={User.name} itemStyle={[{minWidth: 190, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:70, height:35, justifyContent:\"center\"}]} Title={\"\"} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{width:90, height:35}]} Title={User.state} onPress={() => {\r\n                              this.setState({\r\n                                User: User.name\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <Input\r\n              label={\"User-tag:\"}\r\n              containerStyle={[{borderWidth:1, marginTop:10}]}\r\n              style={[ApplicationStyles.input, ]}\r\n              onChangeText={text => {\r\n                this.setState({\r\n                  User: text\r\n                })\r\n              }}\r\n              value={\r\n                this.state.User\r\n              }\r\n            />\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    getUsers: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.USERS, {UserId:\"\"})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserListBoard);","import React, { useEffect, useState, Component } from 'react'\r\nimport { Platform, Text, View, ActivityIndicator, Image, StyleSheet, ScrollView, SafeAreaView, FlatList } from 'react-native'\r\nimport { ListItem, Input } from 'react-native-elements'\r\nimport { useDispatch, useSelector, connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport NavigationService from '../../../Services/NavigationService'\r\n\r\nimport FirebaseActions from '../../../Stores/Firebase/Actions'\r\nimport { Actions, DataRefs, sortObject } from '../../../Stores/Firebase/Selectors'\r\n\r\nimport { Button, OperationsPanel, CustomListItem, ContentProp } from '../../../Components'\r\nimport Style from '../../../Containers/Cloud/CloudScreenStyle'\r\nimport { ApplicationStyles, Helpers, Metrics } from '../../../Theme'\r\n\r\nimport { FlatGrid, SectionGrid } from 'react-native-super-grid';\r\n\r\nclass SystemListBoard extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const {FarmList} = this.setData(props)\r\n    this.state = {\r\n      FarmList: FarmList,\r\n      Farm: {name: \"\"}\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.props.getFarms()\r\n  }\r\n\r\n  setData(Props) {\r\n    const localDataStore = Props.firebase.localDataStore\r\n\r\n    var FarmList = null\r\n    if (localDataStore && localDataStore.farms) {\r\n      FarmList = sortObject(localDataStore.farms)\r\n    }\r\n    return {FarmList}\r\n  }\r\n\r\n  checkData(props) {\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.setViewLoading(false)\r\n    this.props.setViewError(null)\r\n    this.checkData(this.props)\r\n    this.getData()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.props !== prevProps){\r\n      this.checkData(this.props);\r\n\r\n      if (this.props.firebase) {\r\n        if (this.props.firebase.localDataStore) {\r\n          if (this.props.firebase.localDataStore.farms && JSON.stringify(this.state.FarmList)!==JSON.stringify(sortObject(this.props.firebase.localDataStore.farms))) {\r\n            const {FarmList} = this.setData(this.props)\r\n            this.setState({\r\n              FarmList: FarmList,\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const IsLoading = this.props.firebase.firebaseIsLoading\r\n\r\n    return(\r\n      <View\r\n        style={[\r\n          Helpers.mainContainer,\r\n        ]}\r\n      >\r\n        <View style={[Helpers.contentContainer, Helpers.fullWidth, Helpers.fill]}>\r\n          <View style={[Helpers.fill, Helpers.buttonContainer, Helpers.fullWidth, Metrics.bottomMargin, Helpers.column]}>\r\n            {this.state.FarmList ? (\r\n              <View style={[Helpers.fill, Helpers.borderContainer, Metrics.smallHorizontalPadding, Metrics.smallVerticalPadding, {maxWidth:800, marginTop:10}]}>\r\n                <SafeAreaView style={styles.container}>\r\n                  <FlatList\r\n                    data={Object.keys(this.state.FarmList).filter(e => e !== '__jsogObjectId')}\r\n                    renderItem={({item, index})=>{\r\n                      var Farm = this.state.FarmList[item];\r\n                      Farm.id = item\r\n                      return(\r\n                        <View style={[Helpers.fill, Helpers.rowCenter, Helpers.fullWidth, {height:35}]}>\r\n                          <CustomListItem Title={Farm.name} itemStyle={[{minWidth: 100, height:35,}]} onPress={() => {\r\n                              //this.props.setData(item, Section, Pen)\r\n                              //NavigationService.navigate(\"DataDisplay\")\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35, justifyContent:\"center\"}]} Title={Farm.manager} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n\r\n                          <CustomListItem itemStyle={[{minWidth:150, height:35}]} Title={Farm.email} onPress={() => {\r\n                              this.setState({\r\n                                Farm: Farm\r\n                              })\r\n                            }}/>\r\n                        </View>\r\n                      )\r\n                    }}\r\n                    keyExtractor={(item, index) => index.toString()}\r\n                  />\r\n                </SafeAreaView>\r\n              </View>\r\n            ):(<></>)} \r\n            <View style={[Helpers.rowCenter, Helpers.fullWidth, {height:120}]}>\r\n              <Input\r\n                label={\"Farm-tag:\"}\r\n                containerStyle={[Helpers.halvWidth,{borderWidth:1, marginTop:10}]}\r\n                style={[ApplicationStyles.input, ]}\r\n                editable={false}\r\n                onChangeText={text => {\r\n                  var Farm = this.state.Farm;\r\n                  Farm.name = text;\r\n                  this.setState({\r\n                    Farm: Farm\r\n                  })\r\n                }}\r\n                value={\r\n                  this.state.Farm.name\r\n                }\r\n              />\r\n              <Button Text=\"Consys\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  //this.props.logOut()\r\n                }}/>\r\n              <Button Text=\"Farm Panel\"\r\n                boxStyle={[{marginLeft:10}]}\r\n                onPress={() => {\r\n                  if (this.state.Farm.id !== \"\") {\r\n                    this.props.clearDataMem()\r\n                    this.props.setUserFarm(this.state.Farm.id)\r\n                    NavigationService.navigate(\"UserPanel\")\r\n                  }\r\n                }}/>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        {(IsLoading || this.props.firebase.viewIsLoading) &&\r\n          <ActivityIndicator style={Helpers.loadingContainer} size='large' />\r\n        }\r\n      </View>\r\n    )\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  circle: {\r\n    width: 125,\r\n    height: 125,\r\n    borderRadius: 125/2,\r\n    marginTop: Metrics.tiny,\r\n    marginLeft: Metrics.tiny,\r\n  },\r\n});\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { firebase } = state\r\n  return { firebase }\r\n};\r\n\r\nconst mapDispatchToProps  = (dispatch) => {\r\n  return {\r\n    setFirebaseError: error => dispatch(FirebaseActions.setFirebaseError(error)),\r\n    setViewLoading: state => dispatch(FirebaseActions.viewIsLoading(state)),\r\n    setViewError: error => dispatch(FirebaseActions.setViewError(error)),\r\n\r\n    clearDataMem: () => dispatch(FirebaseActions.actionStarting(Actions.CLEAR, DataRefs.USERSDATA)),\r\n    getFarms: () => dispatch(FirebaseActions.actionStarting(Actions.FETCH, DataRefs.FARMS, {FarmId: \"\"})),\r\n    setUserFarm: (FarmId) => dispatch(FirebaseActions.actionStarting(Actions.UPDATE, DataRefs.USERS, {farms:{[FarmId]: true}})),\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SystemListBoard);","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, View, Text } from 'react-native'\r\nimport { Icon } from 'react-native-elements'\r\n\r\nimport NavigationService from '../Services/NavigationService'\r\n\r\nimport AdminFrontScreen from '../Containers/Cloud/AdminPanel/FrontScreen'\r\n\r\nimport AdminUserBoard from '../Containers/Cloud/AdminPanel/UserBoard'\r\nimport AdminSystemBoard from '../Containers/Cloud/AdminPanel/SystemBoard'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\n\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    \r\n    AdminFront: {\r\n      screen: AdminFrontScreen,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('MainStack')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n\r\n    UserBoard: {\r\n      screen: AdminUserBoard,\r\n      navigationOptions: () => ({\r\n        title: 'User Board',\r\n      }),\r\n      path: 'admin_user_board',\r\n    },\r\n    SystemBoard: {\r\n      screen: AdminSystemBoard,\r\n      navigationOptions: () => ({\r\n        title: 'System Board',\r\n      }),\r\n      path: 'admin_system_board',\r\n    },\r\n\r\n    UserPanel: {\r\n      screen: UserPanelNavigation,\r\n      navigationOptions: () => ({\r\n        title: 'Admin Panel',\r\n        headerLeft: () => (\r\n          <View style={{padding:6, paddingLeft: 15}}>\r\n            <Icon type='ionicon' name=\"md-arrow-back\" size={25} color=\"black\" onPress={() => NavigationService.navigate('SystemBoard')}/>\r\n          </View>\r\n        ),\r\n      }),\r\n      path: 'admin_front',\r\n    },\r\n  },\r\n  {\r\n    initialRouteName: 'AdminFront', \r\n\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'float',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerTitleStyle:{...ApplicationStyles.navigationHeader},\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default StackNavigator\r\n","import React from 'react'\r\nimport { createAppContainer } from 'react-navigation'\r\nimport { createStackNavigator } from 'react-navigation-stack'\r\nimport { TouchableOpacity, Icon, View, Text } from 'react-native'\r\n\r\nimport SplashScreen from '../Containers/SplashScreen/SplashScreen'\r\nimport DeepLinkingScreen from '../Containers/DeepLinking/DeepLinkingScreen'\r\n\r\nimport FrontNavigation from '../Navigators/FrontNavigator'\r\nimport AuthNavigation from '../Navigators/AuthNavigator'\r\n\r\nimport UserPanelNavigation from '../Navigators/UserPanelNavigator'\r\nimport AdminPanelNavigator from '../Navigators/AdminPanelNavigator'\r\nimport { ApplicationStyles } from '../Theme'\r\n\r\n/**\r\n * The root screen contains the application's navigation.\r\n *\r\n * @see https://reactnavigation.org/docs/en/hello-react-navigation.html#creating-a-stack-navigator\r\n */\r\nconst StackNavigator = createStackNavigator(\r\n  {\r\n    // Create the application routes here (the key is the route name, the value is the target screen)\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#routeconfigs\r\n    SplashScreen: {\r\n      screen: SplashScreen,\r\n      navigationOptions: () => ({\r\n        headerShown: false,\r\n      }),\r\n    },\r\n\r\n    MainStack: {\r\n      screen: FrontNavigation, // Called By StartupSaga.js\r\n      path: 'Front',\r\n    },\r\n    \r\n    AuthStack: AuthNavigation, // All user pages\r\n\r\n    UserPanel: UserPanelNavigation, // 'Free' Users Pages... \r\n\r\n    AdminPanel: AdminPanelNavigator, // Admin Pages\r\n\r\n    DeepLinkingScreen: {\r\n      screen: DeepLinkingScreen,\r\n      path: 'deeplink',\r\n    },\r\n  },\r\n  {\r\n    // By default the application will show the splash screen\r\n    initialRouteName: 'SplashScreen',\r\n    // See https://reactnavigation.org/docs/en/stack-navigator.html#stacknavigatorconfig\r\n    headerMode: 'none',\r\n    defaultNavigationOptions:{\r\n      headerTitleAlign: 'center',\r\n      headerRight: () => (<View style={{padding:6}}></View>),\r\n    },\r\n  }\r\n)\r\n\r\nexport default createAppContainer(StackNavigator)\r\n","import React, { useEffect } from 'react'\r\nimport { View } from 'react-native'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport NavigationService from '../../Services/NavigationService'\r\nimport AppNavigator from '../../Navigators/AppNavigator'\r\n\r\nimport StartupActions from '../../Stores/Startup/Actions'\r\nimport { Helpers } from '../../Theme'\r\n\r\nconst RootScreen = () => {\r\n  // Deep linking prefix\r\n  const prefix = 'agrisysapp://';\r\n  \r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n    dispatch(StartupActions.startup())\r\n  }, [])\r\n\r\n  return (\r\n    <View style={Helpers.fill}>\r\n      <AppNavigator\r\n        // Initialize the NavigationService (see https://reactnavigation.org/docs/en/navigating-without-navigation-prop.html)\r\n        ref={(navigatorRef) => {\r\n          NavigationService.setTopLevelNavigator(navigatorRef)\r\n        }}\r\n        uriPrefix={prefix}\r\n      />\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default RootScreen\r\n","import { combineReducers } from 'redux'\r\nimport configureStore from './CreateStore'\r\nimport rootSaga from '../Sagas'\r\n\r\nimport { reducer as ExampleReducer } from './Example/Reducers'\r\nimport { reducer as DeviceReducer } from './Device/Reducers'\r\nimport { reducer as FirebaseReducer } from './Firebase/Reducers'\r\n\r\nexport default () => {\r\n  const rootReducer = combineReducers({\r\n    /**\r\n     * Register your reducers here.\r\n     * @see https://redux.js.org/api-reference/combinereducers\r\n     */\r\n    example: ExampleReducer,\r\n    device: DeviceReducer,\r\n    firebase: FirebaseReducer,\r\n  })\r\n\r\n  return configureStore(rootReducer, rootSaga)\r\n}\r\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/lib/integration/react'\n\nimport createStore from './Src/Stores'\nimport RootScreen from './Src/Containers/Root/RootScreen'\n\nconst { store, persistor } = createStore()\n\nconst App = () => (\n  <Provider store={store}>\n    {/**\n     * PersistGate delays the rendering of the app's UI until the persisted state has been retrieved\n     * and saved to redux.\n     * The `loading` prop can be `null` or any react instance to show during loading (e.g. a splash screen),\n     * for example `loading={<SplashScreen />}`.\n     * @see https://github.com/rt2zz/redux-persist/blob/master/docs/PersistGate.md\n     */}\n    <PersistGate loading={null} persistor={persistor}>\n      <RootScreen />\n    </PersistGate>\n  </Provider>\n);\n\nexport default App\n","module.exports = __webpack_public_path__ + \"static/media/Home.1fff8434.png\";","module.exports = __webpack_public_path__ + \"static/media/Dashboard.26766c7a.png\";","module.exports = __webpack_public_path__ + \"static/media/System.7e4af00c.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Curves.da739887.png\";","module.exports = __webpack_public_path__ + \"static/media/Growth-curve.7f9a7fea.png\";","module.exports = __webpack_public_path__ + \"static/media/User.d73be9fd.png\";","module.exports = __webpack_public_path__ + \"static/media/Sow.beff0aff.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABRCAYAAACuepoLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAq9JREFUeNrsnT1Lw1AUhk9FRFEhDhV0qgouLlrcjYOLi3XpasEfYjo62X/Quorg5iS0P0D8GBzVOAkWP6CVigg1197E0Naa3ER7b/K+cLig3tP4eJJz8g5XIig0JRS8Zr3Pn1+JUgE0JYgjK1JRqEz2y9DE1IJwgrdalRr1BxoZm6Th8aTvfVwvVqxacaE8zLXtQ+EEN+cHdH12QHPpLM0uZX3tbdSrdHmyS7VH0wY6w1caQNvwp5GxJC2v57+q2pJmRc7+HmAKaHBolGbTTkVvAGYIFdoBucfPp7p1rH8efwr280iJiu3ytUUr9iSY5+yZrqIqTAayzB+sIgOqHtJgq7vGD1IRpsaHUY3PTptWmCJjC5+/Ao8/7hlONZgZ/ow0OQylqkIGubv5Cl/3ATI4zFQUX+T7BRMCTMCM5mumqhf+fH8lvLdRqzqraJ7aU++pscznuyBvPk3XjEh/lKcpWZSVr8x+mMNufby/2p6m+rc58xRFZZvD0/O6b3PY/Zg5Pd5BA0I3B0yMRlsU3Ms0ALOlXAh5dwCzpZIVdwEh5uP4x+gGk1lwlYAQjDjCRAMCTMAETAgwARMwoZ5zphJiNpqonri73lrF8thu/U+C0x5Dpz0v2fWYKlcmGhC6OQSYMo1GMjnthkSsfr2WRFsD0lFfnlh5rswSyeO0y5BHyKiO4mgURh7POdCA0M0BEzAhwARMwIQAEzABEzAhwARMwIQ6FRen3fgPmHDaxVh5rswSwWnvlsOX4LQHzIEGhG4OmIAJASZgAiYEmIAJmPGEafJVBxZHi21sPCvH30Fv8W7uqMj3F/1uZCe6PtP3vxvQYg7TcO33dLe6LTh2ACk7Gpe5RxkeFcELKYd0m/UrT4q+zxMtBODgHOLcjHnc8oLyrMQvUDWKr3xX46cAAwCxt3YCfnN46AAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/Area_Colour.f4a4e098.png\";","module.exports = __webpack_public_path__ + \"static/media/AutoPig.ec16c410.png\";","module.exports = __webpack_public_path__ + \"static/media/Feed-Components.224ca1b3.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexagon-globe.fce26805.png\";","module.exports = __webpack_public_path__ + \"static/media/Hexa-icon.5129d536.png\";","module.exports = __webpack_public_path__ + \"static/media/Logo.9b051259.png\";","module.exports = __webpack_public_path__ + \"static/media/TOM.c88886f3.png\";"],"sourceRoot":""}